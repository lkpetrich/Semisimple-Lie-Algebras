(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    852554,      21511]
NotebookOptionsPosition[    797946,      20831]
NotebookOutlinePosition[    798389,      20849]
CellTagsIndexPosition[    798346,      20846]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction", "Section",ExpressionUUID->"75731fd3-3f03-4363-ab14-9e54500c7ab3"],

Cell["\<\
For doing semisimple Lie algebras, their representations with products and \
powers, and subalgebra branching rules. Important for particle physics, \
notably for space-time symmetries and gauge symmetries.

A Lie algebra is semisimple if its elements\[CloseCurlyQuote] commutators \
span the entire algebra: for algebra L, [L,L] = L

A semisimple Lie algebra is simple if it has no proper ideals. An ideal M is \
a subalgebra of an algebra L if the commutator of elements from L and M ar \
all in M: [L,M] <= M. A proper ideal is an ideal other than L or the empty \
algebra, {}.

Every semisimple algebra is a product of simple ones, and all the simple ones \
are known.\
\>", "Text",ExpressionUUID->"c6728ba0-7e94-48bd-91fc-a548c5ab97ff"],

Cell[CellGroupData[{

Cell["The Algebras", "Subsection",ExpressionUUID->"5d1e3cb4-f231-4b75-9de6-e198670cbfbf"],

Cell["\<\
Algebras are specified in this code as {family, rank}, where both family and \
rank are positive integers. Using n for the rank,\
\>", "Text",ExpressionUUID->"83b6169a-2691-4cb1-ac0d-db72e84e1a6d"],

Cell["A(n) ~ SU(n+1)", "ItemNumbered",ExpressionUUID->"ccb1fc63-89f1-41b6-b84a-6a8aab6746f3"],

Cell["B(n) ~ SO(2n+1)", "ItemNumbered",ExpressionUUID->"8dd6159c-335c-4fd9-9909-f0bae76d4450"],

Cell["C(n) ~ Sp(2n)", "ItemNumbered",ExpressionUUID->"c908cc44-8fa5-471e-b507-8eb26f68d9cd"],

Cell["D(n) ~ SO(2n)", "ItemNumbered",ExpressionUUID->"363b1115-eddb-40a8-935e-993d23b1845a"],

Cell["E(n) ~ n = 6, 7, 8 (3, 4, 5 reduce to other algebras)", "ItemNumbered",ExpressionUUID->"7bed3ce7-8d69-4268-b8e7-66097ed48a6b"],

Cell["F(n) ~ n = 4", "ItemNumbered",ExpressionUUID->"9d235a6e-8285-44c6-a506-6ffe6e8deca5"],

Cell["G(n) ~ n = 2", "ItemNumbered",ExpressionUUID->"6be2ac17-71af-44f7-ab42-c2b91ddb8031"],

Cell["\<\
Families A, B, C, D (1, 2, 3, 4) are the four infinite families of classical \
algebras, algebras for groups of unitary (A), orthogonal (B, D), and \
symplectic (C) matrices. The orthogonal-matrix algebras are also the algebras \
of spinors: SO(n) algebra ~ Spin(n) algebra. Note: these groups and their \
algebras are often written differently, like the algebras being written in \
small letters: so(n) for the algebra of groups SO(n) and Spin(n).

The algebras G2, F4, E6, E7, E8 are the five exceptional algebras.

This notebook also includes the single-generator algebra, which I call U(1), \
from a matrix group that it generators.

These algebras have several isomorphisms:\
\>", "Text",ExpressionUUID->"77c48fd4-2bb0-4b83-a809-ec8aabff7c69"],

Cell["U(1) ~ SO(2)", "Item",ExpressionUUID->"c4deba49-48d2-4232-9b13-1c1b9050bb08"],

Cell["A1 ~ B1 ~ C1 -- SU(2) ~ SO(3) ~ Sp(2)", "Item",ExpressionUUID->"4a9d9a45-4fa9-4603-a548-2abc4abacfcf"],

Cell["B2 ~ C2 -- SO(5) ~ Sp(4)", "Item",ExpressionUUID->"b8e0fc01-91e4-421d-8127-bd8e56c5ad5a"],

Cell["D2 ~ A1*A1 -- SO(4) ~ SU(2)*SU(2)", "Item",ExpressionUUID->"fb33fdfe-b7a7-4e0c-82c6-5ee0b5bf1b29"],

Cell["D3 ~ A3 -- SO(6) ~ SU(5)", "Item",ExpressionUUID->"86a66dbc-7ba8-40f0-92d9-9eff9eff2993"],

Cell["E3 ~ A2*A1 --  SU(3) * SU(2)", "Item",ExpressionUUID->"8517da03-fdac-4c09-9635-1c5694110fe2"],

Cell["E4 ~ A4 -- SU(5)", "Item",ExpressionUUID->"206a2e1b-ed8e-47e3-9f90-88050c164616"],

Cell["E5 ~ D5 -- SO(10)", "Item",ExpressionUUID->"ac4510c1-a02a-42ee-8544-f95f995f6e6f"],

Cell["\<\
Several features of Lie algebras are named after various mathematicians.\
\>", "Text",ExpressionUUID->"8d44b58d-ce2e-4150-8764-4a28723d62c9"],

Cell["Lie algebra - Sophus Lie: Norwegian, 1842 - 1899", "Item",ExpressionUUID->"74f95770-fede-4f45-a5b4-4d50de025658"],

Cell["Cartan matrix - \[CapitalEAcute]lie Cartan: French, 1869 - 1951", "Item",ExpressionUUID->"f72debc6-a228-44df-8e86-03ece7ccc746"],

Cell["Weyl orbit - Hermann Weyl: German, 1885 - 1955", "Item",ExpressionUUID->"4a7abfd8-bf77-4729-80ae-37edcc52d028"],

Cell["Dynkin diagram - Eugene Dynkin: Russian, 1924 - 2014", "Item",ExpressionUUID->"bccaecce-b67d-4048-b4ec-b031fce59fdf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Algebra Data", "Subsection",ExpressionUUID->"2104d536-76ba-4ef7-90b4-9c4ac5480c08"],

Cell["\<\
Object and data formats:

Dynkin diagram: {lengths of roots, connections}
Connections: {first root, second root, strength}

For root numbering in the diagrams, I have used common conventions as far as \
I can determine. For A(n) I number along the length of the diagram. For B(n) \
and C(n) I number toward the short (B) or the long (C) root, and for D(n), I \
number inward along the long branch, then outward along the short branches. \
For F4 and G2, I number long roots, then short roots, along the lengths of \
those diagrams. For E6, I number one long branch inward, then the other long \
branch outward, before getting to the short branch. For E7 and E8, I number \
the medium branch inward, then the long branch outward, then the short branch \
outward.

Note that for E7 and E8, there is an alternate convention: to number the long \
branch inward, then the medium branch outward, then the short branch outward.

Get a Lie algebra with
GetLieAlgebra[type_]
using the algebra type
It uses a cache variable: LieAlgebraCache
To reset it, do ResetLieAlgebras[]

Create a Lie algebra with
MakeLieAlgebra[type_]
type: algebra type {family,rank}
using
MakeDynkinDiagram[type_,eext_:True]
MakeMetric[dynkdiag_]
MakeCartanMatrix[dynkdiag_]
MakePositiveRoots[dynkdiag_]
MakeLieAlgebra[type_,eext_:False]
eext is whether or not to support exceptional groups E3 (A2*A1), E4 (A4), E5 \
(D5).

The algebra is stored as an association with these keys:
Type -- {family, rank}
Name -- (more usual sort of name)
Special -- special irreps, listed as {name, highest-weight vecotr}, names \
like singlet, fundamental, adjoint, vector, ...
DynkDiag -- Dynkin diagram
Metric -- algebra metric -- MakeMetric[DynkDiag]
CtnMat -- Cartan matrix -- MakeCartanMatrix[DynkDiag]
InvMet -- inverse of algebra metric
InvCtn -- inverse of Cartan matrix
PosRoots - positive root vectors -- MakePositiveRoots[CtnMat]
The algebra roots are in the Cartan-Weyl basis, where all the simple roots \
are {all 0\[CloseCurlyQuote]s except for one 1}.

Extras:
Scales the weight and connection values: ScaleDynkDiag[dd_,scale_]
Joins diagrams: JoinDynkDiags[dd1_, dd2_, ...]
Dimension (number of generators): AlgDimension[type_]\
\>", "Text",ExpressionUUID->"7bc9f658-1cd2-45d9-921e-60461bd66a64"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Orbits", "Subsection",ExpressionUUID->"a54cc1be-ef55-4dbc-b302-df8ba1306b7e"],

Cell["\<\
Weyl orbits are sets of roots induced by symmetries of the algebra\
\[CloseCurlyQuote]s root system, the Weyl group. These symmetries are \
generated by reflections of simple roots, and the groups grow in size very \
fast by increasing rank.

The groups:
A(n) - (n+1)! - permutations of (n+1) symbols
B(n), C(n) - 2^n*n! - signed permutations of n symbols
D(n) - 2^(n-1)*n! - like the previous, but with an even number of minus signs
G2 - 12 - Dih(6), the symmetry group of the hexagon
F4 - 1152 - symmetry group of the 24-cell 4D polytope
E6 - 51840 - automorphism group of the unique simple group of order 25920 - \
PSU(4,2), PSO(6-,2), PSp(4,3), PSO(5,3)
E7 - 2903040 - direct product of Z2 and the unique simple group of order \
1451520 - PSp(6,2), PSO(7,2)
E8 - 696729600 - O(8+,2) - of form 2.G.2 (extensions of G by two Z2\
\[CloseCurlyQuote]s) where G is the unique simple group of order 174182400 - \
PSO(8+,2)

The orbits have format list of {root, weight}.

Get a Weyl orbit with
GetOrbit[type_, maxwts_]
using the algebra type, the weights
It uses a cache variable: OrbitCache
To reset it, do ResetOrbits[]

To add 1 on the beginning, to make the format {degeneracy, root, weight}
GetCntdOrbit[type_,maxwts_]
using
AddCount[orb_]

MakeOrbit[type_, wts_, alg_, mwcheck_:True]
using the algebra type, the weights, the algorithm, and checking on whether \
the weights are maximum weights for a representation (the dominant weights \
for the orbit).

alg is one of three algorithms,
\[OpenCurlyDoubleQuote]WGGens\[CloseCurlyDoubleQuote] - with Weyl-group \
generators directly (accepts symbolic weights)
\[OpenCurlyDoubleQuote]DomWt\[CloseCurlyDoubleQuote] - uses the dominant weight
\[OpenCurlyDoubleQuote]Explicit\[CloseCurlyDoubleQuote] - uses the Weyl \
groups explicitly as far as is reasonable (accepts symbolic weights)
E6, E7, E8 not implemented: returns {} for them.

To use symbolic weights, like {a,b,c}, set mwcheck to False. The code \
canonicalizes expressions in them with Expand[].

To find which Weyl orbit a root is in, use
DomWtFromRoot[type_, root_] returns {d-w root, dominant weight of that orbit}\
\
\>", "Text",ExpressionUUID->"791218e9-e240-43ee-b379-c964885ca99b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps - Irreducible Representations", "Subsection",ExpressionUUID->"347bc930-bc5f-42a6-89ed-1850f4316e80"],

Cell["\<\
Strictly speaking, the representation of an algebra is a set of matrices that \
implements that algebra, but \[OpenCurlyDoubleQuote]representation\
\[CloseCurlyDoubleQuote] is often used to describe the basis vectors of that \
algebra, and so it will be here. They have format

List of {degeneracy, root, weight}

An irreducible representation (irrep for choice) is one that cannot be \
reduced to the sum of two representations.

Get an irrep with
GetRep[type_, maxwts_]
using the algebra type, the weights
It uses a cache variable: RepCache
To reset it, do ResetReps[]

Get an irrep\[CloseCurlyQuote]s Weyl orbits with
GetRepOrbits[type_, maxwts_]
using the algebra type, the weights
It uses a cache variable: RepOrbitCache
To reset it, do ResetRepOrbits[]

Create an irrep directly with
MakeRep[type_, maxwts_]
using
MakeRepRoots[type_, maxwts_]
MakeRepDegens[type_, reproots_]

One can also create one using Weyl orbits. One finds the Weyl-orbit content \
of an irrep with
MakeRepOrbits[type_, maxwts_]
using
MakeRepWODomWts[type_, maxwts_]
MakeRepWODWDegens[type_, maxwts_]

It has the same format as the rep in general: a list of {degeneracy, root, \
weight} where the weights are the dominant weights of the orbits.

Adds up the degeneracies to find the total degeneracy (multiplicity)
TotalDegenOfExpRep[x_] 

Uses Weyl\[CloseCurlyQuote]s celebrated formula; it\[CloseCurlyQuote]s much \
faster than calculating an irrep\[CloseCurlyQuote]s root/weight vectors
TotalDegen[type_,maxwts_] 
Generalized:
TotalDegenXtnd[type_,xttype_,maxwts_]
AlgProdTotalDegen[typelist_,maxwts_]
AlgProdTotalDegenXtnd[typelist_,xttype_,maxwts_]

Total degeneracy of every basic irrep: all of maxwts 0 except for 1
TotalDegenBasic[type_]

Finds the conjugate of an irrep
RepConjugate[type_,maxwts_]

Finds permutation \[OpenCurlyDoubleQuote]perm\[CloseCurlyDoubleQuote] of the \
branch roots for D4 / SO(8)
RepConjugateD4[type_,maxwts_,perm_]

RepReality[type_, maxwts_] gives the irrep\[CloseCurlyQuote]s reality: +1 for \
real, -1 for pseudoreal, and 0 for complex
- Real: self-conjugate, and matrices can be transformed into real ones
- Pseudoreal or quaternionic: self-conjugate, but matrices cannot be \
transformed into real ones
- Complex: not self-conjugate

RepProperties[type_, maxwts_] gives the irrep\[CloseCurlyQuote]s reality, the \
moduli for the congruency-class quantities, and those quantities themselves \
(parity, triality, etc.) These quantities are additive modulo those moduli.

CasimirInvariant[type_, maxwts_] is the Casimir invariant, sum of (algebra \
operator)^2, like in quantum-mechanical angular momentum.

RepIndex[type_, maxwts_] is the irrep\[CloseCurlyQuote]s index: (Casimir \
invariant) * (total degeneracy) / (algebra size) - it is useful in some \
applications

TotalDegen,CasimirInvariant, and RepIndex have a third argument, mwcheck, \
which defaults to True. TotalDegen[type_,maxwts_,mwcheck_:True] and likewise \
for the others. If one makes mwcheck False, then these three functions will \
symbolically evaluate their values for a symbolic max-weights vector.

On can get some stats on an orbit at
OrbitStats[type_,maxwts_]
It returns the max-root vector, the max-weight vector, the length of the \
orbit, and the length of the roots (root.metric.root).\
\>", "Text",ExpressionUUID->"22283115-a69c-4fe6-b8d1-f99b951dbdcf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rep Combinations", "Subsection",ExpressionUUID->"e3ef79e1-10d3-4eb0-919b-8599e7513b9b"],

Cell["\<\
For a list of irreps, specified as a list of max-weight vectors. It produces \
the same kind of output as GetRep[].
GetRepList[type_,mwlist_]

For a counted list of irreps, specified as a list of {count, max-weight \
vector}. It produces the same kind of output as GetRep[].
GetRepCntdList[type_,mwclist_]

Makes a counted list where the input has a type specified with \
\[OpenCurlyDoubleQuote]xttype\[CloseCurlyDoubleQuote]: \
\[OpenCurlyDoubleQuote]Sngl\[CloseCurlyDoubleQuote] for a single irrep, \
\[OpenCurlyDoubleQuote]List\[CloseCurlyDoubleQuote] for a list of irreps, and \
\[OpenCurlyDoubleQuote]Cntd\[CloseCurlyDoubleQuote] for a counted list of \
irreps.
MakeCountedList[xttype_,x_]

For a general rep argument, specified with \[OpenCurlyDoubleQuote]xttype\
\[CloseCurlyDoubleQuote]: \[OpenCurlyDoubleQuote]Sngl\[CloseCurlyDoubleQuote] \
for a single irrep, \[OpenCurlyDoubleQuote]List\[CloseCurlyDoubleQuote] for a \
list of irreps, and \[OpenCurlyDoubleQuote]Cntd\[CloseCurlyDoubleQuote] for a \
counted list of irreps.
GetRepXtnd[type_,xttype_,maxwts_]

These are for representations for algebra products. Their algebra arg is \
{la1, la2, ...}, while their irreps are {mw1, mw2, ...,u1,u2, ...}. mw1 is \
the max weights for algebra la1, mw2 is the max weights for algebra la2, and \
u1, u2, are additional U(1) factors. The root vectors are {r1, r2, ..., u1, \
u2, ...} and the weight vectors are {w1, w2, ..., u1, u2, ...}, where r1 and \
w1 are for la1 and mw2, etc.
GetAlgProdRep[tplist_,maxwts_]

For each rep\[CloseCurlyQuote]s orbits, like GetRepOrbits[] but in the format \
of GetAlgProdRep[]:
GetAlgProdRepOrbits[tplist_,maxwts_]

For a list of algebra-product irreps. Output is in the format of \
GetAlgProdRep[].
GetAlgProdRepList[tplist_,mwlist_]

For a counted list of algebra-product irreps. Output is in the format of \
GetAlgProdRep[].
GetAlgProdRepCntdList[tplist_,mwclist_]

For a general rep argument, specified with \[OpenCurlyDoubleQuote]xttype\
\[CloseCurlyDoubleQuote]. The type is \[OpenCurlyDoubleQuote]Sngl\
\[CloseCurlyDoubleQuote] for a single irrep, \[OpenCurlyDoubleQuote]List\
\[CloseCurlyDoubleQuote] for a list of irreps, and \
\[OpenCurlyDoubleQuote]Cntd\[CloseCurlyDoubleQuote] for a counted list of \
irreps.
GetAlgProdRepXtnd[tplist_,xttype_,maxwts_]

For Weyl orbits instead
GetAlgProdOrbit[tplist_,maxwts_]\
\>", "Text",ExpressionUUID->"f1ea775a-41b8-4d2e-967c-817d26eb10a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rep Products", "Subsection",ExpressionUUID->"ba02c53a-965b-4368-9c48-af051cf9baf2"],

Cell["\<\
For decomposing a product of two irreps into its irrep content, use their \
highest weights here. Makes a counted list of irreps, a list of {degeneracy, \
irrep highest weight}.
DecomposeRepProduct[type_, maxwt1_, maxwt2_]

For more general types of highest weights, where  the types are:  \
\[OpenCurlyDoubleQuote]Sngl\[CloseCurlyDoubleQuote] for a single irrep, \
\[OpenCurlyDoubleQuote]List\[CloseCurlyDoubleQuote] for a list of irreps, and \
\[OpenCurlyDoubleQuote]Cntd\[CloseCurlyDoubleQuote] for a counted list of \
irreps.
DecomposeRepProductXtnd[type_, xttype1_,maxwt1_,xttype2_, maxwt2_]

Uses an algebra product and highest weights consisting of a list of one for \
each algebra and U(1) factors following them
DecomposeAlgProdRepProduct[tplist_, maxwt1_, maxwt2_]

For more general types of reps, as before
DecomposeAlgProdRepProductXtnd[tplist_, xttype1_,maxwt1_,xttype2_, maxwt2_]

For Weyl orbits
DecomposeOrbitProduct[type_, maxwt1_, maxwt2_]

Alternates: these do rep products only on single irreps of each algebra, \
instead of for all of them together. They give the same results, though with \
different performance.
DecomposeRepProductXtndAlt[type_, xttype1_,maxwt1_,xttype2_, maxwt2_]
DecomposeAlgProdRepProductXtndAlt[tplist_, xttype1_,maxwt1_,xttype2_, maxwt2_]

DecomposeRepProdList[type_, maxwtlist_] works on a list of irreps\
\[CloseCurlyQuote] highest weights.\
\>", "Text",ExpressionUUID->"9957bd1b-3292-4147-bd14-93e30fc4357d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rep Powers - Plethysms", "Subsection",ExpressionUUID->"78b976a5-47ac-42cb-b62e-345550fa8f3a"],

Cell["\<\
For decomposing a rep power into parts with different symmetries for general \
positive-integer powers pwr. The symmetric part is the first part and the \
antisymmetric part is the last part, with mixed parts in between. Power = 1 \
returns {original}, and power = 0 returns {singlet}.
DecomposeRepPower[type_, maxwts_, pwr_]

Uses the highest-weight type system: \[OpenCurlyDoubleQuote]Sngl\
\[CloseCurlyDoubleQuote] for a single irrep, \[OpenCurlyDoubleQuote]List\
\[CloseCurlyDoubleQuote] for a list of irreps, and \
\[OpenCurlyDoubleQuote]Cntd\[CloseCurlyDoubleQuote] for a counted list of \
irreps.
DecomposeRepPowerXtnd[type_, xttype_,maxwts_, pwr_]

For algebra products
DecomposeAlgProdRepPower[tplist_, maxwts_, pwr_]

For algebra products and weight types
DecomposeAlgProdRepPowerXtnd[tplist_, xttype_,maxwts_, pwr_]

For Weyl orbits
DecomposeOrbitPower[type_, maxwts_, pwr_]

Pure symmetric and antisymmetric cases: sym = +1 and -1
These are analogous to DecomposeRepListPower[type_, mwlist_, pwr_], etc.

DecomposeRepPwrSym[type_, maxwts_, pwr_,sym_]
DecomposeRepPwrSymXtnd[type_, type_,maxwts_, pwr_,sym_]
DecomposeAlgProdRepPwrSym[tplist_, maxwts_, pwr_,sym_]
DecomposeAlgProdRepPwrSymXtnd[tplist_, type_,maxwts_, pwr_,sym_]
DecomposeOrbiPtwrSym[type_, maxwts_, pwr_,sym_]

One can find details on the symmetry types with the function
GetTensorPowerYDX[pwr_]
It returns an association:
\[OpenCurlyDoubleQuote]DgrmList\[CloseCurlyDoubleQuote] -> diagram list
\[OpenCurlyDoubleQuote]Kostka\[CloseCurlyDoubleQuote] -> Kostka matrix
\[OpenCurlyDoubleQuote]Nesting\[CloseCurlyDoubleQuote] -> rep-nesting matrix

The diagram list\[CloseCurlyQuote]s entries are {multiplicity in the power \
expansion, the diagram itself, the diagram\[CloseCurlyQuote]s length, a \
multinomial multiplicity factor}
Convenience functions for extracting all of each type:
YDGetMultiplicities[dgrmlist_]
YDGetRepDiagrams[dgrmlist_]
YDGetLengths[dgrmlist_]
YDGetMultinomFacs[dgrmlist_]

The Kostka matrix is what Weyl orbits for each irrep of A(n), using the order \
of the diagram list.

The rep-nesting matrix: each rep\[CloseCurlyQuote]s numbers becomes a rep and \
one iterates over them.
Row: index of starting rep, column: index of nested reps concatenated.
At each row and column, a list of entries:
Indices of subreps, multiplicities of subreps, multinomial multiplicity factor.
The reps here are A(n) irreps or Young diagrams.

GetTensorPowerYDX uses list TensorPowersYDX -- reset by setting to {}

*** Various identities involving plethysms: rep-power decompositions. ***

http://www.sbfisica.org.br/bjp/files/v32_641.pdf
The Plethysm Technique Applied to the Classification of Nuclear States, by \
Alcaras, Tambergs, Krasta, Ruza, Katkevicius

plt(a,x) is the plethysm of a on x, with a the plethysmer and x the \
plethysmed one, an irrep. a is a partition / Young diagram. A power p \
decomposes into diagrams a with length p.

Inner product: a.b = sum of ipc(a,b,c) * c

ipc(a,b,c) = 1/N sum over diagrams r of N(r)*X(a,r)*X(b,r)*X(c,r)
X(a,r) = characters of symmetric group for irrep a and class r (always \
integer), N(r) is order of class with part/diag r, N is total order.

Outer product: a*b = sum of opc(a,b,c) * c

opc(a,b,c) one calculates uses the Littlewood-Richardson rule.

Reps x,y have sum (sum of coefficients of irreps in it), difference (likewise \
with differences), product (rep product)

The identities:

plt(a,plt(b,x)) = plt(plt(a,b),x)
plt(a +- b, x) = plt(a,x) +- plt(b,x)
plt(a, x + y) = sum over b,c of ipc(a,b,c) * plt(b,x)*plt(c,y)
plt(a, x - y) = sum over b,c of ipc(a,b,c) * (-1)^length(c) * plt(b,x)*plt(c,y)
plt(a*b,x) = plt(a,x)*plt(b,x)
plt(a,x*y) = sum over b,c of opc(a,b,c) * plt(b,x)*plt(c,y)
conjg(plt(a,x)) = plt (a\[CloseCurlyQuote],conjg(x)) -- a\[CloseCurlyQuote] = \
a for length(a) even, conjg(a) for it odd

A(n) - SU(n+1) -  irreps can be calculated with Young diagrams.

B(n) and D(n) - SO(2n+1) and SO(2n) - have traces factored out, and C(n) - \
Sp(2n) - have sort-of traces factored out, calculated with the symplectic \
metrix (J = - J^T)

VerifyAnOrbits[n_, pwr] - checks the Kostka matrix against the rep orbits for \
A(n) to power (pwr).\
\>", "Text",ExpressionUUID->"8b7d5800-0f95-47a4-a87d-103346944a6c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Subalgebras and Branching Rules", "Subsection",ExpressionUUID->"b43a9725-a1ad-4a39-bc23-3e70dfba0267"],

Cell[TextData[{
 "For finding subalgebra decompositions (branching rules) of an algebra, and \
using those decompositions to find what subalgebra reps an algebra rep \
decomposes into.\n\nDoing the branching, with a brancher and highest weight \
maxwts:\nDoBranching[brancher_, maxwts_]\nMakes a list with members\n\
Degeneracy, list of highest weights of subgroup irreps with U(1) factors \
appended\n\nFor maxwts, type \[OpenCurlyDoubleQuote]sngl\
\[CloseCurlyDoubleQuote] for a single irrep, \[OpenCurlyDoubleQuote]list\
\[CloseCurlyDoubleQuote] for a list of them, and \[OpenCurlyDoubleQuote]cntd\
\[CloseCurlyDoubleQuote] for a counted list of them:\n\
DoBranchingXtnd[brancher_, xttype_, maxwts_]\n\nOn Weyl orbits instead, \
giving Weyl orbits\nDoOrbitBranching[brancher_,maxwts_]\n\nThe branching \
generators have members\nType -- type of original algebra\nSubtypes -- list \
of types of the subalgebras\nSubmatRoots -- list of subalgebra projection \
matrices in root space\nSubmatWeights -- list of subalgebra projection \
matrices in weight space\nU1s -- list of vectors to multiply the roots by to \
give the U(1) factors (may be empty)\n\nRoot demotion and extension splitting \
are \[OpenCurlyDoubleQuote]R\[CloseCurlyDoubleQuote] subalgebras, derivable \
from an algebra\[CloseCurlyQuote]s Dynkin diagram. All the others are \
\[OpenCurlyDoubleQuote]S\[CloseCurlyDoubleQuote] subalgebras, which must be \
derived by some other techniques.\n\n",
 StyleBox["Root Demotion",
  FontWeight->"Bold"],
 "\nFor demoting a root to a U(1) factor\nArgs:  algebra type, and index of \
root to demote\nReturns: brancher\nMakeRootDemoter[type_, ix_]\n\n\
ListRootDemotions[type_] lists the possible root demotions for a type\n\n",
 StyleBox["Extension Splitting",
  FontWeight->"Bold"],
 "\nFor extending an algebra\[CloseCurlyQuote]s Dynkin diagram with an \
adjoint-connected root and then splitting the algebra by removing a root\n\
Args:  algebra type, and index of root to split at\nReturns: brancher\n\
MakeExtensionSplitter[type_, ix_]\n\nListExtensionSplits[type_] lists the \
possible extension splittings for a type\n\n",
 StyleBox["Matrix Outer Products",
  FontWeight->"Bold"],
 "\nIn these two, the matrices of the original groups get decomposed into \
outer products of the subgroup matrices, all in the vector representation.\n\
SubalgMultSU[suords_] -- reduces a SU(n) to a product of SU(m)\
\[CloseCurlyQuote]s; suords is a list of those m\[CloseCurlyQuote]s, and n = \
product(m\[CloseCurlyQuote]s).\nSubalgMultSOSp[sospords_] -- reduces a SO(n) \
or Sp(n) to a product of SO(m)\[CloseCurlyQuote]s and/or Sp(m\
\[CloseCurlyQuote]s); sospords is a list of those m\[CloseCurlyQuote]s, and n \
= product(m\[CloseCurlyQuote]s). Positive n means SO(n) and negative n means \
Sp(-n). SO(2) is supported, and handled as a U(1) factor.\n\nForms of the \
previous two for A, B, C, D - style designation.\nTakes list of A(n) \
subalgebra ranks (root-vector lengths)\nSubalgMultAn[ords_]\nTakes list of \
subalgebra types that are Bn, Cn, and Dn: {2,n}, {3,n}, {4,n}. SO(2) / D(1) / \
{4,1} is supported, and handled as a U(1) factor.\nSubalgMultBCDn[stypes_]\n\n\
",
 StyleBox["SO(even) into Two SO(odd)\[CloseCurlyQuote]s",
  FontWeight->"Bold"],
 "\nRemaining SO(n) split. Extension splitting does even -> even + even (D -> \
D + D) and odd -> even + odd (B -> D + B), with root demotion handling SO(2) \
as U(1) (demote root 1, the one farthest from the fork or the double line, \
the one for the vector rep).\nsplits SO(2n) into SO(2m+1) and SO(2n-2m-1), \
and if m = 0, only SO(2n-1) (D -> B + B)\nSubalgSOEvenOdd[n_,m_]\n\n",
 StyleBox["SU(n) to SO(n), Sp(n)",
  FontWeight->"Bold"],
 "\nThe SO(n) and Sp(n) matrices are subsets of the SU(n) ones.\nTurns SU(n) \
/ A(n-1) into SO(n) / D(n/2) or B((n-1)/2)\nSubalgSUSO[ n_]\nTurns SU(2n) / \
A(2n-1) into Sp(2n) / C(n)\nSubalgSUSp[ n_]\n\n",
 StyleBox["Height Subalgebras",
  FontWeight->"Bold"],
 "\nReduces every algebra to A1/SU(2)/SO(3)/Sp(2), with the rep height \
becoming the largest highest weight.\nSubalgHeight[type_]\n\n",
 StyleBox["Vector-Representation Subalgebras",
  FontWeight->"Bold"],
 "\nGoes from an algebra of family f to one with type dsttype, with the \
source algebra\[CloseCurlyQuote]s fundamental or vector rep being mapped onto \
the destination algebra\[CloseCurlyQuote]s irrep with highest weights dstwts.\
\nSubalgVector[family_,dsttype_,dstwts_] \n\nNOTE: verified with \
classical-algebra (A,B,C,D) subalgebra, like Slansky\[CloseCurlyQuote]s \
examples, but it does not work properly with B3 -> G2\n\n",
 StyleBox["Extra Branching-Rule Generators",
  FontWeight->"Bold"],
 "\nTakes one of these as saname and makes the appropriate split:\n\
SubalgExtra[saname_]\nB3G2 -- splits B3/SO(7) into G2\nD4G2 -- splits \
D4/SO(8) into G2\nE8G2F4 - splits E8 into G2 and F4\netc\nFull list in \
variable SubalgExtraNames\n\n",
 StyleBox["Concatenator, relabelers, and rearrangers",
  FontWeight->"Bold"],
 "\nConcatenates the branchers in sbbrlist onto \
\[OpenCurlyDoubleQuote]brancher\[CloseCurlyDoubleQuote], where sbbrlist is a \
list of {index->brancher}\nConcatMultiBranchers[brancher_,sbbrlist_]\nLike \
the above, but with only a single brancher, sbbr, onto \
\[OpenCurlyDoubleQuote]brancher\[CloseCurlyDoubleQuote], at position ix\n\
ConcatBranchers[brancher_, ix_, sbbr_]\n\nRenames A1, B1, C1 at ix to any of \
these\.08\.08\.08\.08\nBrancherRenameABC1[brancher_, ix_, newfam_]\nFlips B2 \
- C2 at ix\nBrancherRenameBC2[brancher_, ix_]\nFlips A3 - D3 at ix\n\
BrancherRenameAD3[brancher_, ix_]\nSplits the D2 at ix to A1 * A1\n\
BrancherSplitD2[brancher_, ix_]\nJoins the A1\[CloseCurlyQuote]s at ix1 and \
ix2 to D2\nBrancherJoin2A1[brancher_, ix1_, ix2_]\n\nMakes conjugates of the \
subalgebras in the brancher at indices cjixs in it.\n\
BrancherConjugate[brancher_, cjixs_]\nFinds permutation \
\[OpenCurlyDoubleQuote]perm\[CloseCurlyDoubleQuote] of the branch roots for \
subalgebra at index ix if that algebra is D4 / SO(8)\n\
BrancherConjugateD4[brancher_, ix_, perm_]\n\nPuts the subalgebras of the \
brancher  into the order specified in neword.\nBrancherRearrange[brancher_, \
neword_]\nMultiplies the U(1) factors by matrix u1mat\n\
BrancherRearrangeU1s[brancher_,u1mat_]\n\nReturns branching to the original \
algebra\nSubalgSelf[brancher_, type_] \n\[LineSeparator]NOTE: my sources do \
not give the formulas that my code uses. I\[CloseCurlyQuote]ve derived them \
myself by imposing consistency for the smaller irreps. Also note that some of \
the projection matrices are not unique -- there is more than one choice that \
will work."
}], "Text",ExpressionUUID->"868cdb6b-df40-41ef-b9a3-0e3c64178000"]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphs of Roots of Representations", "Subsection",ExpressionUUID->"dc4700cb-0002-48b0-993c-07686a2ceec7"],

Cell["\<\
Root / Weight List Diagram
Graphs of Root Positions\
\>", "Text",ExpressionUUID->"cb5be755-ffbd-4382-be88-c0fec9bb105d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extras", "Subsection",ExpressionUUID->"b9b0dbe2-bd54-4f97-9f0b-92e8d5b74438"],

Cell["\<\
Canonical Root Vectors -- in forms where their symmetries are more manifest
Metrics Found Directly
Cartan Matrices Found Directly
Total Degeneracies/Dimensions Found Directly
Weyl Groups
Weyl Orbits -- including some explicit formulas for most of the algebras
Reps\[CloseCurlyQuote] Weyl Orbits
Weyl Orbit Combinations
Cartan-Weyl Normalizations
Conversion Utilities\
\>", "Text",ExpressionUUID->"70450a6c-ed78-4758-abb1-8760733fa63c"]
}, Closed]],

Cell[CellGroupData[{

Cell["References", "Subsection",ExpressionUUID->"451926c0-9d1c-4b5a-a077-35dbeb071243"],

Cell["\<\
Semi-Simple Lie Algebras and Their Representations, by Robert N. Cahn
http://phyweb.lbl.gov/~rncahn/www/liealgebras/book.html
 
Group Theory for Unified Model Building, by R. Slansky
http://inspirehep.net/search?p=find+a+slansky+and+t+group+theory

This code uses the root-numbering conventions of Robert N. Cahn\
\[CloseCurlyQuote]s book.

Kostka-matrix algorithm from
Determinantal Expression and Recursion for Jack Polynomials, by L. Lapointe, \
A. Lascoux, J. Morse

[0909.2337] Branching rules for the Weyl group orbits of the Lie algebra A(n) \
- http://arxiv.org/abs/0909.2337
[1101.6043] Branching rules for Weyl group orbits of simple Lie algebras \
B(n), C(n) and D(n) - http://arxiv.org/abs/1101.6043
[1206.6379] LieART -- A Mathematica Application for Lie Algebras and \
Representation Theory - http://arxiv.org/abs/1206.6379\
\>", "Text",ExpressionUUID->"4e9e31c7-1c16-4e97-8f5a-e5c0cb6b227c"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Lie Algebras themselves", "Section",ExpressionUUID->"34ddd76d-04f5-444b-ae0a-49db2d262ebc"],

Cell[CellGroupData[{

Cell["Dynkin diagrams", "Subsection",ExpressionUUID->"95c2623a-4e43-475d-9d95-fdb42860bb90"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Type", " ", "checking", " ", "on", " ", "the", " ", "algebra", " ", 
   "type"}], " ", "*)"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"1f2423fd-6190-48c4-a98b-f487eb6e6512"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieAlgebra", "::", "badtype"}], " ", "=", " ", 
   "\"\<Invalid algebra type: ``\>\""}], ";"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"5e314025-1e5f-45a8-8d54-793a033b8930"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BadValue", " ", "=", " ", "Null"}], ";"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"070dc266-da15-47fe-8b45-0f38c92c149f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckLieAlgebraType", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "type", "]"}], "!=", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "type"}], ")"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"97efd59f-b30b-4870-8e4a-65dcfd4a7868"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "args", " ", "are", " ", "the", " ", "type", " ", "and", " ", 
   "whether", " ", "to", " ", "accept", " ", "extended", " ", "E", " ", 
   RowBox[{"algebras", ":", " ", 
    RowBox[{"E3", " ", "E4", " ", "E5"}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"1fb3a5ac-e764-46e8-b770-a138c204c3df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeDynkinDiagram", "[", 
   RowBox[{"type_", ",", 
    RowBox[{"eext_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n", ",", "dynkdiag"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLieAlgebraType", "[", "type", "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dynkdiag", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">=", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "BadValue"}], "]"}], ",", 
        "\[IndentingNewLine]", "2", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">=", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"k", "==", "n"}], ",", "1", ",", "2"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"k", "+", "1"}], ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">=", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}], ",", "BadValue"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "3", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">=", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"k", "==", "n"}], ",", "2", ",", "1"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"k", "+", "1"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"k", "==", 
                   RowBox[{"n", "-", "1"}]}], ",", "2", ",", "1"}], "]"}]}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">=", "1"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}], ",", "BadValue"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "4", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">=", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"n", ">", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"n", "-", "2"}], ",", "n", ",", "1"}], "}"}], ",", 
                "Nothing"}], "]"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "BadValue"}], "]"}], ",", 
        "\[IndentingNewLine]", "5", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", ">=", 
           RowBox[{"If", "[", 
            RowBox[{"eext", ",", "3", ",", "6"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"1", ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"n", ">", "3"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "n", ",", "1"}], "}"}], ",", "Nothing"}], 
               "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "BadValue"}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "==", "4"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], "}"}]}], "}"}], 
          ",", "\[IndentingNewLine]", "BadValue"}], "]"}], ",", 
        "\[IndentingNewLine]", "7", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "==", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "BadValue"}], "]"}], ",", 
        "\[IndentingNewLine]", "_", ",", "BadValue"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dynkdiag", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "dynkdiag"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"a9b299f6-c62a-4ef6-a42b-eccd11465714"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrices", "Subsection",ExpressionUUID->"2a62a8d0-0e24-4ab5-87aa-36c01506db74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMetric", "[", "dynkdiag_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wts", ",", "conns", ",", "n", ",", "k", ",", "i", ",", "j", ",", "c"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wts", ",", "conns"}], "}"}], " ", "=", " ", "dynkdiag"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "wts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"k", ",", "k"}], "}"}], "->", 
             RowBox[{"2", "*", 
              RowBox[{"wts", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "c"}], "}"}], " ", "=", " ", 
              "conn"}], ";", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], "->", 
                RowBox[{"-", "c"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", "i"}], "}"}], "->", 
                RowBox[{"-", "c"}]}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"conn", ",", "conns"}], "}"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"6ec2f87b-a3f9-4af6-b654-d1f3d60a5530"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeCartanMatrix", "[", "dynkdiag_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wts", ",", "conns", ",", "n", ",", "k", ",", "i", ",", "j", ",", "c"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wts", ",", "conns"}], "}"}], " ", "=", " ", "dynkdiag"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "wts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"k", ",", "k"}], "}"}], "->", "2"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", "c"}], "}"}], " ", "=", " ", 
              "conn"}], ";", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], "->", 
                RowBox[{
                 RowBox[{"-", "c"}], "/", 
                 RowBox[{"wts", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"j", ",", "i"}], "}"}], "->", 
                RowBox[{
                 RowBox[{"-", "c"}], "/", 
                 RowBox[{"wts", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"conn", ",", "conns"}], "}"}]}], "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"6a11cdd3-9e95-4736-b47c-230e78730f1a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Roots", "Subsection",ExpressionUUID->"d3e91b5d-0a66-44ca-b64c-f1cbcac7d196"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"From", " ", "the", " ", "Cartan", " ", 
    RowBox[{"matrix", ":", " ", 
     RowBox[{"emits", " ", "a", " ", "list", " ", "containing", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"root", " ", "vector"}], ",", " ", "weight"}], "}"}], " ", 
      "for", " ", "each", " ", "positive", " ", "root", " ", "vector", " ", 
      "found"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"in", " ", "min"}], "-", "to", "-", 
    RowBox[{"max", " ", "order"}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"49c1fa00-59d2-43dc-8f06-53a3ac800d2d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SortRtWtFunc", "[", "rwt_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Total", "[", "#", "]"}], ",", "#"}], "}"}], "&"}], " ", "@", 
   " ", 
   RowBox[{"rwt", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"b504da89-981a-432b-a922-83683a417233"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SortRtWts", "[", "rwts_", "]"}], " ", ":=", " ", 
  RowBox[{"SortBy", "[", 
   RowBox[{"rwts", ",", "SortRtWtFunc"}], "]"}]}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"0c4e3fea-f73a-4bf8-ba89-708efd673c99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakePositiveRoots", "[", "ctnmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "SmplRoots", ",", 
      RowBox[{"PosRoots", "=", 
       RowBox[{"<|", "|>"}]}], ",", 
      RowBox[{"PRIndex", "=", 
       RowBox[{"<|", "|>"}]}], ",", 
      RowBox[{"WhichWay", "=", 
       RowBox[{"<|", "|>"}]}], ",", "NumRoots", ",", " ", "RtIndx", ",", "i", 
      ",", "j", ",", "k", ",", "l", ",", "ctpd", ",", "ThisRoot", ",", 
      "ThisWW", ",", " ", "NewRoot", ",", "NewWW", ",", "NRLen", ",", 
      "NRDivs", ",", "RootOK", ",", "DivRoot", ",", "PosRootList"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Start", " ", "off", " ", "with", " ", "all", " ", "the", " ", "simple", 
      " ", "ones", " ", "in", " ", "a", " ", "clever", " ", "manner"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Use", " ", "args", " ", "of", " ", "vars", " ", "to", " ", "avoid", " ",
       "AppendTo"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "ctnmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SmplRoots", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"AssociateTo", "[", 
         RowBox[{"PosRoots", ",", 
          RowBox[{"i", "->", 
           RowBox[{"SmplRoots", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"PRIndex", ",", 
          RowBox[{
           RowBox[{"SmplRoots", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "->", "i"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"WhichWay", ",", 
          RowBox[{"i", "->", 
           RowBox[{"Table", "[", 
            RowBox[{"True", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "n"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "<=", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"PosRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ctpd", " ", "=", " ", 
         RowBox[{"ThisRoot", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ThisWW", " ", "=", " ", 
            RowBox[{"WhichWay", "[", "RtIndx", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NewWW", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", " ", "!=", " ", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ThisWW", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", ",", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"NewRoot", " ", "=", " ", "ThisRoot"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NewRoot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "+=", " ", "j"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Avoid", " ", "integer", " ", "multiples", " ", "of", " ", 
                  "previous", " ", "root", " ", "vectors"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"NRLen", " ", "=", " ", 
                 RowBox[{"Total", "[", "NewRoot", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"NRDivs", " ", "=", " ", 
                 RowBox[{"Divisors", "[", "NRLen", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"RootOK", " ", "=", " ", "True"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Div", "==", "1"}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"DivRoot", " ", "=", " ", 
                    RowBox[{"NewRoot", "/", "Div"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", " ", "@@", " ", 
                    RowBox[{"(", 
                    RowBox[{"IntegerQ", " ", "/@", " ", "DivRoot"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"PRIndex", ",", "DivRoot"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"RootOK", " ", "=", " ", "False"}], ";", " ", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"Div", ",", "NRDivs"}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"RootOK", ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"PRIndex", ",", "NewRoot"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"WhichWay", "[", "RtIndx", "]"}], " ", "=", " ", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"And", "[", 
                    RowBox[{"ThisWW", ",", "NewWW"}], "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"PosRoots", ",", 
                    RowBox[{"NumRoots", "->", "NewRoot"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"PRIndex", ",", 
                    RowBox[{"NewRoot", "->", "NumRoots"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"WhichWay", ",", 
                    RowBox[{"NumRoots", "->", "NewWW"}]}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"-", 
                  RowBox[{"ctpd", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PosRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"PosRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SortRtWts", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"PosRootList", ",", 
         RowBox[{"PosRootList", ".", "ctnmat"}]}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"680057a9-3080-45d5-beae-9d971ebb0912"]
}, Closed]],

Cell[CellGroupData[{

Cell["The algebras themselves", "Subsection",ExpressionUUID->"ed91a5e2-ee77-4166-8a99-e8ddca5f4412"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgBaseName", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"\"\<ABCDEFG\>\"", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], "*", 
       RowBox[{"type", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"type", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"c0962342-f4f1-4324-a422-e705c47f12c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgExtraName", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"type", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "1", ",", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<SU(``)\>\"", ",", 
       RowBox[{
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], "]"}], "]"}], ",", "2",
     ",", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<SO(``)\>\"", ",", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"type", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "+", "1"}]}], "]"}], "]"}], ",", 
    "3", ",", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<Sp(``)\>\"", ",", 
       RowBox[{"2", "*", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], ",", "4", ",", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"StringForm", "[", 
      RowBox[{"\"\<SO(``)\>\"", ",", 
       RowBox[{"2", "*", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], ",", "_", ",", 
    "\"\<\>\""}], "]"}]}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"9ae5950f-32d4-40b3-b309-e5a118eaba92"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgName", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"AlgBaseName", "[", "type", "]"}], " ", "<>", " ", "\"\< \>\"", 
   " ", "<>", " ", 
   RowBox[{"AlgExtraName", "[", "type", "]"}]}]}]], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"be117b73-8580-440d-8500-6d5e68ba29db"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "an", " ", "association", " ", "or", " ", "else", " ", 
    "BadValue"}], " ", "*)"}]}]], "Input",
 CellLabel->"In[16]:=",ExpressionUUID->"16c67c6d-12e4-4652-af32-1ffc450cf4a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeLieAlgebra", "[", 
   RowBox[{"type_", ",", 
    RowBox[{"eext_", ":", "False"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dynkdiag", ",", "family", ",", "n", ",", "name", ",", "metric", ",", 
      "invmet", ",", "ctnmat", ",", "invctn", ",", "posroots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dynkdiag", " ", "=", " ", 
      RowBox[{"MakeDynkinDiagram", "[", 
       RowBox[{"type", ",", "eext"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dynkdiag", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"name", " ", "=", " ", 
      RowBox[{"AlgName", "[", "type", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"MakeMetric", "[", "dynkdiag", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"Inverse", "[", "metric", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"MakeCartanMatrix", "[", "dynkdiag", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"Inverse", "[", "ctnmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{"MakePositiveRoots", "[", "ctnmat", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<Type\>\"", "->", "type"}], ",", 
       RowBox[{"\"\<Name\>\"", "->", "name"}], ",", 
       RowBox[{"\"\<DynkDiag\>\"", "->", "dynkdiag"}], ",", 
       RowBox[{"\"\<Metric\>\"", "->", "metric"}], ",", 
       RowBox[{"\"\<InvMet\>\"", "->", "invmet"}], ",", 
       RowBox[{"\"\<CtnMat\>\"", "->", "ctnmat"}], ",", 
       RowBox[{"\"\<InvCtn\>\"", "->", "invctn"}], ",", 
       RowBox[{"\"\<PosRoots\>\"", "->", "posroots"}]}], "|>"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"05cbd18c-2c40-4524-9841-e6753de9b419"]
}, Closed]],

Cell[CellGroupData[{

Cell["Caching", "Subsection",ExpressionUUID->"aefcacda-997c-47f1-b8e0-9bbc88ba21fa"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Uses", " ", "a", " ", "global", " ", "cache"}], " ", 
  "*)"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"7b2dca21-4c6f-4665-a301-52ebbf2d4f36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetLieAlgebras", "[", "]"}], " ", ":=", " ", 
  RowBox[{"LieAlgebraCache", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}]}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"50cbf91f-a98b-4901-95d7-08431b098e12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetLieAlgebras", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"1035d355-c190-4711-a4ac-978f62a86c4d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Returns", " ", 
    RowBox[{"LieAlgebraCache", "[", "type", "]"}], " ", "if", " ", "a", " ", 
    "legitimate", " ", "algebra"}], ",", " ", 
   RowBox[{"Null", " ", "otherwise"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"70f23411-317f-4969-8117-bbdf19b1dec2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLieAlgebra", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"LieAlgebraCache", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MissingQ", "[", "la", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"la", " ", "=", " ", 
         RowBox[{"MakeLieAlgebra", "[", "type", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"la", " ", "=!=", " ", "BadValue"}], ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"LieAlgebraCache", ",", 
            RowBox[{"type", "->", "la"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "la"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"c8ee9dbf-e677-4fe2-b7f6-ace013e639cb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extras", "Subsection",ExpressionUUID->"fa2b8411-a9f4-4014-a298-66672b3e2adb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Scale", " ", "a", " ", "DD", " ", "by", " ", "some", " ", "factor"}], " ", 
  "*)"}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"2d4b9f4c-ca21-4d44-b687-e8679907e2f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScaleDynkDiag", "[", 
   RowBox[{"dd_", ",", "scale_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"scale", "*", 
     RowBox[{"dd", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"conn", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"conn", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"scale", "*", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"conn", ",", 
        RowBox[{"dd", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "}"}]}]], "Input",\

 CellLabel->"In[24]:=",ExpressionUUID->"d8f26ebf-1576-42a1-82d0-c776580452d0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"DD", "'"}], "s", " ", "as", " ", "separate", " ", 
    RowBox[{"args", ".", " ", "If"}], " ", "none"}], ",", " ", 
   RowBox[{"then", " ", "gives", " ", "the", " ", "empty", " ", "diagram"}]}],
   " ", "*)"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"5bcc2e9d-c9a9-485c-9d77-d4853056845a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JoinDynkDiags", "[", "dds___", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ddlist", ",", "rks", ",", "rksacc", ",", " ", "wts", ",", "conns", ",", 
      "dd", ",", "cn", ",", "ra"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ddlist", " ", "=", " ", 
      RowBox[{"List", "[", "dds", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Algebra", " ", "ranks", " ", "for", " ", "bumping", " ", "up", " ", 
       "the", " ", "node", " ", "indices"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rks", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"dd", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"dd", ",", "ddlist"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rksacc", " ", "=", " ", 
      RowBox[{"Most", "[", 
       RowBox[{"Accumulate", "[", 
        RowBox[{"Prepend", "[", 
         RowBox[{"rks", ",", "0"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wts", " ", "=", " ", 
      RowBox[{"Join", " ", "@@", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dd", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"dd", ",", "ddlist"}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"conns", " ", "=", " ", 
      RowBox[{"Join", " ", "@@", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dd", " ", "=", " ", 
           RowBox[{"ddlist", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", 
          RowBox[{"ra", " ", "=", " ", 
           RowBox[{"rksacc", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"cn", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "+", "ra"}], ",", 
              RowBox[{
               RowBox[{"cn", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", "ra"}], ",", 
              RowBox[{"cn", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"cn", ",", 
              RowBox[{"dd", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "ddlist", "]"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"wts", ",", "conns"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"0f44242b-2a8b-49bf-99e3-61ad16f8244f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Dimension", " ", "-", " ", 
   RowBox[{"number", " ", "of", " ", "generators"}], " ", "-", " ", 
   RowBox[{"of", " ", "the", " ", "algebra"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"3b2b7cb9-9373-4263-9097-6f89bf87c12d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgDimension", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"Length", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"la", "[", "\"\<Type\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"a3096e91-9e85-4e81-be30-8137fb531d2a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps - Irreducible Representations", "Section",ExpressionUUID->"aafef809-3775-4917-aef6-688be6030c9f"],

Cell[CellGroupData[{

Cell["Check Irrep Highest-Weights Vector", "Subsection",ExpressionUUID->"1158da3b-8731-4cfb-957c-381a5122d270"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Representation", "::", "badmwts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid highest-weight vector: `2`\>\""}], 
  ";"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"2a0d0f15-f331-4c8a-98c0-bbdcfcd31f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckRepMaxWts", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLieAlgebraType", "[", "type", "]"}]}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "maxwts", "]"}], " ", "\[NotEqual]", " ", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Representation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "maxwts"}], ")"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Representation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "maxwts", "]"}], " ", "<", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"Representation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"1d600dea-23c7-4e68-a182-833b1b50a1a7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps Directly", "Subsection",ExpressionUUID->"b5f4b754-fd55-4814-b501-d181f62b716e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Finds", " ", "an", " ", 
    RowBox[{"irrep", "'"}], "s", " ", "root", " ", "and", " ", "weight", " ", 
    "vectors", " ", "from", " ", "its", " ", "maximum", " ", 
    RowBox[{"root", "'"}], "s", " ", "weights", " ", "and", " ", "the", " ", 
    "Lie", " ", 
    RowBox[{"algebra", "'"}], "s", " ", "Cartan", " ", 
    RowBox[{"matrix", ".", " ", "Returns"}], " ", "as", " ", "list", " ", 
    "of", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"root", ",", " ", "weight"}], "}"}], ".", " ", "For"}], " ", 
    "invalid", " ", "inputs"}], ",", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"BadValue", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"7f489544-ce6f-4131-98be-fe52f9f5848e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RevSortRtWtFunc", "[", "rwt_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Total", "[", "#", "]"}]}], ",", "#"}], "}"}], "&"}], " ", "@",
    " ", 
   RowBox[{"rwt", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"33a8861e-8a47-4a47-975d-32d5d8db474a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RevSortRtWts", "[", "rwts_", "]"}], " ", ":=", " ", 
  RowBox[{"SortBy", "[", 
   RowBox[{"rwts", ",", "RevSortRtWtFunc"}], "]"}]}]], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"d4e85bc0-d549-4e47-b578-f2fa7663094c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepRoots", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "invctn", ",", "n", ",", "NumRoots", ",", 
      "MaxRoot", ",", 
      RowBox[{"RepRoots", "=", 
       RowBox[{"<|", "|>"}]}], ",", 
      RowBox[{"RRIndex", "=", 
       RowBox[{"<|", "|>"}]}], ",", " ", 
      RowBox[{"WhichWay", "=", 
       RowBox[{"<|", "|>"}]}], ",", " ", "RtIndx", ",", "i", ",", "j", ",", 
      "k", ",", "l", ",", "ctpd", ",", "ThisRoot", ",", "ThisWW", ",", 
      "NewRoot", ",", "NewWW", ",", "RepRootList"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MaxRoot", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"RepRoots", ",", 
       RowBox[{"NumRoots", "->", "MaxRoot"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"RRIndex", ",", 
       RowBox[{"MaxRoot", "->", "NumRoots"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"WhichWay", ",", 
       RowBox[{"NumRoots", "->", 
        RowBox[{"Table", "[", 
         RowBox[{"True", ",", 
          RowBox[{"{", "n", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "\[LessEqual]", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"RepRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ctpd", " ", "=", " ", 
         RowBox[{"ThisRoot", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ThisWW", " ", "=", " ", 
            RowBox[{"WhichWay", "[", "RtIndx", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NewWW", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", " ", "!=", " ", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ThisWW", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", ",", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NewRoot", " ", "=", " ", "ThisRoot"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NewRoot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "-=", " ", "j"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"KeyExistsQ", "[", 
                   RowBox[{"RRIndex", ",", "NewRoot"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"WhichWay", "[", "RtIndx", "]"}], "=", " ", 
                   RowBox[{"Thread", "[", 
                    RowBox[{"And", "[", 
                    RowBox[{"ThisWW", ",", "NewWW"}], "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"RepRoots", ",", 
                    RowBox[{"NumRoots", "->", "NewRoot"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"RRIndex", ",", 
                    RowBox[{"NewRoot", "->", "NumRoots"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AssociateTo", "[", 
                    RowBox[{"WhichWay", ",", 
                    RowBox[{"NumRoots", "->", "NewWW"}]}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"ctpd", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"RepRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RevSortRtWts", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"RepRootList", ",", 
         RowBox[{"RepRootList", ".", "ctnmat"}]}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[34]:=",ExpressionUUID->"e0804685-c132-4f9f-84c5-59dac8a1d465"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Find", " ", "the", " ", "irrep"}], "-", 
   RowBox[{"root", " ", "degeneracies", " ", "using", " ", 
    RowBox[{"Freudenthal", "'"}], "s", " ", 
    RowBox[{"recurrence", ".", " ", "Needs"}], " ", "only", " ", "the", " ", 
    "root", " ", "values", " ", "and", " ", "not", " ", "the", " ", "weights",
     " ", "for", " ", "the", " ", 
    RowBox[{"irrep", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"ce29e095-f806-4990-9677-63935830bc45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepDegens", "[", 
   RowBox[{"type_", ",", "RepRoots_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "invmet", ",", "ctnmat", ",", "invctn", ",", 
      "posroots", ",", "twodelta", ",", "rrix", ",", "degens", ",", "maxrt", 
      ",", "i", ",", "n", ",", "rt", ",", "bkrt", ",", "shtrt", ",", "pos"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvMet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"twodelta", " ", "=", " ", 
      RowBox[{"Total", "[", "posroots", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rrix", " ", "=", " ", 
      RowBox[{"Association", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"RepRoots", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "RepRoots", "]"}], "]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"degens", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "RepRoots", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assumes", " ", "roots", " ", "sorted", " ", "downward", " ", "by", " ",
        "height"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"maxrt", " ", "=", " ", 
      RowBox[{"RepRoots", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degens", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bkrt", " ", "=", " ", 
            RowBox[{"rt", " ", "+", " ", "shtrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rrix", ",", "bkrt"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", " ", "=", " ", 
               RowBox[{"rrix", "[", "bkrt", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", " ", "+=", " ", 
               RowBox[{
                RowBox[{"degens", "[", 
                 RowBox[{"[", "pos", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"bkrt", ".", "metric", ".", "shtrt"}], ")"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"bkrt", " ", "+=", " ", "shtrt"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"shtrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"degens", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"n", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"maxrt", "+", "rt", "+", "twodelta"}], ")"}], ".", 
             "metric", ".", 
             RowBox[{"(", 
              RowBox[{"maxrt", "-", "rt"}], ")"}]}], ")"}]}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "degens"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"b27944ef-4a13-4d48-bbbe-35ee8e97a609"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Outputs", " ", "roots", " ", "in", " ", "form", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"root", " ", "degeneracy"}], ",", " ", "value", ",", " ", 
     "weights"}], ")"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"1c8858fa-0b5e-46c3-8b6c-f44887f056fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRep", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vecs", ",", "trvcs", ",", "dgns"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vecs", " ", "=", " ", 
      RowBox[{"MakeRepRoots", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"vecs", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trvcs", " ", "=", " ", 
      RowBox[{"Transpose", "[", "vecs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgns", " ", "=", " ", 
      RowBox[{"MakeRepDegens", "[", 
       RowBox[{"type", ",", 
        RowBox[{"trvcs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"trvcs", ",", "dgns"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"758aa126-b95a-4b33-9686-b46223e2698e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl-Group Orders", "Subsection",ExpressionUUID->"e5d06bd1-cd97-4fbe-8867-ed9b959b12f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"n_Integer", "/;", 
      RowBox[{"n", ">=", "1"}]}]}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"n", "+", "1"}], ")"}], "!"}]}]], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"747ca68f-5d83-4bce-9920-430f10d7b75d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"n_Integer", "/;", 
      RowBox[{"n", ">=", "1"}]}]}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "^", "n"}], ")"}], "*", 
   RowBox[{"n", "!"}]}]}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"b9a04779-498d-4fc8-b152-f516b4d7c6b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"n_Integer", "/;", 
      RowBox[{"n", ">=", "1"}]}]}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "^", "n"}], ")"}], "*", 
   RowBox[{"n", "!"}]}]}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"49adb3fd-684c-4ade-a415-d3812ce32e22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"n_Integer", "/;", 
      RowBox[{"n", ">=", "2"}]}]}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"2", "^", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "*", 
   RowBox[{"n", "!"}]}]}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"a5a7d3cd-2bdf-4468-a7e1-a714c2da635a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"WeylGroupOrder", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}], "*", 
   RowBox[{"WeylGroupOrder", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}]}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"48c4eebb-ecba-42bd-a4a1-0dd83c0ea79d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "4"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], "]"}]}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"41d4f9f3-981f-4183-a7b1-64495830667a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], "]"}]}]], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"4fdeb19a-985c-4a12-90a8-e09cbf2b2c23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], "]"}], " ", ":=", "51840"}]], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"617189a6-c579-4467-afb6-84be75cdbe5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "7"}], "}"}], "]"}], " ", ":=", "2903040"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"13d9c9f4-1cd8-457a-aab7-93cf8d35ccad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "8"}], "}"}], "]"}], " ", ":=", "696729600"}]], "Input",\

 CellLabel->"In[48]:=",ExpressionUUID->"05a79805-f632-449b-b9dd-f45b61ce482d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}], "]"}], " ", ":=", "1152"}]], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"3eabeb4a-ebb5-4073-aecf-b542d914e132"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupOrder", "[", 
   RowBox[{"{", 
    RowBox[{"7", ",", "2"}], "}"}], "]"}], " ", ":=", " ", "12"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"ea91b043-19d3-48b8-a451-00bebc4e663e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Orbits", "Subsection",ExpressionUUID->"3b8435ed-2077-450a-8430-33c5c63b19bb"],

Cell[CellGroupData[{

Cell["The Orbits Themselves", "Subsubsection",ExpressionUUID->"db36669b-636d-4a61-b32f-a7940e08511f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Uses", " ", "Weyl"}], "-", 
   RowBox[{
   "group", " ", "generators", " ", "to", " ", "find", " ", "new", " ", 
    "orbit", " ", "members", " ", "from", " ", "existing", " ", "ones"}]}], 
  " ", "*)"}]], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"f66510a7-395d-45d6-b02a-c308011200ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWOStep", "[", 
   RowBox[{"flip_", ",", "rtlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "k", ",", "id", ",", "nwrtl"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "flip", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"id", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nwrtl", " ", "=", " ", "rtlist"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"nwrtl", " ", "=", " ", 
        RowBox[{"Union", "[", 
         RowBox[{"nwrtl", ",", 
          RowBox[{"Expand", "[", 
           RowBox[{"nwrtl", " ", "+", " ", 
            RowBox[{"Outer", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"nwrtl", ".", 
               RowBox[{"flip", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ",", 
              RowBox[{"id", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "nwrtl"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"eeb290dd-d695-46fd-9f06-8ab5d845c9c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeOrbit", "[", 
   RowBox[{"type_", ",", "wts_", ",", "\"\<WGGens\>\"", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "ctnmat", ",", "invctn", ",", "rtlist", ",", 
      "flip"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "wts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rtlist", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Expand", "[", 
        RowBox[{"wts", ".", "invctn"}], "]"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"flip", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "2"}], "/", 
        RowBox[{"Diagonal", "[", "metric", "]"}]}], "*", "metric"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rtlist", " ", "=", " ", 
      RowBox[{"FixedPoint", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MWOStep", "[", 
          RowBox[{"flip", ",", "#"}], "]"}], "&"}], ",", "rtlist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"RevSortRtWts", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"rtlist", ",", 
         RowBox[{"Expand", "[", 
          RowBox[{"rtlist", ".", "ctnmat"}], "]"}]}], "}"}], "]"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"f6c6432d-7248-4d95-8650-0b717b1c2fb2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"From", " ", "the", " ", 
   RowBox[{"orbit", "'"}], "s", " ", "dominant", " ", 
   RowBox[{"weight", ".", " ", "Step"}], " ", "across", " ", "the", " ", 
   "roots", " ", "using", " ", "the", " ", "simple", " ", 
   RowBox[{"roots", ".", " ", "Does"}], " ", "not", " ", "accept", " ", 
   "symbolic", " ", "weights"}], " ", "*)"}]], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"1ab827bd-6352-40a4-ae16-134289e0c7ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeOrbit", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "\"\<DomWt\>\"", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "ctnmat", ",", "invctn", ",", "metric", ",", 
      "wmmults", ",", "oldrts", ",", "ixs", ",", "newrts", ",", "rt", ",", 
      "mtrt", ",", "nrixs", ",", "k", ",", "nwrt", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "mwcheck"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", " ", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wmmults", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "2"}], "/", 
       RowBox[{"Diagonal", "[", "metric", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oldrts", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"maxwts", ".", "invctn"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ixs", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "oldrts", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sow", "[", "oldrts", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newrts", " ", "=", " ", 
           RowBox[{"Union", " ", "@@", " ", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"mtrt", " ", "=", " ", 
                RowBox[{"metric", ".", "rt"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"nrixs", " ", "=", " ", 
                RowBox[{"Select", "[", 
                 RowBox[{"ixs", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mtrt", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ">", "0"}], "&"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nwrt", " ", "=", " ", "rt"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"nwrt", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "+=", " ", 
                   RowBox[{
                    RowBox[{"wmmults", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "*", 
                    RowBox[{"mtrt", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", "nwrt"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "nrixs"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"rt", ",", "oldrts"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"oldrts", " ", "=", " ", "newrts"}]}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RevSortRtWts", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"#", ".", "ctnmat"}]}], "}"}], "&"}], " ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{"Join", " ", "@@", " ", 
         RowBox[{"res", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"53d385c1-c721-41ea-b0df-db9df5e90c08"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Explicit", " ", "expressions", " ", "for", " ", "Weyl", " ", 
   RowBox[{"orbits", "."}]}], " ", "*)"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"cb859690-32cd-40ed-97ae-ae098e59623f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Done", " ", "for", " ", "all", " ", "but", " ", "E6"}], ",", " ", 
   "E7", ",", " ", 
   RowBox[{
    RowBox[{"E8", " ", "--"}], " ", "returns", " ", "empty", " ", "list", " ",
     "for", " ", "those", " ", "ones"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"4850caf3-eb75-4581-8085-c9cc2e4f9884"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWORevAcc", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Reverse", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{"Accumulate", "[", 
     RowBox[{"Reverse", "[", "x", "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"efe30dbc-ee88-4e03-8e63-f89960c47830"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWOMakeSigns", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Tuples", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xe", "=!=", "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"xe", ",", "x"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"c15c05f5-0fb0-43a1-94ba-78a3525fe849"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWOAddSigns", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"x", "*", "#"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"MWOMakeSigns", "[", "x", "]"}]}]}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"664f7ed8-e067-483f-99bb-0ef6e119c0d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWOAddEvenSigns", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{"x", "*", "#"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"MWOMakeSigns", "[", "x", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Times", " ", "@@", " ", "#"}], ")"}], ">=", "0"}], ")"}], 
      "&"}]}], "]"}]}]}]], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"6f16f774-679b-44de-97d3-e11fcf1c0785"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MWOPermList", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Union", " ", "@@", " ", 
   RowBox[{"(", 
    RowBox[{"Permutations", " ", "/@", " ", "x"}], ")"}]}]}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"1aefcd0c-f438-4423-926c-6ad08563f463"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeOrbit", "[", 
   RowBox[{"type_", ",", "wts_", ",", "\"\<Explicit\>\"", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "ctnmat", ",", "orbrts", ",", 
      "mwx"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "wts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Does", " ", "weights", " ", "directly", " ", "to", " ", 
         "orthogonal"}], "-", 
        RowBox[{"basis", " ", "roots"}]}], ",", " ", 
       RowBox[{
        RowBox[{"then", " ", "gets", " ", "the", " ", "usual"}], "-", 
        RowBox[{"basis", " ", "roots", " ", "back"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"orbrts", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MWORevAcc", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"wts", ",", "0"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"Expand", "[", 
           RowBox[{"mwx", " ", "-", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"n", "+", "1"}], ")"}]}], ")"}], "*", 
             RowBox[{"Total", "[", "mwx", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Most", "[", 
             RowBox[{"Accumulate", "[", "#", "]"}], "]"}], "]"}], "&"}], " ", 
          "/@", " ", 
          RowBox[{"Permutations", "[", "mwx", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "wts", "]"}], ",", 
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"Last", "[", "wts", "]"}], "/", "2"}], "]"}]}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MWOPermList", "[", 
           RowBox[{"MWOAddSigns", "[", 
            RowBox[{"MWORevAcc", "[", "mwx", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"Accumulate", "[", "#", "]"}], "]"}], "&"}], " ", "/@", 
          " ", "mwx"}]}], ",", "\[IndentingNewLine]", "3", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MWOPermList", "[", 
           RowBox[{"MWOAddSigns", "[", 
            RowBox[{"MWORevAcc", "[", "wts", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"Accumulate", "[", "#", "]"}], "]"}], "&"}], " ", "/@", 
           "  ", "mwx"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Most", "[", "#", "]"}], ",", 
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{"Last", "[", "#", "]"}], "/", "2"}], "]"}]}], "]"}], 
           "&"}], " ", "/@", " ", "mwx"}]}], ",", "\[IndentingNewLine]", "4", 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"MWORevAcc", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"wts", ",", 
                 RowBox[{"-", "2"}]}], "]"}], ",", 
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"wts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "+", 
                   RowBox[{"wts", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
                "]"}]}], "]"}], "]"}], ",", 
            RowBox[{"Expand", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"wts", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
                RowBox[{"wts", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MWOPermList", "[", 
           RowBox[{"MWOAddEvenSigns", "[", "mwx", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Expand", "[", 
             RowBox[{"Accumulate", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Drop", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"-", "2"}]}], "]"}], ",", 
                RowBox[{"Expand", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{"2", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], "]"}]}], 
               "]"}], "]"}], "]"}], "&"}], " ", "/@", "  ", "mwx"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"#", ",", 
               RowBox[{"-", "2"}]}], "]"}], ",", 
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{"Take", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"-", "2"}]}], "]"}], "/", "2"}], "]"}]}], "]"}], 
           "&"}], " ", "/@", " ", "mwx"}]}], ",", "\[IndentingNewLine]", "5", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "7", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "8", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"Expand", "[", 
             RowBox[{"wts", ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "0", ",", 
                  RowBox[{"-", "2"}]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}], 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1", ",", 
                   RowBox[{"-", "3"}]}], "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"{", 
              RowBox[{"mwx", ",", " ", 
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ".", 
                   "mwx"}], ")"}]}], "]"}], ",", 
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ".", 
                   "mwx"}], ")"}]}], "]"}]}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"MWOPermList", "[", 
             RowBox[{"Union", " ", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"MWOAddSigns", " ", "/@", " ", "mwx"}], ")"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Expand", "[", 
            RowBox[{"mwx", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "2"}], ",", 
                 RowBox[{"-", "3"}], ",", 
                 RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"Permutations", "[", 
             RowBox[{"Expand", "[", 
              RowBox[{"wts", ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"mwx", ",", 
              RowBox[{"-", "mwx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", "#"}], "]"}], 
             "&"}], " ", "/@", " ", "mwx"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"RevSortRtWts", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"Expand", "[", 
           RowBox[{"#", ".", "ctnmat"}], "]"}]}], "}"}], "&"}], " ", "/@", 
       " ", "orbrts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"0cd06a31-cdac-4ac2-988c-345df606f52d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Compares", " ", "the", " ", 
   RowBox[{"algorithms", "'"}], " ", "run", " ", "times"}], " ", 
  "*)"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"2f9ed99a-9301-4d03-a931-d86efa021680"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrbitTimingVerify", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tlst", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tlst", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"Timing", "[", 
           RowBox[{"MakeOrbit", "[", 
            RowBox[{"type", ",", "maxwts", ",", "alg", ",", "mwcheck"}], 
            "]"}], "]"}], ",", "alg"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"alg", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<WGGens\>\"", ",", "\"\<DomWt\>\"", ",", "\"\<Explicit\>\""}], 
           "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tlst", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"tlst", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=!=", "BadValue"}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tlst"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"t", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tlst"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"t1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "===", 
          RowBox[{"t2", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "tlst"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t2", ",", "tlst"}], "}"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"b118b480-7c0e-4a61-92e9-c99d159b06c1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Find Orbit from Root", "Subsubsection",ExpressionUUID->"d160006b-f5e9-412d-9047-98f26e1181a0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Returns", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"DW", " ", "root"}], ",", " ", 
     RowBox[{"dominant", " ", "weight"}]}], "}"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"5c9de9e7-25bb-4201-b728-268ef32e6e3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrbitDomWtFromRoot", "[", 
   RowBox[{"type_", ",", "root_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "ctnmat", ",", "invctn", ",", "metric", ",", 
      "wmmults", ",", "rt", ",", "wt", ",", "mtrt", ",", "ix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wmmults", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "2"}], "/", 
       RowBox[{"Diagonal", "[", "metric", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rt", " ", "=", " ", "root"}], ";", "\[IndentingNewLine]", 
     RowBox[{"wt", " ", "=", 
      RowBox[{"rt", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "wt", "]"}], " ", "<", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mtrt", " ", "=", " ", 
         RowBox[{"metric", ".", "rt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"Ordering", "[", 
           RowBox[{"mtrt", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mtrt", "[", 
            RowBox[{"[", "ix", "]"}], "]"}], " ", "\[GreaterEqual]", " ", 
           "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rt", "[", 
          RowBox[{"[", "ix", "]"}], "]"}], " ", "+=", " ", 
         RowBox[{
          RowBox[{"wmmults", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], "*", 
          RowBox[{"mtrt", "[", 
           RowBox[{"[", "ix", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"wt", " ", "=", 
         RowBox[{"rt", ".", "ctnmat"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"rt", ",", "wt"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"7cf8c5c8-9975-4439-bf43-621fb5f4a43d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Caching", "Subsubsection",ExpressionUUID->"b62fb469-7bea-412b-8e4e-554d05022345"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Uses", " ", "a", " ", "global", " ", "cache"}], " ", 
  "*)"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"eefe4422-3b64-41f9-8266-cdc62aa4d245"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetOrbits", "[", "]"}], " ", ":=", " ", 
  RowBox[{"OrbitCache", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}]}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"5130fdd5-f6ba-45b6-8c3f-8f18e28bb6aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetOrbits", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"2d9a136d-e706-4653-ace6-772d9d95f2a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetOrbit", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mwnz", ",", "mwscale", ",", "mwred", ",", "key", ",", "orb"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Scale", " ", "down", " ", "the", " ", "max", " ", "wts", " ", "to", 
       " ", "avoid", " ", "using", " ", "multiple", " ", "cache", " ", 
       "entries", "\[IndentingNewLine]", "for", " ", "multiples", " ", "of", 
       " ", "the", " ", "same", " ", "orbit"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mwnz", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"maxwts", ",", 
        RowBox[{
         RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwscale", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "mwnz", "]"}], " ", ">", " ", "0"}], ",", " ", 
        RowBox[{"GCD", " ", "@@", " ", 
         RowBox[{"Abs", "[", "mwnz", "]"}]}], ",", " ", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwred", " ", "=", " ", 
      RowBox[{"maxwts", "/", "mwscale"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "mwred"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"OrbitCache", ",", "key"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"orb", " ", "=", " ", 
         RowBox[{"MakeOrbit", "[", 
          RowBox[{"type", ",", "mwred", ",", "\"\<Explicit\>\""}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"orb", " ", "===", " ", "BadValue"}], ",", 
          RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"orb", " ", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"orb", " ", "=", " ", 
            RowBox[{"MakeOrbit", "[", 
             RowBox[{"type", ",", "mwred", ",", "\"\<DomWt\>\""}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"orb", " ", "===", " ", "BadValue"}], ",", 
             RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", " ", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"OrbitCache", ",", 
          RowBox[{"key", "->", "orb"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Scale", " ", "back", " ", "up"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mwscale", "*", 
      RowBox[{"OrbitCache", "[", "key", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"e0205d52-b929-410b-8582-3b9d830e6a11"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Add", " ", "count", " ", "of", " ", "1"}], ",", " ", 
   RowBox[{"to", " ", "resemble", " ", 
    RowBox[{"reps", ":"}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"f9d88ffa-5a10-49af-a3c8-889fb9114df0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddCount", "[", "orb_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Prepend", "[", 
     RowBox[{"#", ",", "1"}], "]"}], "&"}], " ", "/@", " ", 
   "orb"}]}]], "Input",
 CellLabel->"In[73]:=",ExpressionUUID->"23f50336-8259-4102-b2cb-71e5e48aaac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetCntdOrbit", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#", "=!=", "BadValue"}], ",", 
      RowBox[{"AddCount", "[", "#", "]"}], ",", "#"}], "]"}], "&"}], " ", "@",
    " ", 
   RowBox[{"GetOrbit", "[", 
    RowBox[{"type", ",", "maxwts"}], "]"}]}]}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"35496846-315f-4ba2-822d-2b01f24b86dd"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps\[CloseCurlyQuote] Weyl Orbits", "Subsection",ExpressionUUID->"0506f7f9-a990-4367-9065-128a437afda5"],

Cell[CellGroupData[{

Cell["Irreps\[CloseCurlyQuote] Weyl-Orbit Composition", "Subsubsection",ExpressionUUID->"db75c842-133d-4f8d-9206-ec84ca5196d2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Dominant", " ", "weights", " ", "of", " ", "Weyl", " ", "orbits", " ", 
   "of", " ", "a", " ", "rep"}], " ", "*)"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"98df5718-5f00-4643-88c0-8e7059a5b419"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepWODomWts", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "invctn", ",", "posroots", ",", "psrt", ",", 
      "NumRoots", ",", "MaxRoot", ",", 
      RowBox[{"RepRoots", "=", 
       RowBox[{"<|", "|>"}]}], ",", 
      RowBox[{"RRIndex", "=", 
       RowBox[{"<|", "|>"}]}], ",", " ", "RtIndx", ",", "ThisRoot", ",", 
      "NewRoot", ",", "RepRootList"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MaxRoot", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"RepRoots", ",", 
       RowBox[{"NumRoots", "->", "MaxRoot"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"RRIndex", ",", 
       RowBox[{"MaxRoot", "->", "NumRoots"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "\[LessEqual]", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"RepRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"NewRoot", " ", "=", " ", 
            RowBox[{"ThisRoot", " ", "-", " ", "psrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"NewRoot", ".", "ctnmat"}], "]"}], "<", "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{"RRIndex", ",", "NewRoot"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"RepRoots", ",", 
                RowBox[{"NumRoots", "->", "NewRoot"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"RRIndex", ",", 
                RowBox[{"NewRoot", "->", "NumRoots"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"psrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"RepRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RevSortRtWts", "[", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"RepRootList", ",", 
         RowBox[{"RepRootList", ".", "ctnmat"}]}], "}"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"f20d173c-63b0-4755-a2ad-428f7bfce4d9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Uses", " ", 
     RowBox[{"Freudenthal", "'"}], "s", " ", 
     RowBox[{"recurrence", ".", " ", "Since"}], " ", "the", " ", 
     "backtracked", " ", "roots", " ", "are", " ", "not", " ", "necessarily", 
     " ", "Weyl"}], "-", 
    RowBox[{"orbit", " ", "dominant"}], "-", 
    RowBox[{"weight", " ", "ones"}]}], ",", " ", 
   RowBox[{
    RowBox[{"it", "'"}], "s", " ", "necessary", " ", "to", " ", "find", " ", 
    "a", " ", "dominant", " ", "weight", " ", "for", " ", "each", " ", "one", 
    " ", "and", " ", "use", " ", "its", " ", 
    RowBox[{"root", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"f20b12c1-fdbf-415d-b7a1-d3326de16d0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepWODWDegens", "[", 
   RowBox[{"type_", ",", "RepRoots_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "invmet", ",", "ctnmat", ",", "invctn", ",", 
      "posroots", ",", "twodelta", ",", "rrix", ",", "degens", ",", "maxrt", 
      ",", "i", ",", "n", ",", "rt", ",", "bkrt", ",", "bkdmrw", ",", "shtrt",
       ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvMet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"twodelta", " ", "=", " ", 
      RowBox[{"Total", "[", "posroots", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rrix", " ", "=", " ", 
      RowBox[{"Association", "[", 
       RowBox[{"Thread", "[", 
        RowBox[{"RepRoots", "->", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "RepRoots", "]"}], "]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"degens", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "RepRoots", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Assumes", " ", "roots", " ", "sorted", " ", "downward", " ", "by", 
        " ", "height"}], ",", " ", 
       RowBox[{"like", " ", "with", " ", "RepRootSortFunc"}]}], " ", " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"maxrt", " ", "=", " ", 
      RowBox[{"RepRoots", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degens", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bkrt", " ", "=", " ", 
            RowBox[{"rt", " ", "+", " ", "shtrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bkdmrw", " ", "=", " ", 
            RowBox[{"OrbitDomWtFromRoot", "[", 
             RowBox[{"type", ",", "bkrt"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rrix", ",", 
               RowBox[{"bkdmrw", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", " ", "=", " ", 
               RowBox[{"rrix", "[", 
                RowBox[{"bkdmrw", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", " ", "+=", " ", 
               RowBox[{
                RowBox[{"degens", "[", 
                 RowBox[{"[", "pos", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"bkrt", ".", "metric", ".", "shtrt"}], ")"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"bkrt", " ", "+=", " ", "shtrt"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"bkdmrw", " ", "=", " ", 
               RowBox[{"OrbitDomWtFromRoot", "[", 
                RowBox[{"type", ",", "bkrt"}], "]"}]}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"shtrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"degens", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"n", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"maxrt", "+", "rt", "+", "twodelta"}], ")"}], ".", 
             "metric", ".", 
             RowBox[{"(", 
              RowBox[{"maxrt", "-", "rt"}], ")"}]}], ")"}]}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "degens"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"69f3b2a1-aed7-4739-905a-5145a76e96df"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Irrep", " ", "decomposed", " ", "into", " ", "Weyl", " ", "orbits", " ", 
    "with", " ", "appropriate", " ", "degeneracies"}], ",", " ", 
   RowBox[{
   "in", " ", "the", " ", "format", " ", "of", " ", "GetRep", " ", "about", 
    " ", 
    RowBox[{"irreps", ":", " ", 
     RowBox[{"{", 
      RowBox[{"degeneracy", ",", " ", 
       RowBox[{"dominant", " ", "root"}], ",", " ", 
       RowBox[{"dominant", " ", "weight"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"dd26c132-afa7-45d6-87db-c2dc1468d28d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepOrbits", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vecs", ",", "trvcs", ",", "dgns"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vecs", " ", "=", " ", 
      RowBox[{"MakeRepWODomWts", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"vecs", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"trvcs", " ", "=", " ", 
      RowBox[{"Transpose", "[", "vecs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgns", " ", "=", " ", 
      RowBox[{"MakeRepWODWDegens", "[", 
       RowBox[{"type", ",", 
        RowBox[{"trvcs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"trvcs", ",", "dgns"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"cf96815f-d3f4-4de5-bedc-8b2368e3588e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Caching", "Subsubsection",ExpressionUUID->"38509005-0a93-43fd-97b9-dffe13055d05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetRepOrbits", "[", "]"}], " ", ":=", " ", 
  RowBox[{"RepOrbitCache", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}]}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"0bc5a053-0638-4a60-8674-1d36ab71edd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetRepOrbits", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"8f7d2163-0861-4c6d-bb08-992b881a17e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepOrbits", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"key", ",", "rep"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "maxwts"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"RepOrbitCache", ",", "key"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"MakeRepOrbits", "[", 
          RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", " ", "===", " ", "BadValue"}], ",", 
          RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"RepOrbitCache", ",", 
          RowBox[{"key", "->", "rep"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepOrbitCache", "[", "key", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"ffcccfa7-d048-4ecc-93df-5ab9699569ea"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps using Weyl Orbits", "Subsection",ExpressionUUID->"08d1efbc-cc9e-45b1-8cb6-398d94c22648"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Orbits", " ", "input", " ", "as", " ", "list", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"multiplicity", ",", " ", 
     RowBox[{"dominant", " ", "root"}], ",", " ", 
     RowBox[{"dominant", " ", "weight"}]}], "}"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"7f954bda-6813-4402-a677-8dd7fca79fcf"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Uses", " ", "Weyl"}], "-", 
    RowBox[{"orbit", " ", "cache"}]}], ",", " ", 
   RowBox[{"thus", " ", "here"}]}], " ", "*)"}]], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"10745a9c-3c6e-4ab6-80c5-26a14940d4b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RevSortDgRtWtFunc", "[", "drwt_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Total", "[", "#", "]"}]}], ",", "#"}], "}"}], "&"}], " ", "@",
    " ", 
   RowBox[{"drwt", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"01bae535-e35b-4945-84ba-bdbb207510f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RevSortDgRtWts", "[", "drwts_", "]"}], " ", ":=", " ", 
  RowBox[{"SortBy", "[", 
   RowBox[{"drwts", ",", "RevSortDgRtWtFunc"}], "]"}]}]], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"0b38ab23-eff7-4fdc-8cce-965d05dc2cbc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepFromOrbits", "[", 
   RowBox[{"type_", ",", "orbits_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"RevSortDgRtWts", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{"#", ",", 
           RowBox[{"orb", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"GetOrbit", "[", 
         RowBox[{"type", ",", 
          RowBox[{"orb", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"orb", ",", "orbits"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
   "]"}]}]], "Input",
 CellLabel->"In[88]:=",ExpressionUUID->"18a7797c-15d3-47cd-acb5-bbf907572eb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetReps", "[", "]"}], " ", ":=", " ", 
  RowBox[{"RepCache", " ", "=", " ", 
   RowBox[{"<|", "|>"}]}]}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"a2178da3-89b4-4ce8-b26e-29642909e695"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetReps", "[", "]"}], ";"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"84133557-e2c5-42b6-847a-0a059c1b0dc3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRep", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"key", ",", "rep"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "maxwts"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"RepCache", ",", "key"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"MakeRepFromOrbits", "[", 
          RowBox[{"type", ",", 
           RowBox[{"GetRepOrbits", "[", 
            RowBox[{"type", ",", "maxwts"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", " ", "===", " ", "BadValue"}], ",", 
          RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"RepCache", ",", 
          RowBox[{"key", "->", "rep"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepCache", "[", "key", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"8b4b7935-3551-4e6b-b839-93a2aa8095b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepsVerifyTiming", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t0", ",", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"MakeRep", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t1", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"MakeRepFromOrbits", "[", 
        RowBox[{"type", ",", 
         RowBox[{"MakeRepOrbits", "[", 
          RowBox[{"type", ",", "maxwts"}], "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"t1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"t0", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "===", 
        RowBox[{"t1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"103f4066-a0a2-401c-a864-127051dd965d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irrep Properties", "Subsection",ExpressionUUID->"ee4e2957-bcd7-4d5c-82b3-56438a2cef17"],

Cell[CellGroupData[{

Cell["Degeneracy", "Subsubsection",ExpressionUUID->"596558e5-bab0-4891-a52f-03e115b6b58b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Find", " ", "the", " ", "total", " ", "degeneracy", " ", 
   RowBox[{"(", 
    RowBox[{"multiplet", " ", "size"}], ")"}], " ", "from", " ", "the", " ", 
   "above", " ", "results"}], " ", "*)"}]], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"6e9113a4-1302-4b69-8387-26575c19c1b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalDegenExpRep", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "x"}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[94]:=",ExpressionUUID->"45aa8d42-aa5c-4098-b285-c5f245490813"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "'"}], "s", " ", "celebrated", " ", "formula", " ", "for", 
   " ", "the", " ", "total", " ", 
   RowBox[{"degeneracy", ".", " ", "The"}], " ", "last", " ", "arg", " ", 
   "is", " ", "whether", " ", "it", " ", "checks", " ", "the", " ", "maxwts", 
   " ", 
   RowBox[{"vector", ".", " ", "Set"}], " ", "it", " ", "to", " ", "False", 
   " ", "for", " ", "a", " ", "symbolic", " ", 
   RowBox[{"expression", "."}]}], " ", "*)"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"ae76e710-0514-4a24-990c-ff37bdd4b850"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegen", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "ctnmat", ",", "invctn", ",", "posroots", ",", 
      "delta", ",", "maxrtsdel", ",", "prt", ",", "ra"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"delta", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", "posroots", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxrtsdel", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}], " ", "+", 
       " ", "delta"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Product", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ra", " ", "=", " ", 
          RowBox[{"prt", ".", "metric"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ra", ".", "maxrtsdel"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"ra", ".", "delta"}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"prt", ",", "posroots"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"9c49320c-2ff5-4347-958c-41753a0eeb96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenBasic", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"TotalDegen", "[", 
     RowBox[{"type", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"type", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"9d9fba55-5b15-4178-80f8-4a1e0deb6c22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenTest", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"TotalDegenExpRep", "[", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], "]"}], " ", "==", " ", 
   RowBox[{"TotalDegen", "[", 
    RowBox[{"type", ",", "maxwts"}], "]"}]}]}]], "Input",
 CellLabel->"In[98]:=",ExpressionUUID->"85509c77-a875-49e5-bbfc-420073de01a7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conjugation", "Subsubsection",ExpressionUUID->"326fd8ea-f81f-48ee-9661-165984b1830a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Makes", " ", "the", " ", "indices", " ", "of", " ", "the", " ", 
   "conjugate", " ", "irrep"}], " ", "*)"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"ab4e024c-bd39-414d-853b-69caaaeeadb3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeConjgIndices", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"family", "==", "1"}], ",", " ", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Range", "[", "n", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"family", "==", "4"}], ",", " ", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "2"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"family", "==", " ", "5"}], " ", "&&", " ", 
        RowBox[{"n", " ", "==", " ", "6"}]}], ",", " ", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"Range", "[", "5", "]"}], "]"}], ",", "6"}], "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", " ", 
       RowBox[{"Range", "[", "n", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[100]:=",ExpressionUUID->"54fd21c7-4b3a-4aff-b487-415d3bf114ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LARepIndices", "::", "badrearr"}], " ", "=", " ", 
   "\"\<Invalid rearrangement: `1` of `2`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"3da68406-1e38-4146-9ce6-3e582f8f34a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeConjgIndicesD4", "[", "perm_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pmfx", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", "perm", "]"}], "=!=", 
        RowBox[{"Range", "[", "3", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepIndices", "::", "badrearr"}], ",", "perm", ",", 
          RowBox[{"Range", "[", "3", "]"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"pmfx", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"#", ">", "1"}], ",", 
          RowBox[{"#", "+", "1"}], ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
       "perm"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pmfx", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "2", ",", 
       RowBox[{"pmfx", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"pmfx", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[102]:=",ExpressionUUID->"151fd15b-c20d-465f-a64a-e78851149782"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Finds", " ", "the", " ", "highest", " ", "weight", " ", "of", " ", "the", 
    " ", "conjugate", " ", "irrep"}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "one", " ", "with", " ", "the", " ", "root"}], "-", 
    RowBox[{"vector", "/", "weight"}], "-", 
    RowBox[{"vector", " ", "signs", " ", "reversed"}]}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"2c9d2b09-c606-4dc6-ac96-7dc6181a35e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConjugate", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"maxwts", "[", 
   RowBox[{"[", 
    RowBox[{"MakeConjgIndices", "[", "type", "]"}], "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"bb5502b0-fde2-4336-9bd7-c9d2d4f13dc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepIsSelfConjugate", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"maxwts", " ", "==", " ", 
   RowBox[{"RepConjugate", "[", 
    RowBox[{"type", ",", "maxwts"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[105]:=",ExpressionUUID->"8437f567-0f0f-47f1-83f8-c676fc65a768"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"D4", " ", "-", " ", 
   RowBox[{"SO", 
    RowBox[{"(", "8", ")"}]}], " ", "-", " ", 
   RowBox[{
   "permutations", " ", "of", " ", "the", " ", "three", " ", "Dynkin"}], "-", 
   
   RowBox[{"diagram", " ", "legs"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"258851c4-9df5-4210-bd74-6843cbf4aaa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConjugateD4", "[", 
   RowBox[{"maxwts_", ",", "perm_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#", "=!=", "BadValue"}], ",", 
      RowBox[{"maxwts", "[", 
       RowBox[{"[", "#", "]"}], "]"}], ",", "#"}], "]"}], "&"}], " ", "@", 
   " ", 
   RowBox[{"MakeConjgIndicesD4", "[", "perm", "]"}]}]}]], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"4c55d5fd-3124-42e4-964a-4faf7426edc9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Reality", "Subsubsection",ExpressionUUID->"194d0259-ab11-4d3f-849b-45e1291790f3"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "height", " ", "of", " ", "a", " ", "rep", " ", "is", " ", 
     "max"}], " ", "-", " ", 
    RowBox[{"min", " ", "of", " ", "all", " ", "the", " ", "root"}], "-", 
    RowBox[{
    "vector", " ", "component", " ", "sums", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "If", " ", "a", " ", "rep", " ", "is", " ", 
     "self"}], "-", "conjugate"}], ",", " ", 
   RowBox[{
   "then", " ", "if", " ", "its", " ", "height", " ", "is", " ", "even"}], 
   ",", " ", 
   RowBox[{"it", " ", "is", " ", "real"}], ",", " ", 
   RowBox[{
   "while", " ", "if", " ", "its", " ", "height", " ", "is", " ", "odd"}], 
   ",", " ", 
   RowBox[{"it", " ", "is", " ", "pseudoreal"}], ",", " ", 
   RowBox[{"x", "."}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"4719f1cd-0ad9-4f5d-a087-e6c96bb9df34"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepHeightMult", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "k", "+", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "2", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "k", "+", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "k"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "k", "-", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ",", 
           RowBox[{"n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "16", ",", "30", ",", "42", ",", "30", ",", "16", ",", "22"}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
          "34", ",", "66", ",", "96", ",", "75", ",", "52", ",", "27", ",", 
           "49"}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "92", ",", "182", ",", "270", ",", "220", ",", "168", ",", "114", 
           ",", "58", ",", "136"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"22", ",", "42", ",", "30", ",", "16"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"10", ",", "6"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"c8e9f5bf-520a-4851-98b0-a26a7ada50a4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Test", " ", "of", " ", "origin", " ", "of", " ", "rep"}], "-", 
   RowBox[{"height", " ", 
    RowBox[{"coefficients", ".", " ", "The"}], " ", "rep", " ", "height", " ",
     "is", " ", "2", "*", "sum", 
    RowBox[{"(", 
     RowBox[{"maxwt", "-", "root"}], ")"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"65a27898-6cec-43a7-844c-09d7800cfd00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepHeightMultTest", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"RepHeightMult", "[", "type", "]"}], " ", "===", " ", 
   RowBox[{"2", "*", 
    RowBox[{"Total", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{
       RowBox[{"GetLieAlgebra", "[", "type", "]"}], "[", "\"\<InvCtn\>\"", 
       "]"}], "]"}], "]"}]}]}]}]], "Input",
 CellLabel->
  "In[111]:=",ExpressionUUID->"706d177d-fa98-4808-b3cb-397858b5d5c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepHeight", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RepHeightMult", "[", "type", "]"}], ".", "maxwts"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"ae672fee-2a5c-4958-a1da-98904e22e06e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Real", ":", " ", "1"}], ",", " ", 
   RowBox[{"pseudoreal", ":", " ", 
    RowBox[{"-", "1"}]}], ",", " ", 
   RowBox[{"complex", ":", " ", "0"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"9737022e-3ade-4811-a09c-c3e8f16c8fca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepReality", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepMaxWts", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"RepIsSelfConjugate", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"1", "-", 
      RowBox[{"2", "*", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"family", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
            RowBox[{"OddQ", "[", "n", "]"}]}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"A", 
              RowBox[{"(", "n", ")"}]}], ",", " ", 
             RowBox[{"n", " ", "odd"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{"maxwts", ".", 
            RowBox[{"Range", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"family", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "1"}], ",", "4"}], "]"}], " ", "<", " ", 
             "2"}]}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"B", 
              RowBox[{"(", "n", ")"}]}], ",", " ", 
             RowBox[{"n", " ", "=", " ", 
              RowBox[{
               RowBox[{"4", "k"}], "+", "1"}]}], ",", 
             RowBox[{
              RowBox[{"4", "k"}], "+", "2"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"maxwts", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"family", " ", "\[Equal]", " ", "3"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"C", 
             RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"maxwts", ".", 
            RowBox[{"Range", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"family", " ", "\[Equal]", " ", "4"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"n", "-", "2"}], ",", "4"}], "]"}], " ", "<", " ", 
             "2"}]}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"D", 
              RowBox[{"(", "n", ")"}]}], ",", " ", 
             RowBox[{"n", " ", "=", " ", 
              RowBox[{
               RowBox[{"4", "k"}], "+", "2"}]}], ",", 
             RowBox[{
              RowBox[{"4", "k"}], "+", "3"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"maxwts", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], " ", "+", " ", 
            RowBox[{"maxwts", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"family", " ", "\[Equal]", " ", "5"}], " ", "&&", " ", 
            RowBox[{"n", " ", "==", " ", "7"}]}], ",", " ", 
           RowBox[{"(*", " ", "E7", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"maxwts", "[", 
             RowBox[{"[", "4", "]"}], "]"}], " ", "+", " ", 
            RowBox[{"maxwts", "[", 
             RowBox[{"[", "6", "]"}], "]"}], " ", "+", " ", 
            RowBox[{"maxwts", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           "True", ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", 
          "]"}], ",", "2"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"69df26ee-aeed-4a3b-b6a0-f27447eac699"]
}, Closed]],

Cell[CellGroupData[{

Cell["Congruency classes", "Subsubsection",ExpressionUUID->"66960e0e-6f5a-48ea-ac86-b6c8d9873c99"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Weight", " ", "congruency", " ", 
     RowBox[{"classes", ".", "\[IndentingNewLine]", "Conserved"}], " ", 
     "quantities", " ", "in", " ", "weights", " ", "in", " ", "a", " ", 
     RowBox[{"rep", ":", " ", 
      RowBox[{
      "for", " ", "a", " ", "vector", " ", "c", " ", "such", " ", "that", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cartan", " ", "matrix"}], ")"}], " ", ".", " ", "c"}]}]}]}],
     " ", "=", " ", 
    RowBox[{"0", " ", "mod", " ", "p"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "then", " ", "all", " ", "weights", " ", "w", " ", "will", " ", "have", 
     " ", 
     RowBox[{"w", ".", "c"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"same", " ", "mod", " ", 
      RowBox[{"p", ".", " ", "Rep"}], " ", "products", " ", "will", " ", 
      "have", " ", "highest", " ", "weights", " ", "related", " ", "by", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w", " ", "-", " ", "w1", " ", "-", " ", "w2"}], ")"}], ".", 
       "c"}], " ", "mod", " ", "p"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "0", "\[IndentingNewLine]", "\[IndentingNewLine]", "For", " ", "A", 
       RowBox[{"(", "n", ")"}], " ", "SU", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "...", ",", "n"}], "}"}], " ", 
       "mod", " ", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], "\[IndentingNewLine]", "A", 
       RowBox[{"(", "1", ")"}], " ", "SU", 
       RowBox[{"(", "2", ")"}], " ", "j", " ", "is", " ", "integer", " ", 
       RowBox[{"vs", ".", " ", "half"}]}], "-", 
      RowBox[{
       RowBox[{"odd", " ", "/", " ", "tensor"}], " ", 
       RowBox[{"vs", ".", " ", "spinor"}], "\[IndentingNewLine]", "A", 
       RowBox[{"(", "2", ")"}], " ", "SU", 
       RowBox[{"(", "3", ")"}], " ", "triality", "\[IndentingNewLine]", "For",
        " ", "B", 
       RowBox[{"(", "n", ")"}], " ", "SO", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "+", "1"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"...", "1"}]}], "}"}], " ", "mod", " ", 
       RowBox[{"2", " ", "--"}], " ", "tensor", " ", 
       RowBox[{"vs", ".", " ", "spinor"}], "\[IndentingNewLine]", "For", " ", 
       "C", 
       RowBox[{"(", "n", ")"}], " ", "Sp", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "..."}], "}"}], " ", 
       "mod", " ", "2", "\[IndentingNewLine]", "For", " ", "D", 
       RowBox[{"(", "n", ")"}], " ", "SO", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}], " ", "it", " ", "depends", " ", "on", " ", 
       
       RowBox[{"n", "'"}], "s", " ", "parity", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"...", "0"}], ",", "1", ",", "1"}], "}"}], " ", "mod", " ", 
       "2", "\[IndentingNewLine]", "Even", " ", "n", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "1", ",", "0", ",", "...", ",", "0", ",", "1", 
         ",", "0"}], "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "1", ",", "0", ",", "...", ",", "0", ",", "0", 
         ",", "1"}], "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", 
       "Odd", " ", "n", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "2", ",", "0", ",", "2", ",", "0", ",", "...", ",", "2", ",", "3", 
         ",", "1"}], "}"}], " ", "mod", " ", "4", "\[IndentingNewLine]", 
       "For", " ", "E6", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}], " ", "mod", " ", "3", 
       "\[IndentingNewLine]", "For", " ", "E7", " ", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1"}], 
        "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", "None", " ", 
       "for", " ", "G2"}]}]}]}], ",", " ", "F4", ",", " ", 
   RowBox[{
   "or", " ", "E8", "\[IndentingNewLine]", "\[IndentingNewLine]", "When", " ",
     "the", " ", "modulo", " ", "factor", " ", "is", " ", "even"}], ",", " ", 
   
   RowBox[{
    RowBox[{"then", " ", "a", " ", "self"}], "-", 
    RowBox[{
    "conjugate", " ", "rep", " ", "will", " ", "be", " ", "real", " ", "if", 
     " ", "the", " ", "value", " ", "is", " ", "even"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "pseudoreal", " ", "if", " ", "it", " ", "is", " ", "odd"}], 
    ";", " ", "otherwise"}], ",", " ", 
   RowBox[{"it", " ", "is", " ", "always", " ", 
    RowBox[{
    "real", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Gets"}], " ", 
    "an", " ", "algebra", " ", "designation"}], ",", " ", 
   RowBox[{"returns", " ", "multipliers", " ", "for", " ", "weights", " ", 
    RowBox[{"(", 
     RowBox[{"can", " ", "be", " ", "more", " ", "than", " ", "one"}], 
     ")"}]}], ",", " ", 
   RowBox[{"and", " ", "the", " ", "modulus", " ", 
    RowBox[{"(", 
     RowBox[{
     "what", " ", "to", " ", "divide", " ", "by", " ", "and", " ", "take", 
      " ", "the", " ", "remainder", " ", "with"}], ")"}]}]}], " ", 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"fdf24437-38ea-404a-a2e1-0a61778f6729"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConservModMult", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"n", "-", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
         "}"}], "}"}], ",", "\[IndentingNewLine]", "3", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", "2"}], "]"}]}], "}"}], 
        "}"}], ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"OddQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"4", ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}]}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "}"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "0", ",", "1", ",", "2", ",", "0"}], 
             "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
              "1"}], "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "8", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"2280f2ea-324e-466b-a85a-467a7fb89da9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConservModuli", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"First", " ", "/@", " ", 
   RowBox[{"RepConservModMult", "[", "type", "]"}]}]}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"e6395967-e315-4735-9d6a-3f63b29b5c9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConserv", "[", 
   RowBox[{"type_", ",", "wt_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"wt", ".", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"RepConservModMult", "[", "type", "]"}]}]}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"ce173fd7-7137-486a-b608-aae691c486d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepProperties", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RepReality", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", 
    RowBox[{"RepConservModuli", "[", "type", "]"}], ",", 
    RowBox[{"RepConserv", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}]}], "}"}]}]], "Input",
 CellLabel->
  "In[119]:=",ExpressionUUID->"b0291584-117c-4ef2-935b-0f177b667798"]
}, Closed]],

Cell[CellGroupData[{

Cell["Misc Properties", "Subsubsection",ExpressionUUID->"9422c6a9-9c9d-4a12-add1-ca9b4082ba90"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Inverses", " ", "of", " ", "Cartan", " ", 
    RowBox[{"matrices", ".", " ", "weight"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"root", ".", "ctnmat"}], " ", "/", " ", "root"}], " ", "=", " ", 
    
    RowBox[{"weight", ".", 
     RowBox[{"inverse", "[", "ctnmat", "]"}]}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"303ffc43-766e-41dc-8111-ee17b9579707"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Found", " ", "the", " ", "greatest", " ", "common", " ", "multiples", " ",
     "of", " ", "the", " ", "denominators"}], ";", " ", 
   RowBox[{
    RowBox[{
    "they", " ", "agree", " ", "with", " ", "the", " ", "moduli", " ", "in", 
     " ", "the", " ", "conserved"}], "-", 
    RowBox[{"quantity", " ", 
     RowBox[{"calculations", "."}]}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"81d03b0d-7d6c-400f-a119-5e4312ea43ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CasimirInvariant", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "posroots", ",", "delta", ",", "metric", ",", "invmet", ",", 
      "ctnmat", ",", "invctn", ",", "maxroots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvMet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"delta", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", "posroots", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxroots", ".", "metric", ".", 
      RowBox[{"(", 
       RowBox[{"maxroots", "+", 
        RowBox[{"2", "*", "delta"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"da0d868f-1457-4467-8500-5579587b2a4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepIndex", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"TotalDegen", "[", 
    RowBox[{"type", ",", "maxwts", ",", "mwcheck"}], "]"}], "*", 
   RowBox[{
    RowBox[{"CasimirInvariant", "[", 
     RowBox[{"type", ",", "maxwts", ",", "mwcheck"}], "]"}], "/", 
    RowBox[{"AlgDimension", "[", "type", "]"}]}]}]}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"e3f84e50-a66d-47fc-a0d6-53a16051b0e6"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Combinations, Products, and Powers", "Section",ExpressionUUID->"46d390d2-88be-411b-a40d-cf9233ebd2b1"],

Cell[CellGroupData[{

Cell["Rep Combinations", "Subsection",ExpressionUUID->"9207e943-beb3-4150-bbde-e1a97ae19056"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "cases", " ", "of", " ", "multiple", " ", 
   RowBox[{"irreps", "."}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"49f28027-47cb-425d-9c54-8a5a6420c54c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Reducible", " ", 
    RowBox[{"representations", ":", " ", 
     RowBox[{"express", " ", "as", " ", "sum", " ", "of", " ", "irreps"}]}]}],
    ",", " ", 
   RowBox[{"a", " ", "list", " ", "of", " ", "irrep", " ", "highest", " ", 
    RowBox[{"weights", ".", " ", "Uses"}], " ", "generic", " ", "rep", " ", 
    RowBox[{"function", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"2d69011f-9196-4625-9a2b-8115f04758e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"tpx_", ",", "mwlist_", ",", "repfunc_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "maxwts", ",", "indrep", ",", "rprt", ",", "n", ",", 
      "rw", ",", 
      RowBox[{"rcmbd", "=", 
       RowBox[{"<|", "|>"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Find", " ", "the", " ", "combined", " ", 
       RowBox[{"representation", ".", "\[IndentingNewLine]", "Would"}], " ", 
       "like", " ", "degens"}], ",", " ", "roots", ",", " ", 
      RowBox[{"and", " ", "weights"}], ",", " ", 
      RowBox[{"since", " ", 
       RowBox[{"we", "'"}], "ll", " ", "need", " ", "all", " ", 
       RowBox[{"three", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indrep", " ", "===", " ", "BadValue"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"First", "[", "rprt", "]"}]}], ";", " ", 
           RowBox[{"rw", " ", "=", " ", 
            RowBox[{"Rest", "[", "rprt", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rcmbd", ",", "rw"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rcmbd", "[", "rw", "]"}], " ", "+=", " ", "n"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"rcmbd", ",", 
               RowBox[{"rw", "->", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rprt", ",", "indrep"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"maxwts", ",", "mwlist"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "#2", "}"}], ",", "#1"}], "]"}], "&"}], ",", "rcmbd"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"3fc2d7bc-e2f1-43f0-aa8e-fa9d13465c75"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CountedMaxWts", "::", "badmwc"}], " ", "=", " ", 
   "\"\<Invalid counted highest-weight vector: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"52f8d506-6467-4b0c-a6c6-ce319adc84ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckCountedMWTS", "[", "mwc_", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "mwc", "]"}], " ", "<", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mwc", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"82071c13-d677-468c-afff-2fb443f0b2d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"tpx_", ",", "mwclist_", ",", "repfunc_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "mwc", ",", "cnt", ",", "maxwts", ",", "indrep", ",", 
      "rprt", ",", "n", ",", "rw", ",", 
      RowBox[{"rcmbd", "=", 
       RowBox[{"<|", "|>"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Find", " ", "the", " ", "combined", " ", "representation", " ", "for", 
       " ", "a", " ", "counted", " ", 
       RowBox[{"list", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"count", ",", "maxwts"}], ")"}], ".", 
          "\[IndentingNewLine]", "Would"}], " ", "like", " ", "degens"}]}]}], 
      ",", " ", "roots", ",", " ", 
      RowBox[{"and", " ", "weights"}], ",", " ", 
      RowBox[{"since", " ", 
       RowBox[{"we", "'"}], "ll", " ", "need", " ", "all", " ", 
       RowBox[{"three", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"CheckCountedMWTS", "[", "mwc", "]"}]}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cnt", " ", "=", " ", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"maxwts", " ", "=", " ", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indrep", " ", "===", " ", "BadValue"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"cnt", "*", 
             RowBox[{"First", "[", "rprt", "]"}]}]}], ";", " ", 
           RowBox[{"rw", " ", "=", " ", 
            RowBox[{"Rest", "[", "rprt", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rcmbd", ",", "rw"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rcmbd", "[", "rw", "]"}], " ", "+=", " ", "n"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"rcmbd", ",", 
               RowBox[{"rw", "->", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rprt", ",", "indrep"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"mwc", ",", "mwclist"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "#2", "}"}], ",", "#1"}], "]"}], "&"}], ",", "rcmbd"}],
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"42f2f6b4-95a1-41d2-9646-28ba152133cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepList", "[", 
   RowBox[{"type_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"type", ",", "mwlist", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"300d1179-9985-4cbb-ab37-b44a93249c5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepCntdList", "[", 
   RowBox[{"type_", ",", "mwclist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"type", ",", "mwclist", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"2d19efb8-9f27-4068-b9bc-a66de71460df"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Algebra", " ", "products"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"7d35a26e-ffbf-4b19-9ed7-04e0f5ae318a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "repfunc_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tllen", ",", "mwproper", ",", "u1s", ",", "indreps", ",", "mcapnd", ",",
       "madtr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tllen", " ", "=", " ", 
      RowBox[{"Length", "[", "tplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mwproper", " ", "=", " ", 
      RowBox[{"Take", "[", 
       RowBox[{"maxwts", ",", "tllen"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"Drop", "[", 
       RowBox[{"maxwts", ",", "tllen"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "mwproper", "]"}], "==", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "u1s", ",", "u1s"}], "}"}], "}"}], "]"}]}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"indreps", " ", "=", " ", 
      RowBox[{"repfunc", " ", "@@@", " ", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"tplist", ",", "mwproper"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", " ", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "===", "BadValue"}], ")"}], "&"}], " ", "/@", " ", 
          "indreps"}], ")"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mcapnd", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Times", " ", "@@", " ", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "u1s"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "u1s"}], "]"}]}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"madtr", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"mcapnd", "[", 
       RowBox[{"Transpose", "[", "x", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"madtr", "/@", " ", 
      RowBox[{"Tuples", "[", "indreps", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"57ef8b11-2438-4c38-a681-85d385191016"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRep", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist", ",", "maxwts", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"483972a0-07e1-498b-b5e9-26385ae2bb45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepOrbits", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist", ",", "maxwts", ",", "GetRepOrbits"}], "]"}]}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"8549a103-71c8-49cb-9e8f-1a09fc56473c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepList", "[", 
   RowBox[{"tplist_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"tplist", ",", "mwlist", ",", "GetAlgProdRep"}], "]"}]}]], "Input",\

 CellLabel->
  "In[136]:=",ExpressionUUID->"b9861a4a-a125-473b-8b1e-13da200eddba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepCntdList", "[", 
   RowBox[{"tplist_", ",", "mwclist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"tplist", ",", "mwclist", ",", "GetAlgProdRep"}], "]"}]}]], "Input",\

 CellLabel->
  "In[137]:=",ExpressionUUID->"411d7e8b-be16-4f0e-95cf-5d08331e33d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdOrbit", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist", ",", "maxwts", ",", "GetCntdOrbit"}], "]"}]}]], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"d5442a75-d474-476c-99d1-6ebd23c51b01"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Select", " ", 
    RowBox[{"extended", ":", " ", 
     RowBox[{"xttype", " ", "is", " ", 
      RowBox[{"\"\<Sngl\>\"", " ", "--"}], " ", "single", " ", "irrep"}]}]}], 
   ",", " ", 
   RowBox[{
    RowBox[{"\"\<List\>\"", " ", "--"}], " ", "list", " ", "of", " ", 
    "irreps"}], ",", " ", 
   RowBox[{
    RowBox[{"\"\<Cntd\>\"", " ", "--"}], " ", "counted", " ", "list", " ", 
    "of", " ", "irreps"}], ",", " ", "x"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"31f3e0f5-1c25-4b62-9b0d-bb8cec2806ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtendedMaxWts", "::", "badtype"}], " ", "=", " ", 
   "\"\<Invalid extended-maxwts type: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"8a096813-bce9-4c31-9a9b-dc4df0c35a5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeCountedList", "[", 
   RowBox[{"xttype_", ",", "x_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<Sngl\>\"", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "x"}], "}"}], ",", "\"\<List\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "#"}], "}"}], "&"}], " ", "/@", " ", "x"}], ",", 
    " ", "\"\<Cntd\>\"", ",", "x", ",", "_", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "BadValue"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"d1fcd856-c9f3-42b2-a508-7e6b2bfbf188"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<Sngl\>\"", ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<List\>\"", ",", 
    RowBox[{"GetRepList", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<Cntd\>\"", ",", 
    RowBox[{"GetRepCntdList", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "_", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "BadValue"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[142]:=",ExpressionUUID->"96d23390-c17f-4958-aa4c-cd37aaa0df01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<Sngl\>\"", ",", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<List\>\"", ",", 
    RowBox[{"GetAlgProdRepList", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<Cntd\>\"", ",", 
    RowBox[{"GetAlgProdRepCntdList", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "_", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "BadValue"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"ba55c21c-ab3e-47de-ad83-5840b14daa56"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Extensions", ".", " ", "Type"}], " ", "is", " ", 
    RowBox[{"\"\<Sngl\>\"", " ", "--"}], " ", "single", " ", "irrep"}], ",", 
   " ", 
   RowBox[{
    RowBox[{"\"\<List\>\"", " ", "--"}], " ", "list", " ", "of", " ", 
    "irreps"}], ",", " ", 
   RowBox[{
    RowBox[{"\"\<Cntd\>\"", " ", "--"}], " ", "counted", " ", "list", " ", 
    "of", " ", 
    RowBox[{"irreps", ".", " ", "The"}], " ", "algebra", " ", "products", " ",
     "are", " ", 
    RowBox[{"{", 
     RowBox[{"la1", ",", "...", ",", "lan"}], "}"}]}], ",", " ", 
   RowBox[{"with", " ", "the", " ", "corresponding", " ", "irreps", " ", 
    RowBox[{"{", 
     RowBox[{"wt1", ",", "...", ",", "wtn", ",", "u1", ",", 
      RowBox[{"...", "um"}]}], "}"}], " ", "where", " ", "the", " ", 
    RowBox[{"la", "'"}], "s", " ", "are", " ", "the", " ", "individual", " ", 
    "algebras"}], ",", " ", 
   RowBox[{"the", " ", 
    RowBox[{"wt", "'"}], "s", " ", "the", " ", "individual", " ", "weights"}],
    ",", " ", 
   RowBox[{"and", " ", "the", " ", 
    RowBox[{"u", "'"}], "s", " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "factors", " ", "x"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"de66f69c-e790-40b2-bc72-a000a808f66c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<Sngl\>\"", ",", 
    RowBox[{"TotalDegen", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<List\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TotalDegen", "[", 
        RowBox[{"type", ",", "#"}], "]"}], "&"}], " ", "/@", " ", "maxwts"}], 
     "]"}], ",", "\"\<Cntd\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"TotalDegen", "[", 
         RowBox[{"type", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"c3357ab2-5043-406b-b4c5-d525c6fb50c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgProdTotalDegen", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"TotalDegen", "[", 
     RowBox[{
      RowBox[{"tplist", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"maxwts", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "tplist", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"f2786818-898a-4e4a-a913-16467b81ae65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgProdTotalDegenXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<Sngl\>\"", ",", 
    RowBox[{"AlgProdTotalDegen", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<List\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AlgProdTotalDegen", "[", 
        RowBox[{"tplist", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}], ",", "\"\<Cntd\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"AlgProdTotalDegen", "[", 
         RowBox[{"tplist", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}], ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "Null"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[147]:=",ExpressionUUID->"5e98a1ef-9c6c-42dc-b2c6-d7143e1eaee4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Makes", " ", "an", " ", "association", " ", "from", " ", "a", " ", 
   "representation", " ", "list"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[148]:=",ExpressionUUID->"8e30a6c9-9333-4035-8455-5715bc98b498"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRepAssoc", "[", "rep_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rpassoc", "=", 
       RowBox[{"<|", "|>"}]}], ",", "ind", ",", "n", ",", "rw"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"First", "[", "ind", "]"}]}], ";", " ", 
        RowBox[{"rw", " ", "=", " ", 
         RowBox[{"Rest", "[", "ind", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"rpassoc", ",", "rw"}], "]"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"rpassoc", "[", "rw", "]"}], " ", "+=", " ", "n"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"rpassoc", ",", 
            RowBox[{"rw", "->", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"ind", ",", "rep"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "rpassoc"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"66f383c9-41b3-4712-870a-725806e5edf5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Extracts", " ", "irreps", " ", "from", " ", "an", " ", "indexed", " ", 
    "rep"}], ",", " ", 
   RowBox[{"altering", " ", "it", " ", "as", " ", "it", " ", 
    RowBox[{"goes", ".", " ", 
     RowBox[{"Args", ":", " ", "algebra"}]}]}], ",", " ", 
   RowBox[{"rep", " ", "as", " ", "association", " ", "of", " ", 
    RowBox[{"rt", "/", "wt"}], " ", "to", " ", "count"}], ",", " ", 
   RowBox[{"maximum", "-", 
    RowBox[{"root", " ", "function"}]}], ",", " ", 
   RowBox[{"irrep", "-", 
    RowBox[{"finding", " ", "function"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"890df66c-a999-48d2-aa4a-f048b2938d1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"tpx_", ",", "rpasc_", ",", "maxrootfunc_", ",", "repfunc_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"irreplist", "=", 
       RowBox[{"{", "}"}]}], ",", "rpix", ",", "maxrw", ",", "wts", ",", 
      "nwt", ",", "rep", ",", "nrw", ",", "n", ",", "rw", ",", "newn"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rpix", " ", "=", " ", "rpasc"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Strip", " ", "out", " ", "zeroed"}], "-", 
         RowBox[{"out", " ", "elements"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rpix", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"rpix", ",", 
           RowBox[{
            RowBox[{"#", "!=", "0"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"No", " ", 
          RowBox[{"more", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rpix", "]"}], "==", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Search", " ", "for", " ", "the", " ", "highest", " ", 
           RowBox[{"weight", ".", " ", "Ordering"}], " ", "is", " ", "with", 
           " ", "the", " ", "roots"}], ",", " ", 
          RowBox[{
           RowBox[{"not", " ", "with", " ", "the", " ", 
            RowBox[{"weights", ".", " ", "Recommended"}], " ", "in", " ", 
            "Weight", " ", 
            RowBox[{"(", 
             RowBox[{"representation", " ", "theory"}], ")"}]}], " ", "-", 
           " ", "Wikipedia"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"the", " ", "free", " ", "encyclopedia"}], " ", "-", " ", 
            
            RowBox[{"http", ":"}]}], "//", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
             "/", "Weight_"}], 
            RowBox[{"(", "representation_theory", ")"}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"maxrw", "=", " ", "Null"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxrw", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"maxrw", " ", "===", " ", "Null"}], ",", "rw", ",", 
             RowBox[{"maxrootfunc", "[", 
              RowBox[{"maxrw", ",", "rw"}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rw", ",", 
            RowBox[{"Keys", "[", "rpix", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Found", " ", "a", " ", "new", " ", "rep"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"wts", " ", "=", " ", 
         RowBox[{"maxrw", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nwt", " ", "=", " ", 
         RowBox[{"rpix", "[", "maxrw", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"irreplist", ",", 
          RowBox[{"{", 
           RowBox[{"nwt", ",", "wts"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "wts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", "===", " ", "BadValue"}], ",", " ", 
          RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Subtract", " ", "it", " ", "out"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"nwt", "*", 
             RowBox[{"First", "[", "nrw", "]"}]}]}], ";", " ", 
           RowBox[{"rw", " ", "=", " ", 
            RowBox[{"Rest", "[", "nrw", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rpix", ",", "rw"}], "]"}], ",", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"rpix", "[", "rw", "]"}], " ", "-=", " ", "n"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"rpix", ",", 
               RowBox[{"rw", "->", 
                RowBox[{"-", "n"}]}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nrw", ",", "rep"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "irreplist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[151]:=",ExpressionUUID->"b1d8e41e-e16a-4aee-9c82-3668f6d80385"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Bias", " ", "toward", " ", "the", " ", "first", " ", "one"}], 
    " ", "-", " ", 
    RowBox[{"compare", " ", "roots"}]}], ",", " ", 
   RowBox[{"not", " ", "weights"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[152]:=",ExpressionUUID->"889567a0-7587-499f-bcf4-033ffc9526f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaxRepRoot", "[", 
   RowBox[{"en_", ",", "enx_"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"enx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"en", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], " ", ">", " ", "0"}],
     ",", "enx", ",", "en"}], "]"}]}]], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"85f1633c-01c0-4919-9e49-7ac0c177bbc6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Giving", " ", "it", " ", "a", " ", "different", " ", "name", " ", "for", 
   " ", "convenience"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[154]:=",ExpressionUUID->"f610ac37-cbcb-4574-9289-fe5d055bb189"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaxAlgProdRepRoot", "[", 
   RowBox[{"en_", ",", "enx_"}], "]"}], " ", ":=", " ", 
  RowBox[{"MaxRepRoot", "[", 
   RowBox[{"en", ",", "enx"}], "]"}]}]], "Input",
 CellLabel->
  "In[155]:=",ExpressionUUID->"43fec3e2-6b47-4028-acd2-c903b0d58926"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Extract", " ", "irreps", " ", "and", " ", "orbits"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[156]:=",ExpressionUUID->"a69260fa-c73b-45b2-8986-b70dc05675bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepIrreps", "[", 
   RowBox[{"type_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "GetRep"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[157]:=",ExpressionUUID->"33626946-d182-442f-9d1a-9924aa0d4e75"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractAlgProdRepIrreps", "[", 
   RowBox[{"tplist_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{
   "tplist", ",", "rpix", ",", "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"97c16353-2b52-4a84-bdb1-205ae73123a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepOrbitIrreps", "[", 
   RowBox[{"type_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "GetRepOrbits"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[159]:=",ExpressionUUID->"0b8d5f31-09cc-4d7c-9650-c99d889e137f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractAlgProdRepOrbitIrreps", "[", 
   RowBox[{"tplist_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{
   "tplist", ",", "rpix", ",", "MaxAlgProdRepRoot", ",", 
    "GetAlgProdRepOrbits"}], "]"}]}]], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"64e7e4e2-71e3-49f4-8fe1-1c535810153f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Application", ":", " ", 
   RowBox[{"from", " ", "Weyl", " ", "orbits", " ", "to", " ", "irreps"}]}], 
  " ", "*)"}]], "Input",
 CellLabel->
  "In[161]:=",ExpressionUUID->"b8662e30-88d8-4074-b9c9-86977cdd900f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepsFromOrbits", "[", 
   RowBox[{"type_", ",", "orbs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"type", ",", 
    RowBox[{"MakeRepAssoc", "[", "orbs", "]"}], ",", "MaxRepRoot", ",", 
    "GetRepOrbits"}], "]"}]}]], "Input",
 CellLabel->
  "In[162]:=",ExpressionUUID->"7050959b-5ee5-4be5-b4a7-d7ba6cad00ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rep Products", "Subsection",ExpressionUUID->"4b06f698-eb4e-4a68-a49c-8651559c0468"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
  "From", " ", "an", " ", "algebra", " ", "and", " ", "a", " ", "pair", " ", 
   "of", " ", "irreps", " ", "or", " ", "irrep", " ", "lists"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[163]:=",ExpressionUUID->"696599b8-4d87-459e-8c57-40b0e1d6dec5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{
   "type_", ",", "rep1_", ",", "rep2_", ",", "maxrootfunc_", ",", 
    "repfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rpix", "=", 
       RowBox[{"<|", "|>"}]}], ",", "nrw1", ",", "nrw2", ",", "n1", ",", "n2",
       ",", "rw1", ",", "rw2", ",", "n", ",", "rw"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep1", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep2", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n1", " ", "=", " ", 
         RowBox[{"First", "[", "nrw1", "]"}]}], ";", " ", 
        RowBox[{"rw1", " ", "=", " ", 
         RowBox[{"Rest", "[", "nrw1", "]"}]}], ";", " ", 
        RowBox[{"n2", " ", "=", " ", 
         RowBox[{"First", "[", "nrw2", "]"}]}], ";", "  ", 
        RowBox[{"rw2", " ", "=", " ", 
         RowBox[{"Rest", "[", "nrw2", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"n1", "*", "n2"}]}], ";", " ", 
        RowBox[{"rw", " ", "=", " ", 
         RowBox[{"rw1", "+", "rw2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"rpix", ",", "rw"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rpix", "[", "rw", "]"}], " ", "+=", " ", "n"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"rpix", ",", 
            RowBox[{"rw", "->", "n"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nrw1", ",", "rep1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nrw2", ",", "rep2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"type", ",", "rpix", ",", "maxrootfunc", ",", "repfunc"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[164]:=",ExpressionUUID->"1b4cbc05-a7af-4779-8377-3be51e9106c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProduct", "[", 
   RowBox[{"type_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts2"}], "]"}], ",", "MaxRepRoot", ",", 
    "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[165]:=",ExpressionUUID->"799bbbb7-440b-43a9-88cb-d219539d3421"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductXtnd", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype1", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype2", ",", "maxwts2"}], "]"}], ",", 
    "MaxRepRoot", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[166]:=",ExpressionUUID->"e6b823db-d764-4662-90e1-c56807d3eaad"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "products", " ", "of", " ", "algebras"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[167]:=",ExpressionUUID->"b4a06a23-623e-4fc9-b2a6-47e99dfcf210"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProduct", "[", 
   RowBox[{"tplist_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"tplist", ",", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts2"}], "]"}], ",", "MaxAlgProdRepRoot", ",",
     "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[168]:=",ExpressionUUID->"3b82b91b-d8f7-4132-b870-771624ee0f7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProductXtnd", "[", 
   RowBox[{
   "tplist_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"tplist", ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype1", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype2", ",", "maxwts2"}], "]"}], ",", 
    "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[169]:=",ExpressionUUID->"bf0ee1d6-c5ba-4240-89c4-ba6423c3b885"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "Weyl", " ", "orbits"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[170]:=",ExpressionUUID->"69ee588e-1d01-49d1-9ede-2dcab5c2a818"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeOrbitProduct", "[", 
   RowBox[{"type_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetCntdOrbit", "[", 
     RowBox[{"type", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetCntdOrbit", "[", 
     RowBox[{"type", ",", "maxwts2"}], "]"}], ",", "MaxRepRoot", ",", 
    "GetCntdOrbit"}], "]"}]}]], "Input",
 CellLabel->
  "In[171]:=",ExpressionUUID->"9a51ed86-4488-47dc-a01f-d3b8b18858c9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Alternative", ":", " ", 
    RowBox[{"expand", " ", "only", " ", "to", " ", "irreps"}]}], ",", " ", 
   RowBox[{"then", " ", "do", " ", "irrep", " ", "products"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[172]:=",ExpressionUUID->"9b179056-65bc-43fc-83ef-2b59ba90d798"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductXtndAltGen", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_", ",", "drpfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mwxp1", ",", "mwxp2", ",", "mwxp", ",", 
      RowBox[{"rpix", "=", 
       RowBox[{"<|", "|>"}]}], ",", "nmwt1", ",", "nmwt2", ",", "nmwt", ",", 
      "n1", ",", "w1", ",", "n2", ",", "w2", ",", "n", ",", "w", ",", "nx"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mwxp1", " ", "=", " ", 
      RowBox[{"MakeCountedList", "[", 
       RowBox[{"xttype1", ",", "maxwts1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwxp2", " ", "=", " ", 
      RowBox[{"MakeCountedList", "[", 
       RowBox[{"xttype2", ",", "maxwts2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n1", ",", "w1"}], "}"}], " ", "=", " ", "nmwt1"}], ";", 
        " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"n2", ",", "w2"}], "}"}], " ", "=", " ", "nmwt2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mwxp", " ", "=", " ", 
         RowBox[{"drpfunc", "[", 
          RowBox[{"type", ",", "w1", ",", "w2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n", ",", "w"}], "}"}], " ", "=", " ", "nmwt"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nx", " ", "=", " ", 
            RowBox[{"n1", "*", "n2", "*", "n"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{"rpix", ",", "w"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rpix", "[", "w", "]"}], " ", "+=", " ", "nx"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AssociateTo", "[", 
              RowBox[{"rpix", ",", 
               RowBox[{"w", "->", "nx"}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"nmwt", ",", "mwxp"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nmwt1", ",", "mwxp1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nmwt2", ",", "mwxp2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"KeyValueMap", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#2", ",", "#1"}], "}"}], "&"}], ",", "rpix"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"602cc58d-452f-43ff-b7ce-e72c1c1a003b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductXtndAlt", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductXtndAltGen", "[", 
   RowBox[{
   "type", ",", "xttype1", ",", "maxwts1", ",", "xttype2", ",", "maxwts2", 
    ",", "DecomposeRepProduct"}], "]"}]}]], "Input",
 CellLabel->
  "In[174]:=",ExpressionUUID->"946e88d0-8b50-4f7e-b4d5-a723c053c198"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProductXtndAlt", "[", 
   RowBox[{
   "tplist_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductXtndAltGen", "[", 
   RowBox[{
   "tplist", ",", "xttype1", ",", "maxwts1", ",", "xttype2", ",", "maxwts2", 
    ",", "DecomposeAlgProdRepProduct"}], "]"}]}]], "Input",
 CellLabel->
  "In[175]:=",ExpressionUUID->"80cebe31-15ea-4687-ad20-b726c9ec1344"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgProdVerifyTiming", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t0", ",", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetRepOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetReps", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"DecomposeRepProductXtnd", "[", 
        RowBox[{
        "type", ",", "xttype1", ",", "maxwts1", ",", "xttype2", ",", 
         "maxwts2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetRepOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetReps", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t1", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"DecomposeRepProductXtndAlt", "[", 
        RowBox[{
        "type", ",", "xttype1", ",", "maxwts1", ",", "xttype2", ",", 
         "maxwts2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetRepOrbits", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ResetReps", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"t1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"t0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
        RowBox[{"Sort", "[", 
         RowBox[{"t1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[176]:=",ExpressionUUID->"089db545-8917-4fa8-8279-fbc76d199ada"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Find", " ", "a", " ", "rep", " ", "product", " ", "for", " ", "a", " ", 
    "list", " ", "of", " ", "reps"}], ",", " ", 
   RowBox[{"and", " ", "not", " ", "just", " ", "2", " ", "reps"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[177]:=",ExpressionUUID->"a59fe92d-ec05-452e-975f-531a64f08ea8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProdList", "[", 
   RowBox[{"type_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecomposeRepProductXtnd", "[", 
      RowBox[{
      "type", ",", "\"\<Cntd\>\"", ",", "#1", ",", "\"\<Sngl\>\"", ",", 
       "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"type", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "}"}], ",", 
    "mwlist"}], "]"}]}]], "Input",
 CellLabel->
  "In[178]:=",ExpressionUUID->"d0805c6c-f16d-45d0-bcb5-c48be034b359"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProdList", "[", 
   RowBox[{"tplist_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecomposeAlgProdRepProductXtnd", "[", 
      RowBox[{
      "tplist", ",", "\"\<Cntd\>\"", ",", "#1", ",", "\"\<Sngl\>\"", ",", 
       "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ", 
        "tplist"}]}], "}"}], "}"}], ",", "mwlist"}], "]"}]}]], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"7b7c2f90-0fe5-487b-b65f-b89713898205"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "A", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "one", " ", "can", " ", "use", " ", "Young", " ", "diagrams", " ", "and", 
     " ", "the", " ", "Littlewood"}], "-", 
    RowBox[{"Richardson", " ", "rule"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[180]:=",ExpressionUUID->"10630378-fe6d-4aad-a835-edbfbad6bbc0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Rep Powers - Plethysms", "Subsection",ExpressionUUID->"2ba7a779-6276-4e7d-8e9b-9fa9b37210e9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "This", " ", "is", " ", "separate", " ", "from", " ", "Irrep", " ", 
    "Products"}], ",", " ", 
   RowBox[{
   "because", " ", "it", " ", "has", " ", "a", " ", "lot", " ", "of", " ", 
    "stuff", " ", "that", " ", "has", " ", "to", " ", "be", " ", "calculated",
     " ", "for", " ", "it"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[181]:=",ExpressionUUID->"0a74f3ba-c466-4c18-8b70-d92efecb5253"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorPowersYDX", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"84413159-63c9-4df1-80ad-95ce5fa3241c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDTensAddVector", "[", "ylst_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ylnew", ",", 
      RowBox[{"ylnl", "=", 
       RowBox[{"{", "}"}]}], ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ylnew", " ", "=", " ", "ylst"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ylnew", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ylnl", ",", "ylnew"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ylst", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", ">", " ", 
          RowBox[{"ylst", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ylnew", " ", "=", " ", "ylst"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ylnew", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "+=", " ", "1"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ylnl", ",", "ylnew"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "ylst", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ylnew", " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{"ylst", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ylnl", ",", "ylnew"}], "]"}], ";", "\[IndentingNewLine]", 
     "ylnl"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[183]:=",ExpressionUUID->"ff0aae35-6e87-4490-b4b0-1dca4ccfe9cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"memcount", "[", "lst_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"lst", ",", "#"}], "]"}], ",", "#"}], "}"}], "&"}], " ", "/@", 
   " ", 
   RowBox[{"Union", "[", "lst", "]"}]}]}]], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"92ec8b92-df23-4f93-ab32-c2cf6b49fcaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"multnomfac", "[", "dgrm_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cnts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cnts", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"memcount", "[", "dgrm", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", "cnts", "]"}], "!"}], "/", 
      RowBox[{"(", 
       RowBox[{"Times", " ", "@@", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "!"}], "&"}], " ", "/@", " ", "cnts"}], ")"}]}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[185]:=",ExpressionUUID->"4c88bc96-1ccd-4805-bfe5-3205be522c74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDTensSetAddVector", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nxdgs", "=", 
       RowBox[{"{", "}"}]}], ",", "dgcnt", ",", "dgentry", ",", "num", ",", 
      "dg", ",", "i", ",", "ndgs", ",", "ndg", ",", "j", ",", "nxdgmlst"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dgentry", " ", "=", " ", 
         RowBox[{"dgrmlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"num", " ", "=", " ", 
         RowBox[{"dgentry", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"dg", " ", "=", " ", 
         RowBox[{"dgentry", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndgs", " ", "=", " ", 
         RowBox[{"YDTensAddVector", "[", "dg", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ndg", " ", "=", " ", 
            RowBox[{"ndgs", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"dgcnt", "[", "ndg", "]"}], "]"}], " ", "===", " ", 
              "dgcnt"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"nxdgs", ",", "ndg"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dgcnt", "[", "ndg", "]"}], " ", "=", " ", "0"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dgcnt", "[", "ndg", "]"}], " ", "+=", " ", "num"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "ndgs", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "dgrmlist", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nxdgmlst", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ndg", " ", "=", " ", 
          RowBox[{"nxdgs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dgcnt", "[", "ndg", "]"}], ",", "ndg", ",", 
           RowBox[{"Length", "[", "ndg", "]"}], ",", 
           RowBox[{"multnomfac", "[", "ndg", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "nxdgs", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "nxdgmlst"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[186]:=",ExpressionUUID->"591a3807-7052-4a89-9553-357a3cda71db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetMultiplicities", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input",
 CellLabel->
  "In[187]:=",ExpressionUUID->"e5ca0e09-cfc5-47a0-9172-c89b5504b8a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetRepDiagrams", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input",
 CellLabel->
  "In[188]:=",ExpressionUUID->"d3855650-0b0d-4f46-b334-b73e5e34c005"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetLengths", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input",
 CellLabel->
  "In[189]:=",ExpressionUUID->"cc19f5b7-9e27-47a3-ac1f-e218748afbe9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetMultinomFacs", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input",
 CellLabel->
  "In[190]:=",ExpressionUUID->"7680935b-4813-407e-9797-ff8c716b9b01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeIndexing", "[", "lst_", "]"}], " ", ":=", " ", 
  RowBox[{"AssociationThread", "[", 
   RowBox[{"lst", ",", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "lst", "]"}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[191]:=",ExpressionUUID->"a642fde5-d6ee-4acb-a5d6-34239b43c203"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Uses", " ", "a", " ", "list", " ", "of", " ", "contracted", " ", "Young", 
   " ", "diagrams", " ", "that", " ", "are", " ", "all", " ", "with", " ", 
   "some", " ", "number", " ", "of", " ", 
   RowBox[{"boxes", ".", " ", "They"}], " ", "are", " ", "assumed", " ", "to",
    " ", "be", " ", "ordered", " ", "so", " ", "that", " ", "the", " ", 
   "matrix", " ", "will", " ", "be", " ", "upper", " ", "triangular"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[192]:=",ExpressionUUID->"b36706c0-4f8d-4b16-a1bc-9b85936ea04a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDKostkaMatrix", "[", "dgrms_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dglen", ",", "i", ",", "dg", ",", "dgix", ",", "lookback", ",", 
      "denfac", ",", "dgl", ",", "j", ",", "jx", ",", "dgx", ",", "k", ",", 
      "ix", ",", "dgd", ",", "kostka", ",", "kknum"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Index", " ", "the", " ", "diagrams"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgix", " ", "=", " ", 
      RowBox[{"MakeIndexing", "[", "dgrms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "\"\<C\>\"", " ", "lookback", " ", "matrix", " ", "and", 
       " ", "\"\<g\>\"", " ", "denominator", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lookback", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"denfac", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dg", " ", "=", " ", 
         RowBox[{"dgrms", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgl", " ", "=", " ", 
         RowBox[{"Length", "[", "dg", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Do", " ", "lookback"}], ";", " ", 
          RowBox[{"the", " ", "+=", " ", 
           RowBox[{
           "takes", " ", "care", " ", "of", " ", "the", " ", "multiplicities",
             " ", 
            RowBox[{"automatically", "."}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dgx", " ", "=", " ", "dg"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dgx", "[", 
               RowBox[{"[", "j", "]"}], "]"}], " ", "+=", " ", "k"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dgx", "[", 
               RowBox[{"[", "jx", "]"}], "]"}], " ", "-=", " ", "k"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dgd", " ", "=", " ", 
              RowBox[{
               RowBox[{"dgx", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"dgx", "[", 
                RowBox[{"[", "jx", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dgx", " ", "=", " ", 
              RowBox[{"Reverse", "[", 
               RowBox[{"Sort", "[", "dgx", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "dgx", "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{"dgx", "=", 
                RowBox[{"Most", "[", "dgx", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ix", " ", "=", " ", 
              RowBox[{"dgix", "[", "dgx", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"lookback", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "ix"}], "]"}], "]"}], " ", "+=", " ", 
              "dgd"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"dg", "[", 
               RowBox[{"[", "jx", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"dgl", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jx", ",", 
            RowBox[{"j", "+", "1"}], ",", "dgl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Denominator", " ", "factor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"denfac", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"dg", ".", "dg"}], ")"}]}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"dg", ".", 
            RowBox[{"Range", "[", "dgl", "]"}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kostka", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"kostka", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"kknum", " ", "=", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"lookback", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
               RowBox[{"kostka", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "i", ",", 
                RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"kknum", " ", "\[NotEqual]", " ", "0"}], ",", 
             RowBox[{
              RowBox[{"kostka", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"kknum", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"denfac", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"denfac", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]}]}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "dglen"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "kostka"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[193]:=",ExpressionUUID->"2f5718ce-20ef-40f9-a974-b56b337412ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDNesting", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dgrms", ",", "dlens", ",", "dmnfs", ",", "dglen", ",", "dgix", ",", 
      "nesting", ",", "dgrm", ",", "i", ",", "j", ",", "k", ",", "l", ",", 
      "subdgrms", ",", "sublens", ",", "submnfs", ",", "dgxp", ",", "dgxpm", 
      ",", "insdg", ",", "dxplst", ",", "lns", ",", "mnf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlens", " ", "=", " ", 
      RowBox[{"YDGetLengths", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dmnfs", " ", "=", " ", 
      RowBox[{"YDGetMultinomFacs", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgix", " ", "=", " ", 
      RowBox[{"MakeIndexing", "[", "dgrms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dgrm", " ", "=", " ", 
         RowBox[{"dgrms", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"subdgrms", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetRepDiagrams", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dgrms", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sublens", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetLengths", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dlens", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"submnfs", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetMultinomFacs", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dmnfs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgxp", " ", "=", " ", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
           "subdgrms"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dgxpm", " ", "=", " ", 
            RowBox[{"dgxp", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"insdg", " ", "=", " ", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"subdgrms", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", 
                    RowBox[{"dgxpm", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", 
                    RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}], 
                ",", "1"}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"dgix", "[", "insdg", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lns", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"sublens", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", 
                 RowBox[{"dgxpm", "[", 
                  RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"mnf", " ", "=", " ", 
            RowBox[{"Times", " ", "@@", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"submnfs", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", 
                  RowBox[{"dgxpm", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"dxplst", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"dgxpm", ",", "lns", ",", "mnf"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"nesting", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "dxplst"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "dgxp", "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "nesting"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[194]:=",ExpressionUUID->"090870a7-7011-4c07-a91e-9e8759886df3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDFillOut", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dgrms", ",", "kska", ",", "nesting"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kska", " ", "=", " ", 
      RowBox[{"YDKostkaMatrix", "[", "dgrms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{"YDNesting", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"<|", 
      RowBox[{
       RowBox[{"\"\<DgrmList\>\"", "->", "dgrmlist"}], ",", 
       RowBox[{"\"\<Kostka\>\"", "->", "kska"}], ",", 
       RowBox[{"\"\<Nesting\>\"", "->", "nesting"}]}], "|>"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[195]:=",ExpressionUUID->"4e5de0c7-34bf-4da9-84a0-0eca39b05c15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTensorPowerYDX", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tplen", ",", "k", ",", "tnsp", ",", "dgrm", ",", "dgrmlist"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "\[LessEqual]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"YDFillOut", "[", 
         RowBox[{"{", "}"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tplen", " ", "=", " ", 
      RowBox[{"Length", "[", "TensorPowersYDX", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tplen", " ", "<", " ", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dgrm", " ", "=", " ", 
         RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "dgrm", ",", 
            RowBox[{"Length", "[", "dgrm", "]"}], ",", 
            RowBox[{"multnomfac", "[", "dgrm", "]"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TensorPowersYDX", ",", 
          RowBox[{"YDFillOut", "[", "dgrmlist", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tplen", " ", "=", " ", 
         RowBox[{"Length", "[", "TensorPowersYDX", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tnsp", " ", "=", " ", 
         RowBox[{"Last", "[", "TensorPowersYDX", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"tnsp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"YDTensSetAddVector", "[", "dgrmlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TensorPowersYDX", ",", 
          RowBox[{"YDFillOut", "[", "dgrmlist", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"tplen", "+", "1"}], ",", "n"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"TensorPowersYDX", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[196]:=",ExpressionUUID->"c732fece-7657-471a-9db9-9d32d5dbe275"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Args", ":", " ", 
    RowBox[{"tensor", "-", "power", "-", 
     RowBox[{"ydx", " ", "value"}]}]}], ",", " ", 
   RowBox[{"indexer", " ", "of", " ", 
    RowBox[{"rep", "/", "digram"}]}], ",", " ", 
   RowBox[{"list", " ", "of", " ", "indexes"}], ",", " ", 
   RowBox[{"multiplicity", " ", "list", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"gets", " ", "indexed"}], ")"}], ".", " ", 
     RowBox[{"Returns", ":", " ", 
      RowBox[{"list", " ", "of", " ", 
       RowBox[{"(", 
        RowBox[{"multiplicity", ",", "index"}], ")"}]}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"multiplicities", " ", "for", " ", "product"}], "-", 
    RowBox[{"rep", " ", "calculation"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[197]:=",ExpressionUUID->"5fb38c6d-ae15-4da3-b876-fa26803cd2ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorPowerRootMultiplicities", "[", 
   RowBox[{"TensPwrYDX_", ",", "dgix_", ",", "idxs_", ",", "mults_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mc", ",", "repyd", ",", "ixms", ",", "mspwrs", ",", "kostka", ",", 
      "nesting", ",", "nstmem", ",", "nstmmi", ",", "pwrs", ",", "mncf", ",", 
      "pwr", ",", "mspl", ",", "mspwr", ",", "mpres", ",", "i", ",", "j", ",",
       "k", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mc", " ", "=", " ", 
      RowBox[{"memcount", "[", "idxs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mc", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"mc", ",", 
        RowBox[{
         RowBox[{"OrderedQ", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "&"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"repyd", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "mc"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ixms", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"mults", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], " ", "/@", 
       " ", "mc"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mspwrs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", "ixms"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kostka", " ", "=", " ", 
      RowBox[{"TensPwrYDX", "[", "\"\<Kostka\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{
       RowBox[{"TensPwrYDX", "[", "\"\<Nesting\>\"", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"dgix", "[", "repyd", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mpres", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nstmem", " ", "=", " ", 
          RowBox[{"nesting", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nstmmi", " ", "=", " ", 
             RowBox[{"nstmem", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pwrs", " ", "=", " ", 
             RowBox[{"nstmmi", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"mncf", " ", "=", " ", 
             RowBox[{"nstmmi", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"mncf", "*", 
             RowBox[{"Product", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"pwr", " ", "=", " ", 
                 RowBox[{"pwrs", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspwr", " ", "=", " ", 
                 RowBox[{"mspwrs", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspl", " ", "=", " ", 
                 RowBox[{"Length", "[", "mspwr", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pwr", " ", ">", " ", "mspl"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"mspwrs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "mspwr", "]"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ixms", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", "l", "+", "1"}], 
                    ")"}], "/", "l"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"mspl", "+", "1"}], ",", "pwr"}], "}"}]}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspwrs", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "pwr"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", "pwrs", "]"}]}], "}"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "nstmem", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "nesting", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mc", ",", 
       RowBox[{"kostka", ".", "mpres"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[198]:=",ExpressionUUID->"5017af58-de73-450f-8789-b32b4e6204a8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Generator", " ", "of", " ", "index", " ", 
    RowBox[{"sets", ".", " ", "The"}], " ", "indexes", " ", "are", " ", 
    "semi"}], "-", 
   RowBox[{"ascending", "."}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[199]:=",ExpressionUUID->"e6c6b07f-6e24-4f6f-abc1-2564fdf98492"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstIndexVector", "[", "vlen_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", "vlen", "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[200]:=",ExpressionUUID->"5b70c189-1af6-4b6e-89c5-f546a7fe1e47"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{
  "The", " ", "\"\<next\>\"", " ", "function", " ", "returns", " ", "Null", 
   " ", "when", " ", "it", " ", "runs", " ", "out"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[201]:=",ExpressionUUID->"0947b313-6022-44e6-b888-38223ffb1587"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NextIndexVector", "[", 
   RowBox[{"vlen_", ",", "ntot_", ",", "ixvec_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nixvec", ",", "k", ",", "l", ",", "didadvance"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nixvec", " ", "=", " ", "ixvec"}], ";", "\[IndentingNewLine]", 
     RowBox[{"didadvance", " ", "=", " ", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"nixvec", "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", "+=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nixvec", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "\[LessEqual]", " ", 
           "ntot"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"nixvec", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"nixvec", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", 
               RowBox[{"k", "+", "1"}], ",", "vlen"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"didadvance", " ", "=", " ", "True"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "vlen", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"didadvance", ",", "nixvec", ",", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[202]:=",ExpressionUUID->"357a013b-0946-4597-9413-1914724f25c7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "This", " ", "is", " ", "for", " ", "decomposing", " ", "a", " ", 
    "representation", " ", "decomposed", " ", "as", " ", "roots"}], ",", " ", 
   
   RowBox[{
   "for", " ", "the", " ", "purpose", " ", "of", " ", "handling", " ", 
    "reducible", " ", "as", " ", "well", " ", "as", " ", "irreducible", " ", 
    RowBox[{"representations", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[203]:=",ExpressionUUID->"d63b2458-c44a-4790-91c6-23e6dd481d36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RepPower", "::", "badreppwr"}], " ", "=", " ", 
   "\"\<Invalid rep power: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[204]:=",ExpressionUUID->"7f720254-7123-4b19-b909-d297326186a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckRepPower", "[", "pwr_", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "pwr", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RepPower", "::", "badreppwr"}], ",", "pwr"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "<", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RepPower", "::", "badreppwr"}], ",", "pwr"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[205]:=",ExpressionUUID->"4c88d9f8-7976-4c26-8f20-05e7284d2a8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{
   "tpx_", ",", "rep_", ",", "pwr_", ",", "maxrootfunc_", ",", "repfunc_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "len", ",", "zerovec", ",", " ", "tpydx", ",", "dgrms", ",", "dglen", 
      ",", "dgix", ",", "rtdgns", ",", "rpdcnums", ",", 
      RowBox[{"rppwrix", "=", 
       RowBox[{"<|", "|>"}]}], ",", "ixvec", ",", "tpres", ",", "tpdgrm", ",",
       "tpmlts", ",", "rt", ",", "rtsum", ",", "ixmult", ",", "i", ",", "key",
       ",", "num"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepPower", "[", "pwr", "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Zero", ":", " ", 
       RowBox[{"scalar", " ", "rep"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"0", "*", 
             RowBox[{"rep", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], "}"}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Get", " ", "tensor"}], "-", 
       RowBox[{"product", " ", "data", " ", "for", " ", "power"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tpydx", " ", "=", " ", 
      RowBox[{"GetTensorPowerYDX", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tpydx", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", 
       RowBox[{"tpydx", "[", "\"\<DgrmList\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgix", " ", "=", " ", 
      RowBox[{"MakeIndexing", "[", "dgrms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
         "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
         "power"}], "-", 
        RowBox[{"rep", " ", "list"}]}], ";", " ", 
       RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
        RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
        "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
        "convenience"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rtdgns", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "rep"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rpdcnums", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ixvec", " ", "=", " ", 
      RowBox[{"FirstIndexVector", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpres", " ", "=", " ", 
         RowBox[{"TensorPowerRootMultiplicities", "[", 
          RowBox[{"tpydx", ",", "dgix", ",", "ixvec", ",", "rtdgns"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"tpres", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpmlts", " ", "=", " ", 
         RowBox[{"tpres", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ixmult", " ", "=", " ", 
            RowBox[{"tpdgrm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rt", " ", "=", "  ", 
            RowBox[{
             RowBox[{"ixmult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"rep", "[", 
                RowBox[{"[", 
                 RowBox[{"ixmult", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", 
             RowBox[{"rtsum", " ", "=", " ", "rt"}], ",", " ", 
             RowBox[{"rtsum", " ", "+=", " ", "rt"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"key", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "rtsum"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"num", " ", "=", " ", 
            RowBox[{"tpmlts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"num", " ", "!=", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"KeyExistsQ", "[", 
                RowBox[{"rppwrix", ",", "key"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"rppwrix", "[", "key", "]"}], " ", "+=", " ", "num"}],
                ",", "\[IndentingNewLine]", 
               RowBox[{"AssociateTo", "[", 
                RowBox[{"rppwrix", ",", 
                 RowBox[{"key", "->", "num"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "dglen"}], "}"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"ixvec", " ", "=", " ", 
         RowBox[{"NextIndexVector", "[", 
          RowBox[{"pwr", ",", 
           RowBox[{"Length", "[", "rtdgns", "]"}], ",", "ixvec"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ixvec", "===", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ExtractRepIrrepsGeneral", "[", 
        RowBox[{"tpx", ",", 
         RowBox[{"KeyMap", "[", 
          RowBox[{"Last", ",", 
           RowBox[{"KeySelect", "[", 
            RowBox[{"rppwrix", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], "==", "i"}], "&"}]}], 
            "]"}]}], "]"}], ",", "maxrootfunc", ",", "repfunc"}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[206]:=",ExpressionUUID->"22a08245-9aef-4cd4-b0da-7eee53231047"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPower", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "pwr", ",", "MaxRepRoot", 
    ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[207]:=",ExpressionUUID->"eee78451-27ff-42e8-9d66-2a95f38561b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPowerXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ",
   ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",", 
    "MaxRepRoot", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[208]:=",ExpressionUUID->"5fa0412d-8bbd-49d4-9bae-107c1b9617ea"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "products", " ", "of", " ", "algebras"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[209]:=",ExpressionUUID->"894a5dd2-b248-47d2-8719-7138b86cf173"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPower", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"tplist", ",", " ", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "pwr", ",", 
    "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[210]:=",ExpressionUUID->"de884b14-2b5c-4344-b6fc-0172c9968fba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPowerXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_", ",", "pwr_"}], "]"}], 
  " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"tplist", ",", " ", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",",
     "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[211]:=",ExpressionUUID->"cb948cd7-bf54-4aac-a35a-8c07808cc952"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "Weyl", " ", "orbits"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[212]:=",ExpressionUUID->"41293208-88b5-4bec-a306-14dca6616b8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeOrbitPower", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetCntdOrbit", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "pwr", ",", "MaxRepRoot", 
    ",", "GetCntdOrbit"}], "]"}]}]], "Input",
 CellLabel->
  "In[213]:=",ExpressionUUID->"905fe0a3-64a2-43cc-a966-d74b8ef483b8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Pure", " ", "symmetric", " ", "and", " ", "antisymmetric", " ", 
    RowBox[{"cases", ":", " ", "sym"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"+", "1"}], " ", "and"}], " ", "-", "1"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[214]:=",ExpressionUUID->"71fde679-d6eb-43fe-9bef-9aea4fbccb67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{
   "tpx_", ",", "rep_", ",", "pwr_", ",", "sym_", ",", "maxrootfunc_", ",", 
    "repfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "symx", ",", "len", ",", "zerovec", ",", " ", "tpydx", ",", "dgrms", ",",
       "dglen", ",", "dgix", ",", "rtdgns", ",", 
      RowBox[{"rppwrix", "=", 
       RowBox[{"<|", "|>"}]}], ",", "ixvec", ",", "tpres", ",", "tpdgrm", ",",
       "dgi", ",", "dnm", ",", "nmi", ",", "tpmlts", ",", "rt", ",", "rtsum", 
      ",", "ixmult", ",", "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepPower", "[", "pwr", "]"}]}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Zero", ":", " ", 
       RowBox[{"scalar", " ", "rep"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"0", "*", 
            RowBox[{"rep", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fix", " ", "the", " ", "symmetry", " ", "factor"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"symx", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sym", " ", "<", "0"}], ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
         "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
         "power"}], "-", 
        RowBox[{"rep", " ", "list"}]}], ";", " ", 
       RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
        RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
        "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
        "convenience"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rtdgns", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "rep"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ixvec", " ", "=", " ", 
      RowBox[{"FirstIndexVector", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"memcount", "[", "ixvec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"tpdgrm", ",", 
           RowBox[{
            RowBox[{"OrderedQ", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpmlts", " ", "=", " ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dgi", " ", "=", " ", 
             RowBox[{"tpdgrm", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dnm", " ", "=", " ", 
             RowBox[{"dgi", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"nmi", " ", "=", " ", 
             RowBox[{"rtdgns", "[", 
              RowBox[{"[", 
               RowBox[{"dgi", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nmi", " ", "+", " ", 
                 RowBox[{"symx", "*", 
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}]}]}], ")"}], "/", "j"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "dnm"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ixmult", " ", "=", " ", 
            RowBox[{"tpdgrm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rt", " ", "=", " ", 
            RowBox[{
             RowBox[{"ixmult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"rep", "[", 
                RowBox[{"[", 
                 RowBox[{"ixmult", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", 
             RowBox[{"rtsum", " ", "=", " ", "rt"}], ",", 
             RowBox[{"rtsum", " ", "+=", " ", "rt"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tpmlts", "!=", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"KeyExistsQ", "[", 
             RowBox[{"rppwrix", ",", "rtsum"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rppwrix", "[", "rtsum", "]"}], " ", "+=", " ", 
             "tpmlts"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AssociateTo", "[", 
             RowBox[{"rppwrix", ",", 
              RowBox[{"rtsum", "->", "tpmlts"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ixvec", " ", "=", " ", 
         RowBox[{"NextIndexVector", "[", 
          RowBox[{"pwr", ",", 
           RowBox[{"Length", "[", "rtdgns", "]"}], ",", "ixvec"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ixvec", "===", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"tpx", ",", "rppwrix", ",", "maxrootfunc", ",", "repfunc"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[215]:=",ExpressionUUID->"ced1a9e4-7f7e-4c52-8122-c2885f24a4c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPwrSym", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}], " ", ":=",
   " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "pwr", ",", "sym", ",", 
    "MaxRepRoot", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[216]:=",ExpressionUUID->"39ffa1ab-bd12-463f-88a6-13961750e2d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPwrSymXtnd", "[", 
   RowBox[{
   "type_", ",", "xttype_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}],
   " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",", 
    "sym", ",", "MaxRepRoot", ",", "GetRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[217]:=",ExpressionUUID->"c7c52dfc-1f40-4fae-a0fb-cafbedabf374"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "products", " ", "of", " ", "algebras"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[218]:=",ExpressionUUID->"112f358c-8f5e-4538-8f3d-2c45bf38c049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPwrSym", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}], " ", 
  ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"tplist", ",", " ", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "pwr", ",", "sym", ",", 
    "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"dc0e73b4-24aa-47fe-97b0-1da367d87ab2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPwrSymXtnd", "[", 
   RowBox[{
   "tplist_", ",", "xttype_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], 
   "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"tplist", ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",",
     "sym", ",", "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[220]:=",ExpressionUUID->"31f5e2c9-8bdb-40f9-a4db-b6363661dd5e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "Weyl", " ", "orbits"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[221]:=",ExpressionUUID->"2b21580e-54f9-40c5-bb21-005bbecbc664"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeOrbitPwrSym", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}], " ", ":=",
   " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetCntdOrbit", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "pwr", ",", "sym", ",", 
    "MaxRepRoot", ",", "GetCntdOrbit"}], "]"}]}]], "Input",
 CellLabel->
  "In[222]:=",ExpressionUUID->"e38c1c73-d4a3-4788-ad4f-3c1fd3df9a61"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Verify", " ", "for", " ", "SU", 
   RowBox[{"(", "n", ")"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[223]:=",ExpressionUUID->"403a0c6a-5baf-40ce-914c-debdecc14080"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyAnOrbits", "[", 
   RowBox[{"n_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tpydx", ",", "yds", ",", "mxwts", ",", "k", ",", "mwixs", ",", "mw", 
      ",", "rep", ",", "rpdwmlts", ",", "wo", ",", "dwmlts", ",", "kska"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "<", " ", "pwr"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tpydx", " ", "=", " ", 
      RowBox[{"GetTensorPowerYDX", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yds", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", 
       RowBox[{"tpydx", "[", "\"\<DgrmList\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mxwts", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"Differences", "[", 
          RowBox[{"Reverse", "[", 
           RowBox[{"PadRight", "[", 
            RowBox[{"#", ",", 
             RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "]"}], "]"}], "&"}], 
       " ", "/@", " ", "yds"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mwixs", "[", 
         RowBox[{"mxwts", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "=", " ", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "mxwts", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dwmlts", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rep", " ", "=", " ", 
          RowBox[{"GetRepOrbits", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", "mw"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rpdwmlts", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "mxwts", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rpdwmlts", "[", 
             RowBox[{"[", 
              RowBox[{"mwixs", "[", 
               RowBox[{"wo", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}], " ", "=",
             " ", 
            RowBox[{"wo", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"wo", ",", "rep"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "rpdwmlts"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"mw", ",", "mxwts"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kska", " ", "=", " ", 
      RowBox[{"tpydx", "[", "\"\<Kostka\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dwmlts", " ", "===", " ", "kska"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[224]:=",ExpressionUUID->"38953b17-6a58-476a-8abf-8c3c4a463731"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Subalgebras and Branching Rules", "Section",ExpressionUUID->"5c5d33dd-078d-44a5-8eab-eec68c49a250"],

Cell[CellGroupData[{

Cell["Doing the Branching, Setup Functions", "Subsection",ExpressionUUID->"edb6181e-3d08-41ad-9304-aea8f8774eb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"brancher_", ",", "rep_", ",", "maxrootfunc_", ",", "repfunc_"}], 
   "]"}], " ", " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "subtypes", ",", "submatrts", ",", "submatwts", ",", "u1s", ",", 
      RowBox[{"rpix", "=", 
       RowBox[{"<|", "|>"}]}], ",", "rpmem", ",", "num", ",", "rt", ",", "wt",
       ",", "mat", ",", "rts", ",", "wts", ",", "u1vals", ",", "rtwts"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatrts", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatwts", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatWeights\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"num", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"wt", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rts", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"rt", ".", "mat"}], ",", 
           RowBox[{"{", 
            RowBox[{"mat", ",", "submatrts"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"wts", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"wt", ".", "mat"}], ",", 
           RowBox[{"{", 
            RowBox[{"mat", ",", "submatwts"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u1vals", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "u1s", "]"}], ">", "0"}], ",", 
           RowBox[{"u1s", ".", "rt"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rtwts", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"rts", ",", "u1vals"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"wts", ",", "u1vals"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"rpix", ",", "rtwts"}], "]"}], ",", "\[IndentingNewLine]", 
          
          RowBox[{
           RowBox[{"rpix", "[", "rtwts", "]"}], " ", "+=", " ", "num"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"rpix", ",", 
            RowBox[{"rtwts", "->", "num"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"subtypes", ",", "rpix", ",", "maxrootfunc", ",", "repfunc"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[225]:=",ExpressionUUID->"048c7931-0880-4621-a268-9c0f0a497151"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranching", "[", 
   RowBox[{"brancher_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"brancher", ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], ",", "maxwts"}], "]"}], 
    ",", "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], "]"}]}]], "Input",
 CellLabel->
  "In[226]:=",ExpressionUUID->"6feaaaa9-c24b-4749-9439-b1ce7ded04df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranchingXtnd", "[", 
   RowBox[{"brancher_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"brancher", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], ",", "xttype", ",", 
      "maxwts"}], "]"}], ",", "MaxAlgProdRepRoot", ",", "GetAlgProdRep"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[227]:=",ExpressionUUID->"981fda3c-ed81-4b12-a24d-f4a978e98d18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoOrbitBranching", "[", 
   RowBox[{"brancher_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"brancher", ",", 
    RowBox[{"GetCntdOrbit", "[", 
     RowBox[{
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], ",", "maxwts"}], "]"}], 
    ",", "MaxAlgProdRepRoot", ",", "GetAlgProdOrbit"}], "]"}]}]], "Input",
 CellLabel->
  "In[228]:=",ExpressionUUID->"863f9879-14c3-4c28-aff2-03d60a0913c2"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Make", " ", "a", " ", 
   RowBox[{"brancher", ":", " ", 
    RowBox[{
    "submatrices", " ", "in", " ", "weight", " ", "space", " ", "or", " ", 
     "root", " ", 
     RowBox[{"space", ".", " ", "It"}], " ", "fills", " ", "in", " ", "the", 
     " ", "other", " ", "version"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[229]:=",ExpressionUUID->"c0e2354c-ecac-4704-abd9-f1d7a8ae9ab8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeBrancherSMWeights", "[", 
   RowBox[{"type_", ",", "subtypes_", ",", "submatwts_", ",", 
    RowBox[{"u1s_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"brancher", "=", 
      RowBox[{"<|", "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<Type\>\"", "->", "type"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<Subtypes\>\"", "->", "subtypes"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<SubmatWeights\>\"", "->", "submatwts"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<SubmatRoots\>\"", "->", 
        RowBox[{"SubmatWeightsToRoots", "[", "brancher", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<U1s\>\"", "->", "u1s"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "brancher"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[230]:=",ExpressionUUID->"a9d583e9-1972-459d-b2c3-d3d97da6dd35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeBrancherSMRoots", "[", 
   RowBox[{"type_", ",", "subtypes_", ",", "submatrts_", ",", 
    RowBox[{"u1s_", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"brancher", "=", 
      RowBox[{"<|", "|>"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<Type\>\"", "->", "type"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<Subtypes\>\"", "->", "subtypes"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<SubmatRoots\>\"", "->", "submatrts"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<SubmatWeights\>\"", "->", 
        RowBox[{"SubmatRootsToWeights", "[", "brancher", "]"}]}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AssociateTo", "[", 
      RowBox[{"brancher", ",", 
       RowBox[{"\"\<U1s\>\"", "->", "u1s"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "brancher"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[231]:=",ExpressionUUID->"662a77af-5107-4065-97a6-ae5f62e74eeb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatWeightsToRoots", "[", "brancher_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "slas", ",", "submatwts", ",", " ", "m0", ",", " ", "m1s"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", " ", 
       RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slas", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", " ", "/@", " ", 
       RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatwts", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatWeights\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m0", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1s", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<InvCtn\>\"", "]"}], "&"}], " ", "/@", " ", 
       "slas"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"m0", ".", 
        RowBox[{"submatwts", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"m1s", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "slas", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[232]:=",ExpressionUUID->"81a7e427-1698-4179-80e7-0cf57cacab2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatRootsToWeights", "[", "brancher_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "slas", ",", "submatrts", ",", " ", "m0", ",", " ", "m1s"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", " ", 
       RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slas", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", " ", "/@", " ", 
       RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatrts", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m0", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<InvCtn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m1s", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", "\"\<CtnMat\>\"", "]"}], "&"}], " ", "/@", " ", 
       "slas"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"m0", ".", 
        RowBox[{"submatrts", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", 
        RowBox[{"m1s", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "slas", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[233]:=",ExpressionUUID->"130132ea-2547-4488-9534-efe5ce210770"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Results", ":", " ", 
    RowBox[{"in", " ", "weight", " ", "space"}]}], ",", " ", 
   RowBox[{
    RowBox[{"root", " ", "demotion", " ", "is", " ", 
     RowBox[{"easy", ":", " ", 
      RowBox[{
       RowBox[{"original", " ", "root"}], " ", "-", " ", 
       RowBox[{"subalgebra", " ", "root"}]}]}]}], " ", "=", " ", "1"}], ",", 
   " ", 
   RowBox[{
    RowBox[{"all", " ", "others", " ", 
     RowBox[{
     "zero", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Extension"}],
      " ", "splitting", " ", "turns", " ", "the", " ", "subalgebra", " ", 
     "root", " ", "assigned", " ", "to", " ", "the", " ", "extra", " ", 
     "root", " ", "into", " ", "this", " ", "column"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", 
       "2", " ", "-", "2"}], " ", "..."}], " ", "-", "2", " ", "-", "1"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "1", " ", "-", 
      "1", " ", "-", "1"}], " ", "..."}], " ", "-", "1", " ", "-", "1"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", 
      "2"}], " ", "..."}], " ", "-", "2", " ", "-", "1", " ", "-", "1"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"6", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", "3", 
    " ", "-", "2", " ", "-", "1", " ", "-", "2"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"7", " ", "--"}]}], " ", "-", "2", " ", "-", "3", " ", "-", "4", 
    " ", "-", "3", " ", "-", "2", " ", "-", "1", " ", "-", "2"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"8", " ", "--"}]}], " ", "-", "2", " ", "-", "4", " ", "-", "6", 
    " ", "-", "5", " ", "-", "4", " ", "-", "3", " ", "-", "2", " ", "-", 
    "3"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"6", " ", 
     RowBox[{"4", " ", "--"}]}], " ", "-", "2", " ", "-", "3", " ", "-", "2", 
    " ", "-", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"7", " ", 
     RowBox[{"2", " ", "--"}]}], " ", "-", "2", " ", "-", "1"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SubalgSOEvenOdd", " ", "gives", " ", "odd", " ", "results"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
   "SubalgExtra", " ", "gives", " ", "even", " ", "odder", " ", "results"}]}],
   "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[234]:=",ExpressionUUID->"d46761b8-b4a5-4a07-b26f-979156b8155e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Root Demotion: makes U(1) factors from roots", "Subsection",ExpressionUUID->"0788654c-4c5b-428c-a5bf-a3eefd09d733"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Demotion", " ", "of", " ", "roots", " ", "to", " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "factors", " ", "and", " ", "algebra", " ", 
    
    RowBox[{"splits", ".", "\[IndentingNewLine]", 
     RowBox[{"Args", ":", " ", 
      RowBox[{"type", " ", "of", " ", "parent", " ", "algebra"}]}]}]}], ",", 
   " ", 
   RowBox[{"demoted", "-", 
    RowBox[{"root", " ", "index"}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellLabel->
  "In[235]:=",ExpressionUUID->"2558c11c-d249-4fa8-bf2c-2ca79d4ebe87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid demotion root: `2`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[236]:=",ExpressionUUID->"9d40bb66-945c-4091-812a-9e85bf4fd4dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRootDemoter", "[", 
   RowBox[{"type_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", 
      RowBox[{"rsdt", "=", 
       RowBox[{"{", "}"}]}], ",", "subtypes", ",", "origranges", ",", 
      "submatwts", ",", "u1s"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "n"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"List", " ", "of", " ", 
       RowBox[{"{", 
        RowBox[{"subtype", ",", " ", 
         RowBox[{
         "original", " ", "roots", " ", "that", " ", "map", " ", "onto", " ", 
          "subalgebra", " ", "roots"}]}], "}"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ix", " ", ">", " ", "1"}], "&&", 
           RowBox[{"ix", "<", 
            RowBox[{"n", "-", "1"}]}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "\[Equal]", " ", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"n", "-", "2"}]}], "]"}], ",", "n"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "\[Equal]", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}],
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "2", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
               "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "5", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], 
                "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", "7"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "3", ",", "4", ",", "5", ",", "6"}], 
                 "}"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "7"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "6", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "7"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "7", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", 
                 "8"}], "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "8", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "}"}]}], "}"}]}],
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "6", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "7", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "8"}], "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "7"}], "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3", ",", "2"}], "}"}]}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "3", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "4", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "2", "}"}]}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "1", "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "rsdt", "]"}], "==", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"MakeBrancherSMWeights", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtypes", ",", "origranges"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", "rsdt", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"submatwts", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"orng", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "}"}], "->", 
              "1"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "orng", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "orng", "]"}]}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"orng", ",", "origranges"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "==", "ix"}], ",", "1", ",", "0"}], "]"}], "&"}], " ",
         "/@", " ", 
        RowBox[{"Range", "[", "n", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMWeights", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submatwts", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[237]:=",ExpressionUUID->"ad07d541-6704-4727-9679-d842de7da3d7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Finds", " ", "a", " ", "list", " ", "of", " ", "the", " ", "possible", " ",
    "root", " ", "demotions", " ", "of", " ", "an", " ", 
   RowBox[{"algebra", "."}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[238]:=",ExpressionUUID->"6d5f7293-b369-4026-8325-e1b4efd870a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListRootDemotions", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"MakeRootDemoter", "[", 
        RowBox[{"type", ",", "k"}], "]"}], "[", "\"\<Subtypes\>\"", "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[239]:=",ExpressionUUID->"f3494489-bec0-4d76-8a00-5d78f0ca75ce"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extension Splitting", "Subsection",ExpressionUUID->"b38630f1-f5e7-4868-b8ce-75db5737b06f"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Extension", " ", "of", " ", "the", " ", "Dynkin", " ", "diagram", " ", 
     "with", " ", "the", " ", "adjoint"}], "-", 
    RowBox[{
    "connected", " ", "root", " ", "and", " ", "splitting", " ", "of", " ", 
     "the", " ", "algebra", " ", "by", " ", "removing", " ", "a", " ", 
     RowBox[{"root", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Args", ":", " ", 
       RowBox[{
        RowBox[{"label", " ", "of", " ", "branching"}], "-", 
        RowBox[{"rule", " ", "generator"}]}]}]}]}]}], ",", " ", 
   RowBox[{"type", " ", "of", " ", "parent", " ", "algebra"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "demoted"}], "-", 
    RowBox[{"root", " ", "index"}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellLabel->
  "In[240]:=",ExpressionUUID->"a0eb17e7-3aed-4b73-8dd7-5c80cb14420f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid extension root: `2`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"480c3588-1336-485a-a55f-2a65d75cdc3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "unspalg"}], " ", "=", " ", 
   "\"\<Unsupported algebra: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[242]:=",ExpressionUUID->"7cd90dd7-2d4d-4b64-9178-89e19d80530f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExtensionSplitter", "[", 
   RowBox[{"type_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", 
      RowBox[{"rsdt", "=", 
       RowBox[{"{", "}"}]}], ",", "ixe", ",", "subtypes", ",", "origranges", 
      ",", "metdiag", ",", "psrtmax", ",", "spccol", ",", "submatwts"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", ",", "type", ",", 
          "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "n"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", ",", "type", ",", 
          "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"family", " ", "\[Equal]", " ", "4"}], " ", "&&", " ", 
        RowBox[{"n", " ", "\[LessEqual]", " ", "2"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "unspalg"}], " ", ",", "type"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"D2", " ", "=", " ", 
       RowBox[{"A1", "*", "A1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"rsdt", ",", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"ix", "+", "1"}], ",", "n"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"ix", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ix", " ", "\[Equal]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rsdt", ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "n"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "ix"}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"ix", "-", "1"}], ",", "1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"ix", " ", "<", " ", "n"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"rsdt", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"ix", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"rsdt", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "ix"}], "}"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "-", "1"}], ",", "1", ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ix", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"rsdt", ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "n"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"ix", " ", "\[GreaterEqual]", " ", 
          RowBox[{"n", "-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ixe", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "-", " ", "ix"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{"type", ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                    RowBox[{"n", "-", "2"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "ixe"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "ix"}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"ix", "-", "1"}], ",", "1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "6", ",", 
                 RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4", ",", "3", ",", "6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "5", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", 
                 RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "2", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "5", ",", "4", ",", "3", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "3", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", 
                  "7"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4", 
                  ",", "7"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "2", ",", "1", ",", 
                 RowBox[{"-", "1"}], ",", "7"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4", 
                 ",", "5", ",", "6"}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "7", ",", "6", ",", "5", ",", "4", 
                 ",", "3", ",", "2", ",", "8"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "7", ",", "6", ",", "5", ",", "4", 
                  ",", "3", ",", "8"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                  "8"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "7", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", "4", "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], "}"}]}], 
            "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"rsdt", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtypes", ",", "origranges"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", "rsdt", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metdiag", " ", "=", " ", 
      RowBox[{"Diagonal", "[", 
       RowBox[{"la", "[", "\"\<Metric\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psrtmax", " ", "=", " ", 
      RowBox[{"First", "[", 
       RowBox[{"Last", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spccol", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", " ", "psrtmax"}], "*", 
       RowBox[{"metdiag", "/", 
        RowBox[{"Max", "[", "metdiag", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submatwts", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"SparseArray", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"orng", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "==", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"Splice", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}], "->", 
                   RowBox[{"spccol", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"orng", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "}"}], "->", 
                "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "orng", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Length", "[", "orng", "]"}]}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"orng", ",", "origranges"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMWeights", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submatwts"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[243]:=",ExpressionUUID->"38fec709-e966-4e8c-87b8-5a84da49c119"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Finds", " ", "a", " ", "list", " ", "of", " ", "the", " ", "possible", 
    " ", "root"}], "-", 
   RowBox[{
   "extension", " ", "splits", " ", "of", " ", "an", " ", "algebra"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[244]:=",ExpressionUUID->"8f8d14e1-e351-4366-8c02-54a37c016d79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListExtensionSplits", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{
       RowBox[{"MakeExtensionSplitter", "[", 
        RowBox[{"type", ",", "k"}], "]"}], "[", "\"\<Subtypes\>\"", "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[245]:=",ExpressionUUID->"cabb537c-4edb-4a6f-bb54-ab8283be3ea6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Matrix Outer Products", "Subsection",ExpressionUUID->"2d1ac97b-84da-4838-8eb4-c12912268392"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "first", " ", "two", " ", "here", " ", "have", " ", "an", " ", 
    "interesting", " ", 
    RowBox[{"interpretation", ":", " ", 
     RowBox[{
      RowBox[{"the", " ", "original", " ", "Lie"}], "-", 
      RowBox[{
      "group", " ", "matrices", " ", "become", " ", "outer", " ", "products", 
       " ", "of", " ", "the", " ", "subgroup", " ", 
       RowBox[{"matrices", ".", " ", "Dynkin"}], " ", "has", " ", "proved", 
       " ", "that", " ", "these", " ", "are", " ", "the", " ", "only", " ", 
       "maximal", " ", "nonsimple", " ", "subalgebra", " ", "decompositions", 
       " ", "of", " ", "the", " ", "classical", " ", "Lie", " ", 
       RowBox[{
       "algebras", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Determination"}], " ", "of", " ", "all", " ", "the", " ", "simple", 
       " ", "subalgebras", " ", "has", " ", "been", " ", "difficult"}]}]}]}], 
   ",", " ", 
   RowBox[{"it", " ", "must", " ", "be", " ", 
    RowBox[{"noted", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[246]:=",ExpressionUUID->"be62eae5-6c09-450a-8d65-6fdb4dfba63c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "function", " ", "reduces", " ", "SU", 
    RowBox[{"(", "n", ")"}], " ", "to", " ", "a", " ", "product", " ", "of", 
    " ", "SU", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s", " ", "where", " ", "n"}], " ", "=", 
   " ", 
   RowBox[{"product", " ", "of", " ", 
    RowBox[{"m", "'"}], 
    RowBox[{"s", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[247]:=",ExpressionUUID->"7ee0398a-fa42-49b6-a6fe-446e7bb9cbfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsulst"}], " ", "=", " ", 
   "\"\<Invalid SU size list: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[248]:=",ExpressionUUID->"254cf27d-6030-46c2-b6a5-ebca2b718ebf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultSU", "[", "suords_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nso", ",", "soprod", ",", "vecproj", ",", "n", ",", "nt", ",", "type", 
      ",", "stsms", ",", "kso", ",", "smat", ",", "sm", ",", "smt", ",", 
      "sstr", ",", "k", ",", "ko", ",", "ks", ",", "stype", ",", "sla", ",", 
      "subtypes", ",", "submatrts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nso", " ", "=", " ", 
      RowBox[{"Length", "[", "suords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nso", " ", "<", " ", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "suords"}], ")"}]}], ")"}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[GreaterEqual]", "2"}], ")"}], "&"}], " ", "/@", 
            " ", "suords"}], ")"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"soprod", " ", "=", " ", 
      RowBox[{"Times", " ", "@@", " ", "suords"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nt", " ", "=", " ", 
      RowBox[{"n", " ", "-", " ", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "This", " ", "matrix", " ", "turns", " ", "the", " ", "vector", " ", 
        "rep", " ", "into", " ", "a", " ", "diagonal", " ", "line", " ", "of",
         " ", 
        RowBox[{"1", "'"}], "s", " ", "or"}], " ", "-", 
       RowBox[{
        RowBox[{"1", "'"}], "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecproj", " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Splice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"k", "+", "1"}]}], "}"}], "->", 
               RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "nt"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"nt", ",", "n"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sm", " ", "=", " ", 
          RowBox[{"suords", "[", 
           RowBox[{"[", "kso", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smt", " ", "=", " ", 
          RowBox[{"sm", " ", "-", " ", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stype", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "smt"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sstr", " ", "=", " ", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"suords", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"Normal", "[", 
           RowBox[{"SparseArray", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ko", " ", "=", " ", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sm"}], "]"}]}], 
                ";", 
                RowBox[{"Splice", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", "1"}], ",", 
                    "Nothing"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}], ",", "Nothing"}], "]"}]}], "}"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", 
               RowBox[{"sm", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sla", " ", "=", " ", 
          RowBox[{"GetLieAlgebra", "[", "stype", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"smat", ".", 
           RowBox[{"sla", "[", "\"\<InvCtn\>\"", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"vecproj", ".", "smat"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"stype", ",", "smat"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"kso", ",", "nso"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtypes", ",", "submatrts"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", "stsms", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submatrts"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[249]:=",ExpressionUUID->"a9c9ed31-a529-4520-a1b8-61bc2fe52e0d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "function", " ", "reduces", " ", "SO", 
    RowBox[{"(", "n", ")"}], " ", "and", " ", "Sp", 
    RowBox[{"(", "n", ")"}], " ", "to", " ", "a", " ", "product", " ", "of", 
    " ", "SO", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s", " ", "and", " ", "Sp", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s"}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", "n"}], " ", "=", " ", 
    RowBox[{"product", " ", "of", " ", 
     RowBox[{"m", "'"}], 
     RowBox[{"s", ".", " ", "Positive"}], " ", "n", " ", "means", " ", "SO", 
     RowBox[{"(", "n", ")"}], " ", "and", " ", "negative", " ", "n", " ", 
     "means", " ", "Sp", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "n"}], ")"}], ".", " ", "SO"}], 
     RowBox[{"(", "2", ")"}], " ", "is", " ", "handled", " ", "as", " ", "a", 
     " ", "U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{"factor", "."}]}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[250]:=",ExpressionUUID->"94ab9ce3-6898-4f95-89ab-07e69c173b04"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsosplst"}], " ", "=", " ", 
   "\"\<Invalid SO/Sp size list: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[251]:=",ExpressionUUID->"c636c822-1ce9-4cfc-9473-d9610df3f5e4"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"SubalgMultSOSp", "[", "sospords_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nso", ",", "soprod", ",", " ", "vecproj", ",", " ", "n", ",", "nt", 
       ",", "type", ",", 
       RowBox[{"stsms", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"u1s", "=", 
        RowBox[{"{", "}"}]}], ",", "kso", ",", "smat", ",", "sm", ",", "sma", 
       ",", "smt", ",", "sstr", ",", "k", ",", "ko", ",", "ks", ",", "stype", 
       ",", "sla", ",", "subtypes", ",", "submatrts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nso", " ", "=", " ", 
       RowBox[{"Length", "[", "sospords", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nso", " ", "<", " ", "1"}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"And", " ", "@@", " ", 
           RowBox[{"(", 
            RowBox[{"IntegerQ", " ", "/@", " ", "sospords"}], ")"}]}], 
          ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"And", " ", "@@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[GreaterEqual]", "2"}], ")"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "<", "0"}], ")"}], "&&", 
                  RowBox[{"EvenQ", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], 
             " ", "/@", " ", "sospords"}], ")"}]}], ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"soprod", " ", "=", " ", 
       RowBox[{"Times", " ", "@@", " ", "sospords"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Construct", " ", "a", " ", "projection", " ", "matrix", " ", "for", 
         " ", "roots", " ", "onto", " ", "vector", " ", 
         RowBox[{"rep", ".", " ", "Also"}], " ", "get", " ", "the", " ", 
         RowBox[{"type", ".", " ", "Much"}], " ", "like", " ", "the", " ", 
         "previous", " ", "function"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"it", "'"}], "s", " ", "designed", " ", "to", " ", "turn", 
          " ", "the", " ", "vector", " ", "rep", "\[IndentingNewLine]", 
          "into", " ", "crossed", " ", "diagonal", " ", "lines", " ", "of", 
          " ", "1", " ", "and"}], " ", "-", "1"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"soprod", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "soprod", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"SO", 
             RowBox[{"(", "even", ")"}]}], ":", " ", "Dn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"4", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Normal", "[", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "k"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"nt", "-", "1"}], ",", "nt"}], "}"}], "->", "1"}],
                    ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"nt", ",", "nt"}], "}"}], "->", "1"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nt", ",", "nt"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"SO", 
             RowBox[{"(", "odd", ")"}]}], ":", " ", "Bn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"2", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Normal", "[", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "k"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"nt", ",", "nt"}], "}"}], "->", "1"}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nt", ",", "nt"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"{", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", "nt", "}"}]}], "]"}], "}"}], ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "soprod", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Sp", 
             RowBox[{"(", "even", ")"}]}], ":", " ", "Cn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"-", " ", "soprod"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"3", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Normal", "[", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", "k"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"nt", ",", "nt"}], "}"}], "->", "2"}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"nt", ",", "nt"}], "}"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Sp", 
            RowBox[{"(", "odd", ")"}], " ", "does", " ", "not", " ", 
            "exist"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Now", " ", "the", " ", "subalgebra", " ", "matrices"}], ",", 
        " ", 
        RowBox[{"with", " ", "SO", 
         RowBox[{
          RowBox[{"(", "2", ")"}], "/", "D"}], 
         RowBox[{"(", "1", ")"}], " ", "as", " ", "a", " ", "U", 
         RowBox[{"(", "1", ")"}], " ", "factor"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sm", " ", "=", " ", 
          RowBox[{"sospords", "[", 
           RowBox[{"[", "kso", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"sm", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "sm", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"SO", 
                RowBox[{"(", "even", ")"}]}], ":", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dn", " ", "--"}], " ", "works", " ", "for", " ", 
                 "root"}], "-", 
                RowBox[{"vector", " ", "dimension", " ", "1"}]}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", "sm"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{"sma", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"4", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Normal", "[", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "=", " ", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                    ";", 
                    RowBox[{"Splice", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{"smt", "-", "2"}]}], "&&", 
                    RowBox[{"ks", "==", 
                    RowBox[{"smt", "-", "1"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "==", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "==", " ", 
                    RowBox[{"smt", "+", "1"}]}], " ", "&&", " ", 
                    RowBox[{"ks", " ", "==", " ", 
                    RowBox[{"smt", "-", "1"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], 
                    "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", "smt"}], "}"}]}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"SO", 
                RowBox[{"(", "odd", ")"}]}], ":", " ", "Bn"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", "sm"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sma", "-", "1"}], ")"}], "/", "2"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"2", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Normal", "[", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "=", " ", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                    ";", 
                    RowBox[{"Splice", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ks", "\[Equal]", 
                    RowBox[{"smt", "-", "1"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}], ",", "Nothing"}], 
                    "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "==", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ks", "\[Equal]", 
                    RowBox[{"smt", "-", "1"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}]}], ",", "Nothing"}], 
                    "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", "smt"}], "}"}]}], "]"}], "]"}]}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "sm", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"Sp", 
                RowBox[{"(", "even", ")"}]}], ":", " ", "Cn"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", 
               RowBox[{"-", "sm"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{"sma", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"3", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Normal", "[", 
                RowBox[{"SparseArray", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "=", " ", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                    ";", 
                    RowBox[{"Splice", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Splice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "==", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}], ",", "Nothing"}], "]"}],
                     ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", "==", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", "Nothing"}], "]"}]}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "0", ",", 
                    RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"n", ",", "smt"}], "}"}]}], "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Sp", 
               RowBox[{"(", "odd", ")"}], " ", "does", " ", "not", " ", 
               "exist"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "BadValue", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"vecproj", ".", "smat"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"stype", " ", "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Skip", " ", "over", " ", "SO", 
             RowBox[{"(", "1", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"stype", " ", "===", " ", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Treat", " ", "as", " ", "a", " ", "U", 
             RowBox[{"(", "1", ")"}], " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"u1s", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", 
              RowBox[{"First", "[", 
               RowBox[{"Transpose", "[", "smat", "]"}], "]"}]}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "All", " ", "the", " ", "others", " ", "are", " ", "\"\<real\>\"",
              " ", "algebras"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sla", " ", "=", " ", 
             RowBox[{"GetLieAlgebra", "[", "stype", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smat", " ", "=", " ", 
             RowBox[{"smat", ".", 
              RowBox[{"sla", "[", "\"\<InvCtn\>\"", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stsms", ",", 
              RowBox[{"{", 
               RowBox[{"stype", ",", "smat"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"kso", ",", "nso"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"subtypes", ",", "submatrts"}], "}"}], " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "stsms", "]"}], " ", ">", " ", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Transpose", "[", "stsms", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MakeBrancherSMRoots", "[", 
       RowBox[{"type", ",", "subtypes", ",", "submatrts", ",", "u1s"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.942350484856036*^9, 3.942350562552639*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"0da7dea1-4882-4392-95d7-116fd1685405"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Forms", " ", "of", " ", "the", " ", "previous", " ", "two", " ", "for", 
    " ", "A"}], ",", "B", ",", "C", ",", 
   RowBox[{"D", "-", 
    RowBox[{"style", " ", 
     RowBox[{"designation", "."}]}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[253]:=",ExpressionUUID->"339b01cd-7a0e-4456-8967-227eaada260e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"In", ":", " ", 
   RowBox[{
    RowBox[{"list", " ", "of", " ", "root"}], "-", 
    RowBox[{"vector", " ", "lengths"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[254]:=",ExpressionUUID->"ad955560-206e-489d-90ca-0a1f6b88528b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultAn", "[", "ords_", "]"}], " ", ":=", " ", 
  RowBox[{"SubalgMultSU", "[", 
   RowBox[{"ords", "+", "1"}], "]"}]}]], "Input",
 CellLabel->
  "In[255]:=",ExpressionUUID->"45e28b03-a87f-425b-b834-0f9eb83e2b69"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"In", ":", " ", 
    RowBox[{"list", " ", "of", " ", "algebra", " ", "types", " ", "as", " ", 
     RowBox[{"lists", ".", " ", "For"}], " ", "B", 
     RowBox[{"(", "n", ")"}]}]}], ",", 
   RowBox[{"C", 
    RowBox[{"(", "n", ")"}]}], ",", 
   RowBox[{
    RowBox[{"D", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"{", 
     RowBox[{"2", ",", "n"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "n"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "n"}], "}"}], ".", " ", "D"}], 
     RowBox[{"(", "1", ")"}], " ", "or", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1"}], "}"}], " ", "is", " ", "legitimate"}], " ", 
    "-", " ", 
    RowBox[{"it", " ", "becomes", " ", "a", " ", "U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{"factor", "."}]}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[256]:=",ExpressionUUID->"6821d560-b3df-4ba5-8efe-46f81b6e305c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultBCDn", "[", "stypes_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ords", ",", "k", ",", "stype", ",", "family", ",", "n"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ords", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "stype"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "family", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"2", "*", "n"}], "+", "1"}], ",", "\[IndentingNewLine]", 
           "3", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", "2"}], "*", "n"}], ",", "\[IndentingNewLine]", "4", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"2", "*", "n"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"stype", ",", "stypes"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SubalgMultSOSp", "[", "ords", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[257]:=",ExpressionUUID->"de6f432b-400c-4584-a55d-2bb460278132"]
}, Closed]],

Cell[CellGroupData[{

Cell["SO(even) split into two SO(odd)\[CloseCurlyQuote]s", "Subsection",ExpressionUUID->"1fef1a62-1bee-4e55-8de9-5c03fbd17437"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"This", " ", "function", " ", "does", " ", "even", " ", "SO"}], 
     " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"odd", " ", "SO", " ", "or", " ", "odd", " ", "SO"}], " ", "+", 
      " ", 
      RowBox[{"odd", " ", "SO"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"It", " ", "does", " ", "SO", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}]}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SO", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "m"}], "+", "1"}], ")"}]}], " ", "+", " ", 
        RowBox[{"SO", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "n"}], "-", 
           RowBox[{"2", "m"}], "-", "1"}], ")"}], " ", "or", " ", "D", 
         RowBox[{"(", "n", ")"}]}]}], " ", "\[Rule]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"B", 
          RowBox[{"(", "m", ")"}]}], " ", "+", " ", 
         RowBox[{"B", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "m", "-", "1"}], ")"}], ".", 
           "\[IndentingNewLine]", "The"}], " ", "main", " ", "root"}], "-", 
         RowBox[{"split", " ", "function", " ", "does", " ", "even"}]}], " ", 
        "\[Rule]", " ", 
        RowBox[{
         RowBox[{"even", " ", "+", " ", 
          RowBox[{"even", " ", "and", " ", "odd"}]}], " ", "\[Rule]", " ", 
         RowBox[{"odd", " ", "+", " ", 
          RowBox[{
           RowBox[{"even", ".", "\[IndentingNewLine]", "Use"}], " ", "the", 
           " ", "root", " ", "demoter", " ", "and", " ", "demote", " ", 
           "root", " ", "#1", " ", "to", " ", "turn", " ", "SO", 
           RowBox[{"(", "n", ")"}], " ", "into", " ", "SO", 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}], " ", "*", " ", "SO", 
           RowBox[{"(", "2", ")"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"the", " ", "U", 
              RowBox[{"(", "1", ")"}], " ", "factor"}], ")"}], ".", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "For"}], " ", 
           "m"}]}]}]}]}]}], " ", "=", " ", "0"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "it", " ", "will", " ", "make", " ", "only", " ", "one", " ", "odd", " ", 
     "SO"}], ";", " ", 
    RowBox[{
     RowBox[{"for", " ", "m"}], " ", "\[GreaterEqual]", " ", 
     RowBox[{"1", " ", "and", " ", "m"}], " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "2"}]}]}], ",", " ", 
   RowBox[{"it", " ", "will", " ", "make", " ", "two", " ", "odd", " ", 
    RowBox[{"SO", "'"}], 
    RowBox[{"s", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[258]:=",ExpressionUUID->"f029c5f6-a58b-45e2-9a45-0fffa302d16f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsoeo"}], " ", "=", " ", 
   "\"\<Invalid SO even-to-odd parameters: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[259]:=",ExpressionUUID->"984a0d28-2d39-4bee-9c20-1873556c6db4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSOEvenOdd", "[", 
   RowBox[{"n_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"stsms", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "smat", ",", "mx", ",", "i", ",", 
      "subtypes", ",", "submatrts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "<", " ", "0"}], " ", "||", " ", 
        RowBox[{"m", " ", ">", " ", 
         RowBox[{"n", "-", "2"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"m", ">", "1"}], ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"m", "-", "i", "+", "1"}], ",", "i"}], "}"}], "->",
                    "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "2", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"m", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "->", 
               RowBox[{"-", "1"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "k"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"stsms", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "k"}], "}"}], ",", "smat"}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"n", " ", "-", " ", "m", " ", "-", " ", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smat", " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"m", ">", "0"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"m", ",", "i"}], "}"}], "->", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "k"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"m", "+", "i"}], ",", "i"}], "}"}], "->", "1"}], ",", 
             
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"n", "-", "1"}], ",", "k"}], "}"}], "->", "1"}], ",", 
             
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "k"}], "}"}], "->", "1"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "k"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"stsms", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "k"}], "}"}], ",", "smat"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtypes", ",", "submatrts"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", "stsms", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "n"}], "}"}], ",", "subtypes", ",", "submatrts"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[260]:=",ExpressionUUID->"ad7f33bf-d5d6-454f-a195-0f0f6f1efe4e"]
}, Closed]],

Cell[CellGroupData[{

Cell["SU(n) to SO(n), Sp(n)", "Subsection",ExpressionUUID->"e9a23d0f-9af1-4728-a4dc-db6a2a5e560a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Reduces", " ", "SU", 
   RowBox[{
    RowBox[{"(", "n", ")"}], "/", " ", "A"}], 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], " ", "to", " ", "SO", 
   RowBox[{
    RowBox[{"(", "n", ")"}], ".", " ", "Even"}], " ", 
   RowBox[{"n", ":", " ", 
    RowBox[{"D", 
     RowBox[{"(", 
      RowBox[{"n", "/", "2"}], ")"}], " ", "and", " ", "odd", " ", 
     RowBox[{"n", ":", " ", 
      RowBox[{"B", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], ")"}]}]}]}]}]}], "  ", 
  "*)"}]], "Input",
 CellLabel->
  "In[261]:=",ExpressionUUID->"4b280d66-37f3-49c8-92cc-90f2e37021a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsuso"}], " ", "=", " ", 
   "\"\<Invalid SU to SO parameter: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[262]:=",ExpressionUUID->"a67fb2a0-c713-4d1c-8544-a073553aebc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSUSO", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nx", ",", "stype", ",", "smat", ",", "stsms", ",", "k"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsuso"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsuso"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "==", "2"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"MakeBrancherSMWeights", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nx", " ", "=", " ", 
         RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"stype", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"4", ",", "nx"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Splice", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "-", "k"}], ",", "k"}], "}"}], "->", "1"}]}],
                   "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"nx", "-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"nx", ",", 
                   RowBox[{"nx", "-", "1"}]}], "}"}], "->", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"nx", ",", "nx"}], "}"}], "->", "1"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "-", "1"}], ",", "nx"}], "}"}]}], "]"}], "]"}]}]}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Odd", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nx", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stype", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"2", ",", "nx"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Splice", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"n", "-", "k"}], ",", "k"}], "}"}], "->", "1"}]}],
                 "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "nx"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "-", "1"}], ",", "nx"}], "}"}]}], "]"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", "stype", "}"}], ",", 
       RowBox[{"{", "smat", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[263]:=",ExpressionUUID->"5658b021-4253-45cd-b487-703a6755b272"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Reduces", " ", "SU", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "n"}], ")"}], "/", " ", "A"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "to", " ", "Sp", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "n"}], ")"}], "/", " ", "C"}], 
   RowBox[{"(", "n", ")"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[264]:=",ExpressionUUID->"e18076c5-fe0c-4a28-8e78-0bb53a849f5b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsusp"}], " ", "=", " ", 
   "\"\<Invalid SU to Sp parameter: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[265]:=",ExpressionUUID->"d75d5ec6-69b9-4c45-a2ca-f1f05ea3ee71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSUSp", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"smat", ",", "stsms", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsusp"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsusp"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smat", " ", "=", " ", 
      RowBox[{"Normal", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Splice", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k", ",", "k"}], "}"}], "->", "1"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"2", "n"}], "-", "k"}], ",", "k"}], "}"}], "->", 
                 "1"}]}], "}"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n", ",", "n"}], "}"}], "->", "1"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "n"}], "-", "1"}], ",", "n"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"2", "n"}], "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"3", ",", "n"}], "}"}], "}"}], ",", 
       RowBox[{"{", "smat", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[266]:=",ExpressionUUID->"9f370f67-58fc-48d5-adde-71efebde4ac1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Height Subalgebras", "Subsection",ExpressionUUID->"bf7cdfd6-759c-4379-8a6a-5c159ed8e178"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "This", " ", "function", " ", "reduces", " ", "every", " ", "Lie", " ", 
    "algebra", " ", "to", " ", "SU", 
    RowBox[{
     RowBox[{"(", "2", ")"}], " ", "/", " ", "SO"}], 
    RowBox[{
     RowBox[{"(", "3", ")"}], " ", "/", " ", "Sp"}], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "2", ")"}], " ", "/", " ", "A1"}], " ", "/", " ", "B1"}], 
     " ", "/", " ", "C1"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "3", "D", " ", "angular"}], "-", 
    RowBox[{"momentum", " ", 
     RowBox[{"group", ".", " ", "The"}], " ", "\"\<height\>\"", " ", "in", 
     " ", "its", " ", "name", " ", "refers", " ", "to", " ", "the", " ", 
     "largest", " ", "of", " ", "the", " ", "height", " ", "weights", " ", 
     "of", " ", "the", " ", "subalgebra", " ", "equaling", " ", "the", " ", 
     RowBox[{"rep", "'"}], "s", " ", 
     RowBox[{"height", ".", "\[IndentingNewLine]", "Maximal"}], " ", "for", 
     " ", "B", 
     RowBox[{"(", "n", ")"}]}]}], ",", " ", 
   RowBox[{"C", 
    RowBox[{"(", "n", ")"}]}], ",", " ", "G2", ",", " ", "F4", ",", " ", "E7",
    ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"E8", ".", "\[IndentingNewLine]", "There"}], " ", "are", " ", 
     "some", " ", "solutions", " ", "for", " ", "some", " ", "subalgebra"}], 
    "-", 
    RowBox[{
    "matrix", " ", "values", " ", "different", " ", "from", " ", "1."}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[267]:=",ExpressionUUID->"a497e8fe-d02c-48ec-a15d-e4516f6e093a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgHeight", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"type", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[268]:=",ExpressionUUID->"090ca9ff-1271-4124-9ec9-fad59377cd15"]
}, Closed]],

Cell[CellGroupData[{

Cell["Vector-Representation Subalgebras", "Subsection",ExpressionUUID->"a58829b7-5bec-4c37-86e2-b07db9b6a8c7"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
  "This", " ", "function", " ", "reduces", " ", "a", " ", "member", " ", "of",
    " ", "the", " ", "four", " ", "infinite", " ", "families", " ", "to", " ",
    "another", " ", "algebra", " ", "by", " ", "taking", " ", "the", " ", 
   "source", " ", 
   RowBox[{"algebra", "'"}], "s", " ", "vector", " ", "rep", " ", 
   RowBox[{"(", 
    RowBox[{"SU", " ", "and", " ", "Sp", " ", "fundamental"}], ")"}], " ", 
   "to", " ", "the", " ", "destination", " ", 
   RowBox[{"algebra", "'"}], "s", " ", "supplied", " ", 
   RowBox[{"rep", "."}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[269]:=",ExpressionUUID->"066797e6-7617-4be1-b819-a85f8ee7cd33"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "baddrsize"}], " ", "=", " ", 
   "\"\<Invalid dest-rep size: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[270]:=",ExpressionUUID->"ae63799d-73a3-4c24-8c5f-8795feec6a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badfamily"}], "=", " ", 
   "\"\<Invalid source-alg family: ``\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.936615601703931*^9, 3.936615602693138*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"254123e6-2e38-4244-803e-d05dfd7be3f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badproj"}], "=", " ", 
   "\"\<Weight-space projection matrix is not all integer\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.936614578234189*^9, 3.936614597322317*^9}},
 CellLabel->
  "In[272]:=",ExpressionUUID->"1d83b47a-1a0f-43f2-b79b-16f6ca06416f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "baddiff"}], "=", " ", 
   "\"\<Target - projected source is not all zero\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.936614578234189*^9, 3.936614597322317*^9}, {
  3.936614790468472*^9, 3.936614816024424*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"a0238a88-0abc-44ef-a186-332a15b94f99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepWtsFlattened", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ent", " ", "|->", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"ent", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{"ent", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ")"}], " ", "/@", " ", 
     RowBox[{"GetRep", "[", 
      RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", "1"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.936613673656995*^9, 3.93661372520194*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"e6621061-e612-441f-8950-2d0b83f1e11a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgVector", "[", 
   RowBox[{"family_", ",", "dsttype_", ",", "dstwts_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ndst", ",", "n", ",", "srctype", ",", "vecwts", ",", "srcrep", ",", 
      "dstrep", ",", "srtp", ",", "prjmat", ",", "diffmat"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ndst", " ", "=", " ", 
      RowBox[{"TotalDegen", "[", 
       RowBox[{"dsttype", ",", "dstwts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"A", 
         RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"ndst", " ", "-", " ", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "<", "1"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"B", 
         RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "ndst", "]"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ndst", "-", "1"}], ")"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "<", "1"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"C", 
         RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "ndst", "]"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"ndst", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "<", "1"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"D", 
          RowBox[{
           RowBox[{"(", "n", ")"}], " ", "--"}], " ", "exclude", " ", "D", 
          RowBox[{"(", "1", ")"}]}], ",", " ", 
         RowBox[{"D", 
          RowBox[{"(", "2", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "ndst", "]"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"ndst", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "<", "3"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LASubAlgebra", "::", "baddrsize"}], ",", "ndst"}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badfamily"}], ",", "family"}], "]"}],
         ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vecwts", " ", "=", " ", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"n", "-", "1"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"srctype", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"srcrep", " ", "=", " ", 
      RowBox[{"RepWtsFlattened", "[", 
       RowBox[{"srctype", ",", "vecwts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dstrep", " ", "=", " ", 
      RowBox[{"RepWtsFlattened", "[", 
       RowBox[{"dsttype", ",", "dstwts"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"srtp", " ", "=", " ", 
      RowBox[{"Transpose", "[", "srcrep", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prjmat", " ", "=", " ", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{"srtp", ".", "srcrep"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"srtp", ".", "dstrep"}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", 
            RowBox[{"Flatten", "[", "prjmat", "]"}]}], ")"}]}], ")"}]}], ",", 
       " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LASubAlgebra", "::", "badproj"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"diffmat", " ", "=", " ", 
      RowBox[{
       RowBox[{"srcrep", ".", "prjmat"}], "-", "dstrep"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", " ", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "===", "0"}], ")"}], "&"}], " ", "/@", " ", 
            RowBox[{"Flatten", "[", "diffmat", "]"}]}], ")"}]}], ")"}]}], ",",
        " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LASubAlgebra", "::", "baddiff"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMWeights", "[", 
      RowBox[{"srctype", ",", 
       RowBox[{"{", "dsttype", "}"}], ",", 
       RowBox[{"{", "prjmat", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.936613499806019*^9, 3.936613541099202*^9}, {
  3.936613750322475*^9, 3.9366137956513643`*^9}, {3.9366138721896563`*^9, 
  3.936613905742724*^9}, {3.936613943411504*^9, 3.9366141439258623`*^9}, {
  3.9366145043382053`*^9, 3.93661452552862*^9}, {3.936614609450851*^9, 
  3.9366146587017603`*^9}, {3.936614724448645*^9, 3.936614778241214*^9}, {
  3.936614899932473*^9, 3.936614913735635*^9}, {3.9366231685059977`*^9, 
  3.936623202285215*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"158ddd97-dc73-494b-bc3f-453aa51e56bb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extra Branching-Rule Generators", "Subsection",ExpressionUUID->"4fa7fb88-463f-4e8a-a0c4-ad655acd70c6"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Some", " ", "extra", " ", "ones", " ", "named", " ", 
     RowBox[{
     "individually", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      "Mentioned"}], " ", "by", " ", "John", " ", "Baez", " ", "in", " ", 
     "\"\<The Octonions\>\""}], ":", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"B3G2", " ", "--"}], " ", 
     RowBox[{"B3", "/", "SO"}], 
     RowBox[{"(", "7", ")"}], " ", "to", " ", 
     RowBox[{"G2", " ", "--"}], " ", "G2", " ", "is", " ", "the", " ", 
     "isomorphism", " ", "group", " ", "of", " ", "the", " ", "octonions"}]}],
    ",", " ", 
   RowBox[{
   "and", " ", "one", " ", "gets", " ", "a", " ", "construction", " ", "of", 
    " ", "G2", " ", "from", " ", "it", " ", 
    RowBox[{"that", "'"}], "s", " ", "manifestly", " ", "a", " ", "subgroup", 
    " ", "of", " ", "SO", 
    RowBox[{
     RowBox[{"(", "7", ")"}], " ", "--"}], " ", "14", " ", "7", "D", " ", 
    "antisymmetric", " ", "real", " ", 
    RowBox[{"matrices", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"D4G2", " ", "--"}]}], " ", 
    RowBox[{"D4", "/", "SO"}], 
    RowBox[{"(", "8", ")"}], " ", "to", " ", 
    RowBox[{"G2", " ", "--"}], " ", "unlike", " ", "the", " ", "others"}], 
   ",", " ", 
   RowBox[{
   "not", " ", "maximal", "\[IndentingNewLine]", "\[IndentingNewLine]", "The",
     " ", "others", " ", "are", " ", "mentioned", " ", "by", " ", "Slansky"}],
    ",", " ", 
   RowBox[{"Table", " ", "15"}], ",", " ", 
   RowBox[{
    RowBox[{"p", ".", " ", "180"}], " ", 
    RowBox[{"(", "Exceptional", ")"}]}], ",", " ", 
   RowBox[{"Table", " ", "14"}], ",", " ", 
   RowBox[{
    RowBox[{"p", ".", " ", "177"}], " ", 
    RowBox[{"(", "Classical", ")"}]}], ",", " ", 
   RowBox[{"Table", " ", "58"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", ".", " ", "238"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Branching", " ", "Rules"}], ")"}], ".", " ", "Also"}], " ", 
     "in", " ", "Weyl"}], "-", 
    RowBox[{"Orbit", " ", "Branching", " ", "Rules", " ", "for", " ", "An"}], 
    "-", 
    RowBox[{"Larouche", " ", "Nesterenko", " ", "Patera"}], " ", "-", " ", 
    RowBox[{"arxiv", " ", "0909.2337", "v1", " ", "and", " ", "Weyl"}], "-", 
    RowBox[{
    "Orbit", " ", "Branching", " ", "Rules", " ", "for", " ", "Bn", " ", "Cn",
      " ", "Dn"}], "-", 
    RowBox[{"Larouche", " ", "Patera"}], " ", "-", " ", 
    RowBox[{
    "arxiv", " ", "1101.6043", "v1", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "None", " ", "of", " ", "these", " ", 
     "branchings", " ", "have", " ", "U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{"factors", "."}]}]}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellLabel->
  "In[276]:=",ExpressionUUID->"ae979baa-29ac-4e16-a603-a3ce9ddb224c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badextra"}], " ", "=", " ", 
   "\"\<Invalid extra algebra-to-subalgebra branching ``\>\""}], 
  ";"}]], "Input",
 CellLabel->
  "In[277]:=",ExpressionUUID->"55f3220a-0bb6-4f4b-904a-a6f308bcf570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgExtra", "[", "saname_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "type", ",", "subtypes", ",", "submatrts"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"SubalgExtraData", "[", "saname", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "data", "]"}], " ", "\[Equal]", " ", 
        "SubalgExtraData"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badextra"}], ",", "saname"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"subtypes", ",", "submatrts"}], "}"}], " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"data", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submatrts"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[278]:=",ExpressionUUID->"0c88a93b-cfee-4e3f-8c07-2cbee9f10b9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgExtraNames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<G2A1\>\"", ",", " ", "\"\<B3G2\>\"", ",", " ", "\"\<D4A2\>\"", ",", 
     " ", "\"\<D4G2\>\"", ",", " ", "\"\<F4A1\>\"", ",", " ", 
     "\"\<F4A1G2\>\"", ",", " ", "\"\<E6A2\>\"", ",", " ", "\"\<E6G2\>\"", 
     ",", " ", "\"\<E6C4\>\"", ",", " ", "\"\<E6F4\>\"", ",", " ", 
     "\"\<E6A2G2\>\"", ",", " ", "\"\<E7A1-1\>\"", ",", "\"\<E7A1-2\>\"", ",",
      " ", "\"\<E7A2\>\"", ",", "\"\<E7A1A1\>\"", ",", "\"\<E7A1G2\>\"", ",", 
     " ", "\"\<E7A1F4\>\"", ",", "\"\<E7G2C3\>\"", ",", "\"\<E8A1-1\>\"", 
     ",", "\"\<E8A1-2\>\"", ",", "\"\<E8A1-3\>\"", ",", "\"\<E8A1A2\>\"", 
     ",", "\"\<E8B2\>\"", ",", "\"\<E8G2F4\>\""}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[279]:=",ExpressionUUID->"94fde1d2-969a-4662-9f52-f158eb9a1e53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<G2A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[280]:=",ExpressionUUID->"98cb7e39-c79d-44fd-a04e-5fea102ecf97"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<B3G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input",
 CellLabel->
  "In[281]:=",ExpressionUUID->"d824d05d-b5e5-46aa-ada0-149a3a11b972"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<D4A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input",
 CellLabel->
  "In[282]:=",ExpressionUUID->"d8d85e3f-9729-4adb-b930-9645e287d41f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<D4G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input",
 CellLabel->
  "In[283]:=",ExpressionUUID->"c09dec9c-18c3-4f44-a5c9-f8f965e4bca1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<F4A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[284]:=",ExpressionUUID->"f4ba78b0-e0d0-4e7d-b0ce-a5d960825dea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<F4A1G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[285]:=",ExpressionUUID->"e62a4def-6f2a-4663-a73d-6183778abc58"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[286]:=",ExpressionUUID->"f1d79e6b-4a6f-4325-85d8-c103905e88b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[287]:=",ExpressionUUID->"f1bf46ca-9ba7-454c-a398-ac4e4739adf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6C4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
       "}"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[288]:=",ExpressionUUID->"9117032d-d232-486b-930e-e75e99d213b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
       "}"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[289]:=",ExpressionUUID->"2e93ba70-c822-4313-b6da-a9d34aa44987"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6A2G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[290]:=",ExpressionUUID->"ce65e250-000e-41a4-85c1-5acb41a83256"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1-1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[291]:=",ExpressionUUID->"d6d41433-9a21-4623-a76e-4e44f34cb2f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1-2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[292]:=",ExpressionUUID->"d67bd52e-1801-4717-87e6-08a4d4c91d5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[293]:=",ExpressionUUID->"8a9995d3-5bda-4e6d-b5bb-536d88f2eb15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "2"}], "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[294]:=",ExpressionUUID->"37fb40ca-4f22-486c-894d-bf056ad210eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[295]:=",ExpressionUUID->"8c38de81-7957-466f-8f63-c3871af07cca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "3"}], ",", 
             RowBox[{"-", "4"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[296]:=",ExpressionUUID->"7b789337-ec63-4e86-9955-02a6d6355f86"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7G2C3\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[297]:=",ExpressionUUID->"2b5c9655-f030-4457-a2cf-d3770d68d107"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[298]:=",ExpressionUUID->"0da553e0-c923-4c96-a1ab-15b6be72d76b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[299]:=",ExpressionUUID->"2e27ea3f-b5c0-424f-8762-397ff92c9df4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-3\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[300]:=",ExpressionUUID->"1d134ce0-0e26-4529-8d40-f9622a93d159"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[301]:=",ExpressionUUID->"9446acdf-3f36-48d2-8dd8-3b5399435734"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8B2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[302]:=",ExpressionUUID->"14d881ae-dd52-4a2e-a097-3d438548ac1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8G2F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[303]:=",ExpressionUUID->"e481dc4e-bf5e-4ae1-999d-01e835a3a882"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Classical", " ", 
     RowBox[{"ones", ":", " ", "B3"}]}], " ", "\[Rule]", " ", "G2"}], ",", 
   " ", 
   RowBox[{"D4", " ", "\[Rule]", " ", "A2"}], ",", " ", 
   RowBox[{"D4", " ", "\[Rule]", " ", 
    RowBox[{"G2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"non", "-", "maximal"}], ";", " ", 
       RowBox[{
        RowBox[{"is", " ", "D4"}], " ", "\[Rule]", " ", 
        RowBox[{"B3", " ", "\[Rule]", " ", "G2"}]}]}], ")"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
   "From", " ", "what", " ", "Slansky", " ", "and", " ", "Dynkin", " ", 
    "give"}], ",", " ", 
   RowBox[{
    RowBox[{"all", " ", "the", " ", "maximal", " ", "simple"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
    "nonsimple", " ", "subalgebra", " ", "decompositions", " ", "are", " ", 
     "accounted", " ", "for", " ", "in", " ", "my", " ", "code"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "all", " ", "the", " ", "maximal", " ", 
      "exceptional"}], "-", 
     RowBox[{"algebra", " ", 
      RowBox[{"subalgebras", ".", " ", "What"}], " ", "remains", " ", "is", 
      " ", "maximal", " ", "classical"}]}], " ", "\[Rule]", " ", 
    RowBox[{"simple", " ", "any"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "my", " ", "code", " ", "contains", " ", "some", " ", 
     "families", " ", "of", " ", 
     RowBox[{"that", ".", " ", "Dynkin"}], " ", "and", " ", "Slansky", " ", 
     RowBox[{"(", 
      RowBox[{"p", ".88"}], ")"}], " ", "have", " ", "some", " ", "helpful", 
     " ", "theorems", " ", "about", " ", "that", " ", 
     RowBox[{
     "case", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "**"}], "*", 
     " ", "At", " ", "least", " ", "one", " ", "simple", " ", "irrep"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
     RowBox[{"one", " ", "term", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"need", " ", "not", " ", "be", " ", "simple"}], ")"}], ".", 
       " ", "True"}], " ", "of", " ", "classical"}], " ", "\[Rule]", " ", 
     "any"}]}], ",", " ", 
   RowBox[{
    RowBox[{"not", " ", "necessarily", " ", "of", " ", "exceptional"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
     RowBox[{
     "any", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Simple"}], 
     " ", 
     RowBox[{"irreps", ":", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", "and", " ", 
     RowBox[{"conjg", ".", " ", "vector"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "n"}], "+", "1"}], ")"}]}]}], ",", " ", 
   RowBox[{"both", " ", "complex"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dim", ".", " ", "2"}], "n"}], "+", "1"}], ")"}]}]}], ",", 
   " ", "real", ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"spinor", " ", 
    RowBox[{"(", 
     RowBox[{"dim", ".", " ", 
      RowBox[{"2", "^", "n"}]}], ")"}]}], ",", " ", 
   RowBox[{"real", " ", "for", " ", "4", "k"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "3"}], ",", " ", 
   RowBox[{
    RowBox[{"pseudoreal", " ", "for", " ", "4", "k"}], "+", "1"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "2"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "2"}], "n"}], ")"}]}]}], ",", " ", 
   "pseudoreal", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "2"}], "n"}], ")"}]}]}], ",", " ", "real", 
   ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"the", " ", "two", " ", "spinors", " ", 
    RowBox[{"(", 
     RowBox[{"dim", ".", " ", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}], ",", " ", 
   RowBox[{"real", " ", "for", " ", "4", "k"}], ",", " ", 
   RowBox[{
    RowBox[{"pseudoreal", " ", "for", " ", "4", "k"}], "+", "2"}], ",", " ", 
   RowBox[{
    RowBox[{"complex", " ", "for", " ", "4", "k"}], "+", "1"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "3"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", 
     RowBox[{"(", "2", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "7"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", 
     RowBox[{"(", "4", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "26"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "6", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", "and", " ", 
      RowBox[{"conjg", ".", " ", 
       RowBox[{"(", 
        RowBox[{"dim", " ", "27"}], ")"}]}]}], ":", " ", "complex"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "7", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fumdamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "56"}], ")"}]}], ":", " ", "pseudoreal"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "8", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "248"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"**", 
     RowBox[{"*", " ", "Adjoint", " ", "of", " ", "algebra"}]}], " ", 
    "\[Rule]", " ", 
    RowBox[{"adjoint", " ", "of", " ", 
     RowBox[{"subalgebra", ".", " ", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"conjg", " ", "vector"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"adjoint", " ", "+", " ", "scalar"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"C", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "symmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"G", 
      RowBox[{"(", "2", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", 
      RowBox[{"(", "4", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "6", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"conjg", " ", "fund"}]}]}], " ", "\[Rule]", " ", "adjoint"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "7", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "symmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "8", ")"}]}], ":", " ", "fund"}], " ", "=", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quadratic", "-", 
     RowBox[{"form", " ", 
      RowBox[{"constraint", ":", " ", 
       RowBox[{
       "must", " ", "carry", " ", "over", " ", "into", " ", 
        "subalgebra"}]}]}]}], ";", " ", 
    RowBox[{
    "each", " ", "form", " ", "symmetry", " ", "yields", " ", "a", " ", 
     RowBox[{"constraint", ":", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symmetric", ":", " ", "Real"}], " ", "\[Rule]", " ", "real"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Antisymmetric", ":", " ", "Pseudoreal"}], " ", "\[Rule]", " ", 
    "pseudoreal"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"None", ":", " ", "Complex"}], " ", "\[Rule]", " ", "complex"}], 
   ",", " ", "real", ",", " ", "pseudoreal", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
   "Every", " ", "rep", " ", "*", " ", "its", " ", "conjugate", " ", "rep", 
    " ", "contains", " ", "the", " ", "adjoint", " ", 
    RowBox[{"rep", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "In"}], 
    " ", "Table", " ", "5", " ", "of", " ", "his", " ", "ref"}], ",", " ", 
   RowBox[{"Dynkin", " ", "lists", " ", "several", " ", "cases"}], ",", " ", 
   RowBox[{
    RowBox[{"which", " ", 
     RowBox[{"include", ":", " ", "An"}]}], " ", "\[Rule]", " ", 
    RowBox[{"A", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"symmetric", " ", "2"}], "-", "tensor"}], ")"}], " ", "and", 
     " ", "A", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"antisymmetric", " ", "2"}], "-", "tensor"}], ")"}]}]}], ",", 
   " ", "An", ",", "Cn", ",", 
   RowBox[{"Dn", " ", "\[Rule]", " ", 
    RowBox[{"Bn", 
     RowBox[{"(", "spinor", ")"}]}]}], ",", " ", 
   RowBox[{"Dn", 
    RowBox[{"(", "spinor", ")"}]}], ",", " ", "...", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"An", " ", "\[Rule]", " ", 
    RowBox[{"any", " ", "spinor"}]}], ",", " ", 
   RowBox[{"Cn", " ", "\[Rule]", " ", 
    RowBox[{"pseudoreal", " ", "spinor"}]}], ",", " ", 
   RowBox[{"Dn", " ", "\[Rule]", " ", 
    RowBox[{"real", " ", "spinor"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynkin", " ", 
    RowBox[{"reference", ":", " ", 
     RowBox[{
     "\"\<The maximal subgroups of the classical groups\>\"", " ", "in", " ", 
      "\"\<Selected Papers of E.B. Dynkin\>\""}]}]}]}], "\[IndentingNewLine]",
   " ", "*)"}]], "Input",
 CellLabel->
  "In[304]:=",ExpressionUUID->"36050feb-f82b-416b-b064-b396c3c6c023"]
}, Closed]],

Cell[CellGroupData[{

Cell["Concatenator, relabelers, and rearrangers", "Subsection",ExpressionUUID->"9ff9de12-e275-4622-984f-a1bd760c4a27"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Concatenates", " ", "branchers", " ", "from", " ", "a", " ", "list", " ", 
   "onto", " ", "a", " ", "parent", " ", "brancher"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[305]:=",ExpressionUUID->"a1a0abc0-3279-4c35-bc99-aeb1e32dfae7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "typemm"}], " ", "=", " ", 
   "\"\<Type mismatch: `1` and `2` at `3`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[306]:=",ExpressionUUID->"b632ae6f-fef1-4c32-9760-7f2e06adee8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badindex"}], " ", "=", " ", 
   "\"\<Invalid index: ``\>\""}], ";"}]], "Input",
 CellLabel->
  "In[307]:=",ExpressionUUID->"e935bfe3-9b6f-4fe8-9a32-121b3b74b096"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "outrange"}], " ", "=", " ", 
   "\"\<Index `1` is out of range for length `2`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[308]:=",ExpressionUUID->"a8600ff4-82e0-43f2-98a9-41008cae72e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConcatMultiBranchers", "[", 
   RowBox[{"brancher_", ",", "sbbrlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "na", ",", "i",
       ",", "sbassoc", ",", "sbbr", ",", "subtype", ",", "submat", ",", 
      RowBox[{"newsubtypes", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"newsubmats", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"newu1s", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"na", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"newu1s", " ", "=", " ", "u1s"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sbassoc", " ", "=", " ", 
      RowBox[{"<|", "sbbrlist", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"subtype", " ", "=", " ", 
         RowBox[{"subtypes", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"submat", " ", "=", " ", 
         RowBox[{"submats", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"sbassoc", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sbbr", " ", "=", " ", 
            RowBox[{"sbassoc", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"sbbr", "[", "\"\<Type\>\"", "]"}], "=!=", "subtype"}], 
             ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"LASubAlgebra", "::", "typemm"}], " ", ",", 
                RowBox[{"sbbr", "[", "\"\<Type\>\"", "]"}], ",", "subtype", 
                ",", "i"}], "]"}], ";", " ", 
              RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newsubtypes", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"newsubtypes", ",", 
              RowBox[{"sbbr", "[", "\"\<Subtypes\>\"", "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newsubmats", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"newsubmats", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"submat", ".", "#"}], "&"}], " ", "/@", " ", 
               RowBox[{"sbbr", "[", "\"\<SubmatRoots\>\"", "]"}]}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"newu1s", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"newu1s", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"submat", ".", "#"}], "&"}], " ", "/@", " ", 
               RowBox[{"sbbr", "[", "\"\<U1s\>\"", "]"}]}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"newsubtypes", ",", "subtype"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"newsubmats", ",", "submat"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "na"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "newsubtypes", ",", "newsubmats", ",", "newu1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[309]:=",ExpressionUUID->"23f9a6ce-73cb-4847-90ff-92794e4702d9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConcatBranchers", "[", 
   RowBox[{"brancher_", ",", "ix_", ",", "sbbr_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ConcatMultiBranchers", "[", 
   RowBox[{"brancher", ",", 
    RowBox[{"{", 
     RowBox[{"ix", "->", "sbbr"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[310]:=",ExpressionUUID->"e98f44b7-c926-446c-9b97-e95f83c94dec"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Renames", " ", "A1"}], ",", "B1", ",", 
   RowBox[{
   "C1", " ", "at", " ", "ix", " ", "to", " ", "any", " ", "of", " ", 
    "these"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[311]:=",ExpressionUUID->"66fe5287-6619-45d4-871a-858a3a4bf924"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badtypeix"}], " ", "=", " ", 
   "\"\<Invalid type `1` at index `2`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[312]:=",ExpressionUUID->"2724221a-1c1f-448d-b428-c324b2e0b32e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badfamily"}], " ", "=", " ", 
   "\"\<Invalid family: `1`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[313]:=",ExpressionUUID->"3d622b06-4fd5-4f7b-841b-4df41fbb3e52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameABC1", "[", 
   RowBox[{"brancher_", ",", "ix_", ",", "newfam_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "newfam"}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badfamily"}], ",", "newfam"}], "]"}],
         ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subtypes", "[", 
       RowBox[{"[", 
        RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "=", " ", "newfam"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[314]:=",ExpressionUUID->"d42e64e0-f07d-4a76-8ec5-8737baf265bc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flips", " ", "B2"}], "-", 
   RowBox[{"C2", " ", "at", " ", "ix"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[315]:=",ExpressionUUID->"a4d93875-c3ee-4286-b93e-5db6ebc5771a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameBC2", "[", 
   RowBox[{"brancher_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "submat"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subtypes", "[", 
       RowBox[{"[", 
        RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"5", " ", "-", " ", 
       RowBox[{"subtypes", "[", 
        RowBox[{"[", 
         RowBox[{"ix", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"submat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "submat"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[316]:=",ExpressionUUID->"5f7cff2c-9c13-41ec-ab9d-9ac82ea81db5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Flips", " ", "A3"}], "-", 
   RowBox[{"D3", " ", "at", " ", "ix"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[317]:=",ExpressionUUID->"951a930e-b574-4baa-b39d-b026647d1b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameAD3", "[", 
   RowBox[{"brancher_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "submat"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "3"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subtypes", "[", 
       RowBox[{"[", 
        RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{"5", " ", "-", " ", 
       RowBox[{"subtypes", "[", 
        RowBox[{"[", 
         RowBox[{"ix", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"submat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "submat"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[318]:=",ExpressionUUID->"0fdde769-6829-456d-9e6e-7a74b428a6a6"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Splits", " ", "the", " ", "D2", " ", "at", " ", "ix", " ", "to", " ", "A1",
    "*", "A1"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[319]:=",ExpressionUUID->"081f1287-8da8-4d64-94a6-d4bb254c1748"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherSplitD2", "[", 
   RowBox[{"brancher_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "subtype", ",", "submat"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "4"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"subtype", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "==", " ", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Splice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "subtype"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "==", " ", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Splice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"submat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "1"}], "]"}], "]"}], "}"}], "]"}], ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"submat", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "2"}], "]"}], "]"}], "}"}], "]"}]}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", "submat"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[320]:=",ExpressionUUID->"5806273f-f47a-4de8-ad82-04fca3c4282e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Joins", " ", "the", " ", 
   RowBox[{"A1", "'"}], "s", " ", "at", " ", "ix1", " ", "and", " ", "ix2", 
   " ", "to", " ", "D2"}], "  ", "*)"}]], "Input",
 CellLabel->
  "In[321]:=",ExpressionUUID->"57a087cf-a11a-4d42-b9b5-016e3a9f24bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "ixmatch"}], " ", "=", " ", 
   "\"\<Input indices ought not to match\>\""}], ";"}]], "Input",
 CellLabel->
  "In[322]:=",ExpressionUUID->"bd2d0b15-9f27-4912-b91b-5723660040d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherJoin2A1", "[", 
   RowBox[{"brancher_", ",", "ix1_", ",", "ix2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "submat", ",", " ", "subtype", ",", "sbmt1", ",", 
      "sbmt2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix1"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix2"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ix1", " ", "\[Equal]", " ", "ix2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LASubAlgebra", "::", "ixmatch"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix1", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix1", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix1", ",", "ns"}],
          "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix2", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix2", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix2", ",", "ns"}],
          "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix1", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix1", "]"}], "]"}], ",", "ix1"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix2", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix2", "]"}], "]"}], ",", "ix2"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"subtype", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", " ", "==", " ", "ix1"}], " ", "||", " ", 
            RowBox[{"i", " ", "==", " ", "ix2"}]}], ",", 
           "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
           "subtype"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"subtypes", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "2"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"i", "==", "ix1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sbmt1", " ", "=", " ", "submat"}], ";", 
            "\[IndentingNewLine]", "Nothing"}], ",", "\[IndentingNewLine]", 
           RowBox[{"i", " ", "==", " ", "ix2"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sbmt2", " ", "=", " ", "submat"}], ";", 
            "\[IndentingNewLine]", "Nothing"}], ",", "\[IndentingNewLine]", 
           "True", ",", "\[IndentingNewLine]", "submat"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"submats", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "sbmt1", "]"}], ",", 
          RowBox[{"Transpose", "[", "sbmt2", "]"}]}], "]"}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[323]:=",ExpressionUUID->"1feffed0-a06a-48d6-9576-eb3d91d3672e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Does", " ", "conjugation", " ", "of", " ", "every", " ", "subalgebra", " ",
    "rep", " ", "in", " ", "ld0", " ", "with", " ", "index", " ", "in", " ", 
   "cjixs"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[324]:=",ExpressionUUID->"be49d4d3-25c6-48b8-a412-3fc5ef8837ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherConjugate", "[", 
   RowBox[{"brancher_", ",", "cjixs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "ns", ",", "i",
       ",", "submat", ",", "ixs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"cjixs", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ixs", " ", "=", " ", 
             RowBox[{"MakeConjgIndices", "[", 
              RowBox[{"subtypes", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"submat", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "ixs"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "submat"}], "\[IndentingNewLine]", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[325]:=",ExpressionUUID->"fe7e9100-9030-44c9-9df0-d23f7135279d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Finds", " ", "general", " ", "conjugate", " ", "of", " ", "D", 
    RowBox[{"(", "4", ")"}], " ", "in", " ", "ld0"}], ",", " ", 
   RowBox[{"making", " ", 
    RowBox[{"ld", ".", " ", "newrts"}], " ", "is", " ", "a", " ", "list", " ",
     "of", " ", "what", " ", "original", " ", "roots", " ", "become", " ", 
    "new", " ", 
    RowBox[{"roots", ".", " ", "Done"}], " ", "because", " ", "one", " ", 
    "can", " ", "interchange", " ", "all", " ", "three", " ", "of", " ", 
    "the", " ", "outer", " ", 
    RowBox[{"roots", "."}]}]}], "  ", "*)"}]], "Input",
 CellLabel->
  "In[326]:=",ExpressionUUID->"cb535d18-784e-43c3-9fd9-25dfc9bd1af0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badixloc"}], " ", "=", " ", 
   "\"\<Invalid index: `1` at `2` should be at `3`\>\""}], ";"}]], "Input",
 CellLabel->
  "In[327]:=",ExpressionUUID->"432ab1cf-b458-4cba-91aa-2c43f6765508"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherConjugateD4", "[", 
   RowBox[{"brancher_", ",", "ix_", ",", "perm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "submat", ",", "ixs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], " ", "\[NotEqual]", " ", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ixs", " ", "=", " ", 
      RowBox[{"MakeConjgIndicesD4", "[", "perm", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ixs", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"submat", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "==", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"submat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "ixs"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "submat"}], "\[IndentingNewLine]", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[328]:=",ExpressionUUID->"6fc4fc18-8661-4129-b385-fd155daed6e9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Rearranges", " ", "the", " ", "subalgebras"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[329]:=",ExpressionUUID->"3cabbe10-9e96-4502-83da-5c2a5df7e0ee"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRearrange", "[", 
   RowBox[{"brancher_", ",", "neword_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "ns"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", "neword", "]"}], " ", "=!=", " ", 
        RowBox[{"Range", "[", "ns", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepIndices", "::", "badrearr"}], ",", "neword", ",", 
          RowBox[{"Range", "[", "ns", "]"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", 
       RowBox[{"subtypes", "[", 
        RowBox[{"[", "neword", "]"}], "]"}], ",", 
       RowBox[{"submats", "[", 
        RowBox[{"[", "neword", "]"}], "]"}], ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[330]:=",ExpressionUUID->"16b60ad4-6251-44f0-8708-cced9dc523b5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Rearranges", " ", "the", " ", "U", 
   RowBox[{"(", "1", ")"}], " ", "factors"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[331]:=",ExpressionUUID->"25200332-7b5f-4f6c-bd3b-330847814e4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "nou1"}], " ", "=", " ", 
   "\"\<Empty U(1) factor\>\""}], ";"}]], "Input",
 CellLabel->
  "In[332]:=",ExpressionUUID->"9bde51de-6249-4941-8be5-3cf55719495d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badu1mat"}], " ", "=", " ", 
   "\"\<Bad dimensions: `1` should have second dimension `2`\>\""}], 
  ";"}]], "Input",
 CellLabel->
  "In[333]:=",ExpressionUUID->"50a8b0d2-4bac-425b-84f9-74a83001dd33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRearrangeU1s", "[", 
   RowBox[{"brancher_", ",", "u1mat_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "nu", ",", 
      "umdim"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nu", " ", "=", " ", 
      RowBox[{"Length", "[", "u1s", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nu", " ", "==", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LARepIndices", "::", "nou1"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"umdim", " ", "=", " ", 
      RowBox[{"Dimensions", "[", "u1mat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "umdim", "]"}], "!=", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepIndices", "::", "badu1mat"}], ",", "umdim", ",", 
          "nu"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"umdim", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "!=", "nu"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepIndices", "::", "badu1mat"}], ",", "umdim", ",", 
          "nu"}], "]"}], ";", 
        RowBox[{"Return", "[", "BadValue", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancherSMRoots", "[", 
      RowBox[{"type", ",", "subtypes", ",", "submats", ",", 
       RowBox[{"u1mat", ".", "u1s"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[334]:=",ExpressionUUID->"c73b28f3-d92c-43f4-9da3-053ae552cc68"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Branch", " ", "to", " ", "self"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[335]:=",ExpressionUUID->"f1f6f886-3249-4c2e-99e8-43f92e7b8394"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSelf", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"MakeBrancherSMRoots", "[", 
   RowBox[{"type", ",", 
    RowBox[{"{", "type", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"IdentityMatrix", "[", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[336]:=",ExpressionUUID->"3f87d900-205e-4cd8-94f5-5ca3d07abba1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphs of Roots of Representations", "Section",ExpressionUUID->"38c5edb0-f22d-4b8a-b939-13401b0d21f2"],

Cell[CellGroupData[{

Cell["Root / Weight List Diagram", "Subsection",ExpressionUUID->"4d01af77-182f-4a36-906c-9914e3ab7f43"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Made", " ", "general"}], ",", " ", 
   RowBox[{
   "so", " ", "one", " ", "can", " ", "also", " ", "use", " ", "Weyl", " ", 
    "orbits"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[337]:=",ExpressionUUID->"0c22de8f-e887-4716-8e7b-4fa1642b64a1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Sort", " ", "by", " ", "total", " ", "root", " ", "value"}], ",", 
   " ", 
   RowBox[{"sort", " ", "rows", " ", "by", " ", "roots"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[338]:=",ExpressionUUID->"ebf861f5-ce58-427b-b570-0a59dd274bf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RWDiagram", "[", 
   RowBox[{"repdata_", ",", "dispf_", ",", "sep_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortf", ",", "rpdsrt", ",", "rwsrtf", ",", "rpdrows"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"sortf", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"-", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rpdsrt", " ", "=", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{"SortBy", "[", 
        RowBox[{"repdata", ",", "sortf"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rwsrtf", "[", "x_", "]"}], " ", ":=", " ", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpdrows", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"SortBy", "[", 
         RowBox[{"#", ",", "rwsrtf"}], "]"}], "&"}], "/@", " ", 
       RowBox[{"GatherBy", "[", 
        RowBox[{"rpdsrt", ",", "sortf"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"#", ",", "sep"}], "]"}], "&"}], " ", "/@", "  ", 
        RowBox[{"Map", "[", 
         RowBox[{"dispf", ",", "rpdrows", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "Center"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[339]:=",ExpressionUUID->"d363d95a-da64-48cc-bb58-45abe64c42c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bxdstrlst", "[", "x_", "]"}], " ", ":=", " ", 
  RowBox[{"Framed", "[", 
   RowBox[{
    RowBox[{"StringRiffle", "[", 
     RowBox[{
      RowBox[{"ToString", " ", "/@", " ", "x"}], ",", "\"\< \>\""}], "]"}], 
    ",", 
    RowBox[{"FrameStyle", "->", "Gray"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[340]:=",ExpressionUUID->"22f86a06-625e-427a-b31f-2fb1f6c0bd94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BoxRtsDiagram", "[", "repdata_", "]"}], " ", ":=", " ", 
  RowBox[{"RWDiagram", "[", 
   RowBox[{"repdata", ",", 
    RowBox[{
     RowBox[{"bxdstrlst", "[", 
      RowBox[{"#", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "]"}], "&"}], ",", "\"\<   \>\""}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[341]:=",ExpressionUUID->"b56caf6d-54f3-4bcc-9b34-c6378e668d33"]
}, Closed]],

Cell[CellGroupData[{

Cell["Root Positions", "Subsection",ExpressionUUID->"61e6778d-9426-4d0a-95d7-772a171e8902"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "These", " ", "are", " ", "selected", " ", "so", " ", "as", " ", "to", " ", 
   "be", " ", "as", " ", "symmetric", " ", "as", " ", "possible"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[342]:=",ExpressionUUID->"a604f8c8-27b9-4474-ad41-b4b9756af7ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmRootMatrix", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n", ",", "smplx", ",", "smc"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
       RowBox[{"(*", " ", "An", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Make", " ", "a", " ", "simplex"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"smplx", " ", "=", " ", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "->", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], "->", 
                RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"smc", " ", "=", " ", 
                   RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"2", "i", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "smc"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
                    RowBox[{"i", "*", "smc"}]}]}], "}"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], "}"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"smplx", ",", "1"}], "]"}], " ", "-", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{"smplx", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", "2", 
       ",", " ", 
       RowBox[{"(*", " ", "Bn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}], "->", "1"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{"(*", " ", "Cn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}], "->", "2"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "4", ",", " ", 
       RowBox[{"(*", " ", "Dn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Normal", "[", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}], "->", "1"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}], "->", "1"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", " ", 
       RowBox[{"(*", " ", "En", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", "0", ",", "0",
              ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", 
              RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "i"}], "}"}], "->", 
                  RowBox[{"1", "/", "2"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "7"}], "}"}], "->", 
                RowBox[{"1", "/", 
                 RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], "->", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "2"}], "}"}], "->", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"7", ",", "1"}], "}"}], "->", "1"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"7", ",", "2"}], "}"}], "->", 
                RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"7", ",", "7"}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Even", " ", "canonical", " ", "one", " ", "here"}], ";", 
           " ", 
           RowBox[{"could", " ", "also", " ", "use", " ", "odd"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "i"}], "}"}], "->", 
                  RowBox[{"1", "/", "2"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], "->", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", "2"}], "}"}], "->", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"8", ",", "1"}], "}"}], "->", "1"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"8", ",", "2"}], "}"}], "->", 
                RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"8", ",", "8"}], "}"}]}], "]"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       " ", 
       RowBox[{"(*", " ", "Fn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}], 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       " ", 
       RowBox[{"(*", " ", "Gn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[343]:=",ExpressionUUID->"0a37642f-bd68-4e10-a51f-0dbc9a4b1534"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Made", " ", "general"}], ",", " ", 
   RowBox[{
   "so", " ", "one", " ", "can", " ", "also", " ", "use", " ", "Weyl", " ", 
    "orbits"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[344]:=",ExpressionUUID->"23ce16ea-d711-4fde-b673-015b9db28f44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmRootPositions", "[", 
   RowBox[{"type_", ",", "repdata_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tmat", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmat", " ", "=", " ", 
      RowBox[{"SymmRootMatrix", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], ".", "tmat"}], ")"}], "&"}], " ",
       "/@", " ", "repdata"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[345]:=",ExpressionUUID->"b4646f41-24ea-4e6d-bd68-1d60ebeaffa0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Get", " ", "projected", " ", "point", " ", "positions"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[346]:=",ExpressionUUID->"46338d8c-308a-4500-9057-d19cef7e1f66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphRootPoints", "[", 
   RowBox[{"type_", ",", "repdata_", ",", "proj_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "tmat", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tmat", " ", "=", " ", 
      RowBox[{
       RowBox[{"SymmRootMatrix", "[", "type", "]"}], ".", "proj"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Point", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], ".", "tmat"}], "]"}], "&"}], " ",
       "/@", " ", "repdata"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[347]:=",ExpressionUUID->"7ff8742d-782a-4da2-beb7-2087b1e2e21d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphRepRootPoints", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "proj_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GraphRootPoints", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "proj"}], "]"}]}]], "Input",\

 CellLabel->
  "In[348]:=",ExpressionUUID->"b6f47789-f8c2-4444-ae91-ffac31191e83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphRepRootPoints2D", "[", 
   RowBox[{"family_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GraphRepRootPoints", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "2"}], "}"}], ",", "maxwts", ",", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[349]:=",ExpressionUUID->"5e3451ad-8e9a-4de3-be1f-13687e59cf23"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Break", " ", "down", " ", "by", " ", "Weyl", " ", "orbits"}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[350]:=",ExpressionUUID->"f5dcd693-fe22-4c46-bdf0-1a9cc4aa6305"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphRepOrbitRootPoints", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "proj_", ",", "orbstyle_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"orbits", ",", "ix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orbits", " ", "=", " ", 
      RowBox[{"GetRepOrbits", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ix", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"GraphRootPoints", "[", 
          RowBox[{"type", ",", 
           RowBox[{"GetOrbit", "[", 
            RowBox[{"type", ",", 
             RowBox[{"Last", "[", "orb", "]"}]}], "]"}], ",", "proj"}], "]"}],
          ",", 
         RowBox[{"orbstyle", "[", 
          RowBox[{
           RowBox[{"ix", "++"}], ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", "orb"}], "}"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"orb", ",", "orbits"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[351]:=",ExpressionUUID->"7e55b874-dc95-4f09-ae88-37cbf907f787"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphRepOrbitRootPoints2D", "[", 
   RowBox[{"family_", ",", "maxwts_", ",", "orbstyle_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"GraphRepOrbitRootPoints", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "2"}], "}"}], ",", "maxwts", ",", 
    RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", "orbstyle"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[352]:=",ExpressionUUID->"e3365157-dbea-49ca-a3fd-54eb42471e6a"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Extras", "Section",ExpressionUUID->"8e26b579-42e9-4abc-8457-afb8130ab87b"],

Cell[CellGroupData[{

Cell["Graphs of Dynkin diagrams", "Subsection",ExpressionUUID->"be2fadc7-d923-4a18-ba47-eb45723d728e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphDynkDiag", "[", "dynkdiag_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "wts", ",", "conns", ",", "n", ",", "wtmean", ",", "vtsty", ",", "conn", 
      ",", "i", ",", "j", ",", "w", ",", "gredlbls"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wts", ",", "conns"}], "}"}], " ", "=", " ", "dynkdiag"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "wts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wtmean", " ", "=", " ", 
      RowBox[{"Mean", "[", "wts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vtsty", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"k", "->", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"wts", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "<", "wtmean"}], ",", "Black", 
           ",", "White"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gredlbls", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", "j", ",", "w"}], "}"}], " ", "=", " ", "conn"}], 
         ";", 
         RowBox[{
          RowBox[{"UndirectedEdge", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "->", 
          RowBox[{"w", "/", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"wts", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"wts", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}]}], " ", ",", 
        RowBox[{"{", 
         RowBox[{"conn", ",", "conns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graph", "[", 
      RowBox[{
       RowBox[{"Range", "[", "n", "]"}], ",", 
       RowBox[{"First", " ", "/@", " ", "gredlbls"}], ",", 
       RowBox[{"EdgeLabels", "->", 
        RowBox[{"Select", "[", 
         RowBox[{"gredlbls", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       ",", 
       RowBox[{"VertexLabels", "->", "\"\<Name\>\""}], ",", 
       RowBox[{"VertexStyle", "->", "vtsty"}], ",", 
       RowBox[{"GraphLayout", "->", "\"\<SpringElectricalEmbedding\>\""}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[353]:=",ExpressionUUID->"22a472fe-004b-46bf-83b1-06165ffb63cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Canonical Root Vectors", "Subsection",ExpressionUUID->"91b5e1c3-4890-4bc3-887c-626a8e063d09"],

Cell["\<\
Conversion of rep-root values into more convenient vector forms for some \
applications. How many:
An: 1: canonical, 2: simplex projection
Bn: 1: canonical
Cn: 1: canonical
Dn: 1: canonical
E6: 1: From even E8, 2: from odd E8, 3: contracted 1 or 2, 4: from SU(3)^3, \
5: contracted 3
E7: 1: from even E8, 2: from odd E8, 3: contracted
E8: 1: even, 2: odd
F4: 1: canonical
G2: 1: canonical, 2: contracted\
\>", "Text",ExpressionUUID->"f3419617-d081-419e-906b-6c4518442d18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumCanonRootVectors", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", " ", "2", ",", 
       "\[IndentingNewLine]", "2", ",", " ", "1", ",", "\[IndentingNewLine]", 
       "3", ",", " ", "1", ",", "\[IndentingNewLine]", "4", ",", " ", "1", 
       ",", "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", " ", "5", ",", 
         "\[IndentingNewLine]", "7", ",", " ", "3", ",", 
         "\[IndentingNewLine]", "8", ",", " ", "2", ",", 
         "\[IndentingNewLine]", "_", ",", "BadValue"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", " ", "1", ",", 
         "\[IndentingNewLine]", "_", ",", " ", "BadValue"}], "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", " ", "2", ",", 
         "\[IndentingNewLine]", "_", ",", " ", "BadValue"}], "]"}], ",", 
       "\[IndentingNewLine]", "_", ",", " ", "BadValue"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[354]:=",ExpressionUUID->"ca693b36-6757-41a8-862b-334678f3e16e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CanonicalRootVectors", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "smplx", ",", "smc", ",", "i", ",", 
      "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
       RowBox[{"(*", " ", "An", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Join", " ", "@@", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Simplex", " ", "projection"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"smplx", " ", "=", " ", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], "->", 
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}], "->", 
                  RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"smc", " ", "=", " ", 
                    RowBox[{"1", "/", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"2", "i", 
                    RowBox[{"(", 
                    RowBox[{"i", "+", "1"}], ")"}]}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "smc"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "i"}], "}"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "i"}], "}"}], "->", 
                    RowBox[{"i", "*", "smc"}]}]}], "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}]}], 
                "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"n", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"smplx", ",", "1"}], "]"}], " ", "-", " ", 
           RowBox[{"Drop", "[", 
            RowBox[{"smplx", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", "_",
          ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "2", ",", " ", 
       RowBox[{"(*", " ", "Bn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", "n"}], "}"}], "->", "1"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{"(*", " ", "Cn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", "n"}], "}"}], "->", "2"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "4", ",", " ", 
       RowBox[{"(*", " ", "Dn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Normal", "[", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}], "->", "1"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"n", ",", "n"}], "}"}], "->", "1"}]}], "}"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", "5", ",", " ", 
       RowBox[{"(*", " ", "En", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"From", " ", "E8", " ", "even"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", "5"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"6", ",", "1"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"6", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"From", " ", "E8", " ", "odd"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"6", ",", "i"}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<=", "3"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Contracted", " ", "1", " ", "or", " ", "2"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "5"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "6"}], "}"}], "->", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", "5"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"6", ",", "1"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"6", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"From", " ", "SU", 
             RowBox[{
              RowBox[{"(", "3", ")"}], "^", "3"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
               ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
               ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "3"}], ")"}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}], ",", "2", ",", "2", ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}], ",", "2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0", 
               ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
                ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "\[IndentingNewLine]",
             "}"}], ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Contracted", " ", "4"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", "0", ",", 
               "0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{
                RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
               RowBox[{
                RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"0", " ", "is", " ", "even", " ", "E8"}], "-", 
            "derived"}], ",", " ", 
           RowBox[{
            RowBox[{"1", " ", "is", " ", "odd", " ", "E8"}], "-", "derived"}],
            ",", " ", 
           RowBox[{"2", " ", "is", " ", "contracted"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"From", " ", "even", " ", "E8"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"7", ",", "1"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"7", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"From", " ", "odd", " ", "E8"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"7", ",", "i"}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<=", "3"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Contracted", " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "7"}], "}"}], "->", 
                  RowBox[{"1", "/", 
                   RowBox[{"Sqrt", "[", "2", "]"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "1"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"2", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"7", ",", "1"}], "}"}], "->", "1"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"7", ",", "2"}], "}"}], "->", 
                  RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"7", ",", "7"}], "}"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "8", "}"}], ",", 
             RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "vers", ",", "\[IndentingNewLine]", "1", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "Even", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Normal", "[", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "i"}], "}"}], "->", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}], "->", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"2", ",", "2"}], "}"}], "->", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"8", ",", "1"}], "}"}], "->", "1"}], ",", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"8", ",", "2"}], "}"}], "->", 
                   RowBox[{"-", "1"}]}]}], "}"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"8", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", "Odd", " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"Normal", "[", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], "->", "1"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "}"}], "->", 
                    RowBox[{"-", "1"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "i"}], "}"}], "->", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "*", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<=", "3"}], ",", 
                    RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"8", ",", "8"}], "}"}]}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]",
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", " ", 
       RowBox[{"(*", " ", "F4", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "/", "2"}], ")"}]}], 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "}"}], 
           ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", " ", 
       RowBox[{"(*", " ", "G2", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]",
            " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Contracted", " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "BadValue", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[355]:=",ExpressionUUID->"fd836170-ace4-4977-b283-3a8a2e2489bf"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Finds", " ", "extended", " ", "versions", " ", "that", " ", "are", " ", 
   "invertible"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[356]:=",ExpressionUUID->"b6a7336f-bab3-4ed3-b3d9-292139ddaf74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtendedCanonicalRootVectors", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cvc", ",", "family", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cvc", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
                  ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "0", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cvc", ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
                ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cvc", ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
                ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cvc", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "cvc"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[357]:=",ExpressionUUID->"d30ce26b-4b2a-40ca-b3de-ba29c8797a7e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lie-Algebra Roots Found Directly", "Subsection",ExpressionUUID->"343cd271-6fdd-4ff9-9760-4a033effdc1b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Formulas", " ", "only", " ", "for", " ", "the", " ", "four", " ", 
   "infinite", " ", "families"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[358]:=",ExpressionUUID->"4f386e66-6f3a-47fe-94fe-0351e7afbfcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"valrepeats", "[", 
    RowBox[{"val_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"val", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[359]:=",ExpressionUUID->"a04460cb-441a-4338-82c7-4add62c778fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositiveRootsBase", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zeros", ",", "ones", ",", "k", ",", "iwd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zeros", " ", "=", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ones", " ", "=", " ", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"zeros", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"ones", "[", 
              RowBox[{"[", 
               RowBox[{"iwd", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"zeros", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "iwd", "-", "k", "+", "2"}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "\[Equal]", 
              RowBox[{"n", "-", "iwd", "+", "1"}]}], ",", "iwd", ",", "0"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"iwd", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"n", "-", "iwd", "+", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[360]:=",ExpressionUUID->"dec9fdb4-ae85-4604-9c64-2c3aa5fdd0fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositiveRootsExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "family", ",", "n", ",", "rtx", ",", "rt", ",", "wd", ",", "twos", ",", 
      "m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"twos", " ", "=", " ", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";", 
            " ", "rt"}], ",", 
           RowBox[{"{", 
            RowBox[{"rtx", ",", 
             RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}], 
         ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "rt", "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}],
            ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], 
       ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m", "-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ";;"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "rt", "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}],
            ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], 
       ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "2"}]}], "]"}], "]"}], ",", "#"}], 
                    "]"}], "&"}], " ", "/@", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m", "-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "2"}]}], "}"}]}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "2"}]}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}]}], "]"}]}],
              ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", 
                RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "_", ",", 
       "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[361]:=",ExpressionUUID->"8d8a9232-302e-4240-9cea-34558b3f4daf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metrics Found Directly", "Subsection",ExpressionUUID->"4cf77788-d94b-4e4f-b94e-5447cc5ce014"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MetricExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", 
               "1", ",", 
               RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "+", "#2"}], "\[GreaterEqual]", 
                RowBox[{"2", "n"}]}], ",", "1", ",", "2"}], "]"}]}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">", "1"}], ",", "1", ",", 
            RowBox[{"1", "/", "2"}]}], "]"}], "*", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Switch", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", 
                "1", ",", 
                RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "+", "#2"}], "\[GreaterEqual]", 
                 RowBox[{
                  RowBox[{"2", "n"}], "-", "1"}]}], ",", "2", ",", "1"}], 
               "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "0", ",", "1"}], "]"}]}], ",", "2", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "1", ",", "0"}], "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "2"}], "}"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"-", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "4", ",", 
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "2"}], ",", "2", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", 
             RowBox[{"-", "3"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[362]:=",ExpressionUUID->"0bd5c038-8d1f-400a-a38b-4ea10047c3ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseMetricExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"n", "+", "1"}], ")"}]}], "*", " ", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"#1", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#2"}], ")"}]}], ",", 
               RowBox[{"#2", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#1"}], ")"}]}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"n", ">", "1"}], ",", "1", ",", "2"}], "]"}], "*", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "==", "n"}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", "==", "n"}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", ">=", 
                RowBox[{"n", "-", "1"}]}], "&&", 
               RowBox[{"#2", ">=", 
                RowBox[{"n", "-", "1"}]}]}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "4"}], ")"}], 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", "==", "#2"}], ",", "n", ",", 
                 RowBox[{"n", "-", "2"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"#1", ",", "#2"}], "]"}], "*", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", ">=", 
                  RowBox[{"n", "-", "1"}]}], ",", 
                 RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", ">=", 
                  RowBox[{"n", "-", "1"}]}], ",", 
                 RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}]}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"4", ",", "5", ",", "6", ",", "4", ",", "2", ",", "3"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "5", ",", "10", ",", "12", ",", "8", ",", "4", ",", "6"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{
             "6", ",", "12", ",", "18", ",", "12", ",", "6", ",", "9"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "4", ",", "8", ",", "12", ",", "10", ",", "5", ",", "6"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "6", ",", "9", ",", "6", ",", "3", ",", "6"}], 
             "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "4", ",", "6", ",", "8", ",", "6", ",", "4", ",", "2", ",", 
              "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "6", ",", "12", ",", "16", ",", "12", ",", "8", ",", "4", ",", 
              "8"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "8", ",", "16", ",", "24", ",", "18", ",", "12", ",", "6", ",", 
              "12"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "6", ",", "12", ",", "18", ",", "15", ",", "10", ",", "5", ",", 
              "9"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "4", ",", "8", ",", "12", ",", "10", ",", "8", ",", "4", ",", 
              "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3", ",", 
              "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "4", ",", "8", ",", "12", ",", "9", ",", "6", ",", "3", ",", 
              "7"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "4", ",", "7", ",", "10", ",", "8", ",", "6", ",", "4", ",", "2", 
             ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "7", ",", "14", ",", "20", ",", "16", ",", "12", ",", "8", ",", 
             "4", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "10", ",", "20", ",", "30", ",", "24", ",", "18", ",", "12", ",", 
             "6", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "8", ",", "16", ",", "24", ",", "20", ",", "15", ",", "10", ",", 
             "5", ",", "12"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "6", ",", "12", ",", "18", ",", "15", ",", "12", ",", "8", ",", 
             "4", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "10", ",", "8", ",", "6", ",", "3",
              ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", 
             ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "5", ",", "10", ",", "15", ",", "12", ",", "9", ",", "6", ",", 
             "3", ",", "8"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_",
          ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "6", ",", "8", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "8", ",", "12", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4", ",", "6", ",", "4"}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "3"}], ")"}], "*", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "6"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[363]:=",ExpressionUUID->"1e2b6326-d25f-482a-97a7-4077239b1f8e"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"invctn", ".", "metric", ".", 
    RowBox[{"Transpose", "[", "invctn", "]"}]}], " ", "where", " ", "invctn", 
   " ", "is", " ", "the", " ", "inverse", " ", "of", " ", "the", " ", 
   "Cartan", " ", "matrix"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[364]:=",ExpressionUUID->"29e27c78-46ae-4171-a87e-8b6989267cd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DyadVecSqr", "[", "v_", "]"}], " ", ":=", " ", 
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", "v", ",", "v"}], "]"}]}]], "Input",
 CellLabel->
  "In[365]:=",ExpressionUUID->"a5cdf590-5fcc-471c-b2eb-6a67d3a84fa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WSMVec", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
       " ", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"ConstantArray", "[", 
          RowBox[{"2", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}], ",", "1"}], "]"}], ",", 
       "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", ">", "1"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}], ",", "2"}], "]"}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "4", 
       ",", " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "5", ",", 
       " ", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", "n"}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       " ", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", "7", ",", " ", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[366]:=",ExpressionUUID->"a7a02248-9d9c-49ec-9469-94beb4f12920"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightSpaceMetricExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"DyadVecSqr", "[", 
    RowBox[{"WSMVec", "[", "type", "]"}], "]"}], "*", 
   RowBox[{"InverseMetricExplicit", "[", "type", "]"}]}]}]], "Input",
 CellLabel->
  "In[367]:=",ExpressionUUID->"33d8e148-9f11-42d4-97a0-f2380be387b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseWeightSpaceMetricExplicit", "[", "type_", "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{"DyadVecSqr", "[", 
    RowBox[{"1", "/", 
     RowBox[{"WSMVec", "[", "type", "]"}]}], "]"}], "*", 
   RowBox[{"MetricExplicit", "[", "type", "]"}]}]}]], "Input",
 CellLabel->
  "In[368]:=",ExpressionUUID->"cb58f0eb-15b4-41fe-aaf0-55041d8e6e1f"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cartan Matrices Found Directly", "Subsection",ExpressionUUID->"c8df0747-c76d-4dab-9b61-a700a4594f5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CartanMatrixExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", "\[Equal]", "n"}], ",", "2", ",", "1"}], 
                "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", "\[Equal]", "n"}], ",", "2", ",", "1"}], 
                "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "0", ",", "1"}], "]"}]}], ",", "2", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "1", ",", "0"}], "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "2"}], "}"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "3"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[369]:=",ExpressionUUID->"a27209c5-cb5e-4e49-88f4-0cf058203245"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseCartanMatrixExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"n", "+", "1"}], ")"}]}], "*", " ", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"#1", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#2"}], ")"}]}], ",", 
               RowBox[{"#2", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#1"}], ")"}]}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", "\[Equal]", "n"}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"Min", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "\[Equal]", "n"}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"Min", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", ">=", 
                RowBox[{"n", "-", "1"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "\[GreaterEqual]", 
                RowBox[{"n", "-", "1"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "\[GreaterEqual]", 
                   RowBox[{"n", "-", "1"}]}], "&&", 
                  RowBox[{"#2", "\[GreaterEqual]", 
                   RowBox[{"n", "-", "1"}]}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#1", "\[Equal]", "#2"}], ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}], ")"}]}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2", ",", 
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"2", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"10", "/", "3"}], ",", "4", ",", 
             RowBox[{"8", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "4", ",", "2", ",", "3"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"8", "/", "3"}], ",", "4", ",", 
             RowBox[{"10", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2", ",", 
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "2", ",", "1", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "2", ",", "3", ",", "4", ",", "3", ",", "2", ",", "1", ",", "2"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "3", ",", "6", ",", "8", ",", "6", ",", "4", ",", "2", ",", "4"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "9", ",", "6", ",", "3", ",", 
             "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6", ",", "9", ",", 
             RowBox[{"15", "/", "2"}], ",", "5", ",", 
             RowBox[{"5", "/", "2"}], ",", 
             RowBox[{"9", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "2", ",", "3"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", 
             RowBox[{"5", "/", "2"}], ",", "2", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", 
             RowBox[{"9", "/", "2"}], ",", "3", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"7", "/", "2"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "4", ",", "7", ",", "10", ",", "8", ",", "6", ",", "4", ",", "2", 
             ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "7", ",", "14", ",", "20", ",", "16", ",", "12", ",", "8", ",", 
             "4", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "10", ",", "20", ",", "30", ",", "24", ",", "18", ",", "12", ",", 
             "6", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "8", ",", "16", ",", "24", ",", "20", ",", "15", ",", "10", ",", 
             "5", ",", "12"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "6", ",", "12", ",", "18", ",", "15", ",", "12", ",", "8", ",", 
             "4", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "10", ",", "8", ",", "6", ",", "3",
              ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", 
             ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "5", ",", "10", ",", "15", ",", "12", ",", "9", ",", "6", ",", 
             "3", ",", "8"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_",
          ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6", ",", "8", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[370]:=",ExpressionUUID->"e6bdcb9d-0277-4705-a46b-76902c113f8a"],

Cell["\<\
Relation to representation heights

(highest root) = (highest weight).(inverse Cartan matrix)
(rep height) = 2 * ( (highest weight).(row sums for inverse Cartan matrix) ) \
\
\>", "Text",ExpressionUUID->"660c61e6-1d9a-40e6-b464-deb42fcc63a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Total Degeneracies / Dimensions Found Explicitly", "Subsection",ExpressionUUID->"9390a1fb-98de-47ee-83df-b37ac0bb8966"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"from", " ", 
    RowBox[{"Wybourne", "'"}], "s", " ", "Classical", " ", "Groups", " ", 
    "for", " ", "Physicists", " ", "with", " ", "some", " ", 
    RowBox[{"fixing", ".", " ", "For"}], " ", "An"}], ",", " ", "Bn", ",", 
   " ", "Cn", ",", " ", "Dn", ",", " ", 
   RowBox[{
    RowBox[{
    "essentially", " ", "the", " ", "formulas", " ", "for", " ", "the", " ", 
     "Weyl"}], "-", 
    RowBox[{"orbit", " ", 
     RowBox[{"forms", "."}]}]}]}], "  ", "*)"}]], "Input",
 CellLabel->
  "In[371]:=",ExpressionUUID->"216044b9-a644-4a06-95ea-9b24527d8c50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TDRootExpand", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"maxwts", ",", "0"}], "]"}], "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "maxwts", "]"}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "maxwts", "]"}], "/", "2"}]}], "]"}], "]"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", "maxwts", "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "maxwts", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"maxwts", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "-", 
               RowBox[{"maxwts", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
           "]"}], "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Most", "[", "maxwts", "]"}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"Range", "[", "5", "]"}], ".", 
                   RowBox[{"Most", "[", "maxwts", "]"}]}]}], "/", "6"}]}], 
               "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3", ",", "2", ",", "1", ",", "2"}], 
             "}"}], ".", "maxwts"}]}], "]"}], ",", "\[IndentingNewLine]", "7",
          ",", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Most", "[", "maxwts", "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", 
                   RowBox[{
                    RowBox[{"-", "3"}], "/", "4"}], ",", 
                   RowBox[{"1", "/", "4"}]}], "}"}], ".", "maxwts"}]}], "]"}],
               "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{
               RowBox[{"-", "9"}], "/", "4"}], ",", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "4"}], ",", 
              RowBox[{
               RowBox[{"-", "7"}], "/", "4"}]}], "}"}], ".", "maxwts"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Reverse", "[", 
                 RowBox[{"Most", "[", "maxwts", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], "/", "3"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "3"}], ",", "0", ",", "0", ",", 
                   "0", ",", "0", ",", "0", ",", 
                   RowBox[{"1", "/", "3"}]}], "}"}], ".", "maxwts"}]}], "]"}],
               "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "5"}], "/", "3"}], ",", 
              RowBox[{
               RowBox[{"-", "10"}], "/", "3"}], ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"-", "8"}], "/", "3"}]}], "}"}], ".", "maxwts"}]}], 
          "]"}]}], " ", "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"3", "/", "2"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "}"}], ".", 
          "maxwts"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", "maxwts"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[372]:=",ExpressionUUID->"b7c71e1f-c6d4-442b-a298-75e0d13d2e4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenExplicit", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_", ":", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "rt0", ",", "rt1", ",", "i1", ",", 
      "i2", ",", "i3", ",", "i4", ",", "s1", ",", "s2", ",", "s3", ",", 
      "sgnset", ",", "sgns", ",", "mwx"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckRepMaxWts", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rt0", " ", "=", " ", 
      RowBox[{"TDRootExpand", "[", 
       RowBox[{"type", ",", 
        RowBox[{
         RowBox[{"0", "*", "maxwts"}], "+", "1"}], ",", "mwcheck"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rt1", " ", "=", " ", 
      RowBox[{"TDRootExpand", "[", 
       RowBox[{"type", ",", 
        RowBox[{"maxwts", "+", "1"}], ",", "mwcheck"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "-", 
            RowBox[{"rt1", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt0", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "-", 
            RowBox[{"rt0", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", 
           RowBox[{"i1", "+", "1"}], ",", 
           RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rt1", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], "/", 
           RowBox[{"rt0", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rt1", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], "/", 
           RowBox[{"rt0", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "+", 
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "+", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", 
           RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt1", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "/", 
            RowBox[{"rt0", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"rt1", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], "/", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"rt0", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], "/", "2"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i4", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i4", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "-", "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i4", ",", 
              RowBox[{"i3", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sgnset", " ", "=", " ", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "/", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "-", 
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "-", 
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "+", 
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "+", 
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", 
               RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "*", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"sgns", ".", "rt1"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"sgns", ".", "rt0"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"sgns", ",", "sgnset"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "/", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[373]:=",ExpressionUUID->"134f4c62-8155-4968-8f53-80aec1451133"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Explicit", " ", "expressions", " ", "for", " ", "F4"}], ",", " ", 
   "E6", ",", " ", "E7", ",", " ", 
   RowBox[{"and", " ", "E8", " ", "are", " ", "very", " ", "bulky"}], ",", 
   " ", 
   RowBox[{"and", " ", "are", " ", "thus", " ", "omitted"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[374]:=",ExpressionUUID->"9d1a9e70-15c2-4fe5-9f00-4c8b01f9bb27"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Groups", "Subsection",ExpressionUUID->"c819683d-4ed6-49ce-ad93-42fd316b039c"],

Cell["\<\
Weyl groups for Lie algebras:

A (n) -- S (n+1) : symmetric group; S (n) is permutation of n symbols
B (n), C (n) -- 2^n * S (n), the wreathed product of permutations S (n) and \
+-1 group Z (2)^n
D (n) -- half of the above group -- Z (2)^(n-1) instead of Z (2)^n, or Z \
(2)^n with the product equal to 1.

Here, the Weyl-group generators are transformed into forms that make their \
group-member features clearer: permutation matrix for An, permutation matrix \
* signs for B(n), C(n), D(n)

Weyl-group generators; complete Weyl group is much larger. Identity + \
generator for each positive root\
\>", "Text",ExpressionUUID->"0672b63e-54ac-45b4-a11e-07c664cdf020"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupGenerators", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "metric", ",", " ", "posroots", ",", 
      " ", "id"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"id", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"id", " ", "-", " ", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "#", "}"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{"#", ".", "metric"}], "}"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"#", ".", "metric", ".", "#"}], ")"}]}]}]}], " ", ")"}],
          "&"}], " ", "/@", " ", "posroots"}], ",", " ", "id"}], "]"}]}]}], 
   "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[375]:=",ExpressionUUID->"897330e0-122e-4549-92a3-082ef448caa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupCanonGens", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "cvc", ",", "family", ",", "n", ",", "dimc", ",", "nc", ",", 
      "metric", ",", " ", "posroots", ",", " ", "id"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cvc", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nc", ",", "dimc"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "cvc", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<posroots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"id", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "dimc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assumes", " ", "an", " ", "identity", " ", "metric", " ", "for", " ", 
       "the", " ", "canonical", " ", "root", " ", "vectors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"id", " ", "-", " ", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "#", "}"}], "]"}], ".", 
              RowBox[{"{", "#", "}"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"#", ".", "#"}], ")"}]}]}]}], " ", ")"}], "&"}], " ", "/@",
         " ", 
        RowBox[{"(", 
         RowBox[{"posroots", ".", "cvc"}], ")"}]}], ",", " ", "id"}], 
      "]"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[376]:=",ExpressionUUID->"c358a9f0-a7ac-41f3-b95c-2e792fe40e1d"],

Cell["\<\
For A(n), simple roots k: 1 to n interchange symbols k, k+1 out of n+1
All the positive roots permute two symbols: root (k)+root (k+1)+...+root (l) \
permutes symbols k and l+1\
\>", "Text",ExpressionUUID->"f09fa140-cd92-4ab7-ab5b-7ea4fe2f0319"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"1", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Add", " ", "extra", " ", "1", " ", "at", " ", "the", " ", "end", " ", 
       "to", " ", "make", " ", "it", " ", "fit", " ", "with", " ", 
       "permutation", " ", "matrices"}], " ", "*)"}], 
     RowBox[{"perms", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "#", "]"}], ",", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", " ", 
               RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", "n", "}"}]}], "]"}], ",", " ", "1"}], "]"}]}], 
         "]"}], " ", "&"}], " ", "/@", " ", "perms"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", " ", "+", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", " ", "+", " ", "1"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ptmat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", 
           RowBox[{"n", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=", " ", 
        "1"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", " ", "<=", " ", "i"}], ",", " ", "1", ",", " ", "0"}],
           "]"}], " ", "-", " ", 
         RowBox[{"i", "/", 
          RowBox[{"(", 
           RowBox[{"n", " ", "+", " ", "1"}], ")"}]}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"n", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
        " ", "=", " ", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"n", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[377]:=",ExpressionUUID->"946f2ff5-23b3-40c8-80fa-0b267b27b034"],

Cell["\<\
For C(n) ei - ej : (+1) * permute of two, ei + ej: (-1) * permute of two, \
2*ei: diagonal with one element -1\
\>", "Text",ExpressionUUID->"ea64c051-b2ce-4a37-bfb3-e102e3614ce0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"3", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "2"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{
      RowBox[{"pminv", "[", 
       RowBox[{"[", "n", "]"}], "]"}], " ", "*=", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[378]:=",ExpressionUUID->"785ad652-f985-431a-b80e-c7533e190629"],

Cell["\<\
For B(n) ei - ej : (+1) * permute of two, ei + ej: (-1) * permute of two, ei: \
diagonal with one element -1 \
\>", "Text",ExpressionUUID->"142b6648-b17c-4cfd-8c0e-2c6d5c3658b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"2", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[379]:=",ExpressionUUID->"5095e615-48d9-4108-bb5d-447fd71624ae"],

Cell["\<\
For D(n) ei - ej : (+1) * permute of two, ei + ej: (-1) * permute of two\
\>", "Text",ExpressionUUID->"bbe91836-fd86-41a1-954b-b021ed5505d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"4", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "n"}], "]"}], "]"}], 
      " ", "=", " ", "1"}], ";", " ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "-=", " ", 
        RowBox[{"1", "/", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "n"}], "}"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[380]:=",ExpressionUUID->"610a9176-ecc8-43af-a21e-57d2011272f9"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"The", " ", "exceptional", " ", "groups"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[381]:=",ExpressionUUID->"7a06e26b-cc8f-418b-acef-1b2f92515230"],

Cell["For G2: the group is the dihedral group D (6), order 12 ", "Text",ExpressionUUID->"991026a8-e1f1-43a8-9dd0-26391abc3e39"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"7", ",", "2"}], "]"}], " ", ":=", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", " ", "ptmat", ",", " ", "pminv"}], "}"}], ",", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"7", ",", "2"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"ptmat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", 
           RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", " ", "1"}], "}"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "3", "]"}]}], ",", " ", "0"}], "}"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[382]:=",ExpressionUUID->"2e6a3f07-a9e6-4b29-8932-a9448be88737"],

Cell["\<\
For F4: the group is the 4D 24-cell rotation group -- the SO(9) group with \
all matrices of +- 1/2 with determinant +- 1, order 1152 \
\>", "Text",ExpressionUUID->"5b8906a6-6715-41b9-a2bb-d6faca076c1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"6", ",", "4"}], "]"}], " ", ":=", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", " ", "ptmat", ",", " ", "pminv"}], "}"}], ",", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"ptmat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1", ",", " ", "0", ",", " ", "2"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1", ",", " ", "1", ",", " ", "3"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "2"}], "}"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input",
 CellLabel->
  "In[383]:=",ExpressionUUID->"cc91309a-c010-4cea-b81f-0c09691967bf"],

Cell["\<\
For E6, E7, E8: orders 51840, 2903040, 696729600
E6: automorphism groups of simple group PSU (4,2), PSW (6-,2), PSp (4,3), PSW \
(5,3), order 25920
E7: (simple group PSp (6,2) or PSW (7,2), order 1451520) * Z (2)
E8: O (8+,2) = 2.(simple group PSW (8+,2) order 174182400).2

E8 is the SO(16) group with matrices added with each row/column containing 1 \
of 3/4 and 7 of 1/4 with signs +-\
\>", "Text",ExpressionUUID->"dec90094-3435-4743-b405-2752efb5e649"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetWeylGroupOrder", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "!"}], ",", "\[IndentingNewLine]", 
       "2", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", "n"}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", "n"}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "4", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", " ", "25920", ",", 
         "\[IndentingNewLine]", "7", ",", "1451520", ",", 
         "\[IndentingNewLine]", "8", ",", " ", "174182400"}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"n", ",", "\[IndentingNewLine]", "4", ",", " ", "1152"}], 
        "]"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"n", ",", "\[IndentingNewLine]", "2", ",", " ", "12"}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[384]:=",ExpressionUUID->"2713ef7e-b1eb-40df-9e9f-c692be85c2b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOut", "[", 
   RowBox[{"initset_", ",", "xpndfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"oldset", ",", "itmdset", ",", "newset"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"oldset", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newset", " ", "=", " ", "initset"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "newset", "]"}], " ", ">", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"itmdset", " ", "=", " ", "newset"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldset", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"oldset", ",", "itmdset"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newset", " ", "=", " ", 
         RowBox[{"Union", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"xpndfunc", " ", "/@", " ", "newset"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newset", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{"newset", ",", "oldset"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "oldset"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[385]:=",ExpressionUUID->"583eb8db-9fe5-4a21-94bd-0af8901fa1f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutGroupStep", "[", 
   RowBox[{"stpel_", ",", "els_", ",", "op_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"stpel", ",", "#"}], "]"}], "&"}], " ", "/@", " ", "els"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"#", ",", "stpel"}], "]"}], "&"}], " ", "/@", " ", "els"}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[386]:=",ExpressionUUID->"c28f64dc-91fa-4df1-8156-a7bb42dcdc3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutGroup", "[", 
   RowBox[{"els_", ",", "op_"}], "]"}], " ", ":=", " ", 
  RowBox[{"FillOut", "[", 
   RowBox[{"els", ",", 
    RowBox[{
     RowBox[{"FillOutGroupStep", "[", 
      RowBox[{"#", ",", "els", ",", "op"}], "]"}], "&"}]}], "]"}]}]], "Input",\

 CellLabel->
  "In[387]:=",ExpressionUUID->"05578406-7b98-4616-83db-9cf6d0b44c1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutWeylGroup", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"FillOutGroup", "[", 
   RowBox[{
    RowBox[{"WeylGroupGenerators", "[", "type", "]"}], ",", "Dot"}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[388]:=",ExpressionUUID->"a633337b-9cb0-4891-81cd-e50ec77b6ff5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Uses", " ", "canonical", " ", "root", " ", "vectors"}], ";", " ", 
   
   RowBox[{"vers", " ", "is", " ", "which", " ", "set"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[389]:=",ExpressionUUID->"daaa4a77-eafb-463c-af2f-d140171974d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupGensCanonVecs", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "gens", ",", "cvcx", ",", "invcvcx", ",", "nx"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gens", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvcx", " ", "=", " ", 
      RowBox[{"ExtendedCanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nx", " ", "=", " ", 
      RowBox[{"Length", "[", "cvcx", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"invcvcx", " ", "=", " ", 
      RowBox[{"Inverse", "[", "cvcx", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nx", " ", ">", " ", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "cvcx", "]"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"nx", "-", "n"}], "}"}], ",", 
                  RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", "n", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"nx", "-", "n"}], "}"}]}], "]"}], ",", 
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{"nx", "-", "n"}], "]"}]}], "]"}], "]"}]}], "]"}], 
           "]"}], ".", 
          RowBox[{"Transpose", "[", "invcvcx", "]"}]}], "&"}], " ", "/@", " ",
         "gens"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "cvcx", "]"}], ".", "#", ".", 
          RowBox[{"Transpose", "[", "invcvcx", "]"}]}], "&"}], " ", "/@", " ",
         "gens"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[390]:=",ExpressionUUID->"6e8b617c-4e12-4210-b681-50c1223d8381"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Orbit Combinations", "Subsection",ExpressionUUID->"b6b16afb-ebd1-468c-bee9-d1df428eda26"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Given", " ", "some", " ", "Weyl"}], "-", 
    RowBox[{
    "orbit", " ", "generators", " ", "and", " ", "a", " ", "list", " ", "of", 
     " ", "roots", " ", "with", " ", "multiplicities"}]}], ",", " ", 
   RowBox[{"find", " ", "the", " ", "orbits"}], ",", " ", 
   RowBox[{"given", " ", "as", " ", 
    RowBox[{"(", 
     RowBox[{"multiplicity", ",", " ", 
      RowBox[{"max", " ", "root"}]}], ")"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[391]:=",ExpressionUUID->"daad876f-26b4-41e3-8fc5-05cbad49bf85"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrbitsForRootList", "[", 
   RowBox[{"gens_", ",", "mlrts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rtixs", ",", "rtmls", ",", "ml", ",", "rt", ",", "n", ",", "i", ",", 
      "ht", ",", "orblist", ",", "mxml", ",", "mxrt", ",", "mxht", ",", 
      "flrts"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "mlrts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "gens", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "mlrts", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ml", ",", "rt"}], "}"}], " ", "=", " ", 
         RowBox[{"mlrts", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rtixs", "[", "i", "]"}], " ", "=", " ", "rt"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rtmls", "[", "rt", "]"}], " ", "=", " ", "ml"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"orblist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mxml", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rt", " ", "=", " ", 
            RowBox[{"rtixs", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ml", " ", "=", " ", 
            RowBox[{"rtmls", "[", "rt", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ht", " ", "=", " ", 
            RowBox[{"Total", "[", "rt", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ml", " ", "\[Equal]", " ", "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mxml", " ", "\[NotEqual]", " ", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ht", " ", ">", " ", "mxht"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mxml", " ", "=", " ", "ml"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mxrt", " ", "=", " ", "rt"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mxht", " ", "=", " ", "ht"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"mxml", " ", "=", " ", "ml"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mxrt", " ", "=", " ", "rt"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mxht", " ", "=", " ", "ht"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mxml", " ", "\[Equal]", " ", "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"orblist", ",", 
          RowBox[{"{", 
           RowBox[{"mxml", ",", "mxrt"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flrts", " ", "=", " ", 
         RowBox[{"FillOut", "[", 
          RowBox[{
           RowBox[{"{", "mxrt", "}"}], ",", 
           RowBox[{
            RowBox[{"gens", ".", "#"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{"rtmls", "[", "rt", "]"}], "]"}], "===", "rtmls"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"n", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rtmls", "[", "rt", "]"}], " ", "=", " ", 
              RowBox[{"-", " ", "mxml"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rtixs", "[", "n", "]"}], " ", "=", " ", "rt"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rtmls", "[", "rt", "]"}], " ", "-=", " ", "mxml"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rt", ",", "flrts"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"rtmls", ",", "rtixs"}], "]"}], ";", "\[IndentingNewLine]", 
     "orblist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[392]:=",ExpressionUUID->"e92a1870-98fa-4f64-9a67-cd7b77b3c79c"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Products", " ", "of", " ", "Weyl", " ", 
   RowBox[{"orbits", ".", "\[IndentingNewLine]", "Inputs"}], " ", "in", " ", 
   "weight", " ", 
   RowBox[{"space", ".", "\[IndentingNewLine]", "Output"}], " ", "is", " ", 
   "list", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"multiplicity", ",", " ", 
     RowBox[{"dominant", " ", "root"}], ",", " ", 
     RowBox[{"dominant", " ", "weight"}]}], "}"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[393]:=",ExpressionUUID->"09ee201e-f569-46e8-9e65-7b3340202473"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AltOrbitProduct", "[", 
   RowBox[{"type_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "orb1", ",", "orb2", ",", "orbprod", ",", 
      "gens"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "\[Equal]", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orb1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"GetOrbit", "[", 
        RowBox[{"type", ",", "maxwts1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orb2", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"GetOrbit", "[", 
        RowBox[{"type", ",", "maxwts2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbprod", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Plus", " ", "@@", " ", "#"}], ")"}], "&"}], " ", "/@", " ", 
       
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"orb1", ",", "orb2"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gens", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", "ctnmat"}]}], "}"}], "&"}], 
      " ", "/@", " ", 
      RowBox[{"OrbitsForRootList", "[", 
       RowBox[{"gens", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "#"}], "}"}], "&"}], " ", "/@", " ", 
         "orbprod"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[394]:=",ExpressionUUID->"2c083807-3643-407a-bd56-8cfcee0aa386"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "the", " ", "function", " ", "below"}], ",", " ", 
   RowBox[{
    RowBox[{"since", " ", "it", " ", "was", " ", "copy"}], "-", 
    RowBox[{
    "pasted", " ", "with", " ", "a", " ", "minimum", " ", "of", " ", 
     "revision"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[395]:=",ExpressionUUID->"f0fa4ef5-10ab-4c0f-b92a-5fd05bd4a15d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrbitLikeGetRep", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Prepend", "[", 
     RowBox[{"#", ",", "1"}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"GetOrbit", "[", 
    RowBox[{"type", ",", "maxwts"}], "]"}]}]}]], "Input",
 CellLabel->
  "In[396]:=",ExpressionUUID->"23a2249c-dca7-4cb2-93ad-828819550da7"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "One", " ", "can", " ", "also", " ", "do", " ", "decompositions", " ", 
    "for", " ", "branching", " ", "rules"}], ",", " ", 
   RowBox[{
    RowBox[{"using", " ", "the", " ", "branching"}], "-", 
    RowBox[{"rule", " ", 
     RowBox[{"object", "'"}], "s", " ", 
     RowBox[{"contents", "."}]}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[397]:=",ExpressionUUID->"0794b3c2-57ad-41bc-8492-139df134653f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Copy", " ", "and", " ", "paste", " ", "and", " ", "edit", " ", "of", " ", 
    "irrep", " ", "branching"}], "-", 
   RowBox[{"rule", " ", "function", " ", 
    RowBox[{"DoBranching", "[", "]"}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[398]:=",ExpressionUUID->"b7605a61-18f0-4839-8720-1c1ece8b4611"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoOrbitBranching", "[", 
   RowBox[{"brancher_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u1s", ",", "submats", ",", "nsa", ",", "la", ",", "i", ",", "j", ",", 
      "k", ",", "ctnmats", ",", " ", "rep", ",", "repx", ",", "rpmem", ",", 
      "memkey", ",", "rt", ",", "rts", ",", "wts", ",", "u1fac", ",", 
      "u1vals", ",", "rpix", ",", "ix", ",", " ", "zerovec", ",", " ", 
      "zeromem", ",", " ", "irreplist", ",", "mwmem", ",", "found", ",", 
      "outrep", ",", " ", "orind", ",", "ormem", ",", "oimem"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Get", " ", "the", " ", "parameters"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<U1s\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"brancher", "[", "\"\<SubmatRoots\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmats", " ", "=", "  ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"la", " ", "=", " ", 
          RowBox[{"GetLieAlgebra", "[", 
           RowBox[{
            RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
         RowBox[{"la", "[", "\"\<CtnMat\>\"", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "rep", " ", "and", " ", "the", " ", 
       "decomposition", " ", "of", " ", "each", " ", 
       RowBox[{"member", "'"}], "s", " ", "roots", " ", "and", " ", "weights",
        " ", "into", " ", "the", " ", 
       RowBox[{"subalgebras", "'"}], " ", 
       RowBox[{"ones", ".", " ", "Also"}], " ", "handle", " ", "the", " ", 
       "demoted", " ", 
       RowBox[{"root", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"OrbitLikeGetRep", "[", 
       RowBox[{
        RowBox[{"brancher", "[", "\"\<Type\>\"", "]"}], ",", "maxwts"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rt", " ", "=", " ", 
          RowBox[{"rpmem", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rts", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"rt", ".", 
             RowBox[{"submats", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"wts", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rts", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ".", 
             RowBox[{"ctnmats", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Handle", " ", "both", " ", "the", " ", "cases", " ", "of", " ", 
           "a", " ", "vector", " ", "to", " ", "multiply", " ", "the", " ", 
           "roots", " ", "and", " ", "a", " ", "root", " ", "index"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"u1vals", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"u1fac", " ", "=", " ", 
              RowBox[{"u1s", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "u1fac", "]"}], " ", "===", " ", 
                "List"}], ",", 
               RowBox[{"u1fac", ".", "rt"}], ",", 
               RowBox[{"rt", "[", 
                RowBox[{"[", "u1fac", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", "u1s", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rpmem", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "rts", ",", "wts", ",", 
           "u1vals"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consolidate", " ", "all", " ", "rep", " ", "entries", " ", "with", " ",
        "the", " ", "same", " ", 
       RowBox[{
        RowBox[{"root", "/", "weight"}], "/", "coeff"}], " ", "value"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"repx", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"memkey", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"rpix", "[", "memkey", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "ix", "]"}], "===", "rpix"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"repx", ",", "rpmem"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rpix", "[", "memkey", "]"}], " ", "=", " ", 
            RowBox[{"Length", "[", "repx", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"repx", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "+=", " ", 
           RowBox[{"rpmem", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", "repx"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "all", " ", "the", " ", "irreps"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Create", " ", "a", " ", "convenient", " ", 
       RowBox[{"reference", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"zerovec", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "#", "]"}], "}"}]}], "]"}], "&"}], " ", "/@",
        " ", "ctnmats"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zeromem", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "zerovec", ",", " ", "zerovec", ",", " ", "0"}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"irreplist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mwmem", " ", "=", " ", "zeromem"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"found", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rpmem", " ", "=", " ", 
            RowBox[{"rep", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Ought", " ", "to", " ", "have", " ", "an", " ", "assert", " ", 
             "for", " ", "negative", " ", "values"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rpmem", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", " ", 
              "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Ordering", " ", "is", " ", "with", " ", "the", " ", "roots"}], 
             ",", " ", 
             RowBox[{
              RowBox[{"not", " ", "with", " ", "the", " ", 
               RowBox[{"weights", ".", " ", "Recommended"}], " ", "in", " ", 
               "Weight", " ", 
               RowBox[{"(", 
                RowBox[{"representation", " ", "theory"}], ")"}]}], " ", "-", 
              " ", "Wikipedia"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"the", " ", "free", " ", "encyclopedia"}], " ", "-", 
               " ", 
               RowBox[{"http", ":"}]}], "//", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
                "/", "Weight_"}], 
               RowBox[{"(", "representation_theory", ")"}]}]}]}], " ", "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"rpmem", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
                RowBox[{"mwmem", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
              "\[GreaterEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"found", " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mwmem", " ", "=", " ", "rpmem"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "rep", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Are", " ", "we", " ", 
          RowBox[{"done", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "found"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Subtract", " ", "out", " ", "what", " ", "we", " ", "found"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outrep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"mwmem", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"orind", " ", "=", " ", 
            RowBox[{"OrbitLikeGetRep", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"brancher", "[", "\"\<Subtypes\>\"", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"mwmem", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"outrep", " ", "=", " ", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ormem", " ", "=", " ", 
                  RowBox[{"outrep", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"oimem", " ", "=", " ", 
                    RowBox[{"orind", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Length", "[", "orind", "]"}]}], "}"}]}], "]"}]}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "outrep", "]"}]}], "}"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rpix", "[", 
             RowBox[{"ormem", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rep", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "-=", "  ", 
            RowBox[{
             RowBox[{"mwmem", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"ormem", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ormem", ",", "outrep"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"irreplist", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mwmem", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"mwmem", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"mwmem", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "irreplist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[399]:=",ExpressionUUID->"34903a51-55a0-4ccd-b4bb-44b0f2cbb551"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cartan-Weyl Normalizations", "Subsection",ExpressionUUID->"27a33b38-e8c3-45b7-be63-7329f05c9d5f"],

Cell["\<\
Finds the Cartan-Weyl normalizations.

These are the N(a,b) values in
[H(i),E(a)] = a(i)E (a)
[E(a),E(-a)] = a.g.H
[E(a),E(b)] = N(a,b)*E(a+b)
a, b: root vectors, i index in root vector

\[OpenCurlyDoubleQuote]nrm\[CloseCurlyDoubleQuote] is a variable that is a \
function with explicit args\
\>", "Text",ExpressionUUID->"5ba6f4fd-91f8-4979-9208-60a928963606"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "All", " ", "the", " ", "nonzero", " ", "ones", " ", "used", " ", "in", " ",
    "the", " ", "constraints"}], " ", "*)"}]], "Input",
 CellLabel->
  "In[400]:=",ExpressionUUID->"c05bed70-85a2-4058-ae70-94deb5256fd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNVariables", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "psrs", ",", "nps", ",", "i1", ",", "i2", ",", "pi1", ",", 
      "pi2", ",", "pi12", ",", 
      RowBox[{"vars", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vars", ",", 
            RowBox[{"nrm", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "vars"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[401]:=",ExpressionUUID->"138e3433-3042-4519-8085-6948ac8c24fd"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "squares", " ", "of", " ", "the", " ", "normalizations", " ", 
   "as", " ", "functions", " ", "of", " ", "the", " ", "sorted", " ", "root", 
   " ", 
   RowBox[{"lenghts", ":", " ", 
    RowBox[{"N", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", ",", "b"}], ")"}], "^", "2"}], " ", "as", " ", 
     "functions", " ", "of", " ", "sort", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"len", 
          RowBox[{"(", "a", ")"}]}], ",", 
         RowBox[{"len", 
          RowBox[{"(", "b", ")"}]}], ",", 
         RowBox[{"len", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}]}], "}"}], ")"}], "."}]}]}]}], " ",
   "*)"}]], "Input",
 CellLabel->
  "In[402]:=",ExpressionUUID->"73befcc2-7faf-49e7-8b82-881c4fe38259"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "4"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "6"}], "}"}]}], "]"}], " ", "=", " ", "3"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6", ",", "6"}], "}"}]}], "]"}], " ", "=", " ", "3"}],
   ";"}]], "Input",
 CellLabel->
  "In[403]:=",ExpressionUUID->"ef59e8d3-a58b-433c-b9fc-e889a0ef3a4d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"All", " ", "the", " ", 
    RowBox[{"constraints", ".", " ", "Experience"}], " ", "indicates", " ", 
    "that", " ", "there", " ", "this", " ", "works", " ", "up", " ", "to", 
    " ", "signs"}], ",", " ", 
   RowBox[{"and", " ", "that", " ", "there", " ", "are", " ", 
    RowBox[{"2", "^", "n"}], " ", "resulting", " ", "equations", " ", "for", 
    " ", "n", " ", "undetermined", " ", "signs"}], ","}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[404]:=",ExpressionUUID->"e7c508a3-8083-403e-b5d1-0bc546a22dc6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNConstraints", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "psrs", ",", "metric", ",", "nps", 
      ",", "nrm0", ",", "nrmx", ",", "i1", ",", "i2", ",", "i3", ",", "pi1", 
      ",", "pi2", ",", "pi12", ",", "pi3", ",", "pi13", ",", "pi23", ",", 
      "pi123", ",", "psrsx", ",", 
      RowBox[{"cstrs", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nrm", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", "a"}], ")"}]}]}], " ", "=", " ", 
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "a"}], ")"}]}], " ", "=", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"-", " ", "N"}], 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", 
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}]}], ")"}]}], " ", "=", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}], ",", "a"}], ")"}]}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", 
           RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", "pi2"}], "]"}], " ", "=", " ", "0"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", 
           RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Fix", " ", "the", " ", "sign"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nrm0", " ", "=", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"CWNLenMag", "[", 
              RowBox[{"family", ",", " ", 
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pi1", ".", "metric", ".", "pi1"}], ",", 
                  RowBox[{"pi2", ".", "metric", ".", "pi2"}], ",", 
                  RowBox[{"pi12", ".", "metric", ".", "pi12"}]}], "}"}], 
                "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nrm0", " ", "*=", " ", 
            RowBox[{"nrm", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi2"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi1"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], "=", "0"}], ";", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], "=", "0"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "^", "2"}]}], " ", "-", " ", 
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", 
              RowBox[{"-", "b"}]}], ")"}], "^", "2"}]}]}]}], " ", "=", " ", 
        RowBox[{"-", " ", 
         RowBox[{"<", "a"}]}]}], ",", 
       RowBox[{"b", ">"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{
               RowBox[{"nrmx", "[", 
                RowBox[{"pi1", ",", "pi2"}], "]"}], "^", "2"}], " ", "-", " ", 
              RowBox[{
               RowBox[{"nrmx", "[", 
                RowBox[{"pi1", ",", 
                 RowBox[{"-", "pi2"}]}], "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{"pi1", ".", "metric", ".", "pi2"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "nps"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Constraints", ":", " ", 
        RowBox[{
        "Jacobi", " ", "with", " ", "no", " ", "roots", " ", "or", " ", 
         "root", " ", "sums", " ", 
         RowBox[{"zero", ":", " ", 
          RowBox[{
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "+", "b"}], ",", "c"}], ")"}]}], " ", "+", " ", 
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"b", ",", "c"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", "+", "c"}], ",", "a"}], ")"}]}], " ", "+", " ", 
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"c", ",", "a"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", "+", "a"}], ",", "b"}], ")"}]}]}]}]}]}], " ", "=", 
       " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"psrsx", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"psrs", ",", 
        RowBox[{"-", "psrs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi3", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i3", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi12", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi2"}]}], ";", " ", 
             RowBox[{"pi13", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi3"}]}], ";", " ", 
             RowBox[{"pi23", " ", "=", " ", 
              RowBox[{"pi2", "+", "pi3"}]}], ";", 
             RowBox[{"pi123", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi2", "+", "pi3"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi12", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi13", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi23", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi123", "]"}], "]"}], "\[Equal]", 
                 "0"}]}], ",", "\[IndentingNewLine]", "0", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi1", ",", "pi2"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi12", ",", "pi3"}], "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi2", ",", "pi3"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi23", ",", "pi1"}], "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi3", ",", "pi1"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi13", ",", "pi2"}], "]"}]}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"2", "*", "nps"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}],
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", "cstrs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[405]:=",ExpressionUUID->"27aa4c3b-780c-4eac-bc5b-a9ed660c7d84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNSolution", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "vars", ",", "nvrs", ",", "cstrs", ",", "handled", ",", 
      RowBox[{"nrls", "=", 
       RowBox[{"{", "}"}]}], ",", "soln", ",", "i", ",", "vr", ",", "ncss", 
      ",", "nwrl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"CWNVariables", "[", 
       RowBox[{"type", ",", "nrm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nvrs", " ", "=", " ", 
      RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"CWNConstraints", "[", 
       RowBox[{"type", ",", "nrm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"handled", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"False", ",", 
        RowBox[{"{", "nvrs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", "handled"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"handled", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vr", " ", "=", " ", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nwrl", " ", "=", " ", 
            RowBox[{"vr", " ", "\[Rule]", " ", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ncss", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"cstrs", " ", "/.", " ", "nwrl"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[NotEqual]", "0"}], "&"}], " ", "/@", " ", 
                 "ncss"}], ",", "True"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"handled", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"cstrs", " ", "=", " ", "ncss"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nrls", ",", "nwrl"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nwrl", " ", "=", " ", 
            RowBox[{"vr", " ", "\[Rule]", " ", 
             RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ncss", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"cstrs", " ", "/.", " ", "nwrl"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[NotEqual]", "0"}], "&"}], " ", "/@", " ", 
                 "ncss"}], ",", "True"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"handled", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"cstrs", " ", "=", " ", "ncss"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nrls", ",", "nwrl"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nvrs"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "nrls"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[406]:=",ExpressionUUID->"d1bc8d18-2c21-41aa-b648-f9c1664fb3dc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Copy", " ", "and", " ", "paste", " ", "of", " ", "above"}], ",", 
   " ", 
   RowBox[{
   "but", " ", "for", " ", "squares", " ", "and", " ", "as", " ", "functions",
     " ", "of", " ", "the", " ", "root", " ", "lengths"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[407]:=",ExpressionUUID->"4349681c-9b4c-40a1-aad8-bd7c21a01bf4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNSquareConstraints", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "nrm", ",", "family", ",", "psrs", ",", "metric", ",", "nps", 
      ",", "nrm0", ",", "nrmx", ",", "i1", ",", "i2", ",", "i3", ",", "pi1", 
      ",", "pi2", ",", "pi12", ",", "pi3", ",", "pi13", ",", "pi23", ",", 
      "pi123", ",", "psrsx", ",", 
      RowBox[{"cstrs", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "BadValue"}], ",", 
       RowBox[{"Return", "[", "BadValue", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nrm", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"family", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<PosRoots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<Metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", "a"}], ")"}]}]}], " ", "=", " ", 
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "a"}], ")"}]}], " ", "=", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"-", " ", "N"}], 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", 
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}]}], ")"}]}], " ", "=", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}], ",", "a"}], ")"}]}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", 
           RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", "pi2"}], "]"}], " ", "=", " ", "0"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", 
           RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nrm0", " ", "=", " ", 
            RowBox[{"CWNLenMag", "[", 
             RowBox[{"family", ",", " ", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pi1", ".", "metric", ".", "pi1"}], ",", 
                 RowBox[{"pi2", ".", "metric", ".", "pi2"}], ",", 
                 RowBox[{"pi12", ".", "metric", ".", "pi12"}]}], "}"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi2"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi1"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], "=", "0"}], ";", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], "=", "0"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "^", "2"}]}], " ", "-", " ", 
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", 
              RowBox[{"-", "b"}]}], ")"}], "^", "2"}]}]}]}], " ", "=", " ", 
        RowBox[{"-", " ", 
         RowBox[{"<", "a"}]}]}], ",", 
       RowBox[{"b", ">"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"nrmx", "[", 
               RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "-", " ", 
              RowBox[{"nrmx", "[", 
               RowBox[{"pi1", ",", 
                RowBox[{"-", "pi2"}]}], "]"}], " ", "+", " ", 
              RowBox[{"pi1", ".", "metric", ".", "pi2"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "nps"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
         "Jacobi", " ", "with", " ", "no", " ", "roots", " ", "or", " ", 
          "root", " ", "sums", " ", 
          RowBox[{"zero", ":", " ", 
           RowBox[{
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"a", ",", "b"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "b"}], ",", "c"}], ")"}]}], " ", "+", " ", 
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"b", ",", "c"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "+", "c"}], ",", "a"}], ")"}]}], " ", "+", " ", 
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"c", ",", "a"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "+", "a"}], ",", "b"}], ")"}]}]}]}]}]}], " ", "=",
         " ", 
        RowBox[{
        "0", "\[IndentingNewLine]", "\[IndentingNewLine]", "Omitted", " ", 
         "because", " ", "it", " ", "supplies", " ", "sign", " ", 
         "constraints"}]}], ";", " ", 
       RowBox[{
       "working", " ", "on", " ", "values", " ", "of", " ", "squares"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Union", "[", "cstrs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[408]:=",ExpressionUUID->"206b2d3d-5d48-4a38-969c-548d4c73b28b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Successfully", " ", "does", " ", "constraints"}], ",", " ", 
   RowBox[{"to", " ", "within", " ", "several", " ", "signs"}]}], " ", 
  "*)"}]], "Input",
 CellLabel->
  "In[409]:=",ExpressionUUID->"aa6941fb-9fa2-4084-9cd4-0bf97656874c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conversion Utilities", "Subsection",ExpressionUUID->"0093ff9e-c8d8-44ca-897f-885ec92c2fea"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Converts", " ", "numerical", " ", "data", " ", "in", " ", "arrays", " ", 
    "into", " ", "Python", " ", 
    RowBox[{"form", ".", " ", "Supports"}], " ", "Null", " ", 
    RowBox[{"(", 
     RowBox[{"\[Rule]", "None"}], ")"}]}], ",", " ", "integers", ",", " ", 
   "fractions", ",", "\[IndentingNewLine]", 
   RowBox[{
   "and", " ", "lists", " ", "of", " ", "them", " ", "and", " ", "of", " ", 
    "lists"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[410]:=",ExpressionUUID->"66f750dc-e038-4811-846d-3c307033620a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pythonize", "[", "data_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"num", ",", "den", ",", "slst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ToString", "[", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Head", "[", "data", "]"}], ",", "\[IndentingNewLine]", 
       "Symbol", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"data", "===", "Null"}], ",", "\"\<None\>\"", ",", "data"}], 
        "]"}], ",", "\[IndentingNewLine]", "Rational", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"num", " ", "=", " ", 
         RowBox[{"Numerator", "[", "data", "]"}]}], ";", " ", 
        RowBox[{"den", " ", "=", " ", 
         RowBox[{"Denominator", "[", "data", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<`1`Fraction(`2`,`3`)\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"num", "\[GreaterEqual]", "0"}], ",", "\"\<\>\"", ",", 
             "\"\<-\>\""}], "]"}], ",", 
           RowBox[{"Abs", "[", "num", "]"}], ",", "den"}], "]"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "List", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"slst", " ", "=", " ", 
         RowBox[{"Pythonize", " ", "/@", " ", "data"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"slst", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"slst", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"\"\<, \>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "data", "]"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "data", "]"}], " ", ">", " ", "1"}], ",", 
          RowBox[{"slst", " ", "=", " ", 
           RowBox[{"Most", "[", "slst", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<(``)\>\"", ",", 
          RowBox[{"(", 
           RowBox[{"StringJoin", " ", "@@", " ", "slst"}], ")"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", "data"}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[411]:=",ExpressionUUID->"c7a11204-1bf0-4596-b6f0-1a9cb6ea6bfd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PythonizeSubalgExtraData", "[", "]"}], " ", ":=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<SubalgExtraData = {}\\n\\n\>\"", ",", 
    RowBox[{"StringJoin", " ", "@@", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<SubalgExtraData[\\\"``\\\"] = ``\\n\\n\>\"", ",", "#", ",", 
           RowBox[{"Pythonize", "[", 
            RowBox[{"SubalgExtraData", "[", "#", "]"}], "]"}]}], "]"}], "]"}],
         "&"}], " ", "/@", " ", "SubalgExtraNames"}], ")"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[412]:=",ExpressionUUID->"e6bd587b-f548-4ef8-814b-14237046a7e8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Takes", " ", "the", " ", "stsmdata", " ", "objects", " ", "in", " ", 
    "root", " ", "demotion", " ", "and", " ", "extension", " ", "splitting"}],
    ",", " ", 
   RowBox[{
   "and", " ", "turns", " ", "them", " ", "into", " ", "flattened", " ", 
    "data", " ", "suitable", " ", "for", " ", "storing", " ", "in", " ", "a", 
    " ", 
    RowBox[{"C", "++"}], " ", "version"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[413]:=",ExpressionUUID->"31d4451e-1b72-4af0-9bbb-ae0315b56d96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenSTSMData", "[", "stsmdata_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"flattened", "=", 
       RowBox[{"{", "}"}]}], ",", "sslen", ",", "i", ",", "ssind"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sslen", " ", "=", " ", 
      RowBox[{"Length", "[", "stsmdata", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{"flattened", ",", "sslen"}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ssind", " ", "=", " ", 
         RowBox[{"stsmdata", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"ssind", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"ssind", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Numerator", "[", "#", "]"}], ",", 
                 RowBox[{"Denominator", "[", "#", "]"}]}], "}"}], "&"}], " ", 
              "/@", " ", 
              RowBox[{"ssind", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", "1"}], "]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sslen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "flattened"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[414]:=",ExpressionUUID->"fe93e790-2918-4b17-b355-56d94e30b948"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Flattens", " ", "the", " ", "extra", " ", "data", " ", "to", " ", "put", 
     " ", "it", " ", "into", " ", "a", " ", "form", " ", "suitable", " ", 
     "for", " ", 
     RowBox[{"C", "++"}], " ", 
     RowBox[{"code", ".", " ", "Assumes"}], " ", "that", " ", "the", " ", 
     "projection", " ", "matrices", " ", "are", " ", "all"}], "-", 
    "integer"}], ",", " ", 
   RowBox[{"and", " ", "adds", " ", "a", " ", "count", " ", "of", " ", 
    RowBox[{"them", ".", " ", "No"}], " ", "U", 
    RowBox[{
     RowBox[{"(", "1", ")"}], "'"}], "s", " ", 
    RowBox[{"here", "."}]}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[415]:=",ExpressionUUID->"1e49fb69-0f93-4b38-aef5-f5315ed1aac8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenSEData", "[", "sedata_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"params", ",", "projs", ",", "npjs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"params", " ", "=", " ", 
      RowBox[{"sedata", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projs", " ", "=", " ", 
      RowBox[{"sedata", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"npjs", " ", "=", " ", 
      RowBox[{"Length", "[", "projs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"params", ",", "npjs", ",", "projs"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[416]:=",ExpressionUUID->"b413d89e-5cb1-4be7-ad8f-22c28476d0d8"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "substitution", " ", "is", " ", "to", " ", "make", " ", "the",
      " ", "labels", " ", "more", " ", 
     RowBox[{"C", "++"}]}], "-", "friendly"}], ",", " ", 
   RowBox[{
   "so", " ", "they", " ", "can", " ", "be", " ", "used", " ", "as", " ", 
    "identifiers"}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[417]:=",ExpressionUUID->"9e7af1f1-fee2-41f7-901d-764c1fae7739"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CPPizeLabel", "[", "lbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"lbl", ",", 
     RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<_\>\""}]}], "]"}]}], ";"}]], "Input",\

 CellLabel->
  "In[418]:=",ExpressionUUID->"479cda9b-8a81-4eff-9be0-2b5ea7de6fa6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSEString", "[", "selbl_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<static const DKINT SubalgExtraData_\>\"", ",", 
      RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<[] = \>\"", ",", 
      RowBox[{"ToString", "[", 
       RowBox[{"FlattenSEData", "[", 
        RowBox[{"SubalgExtraData", "[", "selbl", "]"}], "]"}], "]"}], ",", 
      "\"\<;\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[419]:=",ExpressionUUID->"615f2545-f19b-46a4-a891-d26e43f00c6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSEEntryString", "[", "selbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\tSubalgExtraData_\>\"", ",", 
     RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<,\\n\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[420]:=",ExpressionUUID->"b68ff109-febf-4957-9c46-74b76f7beed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSESetString", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ind", ",", "plc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plc", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEEntryString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "ind", ",", "\"\<\\nstatic const DKINT *SubalgExtraData[] = {\\n\>\"", 
       ",", "plc", ",", "\"\<};\\n\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[421]:=",ExpressionUUID->"7309f9fd-85da-4303-825b-1c910841a01d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSEEnumString", "[", "selbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\tLA_BR_SUBALG_EXTRA_\>\"", ",", 
     RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<,\\n\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[422]:=",ExpressionUUID->"bfc5ab94-7542-4696-b488-ee6ad6a3ee5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSEEnumSetString", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEEnumString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<enum {\\n\>\"", ",", "ind", ",", 
       "\"\<\\tLA_BR_NUMBER_OF_SUBALG_EXTRAS\\n};\\n\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[423]:=",ExpressionUUID->"c751c1c4-4b1a-4c40-a338-78b40df2b8df"]
}, Closed]]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowSize->{717, 778},
WindowMargins->{{340, Automatic}, {Automatic, 40}},
ShowSelection->True,
FrontEndVersion->"14.1 for Mac OS X x86 (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13f4f2af-ccaa-4dd4-9841-f76b97725646"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 86, 0, 66, "Section",ExpressionUUID->"75731fd3-3f03-4363-ab14-9e54500c7ab3"],
Cell[656, 24, 751, 15, 274, "Text",ExpressionUUID->"c6728ba0-7e94-48bd-91fc-a548c5ab97ff"],
Cell[CellGroupData[{
Cell[1432, 43, 89, 0, 53, "Subsection",ExpressionUUID->"5d1e3cb4-f231-4b75-9de6-e198670cbfbf"],
Cell[1524, 45, 207, 3, 58, "Text",ExpressionUUID->"83b6169a-2691-4cb1-ac0d-db72e84e1a6d"],
Cell[1734, 50, 93, 0, 32, "ItemNumbered",ExpressionUUID->"ccb1fc63-89f1-41b6-b84a-6a8aab6746f3"],
Cell[1830, 52, 94, 0, 32, "ItemNumbered",ExpressionUUID->"8dd6159c-335c-4fd9-9909-f0bae76d4450"],
Cell[1927, 54, 92, 0, 32, "ItemNumbered",ExpressionUUID->"c908cc44-8fa5-471e-b507-8eb26f68d9cd"],
Cell[2022, 56, 92, 0, 32, "ItemNumbered",ExpressionUUID->"363b1115-eddb-40a8-935e-993d23b1845a"],
Cell[2117, 58, 132, 0, 32, "ItemNumbered",ExpressionUUID->"7bed3ce7-8d69-4268-b8e7-66097ed48a6b"],
Cell[2252, 60, 91, 0, 32, "ItemNumbered",ExpressionUUID->"9d235a6e-8285-44c6-a506-6ffe6e8deca5"],
Cell[2346, 62, 91, 0, 32, "ItemNumbered",ExpressionUUID->"6be2ac17-71af-44f7-ab42-c2b91ddb8031"],
Cell[2440, 64, 758, 14, 288, "Text",ExpressionUUID->"77c48fd4-2bb0-4b83-a809-ec8aabff7c69"],
Cell[3201, 80, 83, 0, 32, "Item",ExpressionUUID->"c4deba49-48d2-4232-9b13-1c1b9050bb08"],
Cell[3287, 82, 108, 0, 32, "Item",ExpressionUUID->"4a9d9a45-4fa9-4603-a548-2abc4abacfcf"],
Cell[3398, 84, 95, 0, 32, "Item",ExpressionUUID->"b8e0fc01-91e4-421d-8127-bd8e56c5ad5a"],
Cell[3496, 86, 104, 0, 32, "Item",ExpressionUUID->"fb33fdfe-b7a7-4e0c-82c6-5ee0b5bf1b29"],
Cell[3603, 88, 95, 0, 32, "Item",ExpressionUUID->"86a66dbc-7ba8-40f0-92d9-9eff9eff2993"],
Cell[3701, 90, 99, 0, 32, "Item",ExpressionUUID->"8517da03-fdac-4c09-9635-1c5694110fe2"],
Cell[3803, 92, 87, 0, 32, "Item",ExpressionUUID->"206a2e1b-ed8e-47e3-9f90-88050c164616"],
Cell[3893, 94, 88, 0, 32, "Item",ExpressionUUID->"ac4510c1-a02a-42ee-8544-f95f995f6e6f"],
Cell[3984, 96, 151, 2, 35, "Text",ExpressionUUID->"8d44b58d-ce2e-4150-8764-4a28723d62c9"],
Cell[4138, 100, 119, 0, 32, "Item",ExpressionUUID->"74f95770-fede-4f45-a5b4-4d50de025658"],
Cell[4260, 102, 134, 0, 32, "Item",ExpressionUUID->"f72debc6-a228-44df-8e86-03ece7ccc746"],
Cell[4397, 104, 117, 0, 32, "Item",ExpressionUUID->"4a7abfd8-bf77-4729-80ae-37edcc52d028"],
Cell[4517, 106, 123, 0, 32, "Item",ExpressionUUID->"bccaecce-b67d-4048-b4ec-b031fce59fdf"]
}, Closed]],
Cell[CellGroupData[{
Cell[4677, 111, 89, 0, 37, "Subsection",ExpressionUUID->"2104d536-76ba-4ef7-90b4-9c4ac5480c08"],
Cell[4769, 113, 2271, 55, 1185, "Text",ExpressionUUID->"7bc9f658-1cd2-45d9-921e-60461bd66a64"]
}, Closed]],
Cell[CellGroupData[{
Cell[7077, 173, 88, 0, 37, "Subsection",ExpressionUUID->"a54cc1be-ef55-4dbc-b302-df8ba1306b7e"],
Cell[7168, 175, 2208, 52, 1047, "Text",ExpressionUUID->"791218e9-e240-43ee-b379-c964885ca99b"]
}, Closed]],
Cell[CellGroupData[{
Cell[9413, 232, 113, 0, 37, "Subsection",ExpressionUUID->"347bc930-bc5f-42a6-89ed-1850f4316e80"],
Cell[9529, 234, 3362, 87, 1852, "Text",ExpressionUUID->"22283115-a69c-4fe6-b8d1-f99b951dbdcf"]
}, Closed]],
Cell[CellGroupData[{
Cell[12928, 326, 93, 0, 37, "Subsection",ExpressionUUID->"e3ef79e1-10d3-4eb0-919b-8599e7513b9b"],
Cell[13024, 328, 2440, 54, 886, "Text",ExpressionUUID->"f1ea775a-41b8-4d2e-967c-817d26eb10a2"]
}, Closed]],
Cell[CellGroupData[{
Cell[15501, 387, 89, 0, 37, "Subsection",ExpressionUUID->"ba02c53a-965b-4368-9c48-af051cf9baf2"],
Cell[15593, 389, 1467, 31, 564, "Text",ExpressionUUID->"9957bd1b-3292-4147-bd14-93e30fc4357d"]
}, Closed]],
Cell[CellGroupData[{
Cell[17097, 425, 99, 0, 37, "Subsection",ExpressionUUID->"78b976a5-47ac-42cb-b62e-345550fa8f3a"],
Cell[17199, 427, 4272, 102, 2082, "Text",ExpressionUUID->"8b7d5800-0f95-47a4-a87d-103346944a6c"]
}, Closed]],
Cell[CellGroupData[{
Cell[21508, 534, 108, 0, 37, "Subsection",ExpressionUUID->"b43a9725-a1ad-4a39-bc23-3e70dfba0267"],
Cell[21619, 536, 6716, 105, 2853, "Text",ExpressionUUID->"868cdb6b-df40-41ef-b9a3-0e3c64178000"]
}, Closed]],
Cell[CellGroupData[{
Cell[28372, 646, 111, 0, 37, "Subsection",ExpressionUUID->"dc4700cb-0002-48b0-993c-07686a2ceec7"],
Cell[28486, 648, 130, 3, 58, "Text",ExpressionUUID->"cb5be755-ffbd-4382-be88-c0fec9bb105d"]
}, Closed]],
Cell[CellGroupData[{
Cell[28653, 656, 83, 0, 37, "Subsection",ExpressionUUID->"b9b0dbe2-bd54-4f97-9f0b-92e8d5b74438"],
Cell[28739, 658, 445, 11, 242, "Text",ExpressionUUID->"70450a6c-ed78-4758-abb1-8760733fa63c"]
}, Closed]],
Cell[CellGroupData[{
Cell[29221, 674, 87, 0, 37, "Subsection",ExpressionUUID->"451926c0-9d1c-4b5a-a077-35dbeb071243"],
Cell[29311, 676, 916, 20, 426, "Text",ExpressionUUID->"4e9e31c7-1c16-4e97-8f5a-e5c0cb6b227c"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[30276, 702, 97, 0, 52, "Section",ExpressionUUID->"34ddd76d-04f5-444b-ae0a-49db2d262ebc"],
Cell[CellGroupData[{
Cell[30398, 706, 92, 0, 54, "Subsection",ExpressionUUID->"95c2623a-4e43-475d-9d95-fdb42860bb90"],
Cell[30493, 708, 231, 5, 30, "Input",ExpressionUUID->"1f2423fd-6190-48c4-a98b-f487eb6e6512"],
Cell[30727, 715, 230, 5, 30, "Input",ExpressionUUID->"5e314025-1e5f-45a8-8d54-793a033b8930"],
Cell[30960, 722, 165, 3, 30, "Input",ExpressionUUID->"070dc266-da15-47fe-8b45-0f38c92c149f"],
Cell[31128, 727, 1233, 35, 136, "Input",ExpressionUUID->"97efd59f-b30b-4870-8e4a-65dcfd4a7868"],
Cell[32364, 764, 376, 7, 52, "Input",ExpressionUUID->"1fb3a5ac-e764-46e8-b770-a138c204c3df"],
Cell[32743, 773, 7937, 204, 745, "Input",ExpressionUUID->"a9b299f6-c62a-4ef6-a42b-eccd11465714"]
}, Closed]],
Cell[CellGroupData[{
Cell[40717, 982, 85, 0, 38, "Subsection",ExpressionUUID->"2a62a8d0-0e24-4ab5-87aa-36c01506db74"],
Cell[40805, 984, 1944, 54, 178, "Input",ExpressionUUID->"6ec2f87b-a3f9-4af6-b654-d1f3d60a5530"],
Cell[42752, 1040, 2082, 57, 178, "Input",ExpressionUUID->"6a11cdd3-9e95-4736-b47c-230e78730f1a"]
}, Closed]],
Cell[CellGroupData[{
Cell[44871, 1102, 82, 0, 38, "Subsection",ExpressionUUID->"d3e91b5d-0a66-44ca-b64c-f1cbcac7d196"],
Cell[44956, 1104, 622, 14, 94, "Input",ExpressionUUID->"49c1fa00-59d2-43dc-8f06-53a3ac800d2d"],
Cell[45581, 1120, 380, 11, 30, "Input",ExpressionUUID->"b504da89-981a-432b-a922-83683a417233"],
Cell[45964, 1133, 250, 5, 30, "Input",ExpressionUUID->"0c4e3fea-f73a-4bf8-ba89-708efd673c99"],
Cell[46217, 1140, 8440, 184, 1144, "Input",ExpressionUUID->"680057a9-3080-45d5-beae-9d971ebb0912"]
}, Closed]],
Cell[CellGroupData[{
Cell[54694, 1329, 100, 0, 38, "Subsection",ExpressionUUID->"ed91a5e2-ee77-4166-8a99-e8ddca5f4412"],
Cell[54797, 1331, 568, 15, 52, "Input",ExpressionUUID->"c0962342-f4f1-4324-a422-e705c47f12c1"],
Cell[55368, 1348, 1309, 35, 115, "Input",ExpressionUUID->"9ae5950f-32d4-40b3-b309-e5a118eaba92"],
Cell[56680, 1385, 329, 7, 30, "Input",ExpressionUUID->"be117b73-8580-440d-8500-6d5e68ba29db"],
Cell[57012, 1394, 259, 6, 30, "Input",ExpressionUUID->"16c67c6d-12e4-4652-af32-1ffc450cf4a1"],
Cell[57274, 1402, 2348, 53, 346, "Input",ExpressionUUID->"05cbd18c-2c40-4524-9841-e6753de9b419"]
}, Closed]],
Cell[CellGroupData[{
Cell[59659, 1460, 84, 0, 38, "Subsection",ExpressionUUID->"aefcacda-997c-47f1-b8e0-9bbc88ba21fa"],
Cell[59746, 1462, 198, 4, 30, "Input",ExpressionUUID->"7b2dca21-4c6f-4665-a301-52ebbf2d4f36"],
Cell[59947, 1468, 245, 5, 30, "Input",ExpressionUUID->"50cbf91f-a98b-4901-95d7-08431b098e12"],
Cell[60195, 1475, 161, 3, 30, "Input",ExpressionUUID->"1035d355-c190-4711-a4ac-978f62a86c4d"],
Cell[60359, 1480, 341, 7, 30, "Input",ExpressionUUID->"70f23411-317f-4969-8117-bbdf19b1dec2"],
Cell[60703, 1489, 1042, 25, 178, "Input",ExpressionUUID->"c8ee9dbf-e677-4fe2-b7f6-ace013e639cb"]
}, Closed]],
Cell[CellGroupData[{
Cell[61782, 1519, 83, 0, 38, "Subsection",ExpressionUUID->"fa2b8411-a9f4-4014-a298-66672b3e2adb"],
Cell[61868, 1521, 223, 5, 30, "Input",ExpressionUUID->"2d4b9f4c-ca21-4d44-b687-e8679907e2f3"],
Cell[62094, 1528, 831, 25, 52, "Input",ExpressionUUID->"d8f26ebf-1576-42a1-82d0-c776580452d0"],
Cell[62928, 1555, 369, 8, 30, "Input",ExpressionUUID->"5bcc2e9d-c9a9-485c-9d77-d4853056845a"],
Cell[63300, 1565, 2886, 75, 241, "Input",ExpressionUUID->"0f44242b-2a8b-49bf-99e3-61ad16f8244f"],
Cell[66189, 1642, 293, 5, 30, "Input",ExpressionUUID->"3b2b7cb9-9373-4263-9097-6f89bf87c12d"],
Cell[66485, 1649, 890, 23, 115, "Input",ExpressionUUID->"a3096e91-9e85-4e81-be30-8137fb531d2a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[67424, 1678, 110, 0, 52, "Section",ExpressionUUID->"aafef809-3775-4917-aef6-688be6030c9f"],
Cell[CellGroupData[{
Cell[67559, 1682, 111, 0, 54, "Subsection",ExpressionUUID->"1158da3b-8731-4cfb-957c-381a5122d270"],
Cell[67673, 1684, 262, 6, 52, "Input",ExpressionUUID->"2a0d0f15-f331-4c8a-98c0-bbdcfcd31f07"],
Cell[67938, 1692, 1996, 55, 262, "Input",ExpressionUUID->"1d600dea-23c7-4e68-a182-833b1b50a1a7"]
}, Closed]],
Cell[CellGroupData[{
Cell[69971, 1752, 92, 0, 38, "Subsection",ExpressionUUID->"b5f4b754-fd55-4814-b501-d181f62b716e"],
Cell[70066, 1754, 781, 17, 94, "Input",ExpressionUUID->"7f489544-ce6f-4131-98be-fe52f9f5848e"],
Cell[70850, 1773, 406, 12, 30, "Input",ExpressionUUID->"33a8861e-8a47-4a47-975d-32d5d8db474a"],
Cell[71259, 1787, 256, 5, 30, "Input",ExpressionUUID->"d4e85bc0-d549-4e47-b578-f2fa7663094c"],
Cell[71518, 1794, 6196, 145, 808, "Input",ExpressionUUID->"e0804685-c132-4f9f-84c5-59dac8a1d465"],
Cell[77717, 1941, 529, 10, 73, "Input",ExpressionUUID->"ce29e095-f806-4990-9677-63935830bc45"],
Cell[78249, 1953, 4783, 118, 598, "Input",ExpressionUUID->"b27944ef-4a13-4d48-bbbe-35ee8e97a609"],
Cell[83035, 2073, 330, 7, 30, "Input",ExpressionUUID->"1c8858fa-0b5e-46c3-8b6c-f44887f056fa"],
Cell[83368, 2082, 1224, 31, 178, "Input",ExpressionUUID->"758aa126-b95a-4b33-9686-b46223e2698e"]
}, Closed]],
Cell[CellGroupData[{
Cell[84629, 2118, 94, 0, 38, "Subsection",ExpressionUUID->"e5d06bd1-cd97-4fbe-8867-ed9b959b12f3"],
Cell[84726, 2120, 359, 10, 30, "Input",ExpressionUUID->"747ca68f-5d83-4bce-9920-430f10d7b75d"],
Cell[85088, 2132, 383, 11, 30, "Input",ExpressionUUID->"b9a04779-498d-4fc8-b152-f516b4d7c6b8"],
Cell[85474, 2145, 383, 11, 30, "Input",ExpressionUUID->"49adb3fd-684c-4ade-a415-d3812ce32e22"],
Cell[85860, 2158, 436, 13, 30, "Input",ExpressionUUID->"a5a7d3cd-2bdf-4468-a7e1-a714c2da635a"],
Cell[86299, 2173, 438, 12, 30, "Input",ExpressionUUID->"48c4eebb-ecba-42bd-a4a1-0dd83c0ea79d"],
Cell[86740, 2187, 319, 8, 30, "Input",ExpressionUUID->"41d4f9f3-981f-4183-a7b1-64495830667a"],
Cell[87062, 2197, 319, 8, 30, "Input",ExpressionUUID->"4fdeb19a-985c-4a12-90a8-e09cbf2b2c23"],
Cell[87384, 2207, 228, 5, 30, "Input",ExpressionUUID->"617189a6-c579-4467-afb6-84be75cdbe5b"],
Cell[87615, 2214, 230, 5, 30, "Input",ExpressionUUID->"13d9c9f4-1cd8-457a-aab7-93cf8d35ccad"],
Cell[87848, 2221, 234, 6, 30, "Input",ExpressionUUID->"05a79805-f632-449b-b9dd-f45b61ce482d"],
Cell[88085, 2229, 227, 5, 30, "Input",ExpressionUUID->"3eabeb4a-ebb5-4073-aecf-b542d914e132"],
Cell[88315, 2236, 230, 5, 30, "Input",ExpressionUUID->"ea91b043-19d3-48b8-a451-00bebc4e663e"]
}, Closed]],
Cell[CellGroupData[{
Cell[88582, 2246, 88, 0, 38, "Subsection",ExpressionUUID->"3b8435ed-2077-450a-8430-33c5c63b19bb"],
Cell[CellGroupData[{
Cell[88695, 2250, 101, 0, 45, "Subsubsection",ExpressionUUID->"db36669b-636d-4a61-b32f-a7940e08511f"],
Cell[88799, 2252, 351, 8, 52, "Input",ExpressionUUID->"f66510a7-395d-45d6-b02a-c308011200ad"],
Cell[89153, 2262, 1363, 33, 199, "Input",ExpressionUUID->"eeb290dd-d695-46fd-9f06-8ab5d845c9c2"],
Cell[90519, 2297, 2413, 63, 283, "Input",ExpressionUUID->"f6c6432d-7248-4d95-8650-0b717b1c2fb2"],
Cell[92935, 2362, 466, 8, 52, "Input",ExpressionUUID->"1ab827bd-6352-40a4-ae16-134289e0c7ea"],
Cell[93404, 2372, 5017, 121, 640, "Input",ExpressionUUID->"53d385c1-c721-41ea-b0df-db9df5e90c08"],
Cell[98424, 2495, 239, 4, 30, "Input",ExpressionUUID->"cb859690-32cd-40ed-97ae-ae098e59623f"],
Cell[98666, 2501, 380, 8, 30, "Input",ExpressionUUID->"4850caf3-eb75-4581-8085-c9cc2e4f9884"],
Cell[99049, 2511, 320, 7, 30, "Input",ExpressionUUID->"efe30dbc-ee88-4e03-8e63-f89960c47830"],
Cell[99372, 2520, 534, 15, 30, "Input",ExpressionUUID->"c15c05f5-0fb0-43a1-94ba-78a3525fe849"],
Cell[99909, 2537, 332, 8, 30, "Input",ExpressionUUID->"664f7ed8-e067-483f-99bb-0ef6e119c0d8"],
Cell[100244, 2547, 555, 16, 52, "Input",ExpressionUUID->"6f16f774-679b-44de-97d3-e11fcf1c0785"],
Cell[100802, 2565, 287, 6, 30, "Input",ExpressionUUID->"1aefcd0c-f438-4423-926c-6ad08563f463"],
Cell[101092, 2573, 14339, 354, 1438, "Input",ExpressionUUID->"0cd06a31-cdac-4ac2-988c-345df606f52d"],
Cell[115434, 2929, 239, 5, 30, "Input",ExpressionUUID->"2f9ed99a-9301-4d03-a931-d86efa021680"],
Cell[115676, 2936, 2096, 58, 157, "Input",ExpressionUUID->"b118b480-7c0e-4a61-92e9-c99d159b06c1"]
}, Closed]],
Cell[CellGroupData[{
Cell[117809, 2999, 100, 0, 37, "Subsubsection",ExpressionUUID->"d160006b-f5e9-412d-9047-98f26e1181a0"],
Cell[117912, 3001, 291, 7, 30, "Input",ExpressionUUID->"5c9de9e7-25bb-4201-b728-268ef32e6e3e"],
Cell[118206, 3010, 2968, 74, 430, "Input",ExpressionUUID->"7cf8c5c8-9975-4439-bf43-621fb5f4a43d"]
}, Closed]],
Cell[CellGroupData[{
Cell[121211, 3089, 87, 0, 37, "Subsubsection",ExpressionUUID->"b62fb469-7bea-412b-8e4e-554d05022345"],
Cell[121301, 3091, 198, 4, 30, "Input",ExpressionUUID->"eefe4422-3b64-41f9-8266-cdc62aa4d245"],
Cell[121502, 3097, 235, 5, 30, "Input",ExpressionUUID->"5130fdd5-f6ba-45b6-8c3f-8f18e28bb6aa"],
Cell[121740, 3104, 156, 3, 30, "Input",ExpressionUUID->"2d9a136d-e706-4653-ace6-772d9d95f2a0"],
Cell[121899, 3109, 3431, 83, 430, "Input",ExpressionUUID->"e0205d52-b929-410b-8582-3b9d830e6a11"],
Cell[125333, 3194, 284, 6, 30, "Input",ExpressionUUID->"f9d88ffa-5a10-49af-a3c8-889fb9114df0"],
Cell[125620, 3202, 298, 8, 30, "Input",ExpressionUUID->"23f50336-8259-4102-b2cb-71e5e48aaac8"],
Cell[125921, 3212, 479, 13, 52, "Input",ExpressionUUID->"35496846-315f-4ba2-822d-2b01f24b86dd"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[126449, 3231, 113, 0, 38, "Subsection",ExpressionUUID->"0506f7f9-a990-4367-9065-128a437afda5"],
Cell[CellGroupData[{
Cell[126587, 3235, 127, 0, 45, "Subsubsection",ExpressionUUID->"db75c842-133d-4f8d-9206-ec84ca5196d2"],
Cell[126717, 3237, 255, 5, 30, "Input",ExpressionUUID->"98df5718-5f00-4643-88c0-8e7059a5b419"],
Cell[126975, 3244, 4500, 109, 619, "Input",ExpressionUUID->"f20d173c-63b0-4755-a2ad-428f7bfce4d9"],
Cell[131478, 3355, 744, 16, 94, "Input",ExpressionUUID->"f20b12c1-fdbf-415d-b7a1-d3326de16d0c"],
Cell[132225, 3373, 5482, 133, 682, "Input",ExpressionUUID->"69f3b2a1-aed7-4739-905a-5145a76e96df"],
Cell[137710, 3508, 626, 15, 94, "Input",ExpressionUUID->"dd26c132-afa7-45d6-87db-c2dc1468d28d"],
Cell[138339, 3525, 1237, 31, 178, "Input",ExpressionUUID->"cf96815f-d3f4-4de5-bedc-8b2368e3588e"]
}, Closed]],
Cell[CellGroupData[{
Cell[139613, 3561, 87, 0, 37, "Subsubsection",ExpressionUUID->"38509005-0a93-43fd-97b9-dffe13055d05"],
Cell[139703, 3563, 241, 5, 30, "Input",ExpressionUUID->"0bc5a053-0638-4a60-8674-1d36ab71edd9"],
Cell[139947, 3570, 159, 3, 30, "Input",ExpressionUUID->"8f7d2163-0861-4c6d-bb08-992b881a17e5"],
Cell[140109, 3575, 1344, 34, 199, "Input",ExpressionUUID->"ffcccfa7-d048-4ecc-93df-5ab9699569ea"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[141502, 3615, 101, 0, 38, "Subsection",ExpressionUUID->"08d1efbc-cc9e-45b1-8cb6-398d94c22648"],
Cell[141606, 3617, 371, 7, 30, "Input",ExpressionUUID->"7f954bda-6813-4402-a677-8dd7fca79fcf"],
Cell[141980, 3626, 286, 7, 30, "Input",ExpressionUUID->"10745a9c-3c6e-4ab6-80c5-26a14940d4b7"],
Cell[142269, 3635, 410, 12, 30, "Input",ExpressionUUID->"01bae535-e35b-4945-84ba-bdbb207510f5"],
Cell[142682, 3649, 262, 5, 30, "Input",ExpressionUUID->"0b38ab23-eff7-4fdc-8cce-965d05dc2cbc"],
Cell[142947, 3656, 856, 24, 94, "Input",ExpressionUUID->"18a7797c-15d3-47cd-acb5-bbf907572eb5"],
Cell[143806, 3682, 231, 5, 30, "Input",ExpressionUUID->"a2178da3-89b4-4ce8-b26e-29642909e695"],
Cell[144040, 3689, 154, 3, 30, "Input",ExpressionUUID->"84133557-e2c5-42b6-847a-0a059c1b0dc3"],
Cell[144197, 3694, 1411, 36, 199, "Input",ExpressionUUID->"8b4b7935-3551-4e6b-b839-93a2aa8095b8"],
Cell[145611, 3732, 1416, 36, 178, "Input",ExpressionUUID->"103f4066-a0a2-401c-a864-127051dd965d"]
}, Closed]],
Cell[CellGroupData[{
Cell[147064, 3773, 93, 0, 38, "Subsection",ExpressionUUID->"ee4e2957-bcd7-4d5c-82b3-56438a2cef17"],
Cell[CellGroupData[{
Cell[147182, 3777, 90, 0, 45, "Subsubsection",ExpressionUUID->"596558e5-bab0-4891-a52f-03e115b6b58b"],
Cell[147275, 3779, 330, 6, 30, "Input",ExpressionUUID->"6e9113a4-1302-4b69-8387-26575c19c1b0"],
Cell[147608, 3787, 355, 10, 30, "Input",ExpressionUUID->"45aa8d42-aa5c-4098-b285-c5f245490813"],
Cell[147966, 3799, 583, 11, 73, "Input",ExpressionUUID->"ae76e710-0514-4a24-990c-ff37bdd4b850"],
Cell[148552, 3812, 2686, 70, 325, "Input",ExpressionUUID->"9c49320c-2ff5-4347-958c-41753a0eeb96"],
Cell[151241, 3884, 407, 10, 30, "Input",ExpressionUUID->"9d9fba55-5b15-4178-80f8-4a1e0deb6c22"],
Cell[151651, 3896, 432, 10, 52, "Input",ExpressionUUID->"85509c77-a875-49e5-bbfc-420073de01a7"]
}, Closed]],
Cell[CellGroupData[{
Cell[152120, 3911, 91, 0, 37, "Subsubsection",ExpressionUUID->"326fd8ea-f81f-48ee-9661-165984b1830a"],
Cell[152214, 3913, 247, 5, 30, "Input",ExpressionUUID->"ab4e024c-bd39-414d-853b-69caaaeeadb3"],
Cell[152464, 3920, 1459, 37, 199, "Input",ExpressionUUID->"54fd21c7-4b3a-4aff-b487-415d3bf114ed"],
Cell[153926, 3959, 247, 6, 30, "Input",ExpressionUUID->"3da68406-1e38-4146-9ce6-3e582f8f34a3"],
Cell[154176, 3967, 1368, 37, 178, "Input",ExpressionUUID->"151fd15b-c20d-465f-a64a-e78851149782"],
Cell[155547, 4006, 487, 12, 54, "Input",ExpressionUUID->"2c9d2b09-c606-4dc6-ac96-7dc6181a35e6"],
Cell[156037, 4020, 321, 8, 30, "Input",ExpressionUUID->"bb5502b0-fde2-4336-9bd7-c9d2d4f13dc5"],
Cell[156361, 4030, 334, 8, 30, "Input",ExpressionUUID->"8437f567-0f0f-47f1-83f8-c676fc65a768"],
Cell[156698, 4040, 371, 10, 30, "Input",ExpressionUUID->"258851c4-9df5-4210-bd74-6843cbf4aaa2"],
Cell[157072, 4052, 491, 14, 52, "Input",ExpressionUUID->"4c55d5fd-3124-42e4-964a-4faf7426edc9"]
}, Closed]],
Cell[CellGroupData[{
Cell[157600, 4071, 87, 0, 37, "Subsubsection",ExpressionUUID->"194d0259-ab11-4d3f-849b-45e1291790f3"],
Cell[157690, 4073, 901, 22, 115, "Input",ExpressionUUID->"4719f1cd-0ad9-4f5d-a087-e6c96bb9df34"],
Cell[158594, 4097, 4347, 113, 724, "Input",ExpressionUUID->"c8e9f5bf-520a-4851-98b0-a26a7ada50a4"],
Cell[162944, 4212, 433, 10, 52, "Input",ExpressionUUID->"65a27898-6cec-43a7-844c-09d7800cfd00"],
Cell[163380, 4224, 468, 12, 52, "Input",ExpressionUUID->"706d177d-fa98-4808-b3cb-397858b5d5c9"],
Cell[163851, 4238, 1004, 27, 136, "Input",ExpressionUUID->"ae672fee-2a5c-4958-a1da-98904e22e06e"],
Cell[164858, 4267, 312, 8, 30, "Input",ExpressionUUID->"9737022e-3ade-4811-a09c-c3e8f16c8fca"],
Cell[165173, 4277, 4742, 118, 451, "Input",ExpressionUUID->"69df26ee-aeed-4a3b-b6a0-f27447eac699"]
}, Closed]],
Cell[CellGroupData[{
Cell[169952, 4400, 98, 0, 37, "Subsubsection",ExpressionUUID->"66960e0e-6f5a-48ea-ac86-b6c8d9873c99"],
Cell[170053, 4402, 5659, 129, 683, "Input",ExpressionUUID->"fdf24437-38ea-404a-a2e1-0a61778f6729"],
Cell[175715, 4533, 5476, 137, 892, "Input",ExpressionUUID->"2280f2ea-324e-466b-a85a-467a7fb89da9"],
Cell[181194, 4672, 276, 6, 30, "Input",ExpressionUUID->"e6395967-e315-4735-9d6a-3f63b29b5c9d"],
Cell[181473, 4680, 519, 15, 30, "Input",ExpressionUUID->"ce173fd7-7137-486a-b608-aae691c486d7"],
Cell[181995, 4697, 468, 12, 73, "Input",ExpressionUUID->"b0291584-117c-4ef2-935b-0f177b667798"]
}, Closed]],
Cell[CellGroupData[{
Cell[182500, 4714, 95, 0, 37, "Subsubsection",ExpressionUUID->"9422c6a9-9c9d-4a12-add1-ca9b4082ba90"],
Cell[182598, 4716, 459, 12, 52, "Input",ExpressionUUID->"303ffc43-766e-41dc-8111-ee17b9579707"],
Cell[183060, 4730, 517, 13, 52, "Input",ExpressionUUID->"81d03b0d-7d6c-400f-a119-5e4312ea43ba"],
Cell[183580, 4745, 2403, 62, 304, "Input",ExpressionUUID->"da0d868f-1457-4467-8500-5579587b2a4e"],
Cell[185986, 4809, 530, 13, 73, "Input",ExpressionUUID->"e3f84e50-a66d-47fc-a0d6-53a16051b0e6"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[186577, 4829, 108, 0, 52, "Section",ExpressionUUID->"46d390d2-88be-411b-a40d-cf9233ebd2b1"],
Cell[CellGroupData[{
Cell[186710, 4833, 93, 0, 54, "Subsection",ExpressionUUID->"9207e943-beb3-4150-bbde-e1a97ae19056"],
Cell[186806, 4835, 235, 5, 30, "Input",ExpressionUUID->"49f28027-47cb-425d-9c54-8a5a6420c54c"],
Cell[187044, 4842, 505, 11, 52, "Input",ExpressionUUID->"2d69011f-9196-4625-9a2b-8115f04758e7"],
Cell[187552, 4855, 2995, 74, 367, "Input",ExpressionUUID->"3fc2d7bc-e2f1-43f0-aa8e-fa9d13465c75"],
Cell[190550, 4931, 254, 6, 30, "Input",ExpressionUUID->"52f8d506-6467-4b0c-a6c6-ce319adc84ff"],
Cell[190807, 4939, 1508, 42, 199, "Input",ExpressionUUID->"82071c13-d677-468c-afff-2fb443f0b2d5"],
Cell[192318, 4983, 3832, 95, 430, "Input",ExpressionUUID->"42f2f6b4-95a1-41d2-9646-28ba152133cd"],
Cell[196153, 5080, 305, 7, 30, "Input",ExpressionUUID->"300d1179-9985-4cbb-ab37-b44a93249c5c"],
Cell[196461, 5089, 315, 7, 52, "Input",ExpressionUUID->"2d19efb8-9f27-4068-b9bc-a66de71460df"],
Cell[196779, 5098, 180, 4, 30, "Input",ExpressionUUID->"7d35a26e-ffbf-4b19-9ed7-04e0f5ae318a"],
Cell[196962, 5104, 2674, 73, 262, "Input",ExpressionUUID->"57ef8b11-2438-4c38-a681-85d385191016"],
Cell[199639, 5179, 315, 7, 52, "Input",ExpressionUUID->"483972a0-07e1-498b-b5e9-26385ae2bb45"],
Cell[199957, 5188, 327, 7, 52, "Input",ExpressionUUID->"8549a103-71c8-49cb-9e8f-1a09fc56473c"],
Cell[200287, 5197, 325, 8, 52, "Input",ExpressionUUID->"b9861a4a-a125-473b-8b1e-13da200eddba"],
Cell[200615, 5207, 335, 8, 52, "Input",ExpressionUUID->"411d7e8b-be16-4f0e-95cf-5d08331e33d2"],
Cell[200953, 5217, 323, 7, 52, "Input",ExpressionUUID->"d5442a75-d474-476c-99d1-6ebd23c51b01"],
Cell[201279, 5226, 588, 15, 73, "Input",ExpressionUUID->"31f3e0f5-1c25-4b62-9b0d-bb8cec2806ee"],
Cell[201870, 5243, 247, 6, 30, "Input",ExpressionUUID->"8a096813-bce9-4c31-9a9b-dc4df0c35a5e"],
Cell[202120, 5251, 709, 19, 94, "Input",ExpressionUUID->"d1fcd856-c9f3-42b2-a508-7e6b2bfbf188"],
Cell[202832, 5272, 769, 18, 115, "Input",ExpressionUUID->"96d23390-c17f-4958-aa4c-cd37aaa0df01"],
Cell[203604, 5292, 805, 18, 136, "Input",ExpressionUUID->"ba55c21c-ab3e-47de-ad83-5840b14daa56"],
Cell[204412, 5312, 1295, 31, 115, "Input",ExpressionUUID->"de66f69c-e790-40b2-bc72-a000a808f66c"],
Cell[205710, 5345, 971, 26, 94, "Input",ExpressionUUID->"c3357ab2-5043-406b-b4c5-d525c6fb50c7"],
Cell[206684, 5373, 569, 16, 52, "Input",ExpressionUUID->"f2786818-898a-4e4a-a913-16467b81ae65"],
Cell[207256, 5391, 1169, 31, 136, "Input",ExpressionUUID->"5e98a1ef-9c6c-42dc-b2c6-d7143e1eaee4"],
Cell[208428, 5424, 258, 6, 30, "Input",ExpressionUUID->"8e30a6c9-9333-4035-8455-5715bc98b498"],
Cell[208689, 5432, 1346, 35, 220, "Input",ExpressionUUID->"66f383c9-41b3-4712-870a-725806e5edf5"],
Cell[210038, 5469, 702, 16, 94, "Input",ExpressionUUID->"890df66c-a999-48d2-aa4a-f048b2938d1c"],
Cell[210743, 5487, 5312, 125, 712, "Input",ExpressionUUID->"b1d8e41e-e16a-4aee-9c82-3668f6d80385"],
Cell[216058, 5614, 349, 9, 30, "Input",ExpressionUUID->"889567a0-7587-499f-bcf4-033ffc9526f5"],
Cell[216410, 5625, 547, 16, 30, "Input",ExpressionUUID->"85f1633c-01c0-4919-9e49-7ac0c177bbc6"],
Cell[216960, 5643, 253, 6, 30, "Input",ExpressionUUID->"f610ac37-cbcb-4574-9289-fe5d055bb189"],
Cell[217216, 5651, 280, 7, 30, "Input",ExpressionUUID->"43fec3e2-6b47-4028-acd2-c903b0d58926"],
Cell[217499, 5660, 208, 5, 30, "Input",ExpressionUUID->"a69260fa-c73b-45b2-8986-b70dc05675bb"],
Cell[217710, 5667, 336, 8, 52, "Input",ExpressionUUID->"33626946-d182-442f-9d1a-9924aa0d4e75"],
Cell[218049, 5677, 365, 9, 52, "Input",ExpressionUUID->"97c16353-2b52-4a84-bdb1-205ae73123a2"],
Cell[218417, 5688, 347, 8, 52, "Input",ExpressionUUID->"0b8d5f31-09cc-4d7c-9650-c99d889e137f"],
Cell[218767, 5698, 377, 9, 73, "Input",ExpressionUUID->"64e7e4e2-71e3-49f4-8fe1-1c535810153f"],
Cell[219147, 5709, 256, 6, 30, "Input",ExpressionUUID->"b8662e30-88d8-4074-b9c9-86977cdd900f"],
Cell[219406, 5717, 382, 9, 52, "Input",ExpressionUUID->"7050959b-5ee5-4be5-b4a7-d7ba6cad00ba"]
}, Closed]],
Cell[CellGroupData[{
Cell[219825, 5731, 89, 0, 38, "Subsection",ExpressionUUID->"4b06f698-eb4e-4a68-a49c-8651559c0468"],
Cell[219917, 5733, 333, 7, 73, "Input",ExpressionUUID->"696599b8-4d87-459e-8c57-40b0e1d6dec5"],
Cell[220253, 5742, 2441, 60, 304, "Input",ExpressionUUID->"1b4cbc05-a7af-4779-8377-3be51e9106c0"],
Cell[222697, 5804, 508, 12, 73, "Input",ExpressionUUID->"799bbbb7-440b-43a9-88cb-d219539d3421"],
Cell[223208, 5818, 595, 14, 73, "Input",ExpressionUUID->"e6b823db-d764-4662-90e1-c56807d3eaad"],
Cell[223806, 5834, 207, 5, 30, "Input",ExpressionUUID->"b4a06a23-623e-4fc9-b2a6-47e99dfcf210"],
Cell[224016, 5841, 554, 13, 73, "Input",ExpressionUUID->"3b82b91b-d8f7-4132-b870-771624ee0f7b"],
Cell[224573, 5856, 638, 14, 115, "Input",ExpressionUUID->"bf0ee1d6-c5ba-4240-89c4-ba6423c3b885"],
Cell[225214, 5872, 187, 4, 30, "Input",ExpressionUUID->"69ee588e-1d01-49d1-9ede-2dcab5c2a818"],
Cell[225404, 5878, 528, 12, 73, "Input",ExpressionUUID->"9a51ed86-4488-47dc-a01f-d3b8b18858c9"],
Cell[225935, 5892, 332, 8, 30, "Input",ExpressionUUID->"9b179056-65bc-43fc-83ef-2b59ba90d798"],
Cell[226270, 5902, 2899, 73, 430, "Input",ExpressionUUID->"602cc58d-452f-43ff-b7ce-e72c1c1a003b"],
Cell[229172, 5977, 465, 11, 73, "Input",ExpressionUUID->"946e88d0-8b50-4f7e-b4d5-a723c053c198"],
Cell[229640, 5990, 483, 11, 94, "Input",ExpressionUUID->"80cebe31-15ea-4687-ad20-b726c9ec1344"],
Cell[230126, 6003, 2047, 47, 367, "Input",ExpressionUUID->"089db545-8917-4fa8-8279-fbc76d199ada"],
Cell[232176, 6052, 362, 9, 30, "Input",ExpressionUUID->"a59fe92d-ec05-452e-975f-531a64f08ea8"],
Cell[232541, 6063, 692, 20, 73, "Input",ExpressionUUID->"d0805c6c-f16d-45d0-bcb5-c48be034b359"],
Cell[233236, 6085, 787, 22, 73, "Input",ExpressionUUID->"7b7c2f90-0fe5-487b-b65f-b89713898205"],
Cell[234026, 6109, 415, 11, 52, "Input",ExpressionUUID->"10630378-fe6d-4aad-a835-edbfbad6bbc0"]
}, Closed]],
Cell[CellGroupData[{
Cell[234478, 6125, 99, 0, 38, "Subsection",ExpressionUUID->"2ba7a779-6276-4e7d-8e9b-9fa9b37210e9"],
Cell[234580, 6127, 463, 11, 52, "Input",ExpressionUUID->"0a74f3ba-c466-4c18-8b70-d92efecb5253"],
Cell[235046, 6140, 193, 5, 30, "Input",ExpressionUUID->"84413159-63c9-4df1-80ad-95ce5fa3241c"],
Cell[235242, 6147, 2007, 51, 325, "Input",ExpressionUUID->"ff0aae35-6e87-4490-b4b0-1dca4ccfe9cf"],
Cell[237252, 6200, 390, 12, 30, "Input",ExpressionUUID->"92ec8b92-df23-4f93-ab32-c2cf6b49fcaa"],
Cell[237645, 6214, 862, 24, 94, "Input",ExpressionUUID->"4c88bc96-1ccd-4805-bfe5-3205be522c74"],
Cell[238510, 6240, 3117, 76, 430, "Input",ExpressionUUID->"591a3807-7052-4a89-9553-357a3cda71db"],
Cell[241630, 6318, 317, 9, 30, "Input",ExpressionUUID->"e5ca0e09-cfc5-47a0-9172-c89b5504b8a8"],
Cell[241950, 6329, 314, 9, 30, "Input",ExpressionUUID->"d3855650-0b0d-4f46-b334-b73e5e34c005"],
Cell[242267, 6340, 310, 9, 30, "Input",ExpressionUUID->"cc19f5b7-9e27-47a3-ac1f-e218748afbe9"],
Cell[242580, 6351, 315, 9, 30, "Input",ExpressionUUID->"7680935b-4813-407e-9797-ff8c716b9b01"],
Cell[242898, 6362, 327, 8, 30, "Input",ExpressionUUID->"a642fde5-d6ee-4acb-a5d6-34239b43c203"],
Cell[243228, 6372, 575, 11, 73, "Input",ExpressionUUID->"b36706c0-4f8d-4b16-a1bc-9b85936ea04a"],
Cell[243806, 6385, 7123, 176, 829, "Input",ExpressionUUID->"2f5718ce-20ef-40f9-a974-b56b337412ef"],
Cell[250932, 6563, 6601, 156, 703, "Input",ExpressionUUID->"090870a7-7011-4c07-a91e-9e8759886df3"],
Cell[257536, 6721, 986, 25, 136, "Input",ExpressionUUID->"4e5de0c7-34bf-4da9-84a0-0eca39b05c15"],
Cell[258525, 6748, 2615, 63, 388, "Input",ExpressionUUID->"c732fece-7657-471a-9db9-9d32d5dbe275"],
Cell[261143, 6813, 849, 21, 94, "Input",ExpressionUUID->"5fb38c6d-ae15-4da3-b876-fa26803cd2ac"],
Cell[261995, 6836, 5570, 136, 598, "Input",ExpressionUUID->"5017af58-de73-450f-8789-b32b4e6204a8"],
Cell[267568, 6974, 332, 8, 30, "Input",ExpressionUUID->"e6c6b07f-6e24-4f6f-abc1-2564fdf98492"],
Cell[267903, 6984, 274, 7, 30, "Input",ExpressionUUID->"5b70c189-1af6-4b6e-89c5-f546a7fe1e47"],
Cell[268180, 6993, 283, 6, 30, "Input",ExpressionUUID->"0947b313-6022-44e6-b888-38223ffb1587"],
Cell[268466, 7001, 1950, 50, 262, "Input",ExpressionUUID->"357a013b-0946-4597-9413-1914724f25c7"],
Cell[270419, 7053, 520, 12, 73, "Input",ExpressionUUID->"d63b2458-c44a-4790-91c6-23e6dd481d36"],
Cell[270942, 7067, 232, 6, 30, "Input",ExpressionUUID->"7f720254-7123-4b19-b909-d297326186a6"],
Cell[271177, 7075, 1012, 28, 157, "Input",ExpressionUUID->"4c88d9f8-7976-4c26-8f20-05e7284d2a8c"],
Cell[272192, 7105, 7857, 188, 997, "Input",ExpressionUUID->"22a08245-9aef-4cd4-b0da-7eee53231047"],
Cell[280052, 7295, 461, 11, 52, "Input",ExpressionUUID->"eee78451-27ff-42e8-9d66-2a95f38561b8"],
Cell[280516, 7308, 500, 11, 73, "Input",ExpressionUUID->"5fa0412d-8bbd-49d4-9bae-107c1b9617ea"],
Cell[281019, 7321, 207, 5, 30, "Input",ExpressionUUID->"894a5dd2-b248-47d2-8719-7138b86cf173"],
Cell[281229, 7328, 495, 11, 73, "Input",ExpressionUUID->"de884b14-2b5c-4344-b6fc-0172c9968fba"],
Cell[281727, 7341, 534, 11, 73, "Input",ExpressionUUID->"cb948cd7-bf54-4aac-a35a-8c07808cc952"],
Cell[282264, 7354, 187, 4, 30, "Input",ExpressionUUID->"41293208-88b5-4bec-a306-14dca6616b8b"],
Cell[282454, 7360, 475, 11, 73, "Input",ExpressionUUID->"905fe0a3-64a2-43cc-a966-d74b8ef483b8"],
Cell[282932, 7373, 372, 10, 30, "Input",ExpressionUUID->"71fde679-d6eb-43fe-9bef-9aea4fbccb67"],
Cell[283307, 7385, 7517, 183, 850, "Input",ExpressionUUID->"ced1a9e4-7f7e-4c52-8122-c2885f24a4c3"],
Cell[290827, 7570, 488, 11, 73, "Input",ExpressionUUID->"39ffa1ab-bd12-463f-88a6-13961750e2d7"],
Cell[291318, 7583, 526, 12, 73, "Input",ExpressionUUID->"c7c52dfc-1f40-4fae-a0fb-cafbedabf374"],
Cell[291847, 7597, 207, 5, 30, "Input",ExpressionUUID->"112f358c-8f5e-4538-8f3d-2c45bf38c049"],
Cell[292057, 7604, 522, 11, 73, "Input",ExpressionUUID->"dc0e73b4-24aa-47fe-97b0-1da367d87ab2"],
Cell[292582, 7617, 565, 13, 73, "Input",ExpressionUUID->"31f5e2c9-8bdb-40f9-a4db-b6363661dd5e"],
Cell[293150, 7632, 187, 4, 30, "Input",ExpressionUUID->"2b21580e-54f9-40c5-bb21-005bbecbc664"],
Cell[293340, 7638, 501, 11, 73, "Input",ExpressionUUID->"e38c1c73-d4a3-4788-ad4f-3c1fd3df9a61"],
Cell[293844, 7651, 214, 5, 30, "Input",ExpressionUUID->"403a0c6a-5baf-40ce-914c-debdecc14080"],
Cell[294061, 7658, 3129, 82, 325, "Input",ExpressionUUID->"38953b17-6a58-476a-8abf-8c3c4a463731"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[297239, 7746, 105, 0, 52, "Section",ExpressionUUID->"5c5d33dd-078d-44a5-8eab-eec68c49a250"],
Cell[CellGroupData[{
Cell[297369, 7750, 113, 0, 53, "Subsection",ExpressionUUID->"edb6181e-3d08-41ad-9304-aea8f8774eb2"],
Cell[297485, 7752, 3792, 92, 493, "Input",ExpressionUUID->"048c7931-0880-4621-a268-9c0f0a497151"],
Cell[301280, 7846, 462, 11, 73, "Input",ExpressionUUID->"6feaaaa9-c24b-4749-9439-b1ce7ded04df"],
Cell[301745, 7859, 510, 13, 73, "Input",ExpressionUUID->"981fda3c-ed81-4b12-a24d-f4a978e98d18"],
Cell[302258, 7874, 475, 11, 73, "Input",ExpressionUUID->"863f9879-14c3-4c28-aff2-03d60a0913c2"],
Cell[302736, 7887, 435, 10, 73, "Input",ExpressionUUID->"c0e2354c-ecac-4704-abd9-f1d7a8ae9ab8"],
Cell[303174, 7899, 1385, 35, 199, "Input",ExpressionUUID->"a9d583e9-1972-459d-b2c3-d3d97da6dd35"],
Cell[304562, 7936, 1383, 35, 199, "Input",ExpressionUUID->"662a77af-5107-4065-97a6-ae5f62e74eeb"],
Cell[305948, 7973, 1590, 41, 178, "Input",ExpressionUUID->"81a7e427-1698-4179-80e7-0cf57cacab2a"],
Cell[307541, 8016, 1588, 41, 178, "Input",ExpressionUUID->"130132ea-2547-4488-9534-efe5ce210770"],
Cell[309132, 8059, 2834, 69, 409, "Input",ExpressionUUID->"d46761b8-b4a5-4a07-b26f-979156b8155e"]
}, Closed]],
Cell[CellGroupData[{
Cell[312003, 8133, 121, 0, 37, "Subsection",ExpressionUUID->"0788654c-4c5b-428c-a5bf-a3eefd09d733"],
Cell[312127, 8135, 582, 14, 94, "Input",ExpressionUUID->"2558c11c-d249-4fa8-bf2c-2ca79d4ebe87"],
Cell[312712, 8151, 254, 6, 30, "Input",ExpressionUUID->"9d40bb66-945c-4091-812a-9e85bf4fd4dc"],
Cell[312969, 8159, 27050, 682, 2908, "Input",ExpressionUUID->"ad07d541-6704-4727-9679-d842de7da3d7"],
Cell[340022, 8843, 319, 7, 30, "Input",ExpressionUUID->"6d5f7293-b369-4026-8325-e1b4efd870a8"],
Cell[340344, 8852, 544, 16, 52, "Input",ExpressionUUID->"f3494489-bec0-4d76-8a00-5d78f0ca75ce"]
}, Closed]],
Cell[CellGroupData[{
Cell[340925, 8873, 96, 0, 37, "Subsection",ExpressionUUID->"b38630f1-f5e7-4868-b8ce-75db5737b06f"],
Cell[341024, 8875, 921, 21, 157, "Input",ExpressionUUID->"a0eb17e7-3aed-4b73-8dd7-5c80cb14420f"],
Cell[341948, 8898, 255, 6, 30, "Input",ExpressionUUID->"480c3588-1336-485a-a55f-2a65d75cdc3d"],
Cell[342206, 8906, 236, 6, 30, "Input",ExpressionUUID->"7cd90dd7-2d4d-4b64-9178-89e19d80530f"],
Cell[342445, 8914, 29132, 730, 2698, "Input",ExpressionUUID->"38fec709-e966-4e8c-87b8-5a84da49c119"],
Cell[371580, 9646, 352, 10, 30, "Input",ExpressionUUID->"8f8d14e1-e351-4366-8c02-54a37c016d79"],
Cell[371935, 9658, 552, 16, 52, "Input",ExpressionUUID->"cabb537c-4edb-4a6f-bb54-ab8283be3ea6"]
}, Closed]],
Cell[CellGroupData[{
Cell[372524, 9679, 98, 0, 37, "Subsection",ExpressionUUID->"2d1ac97b-84da-4838-8eb4-c12912268392"],
Cell[372625, 9681, 1163, 24, 192, "Input",ExpressionUUID->"be62eae5-6c09-450a-8d65-6fdb4dfba63c"],
Cell[373791, 9707, 520, 13, 70, "Input",ExpressionUUID->"7ee0398a-fa42-49b6-a6fe-446e7bb9cbfc"],
Cell[374314, 9722, 238, 6, 29, "Input",ExpressionUUID->"254cf27d-6030-46c2-b6a5-ebca2b718ebf"],
Cell[374555, 9730, 7618, 190, 764, "Input",ExpressionUUID->"a9c9ed31-a529-4520-a1b8-61bc2fe52e0d"],
Cell[382176, 9922, 1087, 26, 111, "Input",ExpressionUUID->"94ab9ce3-6898-4f95-89ab-07e69c173b04"],
Cell[383266, 9950, 243, 6, 29, "Input",ExpressionUUID->"c636c822-1ce9-4cfc-9473-d9610df3f5e4"],
Cell[383512, 9958, 30612, 714, 2398, "Input",ExpressionUUID->"0da7dea1-4882-4392-95d7-116fd1685405"],
Cell[414127, 10674, 372, 10, 29, "Input",ExpressionUUID->"339b01cd-7a0e-4456-8967-227eaada260e"],
Cell[414502, 10686, 275, 7, 29, "Input",ExpressionUUID->"ad955560-206e-489d-90ca-0a1f6b88528b"],
Cell[414780, 10695, 252, 6, 29, "Input",ExpressionUUID->"45e28b03-a87f-425b-b834-0f9eb83e2b69"],
Cell[415035, 10703, 998, 29, 49, "Input",ExpressionUUID->"6821d560-b3df-4ba5-8efe-46f81b6e305c"],
Cell[416036, 10734, 1412, 35, 315, "Input",ExpressionUUID->"de6f432b-400c-4584-a55d-2bb460278132"]
}, Closed]],
Cell[CellGroupData[{
Cell[417485, 10774, 127, 0, 37, "Subsection",ExpressionUUID->"1fef1a62-1bee-4e55-8de9-5c03fbd17437"],
Cell[417615, 10776, 2793, 69, 241, "Input",ExpressionUUID->"f029c5f6-a58b-45e2-9a45-0fffa302d16f"],
Cell[420411, 10847, 250, 6, 30, "Input",ExpressionUUID->"984a0d28-2d39-4bee-9c20-1873556c6db4"],
Cell[420664, 10855, 6662, 182, 577, "Input",ExpressionUUID->"ad7f33bf-d5d6-454f-a195-0f0f6f1efe4e"]
}, Closed]],
Cell[CellGroupData[{
Cell[427363, 11042, 98, 0, 37, "Subsection",ExpressionUUID->"e9a23d0f-9af1-4728-a4dc-db6a2a5e560a"],
Cell[427464, 11044, 692, 21, 29, "Input",ExpressionUUID->"4b280d66-37f3-49c8-92cc-90f2e37021a8"],
Cell[428159, 11067, 243, 6, 29, "Input",ExpressionUUID->"a67fb2a0-c713-4d1c-8544-a073553aebc7"],
Cell[428405, 11075, 4829, 130, 458, "Input",ExpressionUUID->"5658b021-4253-45cd-b487-703a6755b272"],
Cell[433237, 11207, 460, 14, 29, "Input",ExpressionUUID->"e18076c5-fe0c-4a28-8e78-0bb53a849f5b"],
Cell[433700, 11223, 243, 6, 29, "Input",ExpressionUUID->"d75d5ec6-69b9-4c45-a2ca-f1f05ea3ee71"],
Cell[433946, 11231, 2473, 72, 213, "Input",ExpressionUUID->"9f370f67-58fc-48d5-adde-71efebde4ac1"]
}, Closed]],
Cell[CellGroupData[{
Cell[436456, 11308, 95, 0, 37, "Subsection",ExpressionUUID->"bf7cdfd6-759c-4379-8a6a-5c159ed8e178"],
Cell[436554, 11310, 1581, 38, 220, "Input",ExpressionUUID->"a497e8fe-d02c-48ec-a15d-e4516f6e093a"],
Cell[438138, 11350, 1030, 28, 115, "Input",ExpressionUUID->"090ca9ff-1271-4124-9ec9-fad59377cd15"]
}, Closed]],
Cell[CellGroupData[{
Cell[439205, 11383, 110, 0, 37, "Subsection",ExpressionUUID->"a58829b7-5bec-4c37-86e2-b07db9b6a8c7"],
Cell[439318, 11385, 730, 14, 111, "Input",ExpressionUUID->"066797e6-7617-4be1-b819-a85f8ee7cd33"],
Cell[440051, 11401, 240, 6, 29, "Input",ExpressionUUID->"ae63799d-73a3-4c24-8c5f-8795feec6a2c"],
Cell[440294, 11409, 305, 7, 29, "Input",ExpressionUUID->"254123e6-2e38-4244-803e-d05dfd7be3f1"],
Cell[440602, 11418, 326, 8, 29, "Input",ExpressionUUID->"1d83b47a-1a0f-43f2-b79b-16f6ca06416f"],
Cell[440931, 11428, 364, 8, 29, "Input",ExpressionUUID->"a0238a88-0abc-44ef-a186-332a15b94f99"],
Cell[441298, 11438, 728, 20, 49, "Input",ExpressionUUID->"e6621061-e612-441f-8950-2d0b83f1e11a"],
Cell[442029, 11460, 8014, 204, 989, "Input",ExpressionUUID->"158ddd97-dc73-494b-bc3f-453aa51e56bb"]
}, Closed]],
Cell[CellGroupData[{
Cell[450080, 11669, 108, 0, 37, "Subsection",ExpressionUUID->"4fa7fb88-463f-4e8a-a0c4-ad655acd70c6"],
Cell[450191, 11671, 2888, 66, 409, "Input",ExpressionUUID->"ae979baa-29ac-4e16-a603-a3ce9ddb224c"],
Cell[453082, 11739, 265, 7, 30, "Input",ExpressionUUID->"55f3220a-0bb6-4f4b-904a-a6f308bcf570"],
Cell[453350, 11748, 1432, 37, 178, "Input",ExpressionUUID->"0c88a93b-cfee-4e3f-8c07-2cbee9f10b9c"],
Cell[454785, 11787, 852, 15, 94, "Input",ExpressionUUID->"94fde1d2-969a-4662-9f52-f158eb9a1e53"],
Cell[455640, 11804, 580, 19, 30, "Input",ExpressionUUID->"98cb7e39-c79d-44fd-a04e-5fea102ecf97"],
Cell[456223, 11825, 722, 23, 30, "Input",ExpressionUUID->"d824d05d-b5e5-46aa-ada0-149a3a11b972"],
Cell[456948, 11850, 824, 26, 52, "Input",ExpressionUUID->"d8d85e3f-9729-4adb-b930-9645e287d41f"],
Cell[457775, 11878, 796, 25, 52, "Input",ExpressionUUID->"c09dec9c-18c3-4f44-a5c9-f8f965e4bca1"],
Cell[458574, 11905, 662, 21, 30, "Input",ExpressionUUID->"f4ba78b0-e0d0-4e7d-b0ce-a5d960825dea"],
Cell[459239, 11928, 1225, 38, 73, "Input",ExpressionUUID->"e62a4def-6f2a-4663-a73d-6183778abc58"],
Cell[460467, 11968, 992, 31, 52, "Input",ExpressionUUID->"f1d79e6b-4a6f-4325-85d8-c103905e88b9"],
Cell[461462, 12001, 966, 30, 52, "Input",ExpressionUUID->"f1bf46ca-9ba7-454c-a398-ac4e4739adf2"],
Cell[462431, 12033, 1094, 30, 94, "Input",ExpressionUUID->"9117032d-d232-486b-930e-e75e99d213b2"],
Cell[463528, 12065, 1066, 29, 94, "Input",ExpressionUUID->"2e93ba70-c822-4313-b6da-a9d34aa44987"],
Cell[464597, 12096, 1657, 50, 73, "Input",ExpressionUUID->"ce65e250-000e-41a4-85c1-5acb41a83256"],
Cell[466257, 12148, 787, 24, 52, "Input",ExpressionUUID->"d6d41433-9a21-4623-a76e-4e44f34cb2f2"],
Cell[467047, 12174, 787, 24, 52, "Input",ExpressionUUID->"d67bd52e-1801-4717-87e6-08a4d4c91d5a"],
Cell[467837, 12200, 1065, 33, 73, "Input",ExpressionUUID->"8a9995d3-5bda-4e6d-b5bb-536d88f2eb15"],
Cell[468905, 12235, 1336, 40, 73, "Input",ExpressionUUID->"37fb40ca-4f22-486c-894d-bf056ad210eb"],
Cell[470244, 12277, 1629, 49, 73, "Input",ExpressionUUID->"8c38de81-7957-466f-8f63-c3871af07cca"],
Cell[471876, 12328, 1773, 49, 94, "Input",ExpressionUUID->"7b789337-ec63-4e86-9955-02a6d6355f86"],
Cell[473652, 12379, 1966, 57, 115, "Input",ExpressionUUID->"2b5c9655-f030-4457-a2cf-d3770d68d107"],
Cell[475621, 12438, 828, 25, 52, "Input",ExpressionUUID->"0da553e0-c923-4c96-a1ab-15b6be72d76b"],
Cell[476452, 12465, 828, 25, 52, "Input",ExpressionUUID->"2e27ea3f-b5c0-424f-8762-397ff92c9df4"],
Cell[477283, 12492, 828, 25, 52, "Input",ExpressionUUID->"1d134ce0-0e26-4529-8d40-f9622a93d159"],
Cell[478114, 12519, 1746, 52, 94, "Input",ExpressionUUID->"9446acdf-3f36-48d2-8dd8-3b5399435734"],
Cell[479863, 12573, 1166, 36, 94, "Input",ExpressionUUID->"14d881ae-dd52-4a2e-a097-3d438548ac1f"],
Cell[481032, 12611, 2353, 66, 136, "Input",ExpressionUUID->"e481dc4e-bf5e-4ae1-999d-01e835a3a882"],
Cell[483388, 12679, 10955, 293, 1459, "Input",ExpressionUUID->"36050feb-f82b-416b-b064-b396c3c6c023"]
}, Closed]],
Cell[CellGroupData[{
Cell[494380, 12977, 118, 0, 37, "Subsection",ExpressionUUID->"9ff9de12-e275-4622-984f-a1bd760c4a27"],
Cell[494501, 12979, 284, 6, 30, "Input",ExpressionUUID->"a1a0abc0-3279-4c35-bc99-aeb1e32dfae7"],
Cell[494788, 12987, 245, 6, 30, "Input",ExpressionUUID->"b632ae6f-fef1-4c32-9760-7f2e06adee8e"],
Cell[495036, 12995, 231, 6, 30, "Input",ExpressionUUID->"e935bfe3-9b6f-4fe8-9a32-121b3b74b096"],
Cell[495270, 13003, 254, 6, 30, "Input",ExpressionUUID->"a8600ff4-82e0-43f2-98a9-41008cae72e2"],
Cell[495527, 13011, 4331, 100, 577, "Input",ExpressionUUID->"23f9a6ce-73cb-4847-90ff-92794e4702d9"],
Cell[499861, 13113, 367, 9, 52, "Input",ExpressionUUID->"e98f44b7-c926-446c-9b97-e95f83c94dec"],
Cell[500231, 13124, 303, 8, 30, "Input",ExpressionUUID->"66fe5287-6619-45d4-871a-858a3a4bf924"],
Cell[500537, 13134, 244, 6, 30, "Input",ExpressionUUID->"2724221a-1c1f-448d-b428-c324b2e0b32e"],
Cell[500784, 13142, 234, 6, 30, "Input",ExpressionUUID->"3d622b06-4fd5-4f7b-841b-4df41fbb3e52"],
Cell[501021, 13150, 3869, 104, 451, "Input",ExpressionUUID->"d42e64e0-f07d-4a76-8ec5-8737baf265bc"],
Cell[504893, 13256, 233, 6, 30, "Input",ExpressionUUID->"a4d93875-c3ee-4286-b93e-5db6ebc5771a"],
Cell[505129, 13264, 4338, 114, 535, "Input",ExpressionUUID->"5f7cff2c-9c13-41ec-ab9d-9ac82ea81db5"],
Cell[509470, 13380, 233, 6, 30, "Input",ExpressionUUID->"951a930e-b574-4baa-b39d-b026647d1b08"],
Cell[509706, 13388, 4348, 114, 535, "Input",ExpressionUUID->"0fdde769-6829-456d-9e6e-7a74b428a6a6"],
Cell[514057, 13504, 247, 6, 30, "Input",ExpressionUUID->"081f1287-8da8-4d64-94a6-d4bb254c1748"],
Cell[514307, 13512, 5119, 133, 577, "Input",ExpressionUUID->"5806273f-f47a-4de8-ad82-04fca3c4282e"],
Cell[519429, 13647, 282, 6, 30, "Input",ExpressionUUID->"57a087cf-a11a-4d42-b9b5-016e3a9f24bd"],
Cell[519714, 13655, 245, 6, 30, "Input",ExpressionUUID->"bd2d0b15-9f27-4912-b91b-5723660040d3"],
Cell[519962, 13663, 6538, 166, 955, "Input",ExpressionUUID->"1feffed0-a06a-48d6-9576-eb3d91d3672e"],
Cell[526503, 13831, 322, 7, 30, "Input",ExpressionUUID->"be49d4d3-25c6-48b8-a412-3fc5ef8837ea"],
Cell[526828, 13840, 2300, 55, 367, "Input",ExpressionUUID->"fe7e9100-9030-44c9-9df0-d23f7135279d"],
Cell[529131, 13897, 704, 14, 94, "Input",ExpressionUUID->"cb535d18-784e-43c3-9fd9-25dfc9bd1af0"],
Cell[529838, 13913, 256, 6, 30, "Input",ExpressionUUID->"432ab1cf-b458-4cba-91aa-2c43f6765508"],
Cell[530097, 13921, 3705, 94, 535, "Input",ExpressionUUID->"6fc4fc18-8661-4129-b385-fd155daed6e9"],
Cell[533805, 14017, 201, 5, 30, "Input",ExpressionUUID->"3cabbe10-9e96-4502-83da-5c2a5df7e0ee"],
Cell[534009, 14024, 1842, 45, 283, "Input",ExpressionUUID->"16b60ad4-6251-44f0-8708-cced9dc523b5"],
Cell[535854, 14071, 233, 5, 30, "Input",ExpressionUUID->"25200332-7b5f-4f6c-bd3b-330847814e4e"],
Cell[536090, 14078, 227, 6, 30, "Input",ExpressionUUID->"9bde51de-6249-4941-8be5-3cf55719495d"],
Cell[536320, 14086, 269, 7, 52, "Input",ExpressionUUID->"50a8b0d2-4bac-425b-84f9-74a83001dd33"],
Cell[536592, 14095, 2528, 63, 367, "Input",ExpressionUUID->"c73b28f3-d92c-43f4-9da3-053ae552cc68"],
Cell[539123, 14160, 186, 4, 30, "Input",ExpressionUUID->"f1f6f886-3249-4c2e-99e8-43f92e7b8394"],
Cell[539312, 14166, 427, 11, 52, "Input",ExpressionUUID->"3f87d900-205e-4cd8-94f5-5ca3d07abba1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[539788, 14183, 108, 0, 52, "Section",ExpressionUUID->"38c5edb0-f22d-4b8a-b939-13401b0d21f2"],
Cell[CellGroupData[{
Cell[539921, 14187, 103, 0, 54, "Subsection",ExpressionUUID->"4d01af77-182f-4a36-906c-9914e3ab7f43"],
Cell[540027, 14189, 306, 8, 30, "Input",ExpressionUUID->"0c22de8f-e887-4716-8e7b-4fa1642b64a1"],
Cell[540336, 14199, 303, 8, 30, "Input",ExpressionUUID->"ebf861f5-ce58-427b-b570-0a59dd274bf2"],
Cell[540642, 14209, 1672, 46, 178, "Input",ExpressionUUID->"d363d95a-da64-48cc-bb58-45abe64c42c5"],
Cell[542317, 14257, 400, 11, 30, "Input",ExpressionUUID->"22f86a06-625e-427a-b31f-2fb1f6c0bd94"],
Cell[542720, 14270, 423, 12, 30, "Input",ExpressionUUID->"b56caf6d-54f3-4bcc-9b34-c6378e668d33"]
}, Closed]],
Cell[CellGroupData[{
Cell[543180, 14287, 91, 0, 38, "Subsection",ExpressionUUID->"61e6778d-9426-4d0a-95d7-772a171e8902"],
Cell[543274, 14289, 301, 7, 30, "Input",ExpressionUUID->"a604f8c8-27b9-4474-ad41-b4b9756af7ba"],
Cell[543578, 14298, 14219, 357, 1186, "Input",ExpressionUUID->"0a37642f-bd68-4e10-a51f-0dbc9a4b1534"],
Cell[557800, 14657, 306, 8, 30, "Input",ExpressionUUID->"23ce16ea-d711-4fde-b673-015b9db28f44"],
Cell[558109, 14667, 719, 20, 94, "Input",ExpressionUUID->"b4646f41-24ea-4e6d-bd68-1d60ebeaffa0"],
Cell[558831, 14689, 212, 5, 30, "Input",ExpressionUUID->"46338d8c-308a-4500-9057-d19cef7e1f66"],
Cell[559046, 14696, 771, 21, 94, "Input",ExpressionUUID->"7ff8742d-782a-4da2-beb7-2087b1e2e21d"],
Cell[559820, 14719, 389, 10, 52, "Input",ExpressionUUID->"b6f47789-f8c2-4444-ae91-ffac31191e83"],
Cell[560212, 14731, 409, 10, 52, "Input",ExpressionUUID->"5e3451ad-8e9a-4de3-be1f-13687e59cf23"],
Cell[560624, 14743, 216, 5, 30, "Input",ExpressionUUID->"f5dcd693-fe22-4c46-bdf0-1a9cc4aa6305"],
Cell[560843, 14750, 1258, 33, 157, "Input",ExpressionUUID->"7e55b874-dc95-4f09-ae88-37cbf907f787"],
Cell[562104, 14785, 461, 12, 52, "Input",ExpressionUUID->"e3365157-dbea-49ca-a3fd-54eb42471e6a"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[562614, 14803, 80, 0, 52, "Section",ExpressionUUID->"8e26b579-42e9-4abc-8457-afb8130ab87b"],
Cell[CellGroupData[{
Cell[562719, 14807, 102, 0, 53, "Subsection",ExpressionUUID->"be2fadc7-d923-4a18-ba47-eb45723d728e"],
Cell[562824, 14809, 2606, 69, 262, "Input",ExpressionUUID->"22a472fe-004b-46bf-83b1-06165ffb63cc"]
}, Closed]],
Cell[CellGroupData[{
Cell[565467, 14883, 99, 0, 37, "Subsection",ExpressionUUID->"91b5e1c3-4890-4bc3-887c-626a8e063d09"],
Cell[565569, 14885, 482, 13, 265, "Text",ExpressionUUID->"f3419617-d081-419e-906b-6c4518442d18"],
Cell[566054, 14900, 1715, 37, 493, "Input",ExpressionUUID->"ca693b36-6757-41a8-862b-334678f3e16e"],
Cell[567772, 14939, 33439, 782, 3307, "Input",ExpressionUUID->"fd836170-ace4-4977-b283-3a8a2e2489bf"],
Cell[601214, 15723, 246, 6, 30, "Input",ExpressionUUID->"b6a7336f-bab3-4ed3-b3d9-292139ddaf74"],
Cell[601463, 15731, 5068, 117, 787, "Input",ExpressionUUID->"d30ce26b-4b2a-40ca-b3de-ba29c8797a7e"]
}, Closed]],
Cell[CellGroupData[{
Cell[606568, 15853, 109, 0, 37, "Subsection",ExpressionUUID->"343cd271-6fdd-4ff9-9760-4a033effdc1b"],
Cell[606680, 15855, 255, 6, 30, "Input",ExpressionUUID->"4f386e66-6f3a-47fe-94fe-0351e7afbfcb"],
Cell[606938, 15863, 421, 12, 30, "Input",ExpressionUUID->"a04460cb-441a-4338-82c7-4add62c778fb"],
Cell[607362, 15877, 1697, 44, 157, "Input",ExpressionUUID->"dec9fdb4-ae85-4604-9c64-2c3aa5fdd0fe"],
Cell[609062, 15923, 8625, 201, 1186, "Input",ExpressionUUID->"8d8a9232-302e-4240-9cea-34558b3f4daf"]
}, Closed]],
Cell[CellGroupData[{
Cell[617724, 16129, 99, 0, 37, "Subsection",ExpressionUUID->"4cf77788-d94b-4e4f-b94e-5447cc5ce014"],
Cell[617826, 16131, 10270, 248, 1030, "Input",ExpressionUUID->"0bd5c038-8d1f-400a-a38b-4ea10047c3ad"],
Cell[628099, 16381, 9938, 250, 989, "Input",ExpressionUUID->"1e2b6326-d25f-482a-97a7-4077239b1f8e"],
Cell[638040, 16633, 373, 8, 49, "Input",ExpressionUUID->"29e27c78-46ae-4171-a87e-8b6989267cd2"],
Cell[638416, 16643, 251, 6, 29, "Input",ExpressionUUID->"a5cdf590-5fcc-471c-b2eb-6a67d3a84fa2"],
Cell[638670, 16651, 1809, 46, 254, "Input",ExpressionUUID->"a7a02248-9d9c-49ec-9469-94beb4f12920"],
Cell[640482, 16699, 350, 8, 49, "Input",ExpressionUUID->"33d8e148-9f11-42d4-97a0-f2380be387b3"],
Cell[640835, 16709, 379, 10, 49, "Input",ExpressionUUID->"cb58f0eb-15b4-41fe-aaf0-55041d8e6e1f"]
}, Closed]],
Cell[CellGroupData[{
Cell[641251, 16724, 107, 0, 37, "Subsection",ExpressionUUID->"c8df0747-c76d-4dab-9b61-a700a4594f5c"],
Cell[641361, 16726, 9851, 237, 997, "Input",ExpressionUUID->"a27209c5-cb5e-4e49-88f4-0cf058203245"],
Cell[651215, 16965, 10230, 251, 1039, "Input",ExpressionUUID->"e6bdcb9d-0277-4705-a46b-76902c113f8a"],
Cell[661448, 17218, 252, 6, 104, "Text",ExpressionUUID->"660c61e6-1d9a-40e6-b464-deb42fcc63a8"]
}, Closed]],
Cell[CellGroupData[{
Cell[661737, 17229, 125, 0, 37, "Subsection",ExpressionUUID->"9390a1fb-98de-47ee-83df-b37ac0bb8966"],
Cell[661865, 17231, 617, 15, 73, "Input",ExpressionUUID->"216044b9-a644-4a06-95ea-9b24527d8c50"],
Cell[662485, 17248, 8075, 202, 1018, "Input",ExpressionUUID->"b7c71e1f-c6d4-442b-a298-75e0d13d2e4c"],
Cell[670563, 17452, 18875, 492, 1312, "Input",ExpressionUUID->"134f4c62-8155-4968-8f53-80aec1451133"],
Cell[689441, 17946, 417, 10, 52, "Input",ExpressionUUID->"9d1a9e70-15c2-4fe5-9f00-4c8b01f9bb27"]
}, Closed]],
Cell[CellGroupData[{
Cell[689895, 17961, 88, 0, 37, "Subsection",ExpressionUUID->"c819683d-4ed6-49ce-ad93-42fd316b039c"],
Cell[689986, 17963, 677, 15, 288, "Text",ExpressionUUID->"0672b63e-54ac-45b4-a11e-07c664cdf020"],
Cell[690666, 17980, 1933, 52, 220, "Input",ExpressionUUID->"897330e0-122e-4549-92a3-082ef448caa2"],
Cell[692602, 18034, 2657, 70, 283, "Input",ExpressionUUID->"c358a9f0-a7ac-41f3-b95c-2e792fe40e1d"],
Cell[695262, 18106, 255, 4, 81, "Text",ExpressionUUID->"f09fa140-cd92-4ab7-ab5b-7ea4fe2f0319"],
Cell[695520, 18112, 4104, 113, 283, "Input",ExpressionUUID->"946f2ff5-23b3-40c8-80fa-0b267b27b034"],
Cell[699627, 18227, 189, 3, 58, "Text",ExpressionUUID->"ea64c051-b2ce-4a37-bfb3-e102e3614ce0"],
Cell[699819, 18232, 2276, 65, 178, "Input",ExpressionUUID->"785ad652-f985-431a-b80e-c7533e190629"],
Cell[702098, 18299, 188, 3, 58, "Text",ExpressionUUID->"142b6648-b17c-4cfd-8c0e-2c6d5c3658b8"],
Cell[702289, 18304, 2105, 60, 178, "Input",ExpressionUUID->"5095e615-48d9-4108-bb5d-447fd71624ae"],
Cell[704397, 18366, 151, 2, 35, "Text",ExpressionUUID->"bbe91836-fd86-41a1-954b-b021ed5505d7"],
Cell[704551, 18370, 2761, 79, 199, "Input",ExpressionUUID->"610a9176-ecc8-43af-a21e-57d2011272f9"],
Cell[707315, 18451, 194, 4, 30, "Input",ExpressionUUID->"7a06e26b-cc8f-418b-acef-1b2f92515230"],
Cell[707512, 18457, 127, 0, 35, "Text",ExpressionUUID->"991026a8-e1f1-43a8-9dd0-26391abc3e39"],
Cell[707642, 18459, 1542, 46, 136, "Input",ExpressionUUID->"2e6a3f07-a9e6-4b29-8932-a9448be88737"],
Cell[709187, 18507, 213, 3, 58, "Text",ExpressionUUID->"5b8906a6-6715-41b9-a2bb-d6faca076c1a"],
Cell[709403, 18512, 2029, 54, 157, "Input",ExpressionUUID->"cc91309a-c010-4cea-b81f-0c09691967bf"],
Cell[711435, 18568, 466, 9, 196, "Text",ExpressionUUID->"dec90094-3435-4743-b405-2752efb5e649"],
Cell[711904, 18579, 1895, 45, 451, "Input",ExpressionUUID->"2713ef7e-b1eb-40df-9e9f-c692be85c2b2"],
Cell[713802, 18626, 1461, 36, 241, "Input",ExpressionUUID->"583eb8db-9fe5-4a21-94bd-0af8901fa1f3"],
Cell[715266, 18664, 548, 17, 52, "Input",ExpressionUUID->"c28f64dc-91fa-4df1-8156-a7bb42dcdc3d"],
Cell[715817, 18683, 379, 11, 30, "Input",ExpressionUUID->"05578406-7b98-4616-83db-9cf6d0b44c1e"],
Cell[716199, 18696, 310, 8, 30, "Input",ExpressionUUID->"a633337b-9cb0-4891-81cd-e50ec77b6ff5"],
Cell[716512, 18706, 297, 8, 30, "Input",ExpressionUUID->"daaa4a77-eafb-463c-af2f-d140171974d5"],
Cell[716812, 18716, 2933, 71, 367, "Input",ExpressionUUID->"6e8b617c-4e12-4210-b681-50c1223d8381"]
}, Closed]],
Cell[CellGroupData[{
Cell[719782, 18792, 100, 0, 37, "Subsection",ExpressionUUID->"b6b16afb-ebd1-468c-bee9-d1df428eda26"],
Cell[719885, 18794, 583, 14, 73, "Input",ExpressionUUID->"daad876f-26b4-41e3-8fc5-05cbad49bf85"],
Cell[720471, 18810, 5110, 119, 850, "Input",ExpressionUUID->"e92a1870-98fa-4f64-9a67-cd7b77b3c79c"],
Cell[725584, 18931, 554, 12, 73, "Input",ExpressionUUID->"09ee201e-f569-46e8-9e65-7b3340202473"],
Cell[726141, 18945, 2461, 70, 241, "Input",ExpressionUUID->"2c083807-3643-407a-bd56-8cfcee0aa386"],
Cell[728605, 19017, 408, 10, 52, "Input",ExpressionUUID->"f0fa4ef5-10ab-4c0f-b92a-5fd05bd4a15d"],
Cell[729016, 19029, 403, 11, 30, "Input",ExpressionUUID->"23a2249c-dca7-4cb2-93ad-828819550da7"],
Cell[729422, 19042, 470, 12, 52, "Input",ExpressionUUID->"0794b3c2-57ad-41bc-8492-139df134653f"],
Cell[729895, 19056, 366, 9, 30, "Input",ExpressionUUID->"b7605a61-18f0-4839-8720-1c1ece8b4611"],
Cell[730264, 19067, 15431, 369, 1606, "Input",ExpressionUUID->"34903a51-55a0-4ccd-b4bb-44b0f2cbb551"]
}, Closed]],
Cell[CellGroupData[{
Cell[745732, 19441, 103, 0, 37, "Subsection",ExpressionUUID->"27a33b38-e8c3-45b7-be63-7329f05c9d5f"],
Cell[745838, 19443, 370, 11, 219, "Text",ExpressionUUID->"5ba6f4fd-91f8-4979-9208-60a928963606"],
Cell[746211, 19456, 263, 6, 30, "Input",ExpressionUUID->"c05bed70-85a2-4058-ae70-94deb5256fd2"],
Cell[746477, 19464, 2170, 57, 241, "Input",ExpressionUUID->"138e3433-3042-4519-8085-6948ac8c24fd"],
Cell[748650, 19523, 846, 25, 52, "Input",ExpressionUUID->"73befcc2-7faf-49e7-8b82-881c4fe38259"],
Cell[749499, 19550, 2400, 81, 157, "Input",ExpressionUUID->"ef59e8d3-a58b-433c-b9fc-e889a0ef3a4d"],
Cell[751902, 19633, 573, 12, 73, "Input",ExpressionUUID->"e7c508a3-8083-403e-b5d1-0bc546a22dc6"],
Cell[752478, 19647, 15586, 396, 1312, "Input",ExpressionUUID->"27aa4c3b-780c-4eac-bc5b-a9ed660c7d84"],
Cell[768067, 20045, 4814, 113, 703, "Input",ExpressionUUID->"d1bc8d18-2c21-41aa-b648-f9c1664fb3dc"],
Cell[772884, 20160, 393, 10, 52, "Input",ExpressionUUID->"4349681c-9b4c-40a1-aad8-bd7c21a01bf4"],
Cell[773280, 20172, 12040, 316, 1081, "Input",ExpressionUUID->"206b2d3d-5d48-4a38-969c-548d4c73b28b"],
Cell[785323, 20490, 293, 7, 30, "Input",ExpressionUUID->"aa6941fb-9fa2-4084-9cd4-0bf97656874c"]
}, Closed]],
Cell[CellGroupData[{
Cell[785653, 20502, 97, 0, 37, "Subsection",ExpressionUUID->"0093ff9e-c8d8-44ca-897f-885ec92c2fea"],
Cell[785753, 20504, 582, 14, 73, "Input",ExpressionUUID->"66f750dc-e038-4811-846d-3c307033620a"],
Cell[786338, 20520, 2644, 63, 367, "Input",ExpressionUUID->"c7a11204-1bf0-4596-b6f0-1a9cb6ea6bfd"],
Cell[788985, 20585, 722, 18, 115, "Input",ExpressionUUID->"e6bd587b-f548-4ef8-814b-14237046a7e8"],
Cell[789710, 20605, 551, 13, 73, "Input",ExpressionUUID->"31d4451e-1b72-4af0-9bbb-ae0315b56d96"],
Cell[790264, 20620, 2087, 54, 262, "Input",ExpressionUUID->"fe93e790-2918-4b17-b355-56d94e30b948"],
Cell[792354, 20676, 764, 18, 73, "Input",ExpressionUUID->"1e49fb69-0f93-4b38-aef5-f5315ed1aac8"],
Cell[793121, 20696, 893, 22, 136, "Input",ExpressionUUID->"b413d89e-5cb1-4be7-ad8f-22c28476d0d8"],
Cell[794017, 20720, 463, 12, 52, "Input",ExpressionUUID->"9e7af1f1-fee2-41f7-901d-764c1fae7739"],
Cell[794483, 20734, 321, 9, 30, "Input",ExpressionUUID->"479cda9b-8a81-4eff-9be0-2b5ea7de6fa6"],
Cell[794807, 20745, 659, 14, 94, "Input",ExpressionUUID->"615f2545-f19b-46a4-a891-d26e43f00c6e"],
Cell[795469, 20761, 371, 9, 52, "Input",ExpressionUUID->"b68ff109-febf-4957-9c46-74b76f7beed5"],
Cell[795843, 20772, 976, 24, 136, "Input",ExpressionUUID->"7309f9fd-85da-4303-825b-1c910841a01d"],
Cell[796822, 20798, 373, 9, 52, "Input",ExpressionUUID->"bfc5ab94-7542-4696-b488-ee6ad6a3ee5d"],
Cell[797198, 20809, 720, 18, 94, "Input",ExpressionUUID->"c751c1c4-4b1a-4c40-a338-78b40df2b8df"]
}, Closed]]
}, Closed]]
}
]
*)

