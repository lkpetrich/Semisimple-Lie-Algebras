(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    832179,      21529]
NotebookOptionsPosition[    812247,      21017]
NotebookOutlinePosition[    812654,      21035]
CellTagsIndexPosition[    812611,      21032]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Introduction", "Section"],

Cell[TextData[{
 "For doing semisimple Lie algebras, their representations, and their \
decompositions. Important for particle physics.\n\nAlgebras are {family, n}, \
where family is\n 1: A(n) - SU(n+1)\n 2: B(n) - SO(2n+1)\n 3: C(n) - Sp(2n)\n \
4: D(n) - SO(2n)\n 5: E(n) - n = 6, 7, 8 (3, 4, 5 reduce to other algebras)\n \
6: F(n) - n = 4\n 7: G(n) - n = 2\n \nIsomorphisms:\nU(1) ~ SO(2)\nA(1) ~ \
B(1) ~ C(1) / SU(2) ~ SO(3) ~ Sp(2)\nB(2) ~ C(2) / SO(5) ~ Sp(4)\nD(2) ~ A(1) \
* A(1) / SO(4) ~ SU(2) * SU(2)\nD(3) ~ A(3) / SO(6) ~ SU(4)\nE(3) ~ A(2) * \
A(1) / SU(3) * SU(2)\nE(4) ~ A(4) / SU(5)\nE(5) ~ D(5) / SO(10)\n  \nObject \
and data formats:\n\nDynkin diagram: {lengths of roots, connections}\n\
Connections: {first root, second root, strength}\n\nLie algebra: implemented \
as a function with text-string args with various algebra properties as \
values. Thus, for an algebra labeled with \"la\", la[\"type\"] returns the \
type. Args and their values:\n\ntype -- {family, rank or Cartan dimension}\n\
name -- more usual. Will be \"Invalid type\" if the type is not valid\n\
special -- list of special irreps in the form {name, highest-weight vector}. \
Names like singlet, adjoint, fundamental, vector, spinor, ...\ndynkin -- \
Dynkin diagram\nmetric -- algebra metric\nctnmat -- Cartan matrix\ninvmet -- \
inverse of algebra metric\ninvctn -- inverse of Cartan matrix\nposroots -- \
positive root vectors\n\nTo find a Lie algebra to be labeled \"la\" from the \
type:\nMakeLieAlgebra[la_, type_]\nReturns whether the algebra is a \
legitimate one (True or False)\n\nTo get a cached Lie algebra, do\n\
GetLieAlgebra[type_] \nIt returns the algebra with this label: \
LieAlgebraCache[type]\n\nThe rest of the code uses cached algebras \
exclusively.\n\nAn algebra\[CloseCurlyQuote]s dimension (number of \
generators): AlgDimension[type_]\n\n\nTo calculate the degeneracies, root \
vectors, and weight vectors of irreps (irreducible representations), take the \
Lie-algebra label and the highest-weight vector maxwts and do\n\
GetRep[type_,maxwts_]\n\nTo calculate an irrep\[CloseCurlyQuote]s Weyl-orbit \
composition in that format, do\nGetRepOrbits[type_,maxwts_]\n\nTo calculate a \
Weyl orbit in this format, minus the degeneracy, do\nGetOrbit[type_,maxwts_]\n\
\nYou can get some stats on the orbit at\nWeylOrbitStats[type_,maxwts_]\nIt \
returns the max-root vector, the max-weight vector, the length of the orbit, \
and the length of the roots (root.metric.root).\n\nFor a list of irreps, \
specified as a list of max-weight vectors. It produces the same kind of \
output as GetRep[].\nGetRepList[type_,mwlist_]\n\nFor a counted list of \
irreps, specified as a list of {count, max-weight vector}. It produces the \
same kind of output as GetRep[].\nGetRepCntdList[type_,mwclist_]\n\nFor a \
general rep argument, specified with \"type\". The type is \"sngl\" for a \
single irrep, \"list\" for a list of irreps, and \"cntd\" for a counted list \
of irreps.\nGetRepXtnd[type_,type_,maxwts_]\n\nThese are for representations \
for algebra products. Their algebra arg is {la1, la2, ...}, while their \
irreps are {mw1, mw2, ...,u1,u2, ...}. mw1 is the max weights for algebra \
la1, mw2 is the max weights for algebra la2, and u1, u2, are additional U(1) \
factors. The root vectors are {r1, r2, ..., u1, u2, ...} and the weight \
vectors are {w1, w2, ..., u1, u2, ...}, where r1 and w1 are for la1 and mw2, \
etc.\nGetAlgProdRep[type_,maxwts_]\n\nFor each rep\[CloseCurlyQuote]s orbits, \
like GetRepOrbits[] but in the format of GetAlgProdRep[]:\n\
GetAlgProdRepOrbits[type_,maxwts_]\n\nFor a list of algebra-product irreps. \
Output is in the format of GetAlgProdRep[].\nGetAlgProdRepList[type_,mwlist_]\
\n\nFor a counted list of algebra-product irreps. Output is in the format of \
GetAlgProdRep[].\nGetAlgProdRepCntdList[type_,mwclist_]\n\nFor a general rep \
argument, specified with \"type\". The type is \"sngl\" for a single irrep, \
\"list\" for a list of irreps, and \"cntd\" for a counted list of irreps.\n\
GetAlgProdRepXtnd[typelist_,type_,maxwts_]\n\nAdds up the degeneracies to \
find the total degeneracy (multiplicity)\nTotalDegenOfExpRep[x_] \n\nUses \
Weyl's celebrated formula; it's much faster than calculating an irrep's \
root/weight vectors\nTotalDegen[type_,maxwts_] \nGeneralized:\n\
TotalDegenXtnd[type_,type_,maxwts_]\nAlgProdTotalDegen[typelist_,maxwts_]\n\
AlgProdTotalDegenXtnd[typelist_,type_,maxwts_]\n\nRepProperties[type_, \
maxwts_] gives whether self-conjugate (yes: 1, no: 0), the moduli for the \
congruency-class quantities, and those quantities themselves (parity, \
triality, etc.) The quantities are additive modulo those moduli.\n\n\nFor \
decomposing a product of two irreps into its irrep content, use their highest \
weights here. Makes a counted list of irreps, a list of {degeneracy, irrep \
highest weight}.\nDecomposeRepProduct[type_, maxwt1_, maxwt2_]\n\nFor more \
general types of highest weights, where  the types are:\"sngl\" is single \
one, \"list\" is a list, and \"cntd\" is a counted list.\n\
DecomposeRepProductXtnd[type_, type1_,maxwt1_,type2_, maxwt2_]\n\nUses an \
algebra product and highest weights consisting of a list of one for each \
algebra and U(1) factors\nDecomposeAlgProdRepProduct[typelist_, maxwt1_, \
maxwt2_]\n\nFor more general types of reps, as before\n\
DecomposeAlgProdRepProductXtnd[typelist_, type1_,maxwt1_,type2_, maxwt2_]\n\n\
Alternates: these do rep products only on single irreps of each algebra, \
instead of for all of them together. They give the same results, though with \
different performance.\nDecomposeRepProductXtndAlt[type_, \
type1_,maxwt1_,type2_, maxwt2_]\nDecomposeAlgProdRepProductAlt[typelist_, \
maxwt1_, maxwt2_]\nDecomposeAlgProdRepProductXtndAlt[typelist_, \
type1_,maxwt1_,type2_, maxwt2_]\n\nDecomposeRepProductVerify[type_, maxwt1_, \
maxwt2_]\nemits {{input hw vectors, output}, {degens of inputs, degens of \
outputs}, {total input degen, total output degen}}\n\n\
DecomposeRepProdList[type_, maxwtlist_] works on a list of irreps' highest \
weights.\n\n\nFor decomposing a rep power into parts with different \
symmetries for general positive-integer powers pwr. The symmetric part is the \
first part and the antisymmetric part is the last part, with (pwr - 2) mixed \
parts in between. Power = 1 returns {original}, and power = 0 return \
{scalar}.\nDecomposeRepPower[type_, maxwts_, pwr_]\n\nUses the highest-weight \
type system: \"sngl\", \"list\", \"cntd\" (counted list)\n\
DecomposeRepPowerXtnd[type_, type_,maxwts_, pwr_]\n\nFor algebra products\n\
DecomposeAlgProdRepPower[typelist_, maxwts_, pwr_]\n\nFor algebra products \
and weight types\nDecomposeAlgProdRepPowerXtnd[typelist_, type_,maxwts_, \
pwr_]\n\nFor verifying the a rep power; much like DecomposeRepProductVerify[]\
\nDecomposeRepPowerVerify[type_, maxwts_, pwr_]\n\nPure symmetric and \
antisymmetric cases: sym = +1 and -1\nThese are analogous to \
DecomposeRepListPower[type_, mwlist_, pwr_], etc.\n\n\
DecomposeRepPwrSym[type_, maxwts_, pwr_,sym_]\nDecomposeRepPwrSymXtnd[type_, \
type_,maxwts_, pwr_,sym_]\nDecomposeAlgProdRepPwrSym[typelist_, maxwts_, \
pwr_,sym_]\nDecomposeAlgProdRepPwrSymXtnd[typelist_, type_,maxwts_, \
pwr_,sym_]\n\n\nOne can find details on the symmetry types with the function\n\
GetTensorPowerYDX[pwr_]\nIt returns {diagram list, Kostka matrix, rep-nesting \
matrix}\n\nThe diagram list\[CloseCurlyQuote]s entries are {multiplicity in \
the power expansion, the diagram itself, the diagram\[CloseCurlyQuote]s \
length, a multinomial multiplicity factor}\nConvenience functions for \
extracting all of each type:\nYDGetMultiplicities[dgrmlist_]\n\
YDGetRepDiagrams[dgrmlist_]\nYDGetLengths[dgrmlist_]\n\
YDGetMultinomFacs[dgrmlist_]\n\nThe Kostka matrix is what Weyl orbits for \
each irrep of A(n), using the order of the diagram list.\n\nThe rep-nesting \
matrix: each rep\[CloseCurlyQuote]s numbers becomes a rep and one iterates \
over them.\nRow: index of starting rep, column: index of nested reps \
concatenated.\nAt each row and column, a list of entries:\nIndices of \
subreps, multiplicities of subreps, multinomial multiplicity factor.\nThe \
reps here are A(n) irreps or Young diagrams.\n\n\nBranching-rule generators \
are implemented as a label with args, with these values:\n\ntype -- type of \
algebra\nalg -- worked-out algebra\nu1s -- indices of roots that become U (1) \
factors; may be none\nsubtypes -- types of the subalgebras\nsubalgs -- \
worked-out subalgebras; each one is [\"subalgs\"][1], [\"subalgs\"][2], etc.\n\
submats -- projection matrices for finding subalgebra root vectors from \
original-algebra ones\n\nFor demoting a root to a U(1) factor.\nArgs: \
branching-generator label, algebra type, and index of root to demote\n\
MakeRootDemoter[ld_, type_, m_]\n\nListRootDemotions[type_] lists the \
possible root demotions for a type\n\nLike previous one, but with a list of \
roots\nMakeMultiRootDemoter[ld_, type_, dmrts_]\n\nFor extending an algebra's \
Dynkin diagram with an adjoint-connected root and then splitting the algebra \
by removing a root.\nArgs: branching-generator label, algebra type, and index \
of root to split at\nMakeExtensionSplitter[ld_, type_, m_]\n\n\
ListExtensionSplits[type_] lists the possible extension splittings for a type\
\n\nAdditional ones (ld is the branching-generator label):\n\nIn these two, \
the matrices of the original groups get decomposed into outer products of the \
subgroup matrices, all in the vector representation.\nSubalgMultSU[ld_, \
suords_] -- reduces a SU(n) to a product of SU(m)'s; suords is a list of \
those m's, and n = product(m's). SubalgMultSOSp[ld_, sospords_] -- reduces a \
SO(n) or Sp(n) to a product of SO(m)'s and/or Sp(m's); sospords is a list of \
those m's, and n = product(m's). Positive n means SO(n) and negative n means \
Sp(-n). SO(2) is handled as a U(1) factor.\n\nForms of the previous two for \
A, B, C, D - style designation.\nSubalgMultAn[ld_, ords_] -- takes list of \
subalgebra root-vector lengths. The 1 in {1,n} is assumed.\n\
SubalgMultBCDn[ld_, stypes_]  -- takes list of subalgebra types that are Bn, \
Cn, and Dn: {2,n}, {3,n}, {4,n}. SO(2) / D(1) / {4,1} is legitimate here; it \
becomes a U(1) factor.\n\nRemaining SO(n) split. Extension splitting does \
even -> even + even (D -> D + D) and odd -> even + odd (B -> D + B), with \
root demotion handling SO(2) as U(1) (demote the root farthest from the fork \
or the double line, the root for the vector rep).\nSubalgSOEvenOdd[ld_,n_,m_] \
-- splits SO(2n) into SO(2m+1) and SO(2n-2m-1), and if m = 0, only SO(2n-1) \
(D -> B + B)\n\nSubalgSUSO[ld_, n_] -- turns SU(n) / A(n-1) into SO(n) / \
D(n/2) or B((n-1)/2)\nSubalgSUSp[ld_, n_] -- turns SU(2n) / A(2n-1) into \
Sp(2n) / C(n)\nSubalgHeightA1[ld_,type_] -- reduces any algebra to A(1), with \
the rep height becoming the largest highest weight\nSubalgExtra[ld_,saname_] \
-- takes one of these as saname and makes the appropriate split,\nlike \"B3G2\
\" for splitting B(3) into G(2)\nB3G2 -- splits B(3)/SO(7) into G(2)\nD4G2 -- \
splits D(4)/SO(8) into G(2)\netc\nFull list in variable SubalgExtraNames\n\n\
Doing the branching, with generator ld and highest weight maxwts:\n\
DoBranching[ld_, maxwts_]\nMakes a list with members\nDegeneracy, list of \
highest weights of subgroup irreps with U(1) factors appended\n\nWith type \
\"sngl\" for a single irrep, \"list\" for a list of them, and \"cntd\" for a \
counted list of them\nDoBranchingXtnd[ld_, type_, maxwts_]\n\n\
DoBranchingVerify[ld_, maxwts_]\nemits {{input hw vector, output}, {degen of \
inputs, degens of outputs}, {total input degen, total output degen}}\n\nThese \
all make brancher object ld from their input brancher objects and other data\n\
ConcatBranchers[ld_, ld0_, ix_, ld1_] -- subalgebra #ix of brancher ld0 gets \
branched by ld1, making a combined brancher.\.08\.08\.08\.08\n\
BrancherRenameA1B1C1[ld_, ld0_, ix_, newfam_] -- subalgebra #ix of brancher \
ld0 gets a new family number if it's A(1), B(1), or C(1): 1, 2, 3\n\
BrancherRenameB2C2[ld_, ld0_, ix_] -- subalgebra #ix of brancher ld0 gets \
flipped between B(2) and C(2)\nBrancherRenameA3D3[ld_, ld0_, ix_] -- \
subalgebra #ix of brancher ld0 gets flipped between A(3) and D(3)\n\
BrancherSplitD2[ld_, ld0_, ix_] -- subalgebra #ix of brancher ld0 gets split \
into two A(1)'s if it is D(2)\nBrancherJoin2A1[ld_, ld0_, ix1_, ix2_] -- \
subalgebras #ix1 and #ix2 of brancher ld0 get joined into D(2) if they are \
A(1)/B(1)/C(1)'s.\nBrancherConjugate[ld_, ld0_, cjixs_] -- makes conjugates \
of subalgebras of brancher ld0 with indexes in cjixs; different for A(n), \
n>1, D(n), and E(6). Not a true conjugate for D(2n), but exchanged anyway.\n\
BrancherConjgD4[ld_, ld0_, ix_, newrts_] -- subalgebra #ix gets conjugated \
with newrts specifiying the new roots' location if it is D(4). newrts has \
length 4 with the second being 2\nBrancherRearrange[ld_, ld0_, neword_] -- \
puts the subalgebras of brancher ld0 into the order specified in neword.\n\
Returns branching to the original algebra\nSubalgSelf[ld_, type_] \n\n\
\[LineSeparator]NOTE: my sources do not give the formulas that my code uses. \
I've derived them myself by imposing consistency for the smaller irreps. Also \
note that some of the projection matrices are not unique -- there is more \
than one choice that will work.\n\nGraphs of Roots of Representations:\nRoot \
/ Weight List Diagram\nComposition of 1D: A1/B1/C1 SU(2)/SO(3)/Sp(2) - 3D \
angular momentum\n2D: A2/SU(3), B2/SO(5), C2/Sp(4), D2/SO(4), G2\n3D: \
A3/SU(4),  B3/SO(7), C2/Sp(8), D3/SO(6)\n\nExtras:\nCanonical Root Vectors -- \
in forms where their symmetries are more manifest\nMetrics Found Directly\n\
Cartan Matrices Found Directly\nTotal Degeneracies/Dimensions Found Directly\n\
Weyl Groups\nWeyl Orbits -- including some explicit formulas for most of the \
algebras\nReps\[CloseCurlyQuote] Weyl Orbits\nWeyl Orbit Combinations\n\
Cartan-Weyl Normalizations\nConversion Utilities\n\nSpeed-up trick : use some \
variables as functions with several fixed arguments. Construct one and see \
what it evaluates out to. An unevalulated one will have a Head value equal to \
the variable name. Uses ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "'s built-in search algorithm. No need for Position or MemberQ, which are \
much slower.\n\nThis function approach is also used for the Lie algebras and \
the subalgebra irrep decomposers. It' s convenient for creating named \
collection members, something easy in many programming languages, but not \
directly possible in ",
 StyleBox["Mathematica.\n",
  FontSlant->"Italic"],
 "\nReferences:",
 StyleBox["\n\n",
  FontSlant->"Italic"],
 "Semi-Simple Lie Algebras and Their Representations, by Robert N. Cahn\n\
http://phyweb.lbl.gov/~rncahn/www/liealgebras/book.html\n \nGroup Theory for \
Unified Model Building, by R. Slansky\n\
http://inspirehep.net/search?p=find+a+slansky+and+t+group+theory\n\nThis code \
uses the root-numbering conventions of Robert N. Cahn's book.\n\n\
Kostka-matrix algorithm from\nDeterminantal Expression and Recursion for Jack \
Polynomials, by L. Lapointe, A. Lascoux, J. Morse\n\n[0909.2337] Branching \
rules for the Weyl group orbits of the Lie algebra A(n) - \
http://arxiv.org/abs/0909.2337\n[1101.6043] Branching rules for Weyl group \
orbits of simple Lie algebras B(n), C(n) and D(n) - \
http://arxiv.org/abs/1101.6043\n[1206.6379] LieART -- A Mathematica \
Application for Lie Algebras and Representation Theory - \
http://arxiv.org/abs/1206.6379"
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lie Algebras themselves", "Section"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"Preliminaries", ":", " ", 
   RowBox[{
   "functions", " ", "to", " ", "extract", " ", "keys", " ", "and", " ", 
    "values"}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"From", " ", "the", " ", "Dynkin", " ", "diagram"}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LAMetric", "[", "dynkdiag_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "metric", ",", "conn", ",", "i", ",", "j", ",", "str", ",", "k"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"2", "*", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"dynkdiag", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"conn", " ", "=", " ", 
         RowBox[{"dynkdiag", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "k"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"str", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"metric", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", " ", "str"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"metric", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", " ", "str"}]}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"dynkdiag", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "metric"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LACartanMatrix", "[", "dynkdiag_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ctnmat", ",", "conn", ",", "i", ",", "j", ",", "str", ",", "k"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"2", "*", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"dynkdiag", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"conn", " ", "=", " ", 
         RowBox[{"dynkdiag", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "k"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"j", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"str", " ", "=", " ", 
         RowBox[{"conn", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ctnmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", " ", "str"}], "/", 
          RowBox[{"dynkdiag", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "j"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ctnmat", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", " ", "str"}], "/", 
          RowBox[{"dynkdiag", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}]}]}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"dynkdiag", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "ctnmat"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"From", " ", "the", " ", "Cartan", " ", "matrix"}], ";", " ", 
    RowBox[{"emits", " ", "a", " ", "list", " ", "containing", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"root", " ", "vector"}], ",", " ", "weight"}], "}"}], " ", 
     "for", " ", "each", " ", "positive", " ", "root", " ", "vector", " ", 
     "found"}]}], ",", " ", 
   RowBox[{
    RowBox[{"in", " ", "min"}], "-", "to", "-", 
    RowBox[{"max", " ", "order"}]}]}], "\n", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RootSortFunc", "[", 
   RowBox[{"rx1_", ",", "rx2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2", ",", "l1", ",", "l2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r1", " ", "=", " ", 
      RowBox[{"rx1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
     RowBox[{"r2", " ", "=", " ", 
      RowBox[{"rx2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"l1", " ", "=", " ", 
      RowBox[{"Total", "[", "r1", "]"}]}], ";", " ", 
     RowBox[{"l2", " ", "=", " ", 
      RowBox[{"Total", "[", "r2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"l1", " ", "\[Equal]", " ", "l2"}], ",", " ", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"r2", ",", "r1"}], "}"}], "]"}], ",", " ", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"l1", ",", "l2"}], "}"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LAPositiveRoots", "[", "ctnmat_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "SmplRoots", ",", "PosRoots", ",", "PRindex", ",", "WhichWay", 
      ",", "NumRoots", ",", " ", "RtIndx", ",", "i", ",", "j", ",", "k", ",", 
      "l", ",", "ctpd", ",", "ThisRoot", ",", "ThisWW", ",", " ", "NewRoot", 
      ",", "NewWW", ",", "NRLen", ",", "NRDivs", ",", "RootOK", ",", 
      "DivRoot", ",", "PosRootList", ",", "PRSet"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Start", " ", "off", " ", "with", " ", "all", " ", "the", " ", "simple", 
      " ", "ones", " ", "in", " ", "a", " ", "clever", " ", "manner"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Use", " ", "args", " ", "of", " ", "vars", " ", "to", " ", "avoid", " ",
       "AppendTo"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "ctnmat", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SmplRoots", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"PosRoots", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"SmplRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PRindex", "[", 
          RowBox[{"SmplRoots", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "=", " ", "i"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"WhichWay", "[", "i", "]"}], " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"True", ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "n"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "<=", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"PosRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ctpd", " ", "=", " ", 
         RowBox[{"ThisRoot", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ThisWW", " ", "=", " ", 
            RowBox[{"WhichWay", "[", "RtIndx", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NewWW", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", " ", "!=", " ", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ThisWW", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", ",", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"NewRoot", " ", "=", " ", "ThisRoot"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NewRoot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "+=", " ", "j"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Avoid", " ", "integer", " ", "multiples", " ", "of", " ", 
                  "previous", " ", "root", " ", "vectors"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"NRLen", " ", "=", " ", 
                 RowBox[{"Total", "[", "NewRoot", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"NRDivs", " ", "=", " ", 
                 RowBox[{"Divisors", "[", "NRLen", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"RootOK", " ", "=", " ", "True"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Do", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NRDivs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "==", "1"}], ",", 
                    RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"DivRoot", " ", "=", " ", 
                    RowBox[{"NewRoot", "/", 
                    RowBox[{"NRDivs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", " ", "@@", " ", 
                    RowBox[{"(", 
                    RowBox[{"IntegerQ", " ", "/@", " ", "DivRoot"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"PRindex", "[", "DivRoot", "]"}], "]"}], "=!=", 
                    "PRindex"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"RootOK", " ", "=", " ", "False"}], ";", " ", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"Length", "[", "NRDivs", "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"RootOK", ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"PRindex", "[", "NewRoot", "]"}], "]"}], "=!=", 
                    "PRindex"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"WhichWay", "[", "RtIndx", "]"}], " ", "=", " ", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ThisWW", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "&&", " ", 
                    RowBox[{"NewWW", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PosRoots", "[", "NumRoots", "]"}], " ", "=", " ",
                     "NewRoot"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"PRindex", "[", "NewRoot", "]"}], " ", "=", " ", 
                    "NumRoots"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"WhichWay", "[", "NumRoots", "]"}], " ", "=", " ",
                     "NewWW"}]}]}], "\[IndentingNewLine]", "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"-", 
                  RowBox[{"ctpd", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"PosRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"PosRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PRSet", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"PosRootList", ",", 
         RowBox[{"PosRootList", ".", "ctnmat"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{"PRSet", ",", " ", "RootSortFunc"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"From", " ", "the", " ", "above"}], ",", " ", 
   RowBox[{
   "find", " ", "the", " ", "total", " ", "roots", " ", "of", " ", "an", " ", 
    "algebra"}], ",", " ", 
   RowBox[{
    RowBox[{"in", " ", "max"}], "-", "to", "-", 
    RowBox[{"min", " ", "order"}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LAAllRoots", "[", "ctnmat_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", "#1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"#2", ",", "#2"}], "}"}], "}"}], ",", 
      RowBox[{"-", "#1"}]}], "]"}], "&"}], " ", "@", " ", 
   RowBox[{"Sequence", "[", 
    RowBox[{
     RowBox[{"LAPositiveRoots", "[", "ctnmat", "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "ctnmat", "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgName", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Characters", "[", "\"\<ABCDEFG\>\"", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"type", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"ToString", "[", 
     RowBox[{"type", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Args", ":", " ", 
     RowBox[{"Lie", "-", 
      RowBox[{"algebra", " ", "label"}]}]}], ",", " ", 
    RowBox[{"LA", " ", 
     RowBox[{"type", ".", "\[IndentingNewLine]", "Returns"}], " ", "whether", 
     " ", 
     RowBox[{"it", "'"}], "s", " ", "a", " ", "legitimate", " ", 
     "algebra"}]}], "\[IndentingNewLine]", " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LieAlgebra", "::", "badtype"}], " ", "=", " ", 
   "\"\<Invalid algebra type: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeLieAlgebra", "[", 
   RowBox[{"la_", ",", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "family", ",", "n", ",", "nmc", ",", " ", "nmsfx", ",", " ", "special", 
      ",", " ", "hwzero", ",", "hwspc", ",", " ", "dynkin"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "type", "]"}], " ", "<", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "family", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "<", " ", "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hwzero", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Special", " ", "irreps", " ", "and", " ", "Dynkin", " ", "diagrams"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nmsfx", " ", "=", " ", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"special", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<singlet\>\"", ",", "hwzero"}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nmsfx", " ", "=", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<SU(``)\>\"", ",", 
            RowBox[{"n", "+", "1"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{"Switch", "[", 
         RowBox[{"n", ",", "\[IndentingNewLine]", "1", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", "2"}], ",", 
          "\[IndentingNewLine]", "_", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vector\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vector-mirror\>\"", ",", "hwspc"}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<fundamental-mirror\>\"", ",", "hwspc"}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nmsfx", " ", "=", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<SO(``)\>\"", ",", 
            RowBox[{
             RowBox[{"2", "n"}], "+", "1"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
        RowBox[{"Switch", "[", 
         RowBox[{"n", ",", "\[IndentingNewLine]", "1", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "=", "2"}], ",", 
          "\[IndentingNewLine]", "2", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", "2"}], ",", 
          "\[IndentingNewLine]", "_", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "   ", 
        RowBox[{"Switch", "[", 
         RowBox[{"n", ",", "\[IndentingNewLine]", "1", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "2"}], ",", 
          "\[IndentingNewLine]", "_", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vector\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OddQ", "[", "n", "]"}], " ", "&&", " ", 
           RowBox[{"n", " ", ">", " ", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental-2\>\"", ",", "hwspc"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<spinor\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"EvenQ", "[", "n", "]"}], " ", "||", " ", 
           RowBox[{"n", " ", "\[Equal]", " ", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OddQ", "[", "n", "]"}], " ", "&&", " ", 
           RowBox[{"n", " ", ">", " ", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental-1\>\"", ",", "hwspc"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"2", ",", 
                 RowBox[{"{", 
                  RowBox[{"n", "-", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
             ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"k", "+", "1"}], ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "-", "1"}], ",", "n", ",", "2"}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nmsfx", " ", "=", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"StringForm", "[", 
           RowBox[{"\"\<Sp(``)\>\"", ",", 
            RowBox[{"2", "n"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "2"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vector\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"n", ">", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"1", ",", 
                 RowBox[{"{", 
                  RowBox[{"n", "-", "1"}], "}"}]}], "]"}], ",", "2"}], "]"}], 
             ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "-", "1"}], ",", "n", ",", "2"}], "}"}]}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "}"}]}], "}"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", " ", "<", " ", "2"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nmsfx", " ", "=", " ", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<SO(``)\>\"", ",", 
           RowBox[{"2", "n"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", " ", ">", " ", "2"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{"Switch", "[", 
            RowBox[{"n", ",", "\[IndentingNewLine]", "3", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"hwspc", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=", "1"}], ";", " ", 
              RowBox[{
               RowBox[{"hwspc", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "=", "1"}]}], ",", 
             "\[IndentingNewLine]", "_", ",", 
             RowBox[{
              RowBox[{"hwspc", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", "1"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "2"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint-1\>\"", ",", "hwspc"}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "2"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint-2\>\"", ",", "hwspc"}], "}"}]}], "]"}]}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{"Switch", "[", 
         RowBox[{"n", ",", "\[IndentingNewLine]", "2", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "1"}]}], ",", 
          "\[IndentingNewLine]", "_", ",", 
          RowBox[{
           RowBox[{"hwspc", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<vector\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<spinor-1\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "n", "]"}], " ", ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental-1\>\"", ",", "hwspc"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "n", "]"}], " ", ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<spinor-2\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "n", "]"}], " ", ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental-2\>\"", ",", "hwspc"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OddQ", "[", "n", "]"}], " ", ",", " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"special", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<fundamental-mirror\>\"", ",", "hwspc"}], "}"}]}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"n", ">", "2"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", 
                   RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"n", "-", "2"}], ",", "n", ",", "1"}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<fundamental-mirror\>\"", ",", "hwspc"}], "}"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", "7", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}]}],
           ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
           RowBox[{
            RowBox[{"hwspc", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"special", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}]}],
           ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"k", "+", "1"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "n", ",", "1"}], "}"}]}], "]"}]}], "}"}]}]}], 
       ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[NotEqual]", "4"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "1"}], "}"}]}], "}"}]}], "}"}]}]}], 
       ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n", "\[NotEqual]", "2"}], ",", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{
             RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], 
           ";", " ", 
           RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", " ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<adjoint\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hwspc", " ", "=", " ", "hwzero"}], ";", "  ", 
        RowBox[{
         RowBox[{"hwspc", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"special", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<fundamental\>\"", ",", "hwspc"}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"dynkin", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]}], "}"}]}]}], 
       ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LieAlgebra", "::", "badtype"}], ",", "type"}], "]"}], ";", 
        " ", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "la", "]"}], "===", "Symbol"}], ",", 
       RowBox[{"Clear", "[", "la", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<type\>\"", "]"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<name\>\"", "]"}], " ", "=", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"StringForm", "[", 
        RowBox[{"\"\<`` ``\>\"", ",", 
         RowBox[{"AlgName", "[", "type", "]"}], ",", "nmsfx"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<special\>\"", "]"}], " ", "=", " ", "special"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<dynkin\>\"", "]"}], " ", "=", " ", "dynkin"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Remaining", " ", "stuff"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}], " ", "=", " ", 
      RowBox[{"LAMetric", "[", "dynkin", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"la", "[", "\"\<invmet\>\"", "]"}], " ", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{"la", "[", "\"\<metric\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], " ", "=", " ", 
      RowBox[{"LACartanMatrix", "[", "dynkin", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}], " ", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], " ", "=", " ", 
      RowBox[{"LAPositiveRoots", "[", 
       RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Uses", " ", "a", " ", "global", " ", "cache"}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "LieAlgebraCache", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Returns", " ", 
    RowBox[{"LieAlgebraCache", "[", "type", "]"}], " ", "if", " ", "a", " ", 
    "legitimate", " ", "algebra"}], ",", " ", 
   RowBox[{"Null", " ", "otherwise"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetLieAlgebra", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"LieAlgebraCache", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"la", "[", "\"\<type\>\"", "]"}], "]"}], "=!=", " ", 
        "List"}], ",", "\[IndentingNewLine]", 
       RowBox[{"MakeLieAlgebra", "[", 
        RowBox[{"la", ",", "type"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"la", "[", "\"\<type\>\"", "]"}], "]"}], "===", " ", 
        "List"}], ",", "\[IndentingNewLine]", "la", ",", 
       "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgDimension", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"[", "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"Length", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}]}], "+", 
      RowBox[{"Length", "[", 
       RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps - Irreducible Representations", "Section"],

Cell[CellGroupData[{

Cell["Irreps themselves", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Finds", " ", "an", " ", 
    RowBox[{"irrep", "'"}], "s", " ", "root", " ", "and", " ", "weight", " ", 
    "vectors", " ", "from", " ", "its", " ", "maximum", " ", 
    RowBox[{"root", "'"}], "s", " ", "weights", " ", "and", " ", "the", " ", 
    "Lie", " ", 
    RowBox[{"algebra", "'"}], "s", " ", "Cartan", " ", 
    RowBox[{"matrix", ".", " ", "For"}], " ", "invalid", " ", "inputs"}], ",",
    " ", 
   RowBox[{"returns", " ", "Null"}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LARepresentation", "::", "badmwts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid highest-weight vector: `2`\>\""}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckLARep", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "maxwts", "]"}], " ", "\[NotEqual]", " ", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepresentation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "maxwts"}], ")"}]}], ")"}]}], 
       ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepresentation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "maxwts", "]"}], " ", "<", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LARepresentation", "::", "badmwts"}], ",", "type", ",", 
          "maxwts"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Reverse", " ", "of", " ", "RootSortFunc"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepRootSortFunc", "[", 
   RowBox[{"rx1_", ",", "rx2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2", ",", "l1", ",", "l2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r1", " ", "=", " ", 
      RowBox[{"rx1", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
     RowBox[{"r2", " ", "=", " ", 
      RowBox[{"rx2", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"l1", " ", "=", " ", 
      RowBox[{"Total", "[", "r1", "]"}]}], ";", " ", 
     RowBox[{"l2", " ", "=", " ", 
      RowBox[{"Total", "[", "r2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"l1", " ", "\[Equal]", " ", "l2"}], ",", " ", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"r1", ",", "r2"}], "}"}], "]"}], ",", " ", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{"l2", ",", "l1"}], "}"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepRootVectors", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "invctn", ",", "n", ",", "NumRoots", ",", 
      "RepRoots", ",", "RRIndex", ",", " ", "WhichWay", ",", " ", "RtIndx", 
      ",", "i", ",", "j", ",", "k", ",", "l", ",", "ctpd", ",", "ThisRoot", 
      ",", "ThisWW", ",", "NewRoot", ",", "NewWW", ",", "RepRootList", ",", 
      "RepRSet"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RepRoots", "[", "NumRoots", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RRIndex", "[", 
       RowBox[{"RepRoots", "[", "NumRoots", "]"}], "]"}], " ", "=", " ", 
      "RepRoots"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"WhichWay", "[", "NumRoots", "]"}], " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"True", ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "\[LessEqual]", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"RepRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ctpd", " ", "=", " ", 
         RowBox[{"ThisRoot", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ThisWW", " ", "=", " ", 
            RowBox[{"WhichWay", "[", "RtIndx", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"NewWW", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"j", " ", "!=", " ", "i"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ThisWW", "[", 
              RowBox[{"[", "i", "]"}], "]"}], " ", ",", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NewRoot", " ", "=", " ", "ThisRoot"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NewRoot", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], " ", "-=", " ", "j"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "[", 
                    RowBox[{"RRIndex", "[", "NewRoot", "]"}], "]"}], "=!=", 
                   "RRIndex"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"WhichWay", "[", "RtIndx", "]"}], "=", " ", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ThisWW", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "&&", " ", 
                    RowBox[{"NewWW", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "n"}], "}"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"RepRoots", "[", "NumRoots", "]"}], "=", 
                    "NewRoot"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"RRIndex", "[", "NewRoot", "]"}], " ", "=", " ", 
                    "NumRoots"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"WhichWay", "[", "NumRoots", "]"}], " ", "=", " ",
                     "NewWW"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"ctpd", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"RepRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RepRSet", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"RepRootList", ",", 
         RowBox[{"RepRootList", ".", "ctnmat"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{"RepRSet", ",", "RepRootSortFunc"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Find", " ", "the", " ", "irrep"}], "-", 
   RowBox[{"root", " ", "degeneracies", " ", "using", " ", 
    RowBox[{"Freudenthal", "'"}], "s", " ", 
    RowBox[{"recurrence", ".", " ", "Needs"}], " ", "only", " ", "the", " ", 
    "root", " ", "values", " ", "and", " ", "not", " ", "the", " ", "weights",
     " ", "for", " ", "the", " ", 
    RowBox[{"irrep", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepRootDegens", "[", 
   RowBox[{"type_", ",", "RepRoots_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "invmet", ",", "ctnmat", ",", "invctn", ",", 
      "posroots", ",", "twodelta", ",", "rrix", ",", "degens", ",", "maxrt", 
      ",", "i", ",", "n", ",", "rt", ",", "bkrt", ",", "shtrt", ",", "pos"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invmet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"twodelta", " ", "=", " ", 
      RowBox[{"Total", "[", "posroots", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rrix", "[", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "=", " ", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degens", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "RepRoots", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Assumes", " ", "roots", " ", "sorted", " ", "downward", " ", "by", 
        " ", "height"}], ",", " ", 
       RowBox[{"like", " ", "with", " ", "RepRootSortFunc"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"maxrt", " ", "=", " ", 
      RowBox[{"RepRoots", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degens", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bkrt", " ", "=", " ", 
            RowBox[{"rt", " ", "+", " ", "shtrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"rrix", "[", "bkrt", "]"}], "]"}], "=!=", "rrix"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", " ", "=", " ", 
               RowBox[{"rrix", "[", "bkrt", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", " ", "+=", " ", 
               RowBox[{
                RowBox[{"degens", "[", 
                 RowBox[{"[", "pos", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"bkrt", ".", "metric", ".", "shtrt"}], ")"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"bkrt", " ", "+=", " ", "shtrt"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"shtrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"degens", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"n", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"maxrt", "+", "rt", "+", "twodelta"}], ")"}], ".", 
             "metric", ".", 
             RowBox[{"(", 
              RowBox[{"maxrt", "-", "rt"}], ")"}]}], ")"}]}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "degens"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"Outputs", " ", "roots", " ", "in", " ", "form", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"root", " ", "degeneracy"}], ",", " ", "value", ",", " ", 
     "weights"}], ")"}]}], "\n", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepRootVectorsDegens", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vecs", ",", "trvcs", ",", "dgns"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vecs", " ", "=", " ", 
      RowBox[{"RepRootVectors", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"vecs", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"trvcs", " ", "=", " ", 
      RowBox[{"Transpose", "[", "vecs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgns", " ", "=", " ", 
      RowBox[{"RepRootDegens", "[", 
       RowBox[{"type", ",", 
        RowBox[{"trvcs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"trvcs", ",", "dgns"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Convenience", " ", 
   RowBox[{"function", ":", " ", 
    RowBox[{"no", " ", "caching"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepDirect", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"RepRootVectorsDegens", "[", 
   RowBox[{"type", ",", "maxwts"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"Find", " ", "the", " ", "total", " ", "degeneracy", " ", 
   RowBox[{"(", 
    RowBox[{"multiplet", " ", "size"}], ")"}], " ", "from", " ", "the", " ", 
   "above", " ", "results"}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TotalDegenOfExpRep", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", "x", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Weyl", "'"}], "s", " ", "celebrated", " ", "formula", " ", "for", 
   " ", "the", " ", "total", " ", 
   RowBox[{"degeneracy", ".", " ", "The"}], " ", "last", " ", "arg", " ", 
   "is", " ", "whether", " ", "it", " ", "checks", " ", "the", " ", "maxwts", 
   " ", 
   RowBox[{"vector", ".", " ", "Set"}], " ", "it", " ", "to", " ", "False", 
   " ", "for", " ", "a", " ", "symbolic", " ", 
   RowBox[{"expression", "."}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegen", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_:", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "invmet", ",", "ctnmat", ",", "invctn", ",", 
      "posroots", ",", "delta", ",", "maxrtsdel", ",", "prt", ",", "ra"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckLARep", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invmet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<posroots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"delta", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", "posroots", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxrtsdel", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}], " ", "+", 
       " ", "delta"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Product", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ra", " ", "=", " ", 
         RowBox[{"prt", ".", "metric"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ra", ".", "maxrtsdel"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"ra", ".", "delta"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"prt", ",", "posroots"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Orbits", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"From", " ", "the", " ", 
   RowBox[{"orbit", "'"}], "s", " ", "dominant", " ", 
   RowBox[{"weight", ".", " ", "Step"}], " ", "down", " ", "using", " ", 
   "the", " ", "simple", " ", "roots"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitForDomWt", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "ctnmat", ",", "invctn", ",", "metric", ",", 
      "wmmults", ",", "oldrts", ",", "ixs", ",", "newrts", ",", "rt", ",", 
      "mtrt", ",", "nrixs", ",", "k", ",", "nwrt", ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", " ", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wmmults", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "2"}], "/", 
       RowBox[{"Diagonal", "[", "metric", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"oldrts", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"maxwts", ".", "invctn"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ixs", " ", "=", " ", 
      RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Reap", "[", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "oldrts", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sow", "[", "oldrts", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newrts", " ", "=", " ", 
           RowBox[{"Union", " ", "@@", " ", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"mtrt", " ", "=", " ", 
                RowBox[{"metric", ".", "rt"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"nrixs", " ", "=", " ", 
                RowBox[{"Select", "[", 
                 RowBox[{"ixs", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mtrt", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], ">", "0"}], "&"}]}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"nwrt", " ", "=", " ", "rt"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"nwrt", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "+=", " ", 
                   RowBox[{
                    RowBox[{"wmmults", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "*", 
                    RowBox[{"mtrt", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}], ";", 
                  "\[IndentingNewLine]", "nwrt"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "nrixs"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"rt", ",", "oldrts"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"oldrts", " ", "=", " ", "newrts"}]}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"#", ".", "ctnmat"}]}], "}"}], "&"}], " ", "/@", " ", 
      RowBox[{"(", 
       RowBox[{"Join", " ", "@@", " ", 
        RowBox[{"res", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "For", " ", "finding", " ", "which", " ", "orbit", " ", "a", " ", "root", 
   " ", "is", " ", "in"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DomWtFromRoot", "[", 
   RowBox[{"type_", ",", "root_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "ctnmat", ",", "invctn", ",", "metric", ",", 
      "wmmults", ",", "rt", ",", "wt", ",", "mtrt", ",", "ix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", " ", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wmmults", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", "2"}], "/", 
       RowBox[{"Diagonal", "[", "metric", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rt", " ", "=", " ", "root"}], ";", "\[IndentingNewLine]", 
     RowBox[{"wt", " ", "=", 
      RowBox[{"rt", ".", "ctnmat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "wt", "]"}], " ", "<", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mtrt", " ", "=", " ", 
         RowBox[{"metric", ".", "rt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"Ordering", "[", 
           RowBox[{"mtrt", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mtrt", "[", 
            RowBox[{"[", "ix", "]"}], "]"}], " ", "\[GreaterEqual]", " ", 
           "0"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rt", "[", 
          RowBox[{"[", "ix", "]"}], "]"}], " ", "+=", " ", 
         RowBox[{
          RowBox[{"wmmults", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], "*", 
          RowBox[{"mtrt", "[", 
           RowBox[{"[", "ix", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"wt", " ", "=", 
         RowBox[{"rt", ".", "ctnmat"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"rt", ",", "wt"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Explicit", " ", "expressions", " ", "for", " ", "Weyl", " ", "orbits"}], 
  " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MxWtToYD", "[", "maxwts_", "]"}], " ", ":=", "  ", 
  RowBox[{"Reverse", "[", 
   RowBox[{"Accumulate", "[", 
    RowBox[{"Reverse", "[", "maxwts", "]"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddSignsToRoot", "[", "rt_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rtlst", ",", "n", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rtlst", " ", "=", " ", 
      RowBox[{"Tuples", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}], "*", "#"}], "]"}], "&"}], " ", "/@",
         " ", "rt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "rt", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Select", " ", "ones", " ", "that", " ", "are", " ", "unique", " ", 
        "to", " ", "within", " ", "sorting"}], ";", " ", 
       RowBox[{
       "assumes", " ", "that", " ", "rt", " ", "is", " ", "already", " ", 
        "sorted"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"rt", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "\[Equal]", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"rt", "[", 
            RowBox[{"[", 
             RowBox[{"k", "+", "1"}], "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"rtlst", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"rtlst", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "k", "]"}], "]"}], " ", ">=", " ", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", "1"}], "]"}], "]"}]}], ")"}], "&"}]}], 
           "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "rtlst"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PermuteRootsInList", "[", "rtlst_", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Permutations", " ", "/@", " ", "rtlst"}], ",", "1"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Done", " ", "for", " ", "all", " ", "but", " ", "E6"}], ",", " ", 
   "E7", ",", " ", "E8"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitForDomWtExplicit", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "ctnmat", ",", "orbrts", ",", "mwx", 
      ",", "mwxl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbrts", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MxWtToYD", "[", 
           RowBox[{"Append", "[", 
            RowBox[{"maxwts", ",", "0"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "-=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"n", "+", "1"}], ")"}]}], ")"}], "*", 
           RowBox[{"Total", "[", "mwx", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Most", "[", 
            RowBox[{"Accumulate", "[", "#", "]"}], "]"}], "&"}], " ", "/@", 
          " ", 
          RowBox[{"Permutations", "[", "mwx", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "maxwts", "]"}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "maxwts", "]"}], "/", "2"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MxWtToYD", "[", "mwx", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{"AddSignsToRoot", "[", "mwx", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Accumulate", " ", "/@", " ", 
          RowBox[{"PermuteRootsInList", "[", "mwxl", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"MxWtToYD", "[", "maxwts", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{"AddSignsToRoot", "[", "mwx", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{"Accumulate", " ", "/@", 
           RowBox[{"PermuteRootsInList", "[", "mwxl", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Most", "[", "#", "]"}], ",", 
             RowBox[{
              RowBox[{"Last", "[", "#", "]"}], "/", "2"}]}], "]"}], "&"}], 
          " ", "/@", " ", "mwxl"}]}], ",", "\[IndentingNewLine]", "4", ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mwx", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"MxWtToYD", "[", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"maxwts", ",", 
                 RowBox[{"-", "2"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"maxwts", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "+", 
                  RowBox[{"maxwts", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"maxwts", "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "2"}], "]"}], "]"}]}], "+", 
               RowBox[{"maxwts", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{"AddSignsToRoot", "[", "mwx", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"mwx", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"mwxl", " ", "=", " ", 
            RowBox[{"Select", "[", 
             RowBox[{"mwxl", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Times", " ", "@@", " ", "#"}], ")"}], "*", 
                 RowBox[{"mwx", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], " ", ">", " ", "0"}], 
               "&"}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{"PermuteRootsInList", "[", "mwxl", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mwxl", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Accumulate", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"-", "2"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"2", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}]}], "]"}], 
             "]"}], "&"}], " ", "/@", " ", "mwxl"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Drop", "[", 
              RowBox[{"#", ",", 
               RowBox[{"-", "2"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", 
                RowBox[{"-", "2"}]}], "]"}], "/", "2"}]}], "]"}], "&"}], " ", 
          "/@", " ", "mwxl"}]}], ",", "\[IndentingNewLine]", "5", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "7", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "8", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mwxl", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"maxwts", "[", 
                RowBox[{"[", "3", "]"}], "]"}], " ", ">", " ", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}]}], 
                   "}"}], "*", 
                  RowBox[{"maxwts", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], " ", "+", " ", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "*", 
                  RowBox[{"maxwts", "[", 
                   RowBox[{"[", "4", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"3", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "*", 
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "4", "]"}], "]"}], " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], "*", 
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "4", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}],
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mwxl", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], "*", 
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "}"}], "*", 
                 RowBox[{"maxwts", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "+", "#"}], ")"}], "&"}], 
             " ", "/@", " ", "mwxl"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mwxl", " ", "=", " ", 
            RowBox[{"PermuteRootsInList", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"AddSignsToRoot", " ", "/@", " ", "mwxl"}], ",", "1"}],
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0", ",", "0", ",", 
                   RowBox[{"-", "1"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1", ",", 
                   RowBox[{"-", "3"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", 
                   RowBox[{"-", "2"}]}], "}"}]}], "}"}], ".", "#"}], ")"}], 
             "&"}], " ", "/@", " ", "mwxl"}]}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mwx", " ", "=", " ", 
            RowBox[{"maxwts", ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mwxl", " ", "=", " ", 
            RowBox[{"Permutations", "[", "mwx", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"Abs", "[", "mwx", "]"}], "]"}], " ", ">", " ", "0"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"mwxl", " ", "=", " ", 
              RowBox[{"Join", "[", 
               RowBox[{"mwxl", ",", 
                RowBox[{"-", "mwxl"}]}], "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ".", "#"}], 
             "&"}], " ", "/@", " ", "mwxl"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"#", ",", 
         RowBox[{"#", ".", "ctnmat"}]}], "}"}], "&"}], " ", "/@", " ", 
      "orbrts"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitTimingVerify", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t0", ",", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t0", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"WeylOrbitForDomWt", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t1", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"WeylOrbitForDomWtExplicit", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"t0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"t1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], " ", "===", " ", 
        RowBox[{"Sort", "[", 
         RowBox[{"t0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Caching", " ", "of", " ", "Weyl", " ", 
   RowBox[{"orbits", ".", " ", "Uses"}], " ", "a", " ", "global", " ", 
   RowBox[{"cache", " ", "--"}], " ", "can", " ", "get", " ", "which", " ", 
   "irreps", " ", "cached", " ", "with", " ", 
   RowBox[{"DownValues", "[", "]"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "WeylOrbitCache", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetOrbit", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rep", ",", "key", ",", "mwnz", ",", "mwscale", ",", "mwred"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "maxwts"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"WeylOrbitCache", "[", "key", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "rep", "]"}], " ", "===", " ", 
        "WeylOrbitCache"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rep", " ", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"type", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", " ", "4"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"WeylOrbitForDomWtExplicit", "[", 
            RowBox[{"type", ",", "maxwts"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"WeylOrbitForDomWt", "[", 
            RowBox[{"type", ",", "maxwts"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", " ", "=!=", " ", "Null"}], ",", " ", 
          RowBox[{
           RowBox[{"WeylOrbitCache", "[", "key", "]"}], " ", "=", " ", 
           "rep"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "rep"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Statistics", " ", "--"}], " ", "returns", " ", "dom", " ", 
    "root"}], ",", " ", 
   RowBox[{"dom", " ", "wt"}], ",", " ", 
   RowBox[{"length", " ", "of", " ", "orbit"}], ",", " ", 
   RowBox[{"and", " ", "length", " ", "of", " ", "roots"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitStats", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"orb", ",", "metric", ",", "invctn", ",", "maxrts"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orb", " ", "=", " ", 
      RowBox[{"GetOrbit", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"orb", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxrts", " ", "=", " ", 
      RowBox[{"maxwts", ".", "invctn"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"maxrts", ",", "maxwts", ",", 
       RowBox[{"Length", "[", "orb", "]"}], ",", 
       RowBox[{"maxrts", ".", "metric", ".", "maxrts"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Note", ":", " ", 
    RowBox[{
     RowBox[{"the", " ", "orbit"}], "-", 
     RowBox[{
     "stabilizer", " ", "theorem", " ", "constrains", " ", "the", " ", 
      "number", " ", "of", " ", "members", " ", "of", " ", "Weyl"}], "-", 
     RowBox[{"group", " ", "orbits"}]}], ":", "\n", "\n", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
      "order", " ", "of", " ", "orbit", " ", "of", " ", "x", " ", "in", " ", 
       "G"}], ")"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
      "order", " ", "of", " ", "stabilizer", " ", "of", " ", "x", " ", "in", 
       " ", "G"}], ")"}]}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"order", " ", "of", " ", "G"}], ")"}], " ", "--"}], " ", "the", 
    " ", "stabilizer", " ", "subgroup", " ", "of", " ", "G", " ", "for", " ", 
    "x", " ", "has", " ", "all", " ", "the", " ", "elements", " ", "of", " ", 
    "G", " ", "that", " ", "keep", " ", "x", " ", "fixed"}]}], " ", 
  "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreps from Weyl Orbits", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Dominant", " ", "weights", " ", "of", " ", "Weyl", " ", "orbits", " ", 
   "of", " ", "a", " ", "rep"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylDomWtRepRootVectors", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "invctn", ",", "posroots", ",", "psrt", ",", 
      "NumRoots", ",", "RepRoots", ",", "RRIndex", ",", " ", "RtIndx", ",", 
      "ThisRoot", ",", "NewRoot", ",", "RepRootList", ",", "RepRSet"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<posroots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NumRoots", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RepRoots", "[", "NumRoots", "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RRIndex", "[", 
       RowBox[{"RepRoots", "[", "NumRoots", "]"}], "]"}], " ", "=", " ", 
      "RepRoots"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RtIndx", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"RtIndx", " ", "\[LessEqual]", " ", "NumRoots"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ThisRoot", " ", "=", " ", 
         RowBox[{"RepRoots", "[", "RtIndx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"NewRoot", " ", "=", " ", 
            RowBox[{"ThisRoot", " ", "-", " ", "psrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"NewRoot", ".", "ctnmat"}], "]"}], "<", "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"RRIndex", "[", "NewRoot", "]"}], "]"}], "===", 
              "RRIndex"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"NumRoots", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RepRoots", "[", "NumRoots", "]"}], "=", "NewRoot"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"RRIndex", "[", "NewRoot", "]"}], " ", "=", " ", 
               "NumRoots"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"psrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RtIndx", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"RepRootList", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{"RepRoots", ",", "NumRoots"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RepRSet", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"RepRootList", ",", 
         RowBox[{"RepRootList", ".", "ctnmat"}]}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", 
      RowBox[{"RepRSet", ",", "RepRootSortFunc"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Uses", " ", 
     RowBox[{"Freudenthal", "'"}], "s", " ", 
     RowBox[{"recurrence", ".", " ", "Since"}], " ", "the", " ", 
     "backtracked", " ", "roots", " ", "are", " ", "not", " ", "necessarily", 
     " ", "Weyl"}], "-", 
    RowBox[{"orbit", " ", "dominant"}], "-", 
    RowBox[{"weight", " ", "ones"}]}], ",", " ", 
   RowBox[{
    RowBox[{"it", "'"}], "s", " ", "necessary", " ", "to", " ", "find", " ", 
    "a", " ", "dominant", " ", "weight", " ", "for", " ", "each", " ", "one", 
    " ", "and", " ", "use", " ", "its", " ", 
    RowBox[{"root", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylDomWtRepRootDegens", "[", 
   RowBox[{"type_", ",", "RepRoots_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "metric", ",", "invmet", ",", "ctnmat", ",", "invctn", ",", 
      "posroots", ",", "twodelta", ",", "rrix", ",", "degens", ",", "maxrt", 
      ",", "i", ",", "n", ",", "rt", ",", "bkrt", ",", "bkdmrw", ",", "shtrt",
       ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invmet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"twodelta", " ", "=", " ", 
      RowBox[{"Total", "[", "posroots", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rrix", "[", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "=", " ", "i"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"degens", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"Length", "[", "RepRoots", "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Assumes", " ", "roots", " ", "sorted", " ", "downward", " ", "by", 
        " ", "height"}], ",", " ", 
       RowBox[{"like", " ", "with", " ", "RepRootSortFunc"}]}], " ", " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"maxrt", " ", "=", " ", 
      RowBox[{"RepRoots", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"degens", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"RepRoots", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"bkrt", " ", "=", " ", 
            RowBox[{"rt", " ", "+", " ", "shtrt"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bkdmrw", " ", "=", " ", 
            RowBox[{"DomWtFromRoot", "[", 
             RowBox[{"type", ",", "bkrt"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"rrix", "[", 
                RowBox[{"bkdmrw", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=!=", 
              "rrix"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pos", " ", "=", " ", 
               RowBox[{"rrix", "[", 
                RowBox[{"bkdmrw", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", " ", "+=", " ", 
               RowBox[{
                RowBox[{"degens", "[", 
                 RowBox[{"[", "pos", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"bkrt", ".", "metric", ".", "shtrt"}], ")"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"bkrt", " ", "+=", " ", "shtrt"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"bkdmrw", " ", "=", " ", 
               RowBox[{"DomWtFromRoot", "[", 
                RowBox[{"type", ",", "bkrt"}], "]"}]}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"shtrt", ",", "posroots"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"degens", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"2", "*", 
          RowBox[{"n", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"maxrt", "+", "rt", "+", "twodelta"}], ")"}], ".", 
             "metric", ".", 
             RowBox[{"(", 
              RowBox[{"maxrt", "-", "rt"}], ")"}]}], ")"}]}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "RepRoots", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "degens"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Irrep", " ", "decomposed", " ", "into", " ", "Weyl", " ", "orbits", " ", 
    "with", " ", "appropriate", " ", "degeneracies"}], ",", " ", 
   RowBox[{
   "in", " ", "the", " ", "format", " ", "of", " ", "GetRep", " ", "about", 
    " ", 
    RowBox[{"irreps", ":", " ", 
     RowBox[{"{", 
      RowBox[{"degeneracy", ",", " ", 
       RowBox[{"dominant", " ", "root"}], ",", " ", 
       RowBox[{"dominant", " ", "weight"}]}], "}"}]}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylDomRtRepRootVectorsDegens", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vecs", ",", "trvcs", ",", "dgns"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vecs", " ", "=", " ", 
      RowBox[{"WeylDomWtRepRootVectors", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"vecs", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"trvcs", " ", "=", " ", 
      RowBox[{"Transpose", "[", "vecs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgns", " ", "=", " ", 
      RowBox[{"WeylDomWtRepRootDegens", "[", 
       RowBox[{"type", ",", 
        RowBox[{"trvcs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Prepend", "[", 
       RowBox[{"trvcs", ",", "dgns"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Caching", " ", "of", " ", 
   RowBox[{"irreps", "'"}], " ", "Weyl", " ", 
   RowBox[{"orbits", ".", " ", "Uses"}], " ", "a", " ", "global", " ", 
   RowBox[{"cache", " ", "--"}], " ", "can", " ", "get", " ", "which", " ", 
   "irreps", " ", "cached", " ", "with", " ", 
   RowBox[{"DownValues", "[", "]"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "RepresentationWeylOrbitCache", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepOrbits", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rep", ",", "key"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "maxwts"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"RepresentationWeylOrbitCache", "[", "key", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "rep", "]"}], " ", "===", " ", 
        "RepresentationWeylOrbitCache"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"WeylDomRtRepRootVectorsDegens", "[", 
          RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", " ", "=!=", " ", "Null"}], ",", " ", 
          RowBox[{
           RowBox[{"RepresentationWeylOrbitCache", "[", "key", "]"}], " ", 
           "=", " ", "rep"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "rep"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Orbits", " ", "input", " ", "as", " ", "list", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"multiplicity", ",", " ", 
     RowBox[{"dominant", " ", "root"}], ",", " ", 
     RowBox[{"dominant", " ", "weight"}]}], "}"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandWeylOrbits", "[", 
   RowBox[{"type_", ",", "orbits_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "orb", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"orbits", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#", ",", 
             RowBox[{"orb", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ", 
          
          RowBox[{"GetOrbit", "[", 
           RowBox[{"type", ",", 
            RowBox[{"orb", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"orb", ",", "orbits"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Expand", " ", "the", " ", "rep", " ", "with", " ", "the", " ", "Weyl", " ",
    "orbits"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepOrbitsExpanded", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandWeylOrbits", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRepOrbits", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Caching", " ", "of", " ", 
   RowBox[{"representations", ".", " ", "Uses"}], " ", "a", " ", "global", 
   " ", 
   RowBox[{"cache", " ", "--"}], " ", "can", " ", "get", " ", "which", " ", 
   "irreps", " ", "cached", " ", "with", " ", 
   RowBox[{"DownValues", "[", "]"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "RepresentationCache", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRep", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rep", ",", "key"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"key", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"type", ",", "maxwts"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"RepresentationCache", "[", "key", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "rep", "]"}], " ", "===", " ", 
        "RepresentationCache"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"GetRepOrbitsExpanded", "[", 
          RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", " ", "=!=", " ", "Null"}], ",", " ", 
          RowBox[{
           RowBox[{"RepresentationCache", "[", "key", "]"}], " ", "=", " ", 
           "rep"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "rep"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "From", " ", "highest", " ", "weight", " ", "to", " ", "lowest", " ", 
    "weight", " ", "in", " ", "standard", " ", "root"}], "-", 
   RowBox[{"sorting", " ", "order"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SortRep", "[", "rep_", "]"}], " ", ":=", " ", 
  RowBox[{"Sort", "[", 
   RowBox[{"rep", ",", 
    RowBox[{
     RowBox[{"RepRootSortFunc", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "#1", "]"}], ",", 
       RowBox[{"Rest", "[", "#2", "]"}]}], "]"}], "&"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearRepOrbitCaches", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"Clear", "[", "WeylOrbitCache", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "RepresentationWeylOrbitCache", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "RepresentationCache", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepWeylOrbitsVerifyTiming", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t0", ",", "t1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearRepOrbitCaches", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"GetRepDirect", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t1", " ", "=", " ", 
      RowBox[{"Timing", "[", 
       RowBox[{"GetRep", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"t0", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"t0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
        RowBox[{"Sort", "[", 
         RowBox[{"t1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"VerifyAnWeylOrbits", "[", 
   RowBox[{"n_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tpydx", ",", "yds", ",", "mxwts", ",", "k", ",", "mwixs", ",", "mw", 
      ",", "rep", ",", "rpdwmlts", ",", "wo", ",", "dwmlts", ",", "kska"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "<", " ", "pwr"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"tpydx", " ", "=", " ", 
      RowBox[{"GetTensorPowerYDX", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"yds", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"tpydx", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mxwts", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Reverse", "[", 
         RowBox[{"Differences", "[", 
          RowBox[{"Reverse", "[", 
           RowBox[{"PadRight", "[", 
            RowBox[{"#", ",", 
             RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "]"}], "]"}], "&"}], 
       " ", "/@", " ", "yds"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mwixs", "[", 
         RowBox[{"mxwts", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "=", " ", "k"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "mxwts", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dwmlts", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rep", " ", "=", " ", 
          RowBox[{"GetRepOrbits", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], ",", "mw"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rpdwmlts", " ", "=", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Length", "[", "mxwts", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rpdwmlts", "[", 
             RowBox[{"[", 
              RowBox[{"mwixs", "[", 
               RowBox[{"wo", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], "]"}], " ", "=",
             " ", 
            RowBox[{"wo", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"wo", ",", "rep"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "rpdwmlts"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"mw", ",", "mxwts"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kska", " ", "=", " ", 
      RowBox[{"tpydx", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dwmlts", " ", "===", " ", "kska"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irrep Properties", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Finds", " ", "the", " ", "highest", " ", "weight", " ", "of", " ", "the", 
    " ", "conjugate", " ", "irrep"}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "one", " ", "with", " ", "the", " ", "root"}], "-", 
    RowBox[{"vector", "/", "weight"}], "-", 
    RowBox[{"vector", " ", "signs", " ", "reversed"}]}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConjugate", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"family", " ", "\[Equal]", " ", "1"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"A", 
         RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", "maxwts", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"family", " ", "\[Equal]", " ", "4"}], " ", "&&", " ", 
        RowBox[{"OddQ", "[", "n", "]"}]}], ",", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"D", 
          RowBox[{"(", "n", ")"}], " ", "for", " ", "odd", " ", 
          RowBox[{"n", " ", "--"}], " ", "even", " ", "n", " ", "always", " ",
           "self"}], "-", "conjugate"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"maxwts", ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"maxwts", ",", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"family", " ", "\[Equal]", " ", "5"}], " ", "&&", " ", 
        RowBox[{"n", " ", "\[Equal]", " ", "6"}]}], ",", " ", 
       RowBox[{"(*", " ", "E6", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"Most", "[", "maxwts", "]"}], "]"}], ",", 
         RowBox[{"Last", "[", "maxwts", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "maxwts"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepIsSelfConjugate", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mwcjg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mwcjg", " ", "=", " ", 
      RowBox[{"RepConjugate", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mwcjg", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"And", " ", "@@", " ", 
      RowBox[{"Thread", "[", 
       RowBox[{"maxwts", " ", "\[Equal]", " ", "mwcjg"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "height", " ", "of", " ", "a", " ", "rep", " ", "is", " ", 
     "max"}], " ", "-", " ", 
    RowBox[{"min", " ", "of", " ", "all", " ", "the", " ", "root"}], "-", 
    RowBox[{
    "vector", " ", "component", " ", "sums", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "If", " ", "a", " ", "rep", " ", "is", " ", 
     "self"}], "-", "conjugate"}], ",", " ", 
   RowBox[{
   "then", " ", "if", " ", "its", " ", "height", " ", "is", " ", "even"}], 
   ",", " ", 
   RowBox[{"it", " ", "is", " ", "real"}], ",", " ", 
   RowBox[{
   "while", " ", "if", " ", "its", " ", "height", " ", "is", " ", "odd"}], 
   ",", " ", 
   RowBox[{"it", " ", "is", " ", "pseudoreal"}], ",", " ", 
   RowBox[{"x", "."}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepHeightMult", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "*", 
          RowBox[{"(", 
           RowBox[{"n", "-", "k", "+", "1"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "2", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "k", "+", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}], "/", "2"}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"k", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "n"}], "-", "k"}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]",
        "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"k", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "k", "-", "1"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "2"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ",", 
           RowBox[{"n", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "16", ",", "30", ",", "42", ",", "30", ",", "16", ",", "22"}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
          "34", ",", "66", ",", "96", ",", "75", ",", "52", ",", "27", ",", 
           "49"}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
          "92", ",", "182", ",", "270", ",", "220", ",", "168", ",", "114", 
           ",", "58", ",", "136"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"22", ",", "42", ",", "30", ",", "16"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"10", ",", "6"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepHeight", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RepHeightMult", "[", "type", "]"}], ".", "maxwts"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Real", ":", " ", "0"}], ",", " ", 
   RowBox[{"pseudoreal", ":", " ", "1"}], ",", " ", 
   RowBox[{"complex", ":", " ", 
    RowBox[{"-", "1"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepReality", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckLARep", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"RepIsSelfConjugate", "[", 
         RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"-", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"family", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
          RowBox[{"OddQ", "[", "n", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"A", 
            RowBox[{"(", "n", ")"}]}], ",", " ", 
           RowBox[{"n", " ", "odd"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"maxwts", ".", 
          RowBox[{"Range", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"family", " ", "\[Equal]", " ", "2"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"n", "-", "1"}], ",", "4"}], "]"}], " ", "<", " ", 
           "2"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"B", 
            RowBox[{"(", "n", ")"}]}], ",", " ", 
           RowBox[{"n", " ", "=", " ", 
            RowBox[{
             RowBox[{"4", "k"}], "+", "1"}]}], ",", 
           RowBox[{
            RowBox[{"4", "k"}], "+", "2"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"maxwts", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"family", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"C", 
           RowBox[{"(", "n", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"maxwts", ".", 
          RowBox[{"Range", "[", "n", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"family", " ", "\[Equal]", " ", "4"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"n", "-", "2"}], ",", "4"}], "]"}], " ", "<", " ", 
           "2"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"D", 
            RowBox[{"(", "n", ")"}]}], ",", " ", 
           RowBox[{"n", " ", "=", " ", 
            RowBox[{
             RowBox[{"4", "k"}], "+", "2"}]}], ",", 
           RowBox[{
            RowBox[{"4", "k"}], "+", "3"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxwts", "[", 
           RowBox[{"[", 
            RowBox[{"-", "2"}], "]"}], "]"}], " ", "+", " ", 
          RowBox[{"maxwts", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"family", " ", "\[Equal]", " ", "5"}], " ", "&&", " ", 
          RowBox[{"n", " ", "==", " ", "7"}]}], ",", " ", 
         RowBox[{"(*", " ", "E7", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxwts", "[", 
           RowBox[{"[", "4", "]"}], "]"}], " ", "+", " ", 
          RowBox[{"maxwts", "[", 
           RowBox[{"[", "6", "]"}], "]"}], " ", "+", " ", 
          RowBox[{"maxwts", "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         "True", ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", 
        "]"}], ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Weight", " ", "congruency", " ", 
     RowBox[{"classes", ".", "\[IndentingNewLine]", "Conserved"}], " ", 
     "quantities", " ", "in", " ", "weights", " ", "in", " ", "a", " ", 
     RowBox[{"rep", ":", " ", 
      RowBox[{
      "for", " ", "a", " ", "vector", " ", "c", " ", "such", " ", "that", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Cartan", " ", "matrix"}], ")"}], " ", ".", " ", "c"}]}]}]}],
     " ", "=", " ", 
    RowBox[{"0", " ", "mod", " ", "p"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "then", " ", "all", " ", "weights", " ", "w", " ", "will", " ", "have", 
     " ", 
     RowBox[{"w", ".", "c"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"same", " ", "mod", " ", 
      RowBox[{"p", ".", " ", "Rep"}], " ", "products", " ", "will", " ", 
      "have", " ", "highest", " ", "weights", " ", "related", " ", "by", " ", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"w", " ", "-", " ", "w1", " ", "-", " ", "w2"}], ")"}], ".", 
       "c"}], " ", "mod", " ", "p"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "0", "\[IndentingNewLine]", "\[IndentingNewLine]", "For", " ", "A", 
       RowBox[{"(", "n", ")"}], " ", "SU", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "...", ",", "n"}], "}"}], " ", 
       "mod", " ", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}], "\[IndentingNewLine]", "A", 
       RowBox[{"(", "1", ")"}], " ", "SU", 
       RowBox[{"(", "2", ")"}], " ", "j", " ", "is", " ", "integer", " ", 
       RowBox[{"vs", ".", " ", "half"}]}], "-", 
      RowBox[{
       RowBox[{"odd", " ", "/", " ", "tensor"}], " ", 
       RowBox[{"vs", ".", " ", "spinor"}], "\[IndentingNewLine]", "A", 
       RowBox[{"(", "2", ")"}], " ", "SU", 
       RowBox[{"(", "3", ")"}], " ", "triality", "\[IndentingNewLine]", "For",
        " ", "B", 
       RowBox[{"(", "n", ")"}], " ", "SO", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "+", "1"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"...", "1"}]}], "}"}], " ", "mod", " ", 
       RowBox[{"2", " ", "--"}], " ", "tensor", " ", 
       RowBox[{"vs", ".", " ", "spinor"}], "\[IndentingNewLine]", "For", " ", 
       "C", 
       RowBox[{"(", "n", ")"}], " ", "Sp", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}], " ", 
       RowBox[{"it", "'"}], "s", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "..."}], "}"}], " ", 
       "mod", " ", "2", "\[IndentingNewLine]", "For", " ", "D", 
       RowBox[{"(", "n", ")"}], " ", "SO", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}], " ", "it", " ", "depends", " ", "on", " ", 
       
       RowBox[{"n", "'"}], "s", " ", "parity", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"...", "0"}], ",", "1", ",", "1"}], "}"}], " ", "mod", " ", 
       "2", "\[IndentingNewLine]", "Even", " ", "n", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "1", ",", "0", ",", "...", ",", "0", ",", "1", 
         ",", "0"}], "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "1", ",", "0", ",", "...", ",", "0", ",", "0", 
         ",", "1"}], "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", 
       "Odd", " ", "n", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "2", ",", "0", ",", "2", ",", "0", ",", "...", ",", "2", ",", "3", 
         ",", "1"}], "}"}], " ", "mod", " ", "4", "\[IndentingNewLine]", 
       "For", " ", "E6", " ", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}], ",", "0", ",", "1", ",", 
         RowBox[{"-", "1"}], ",", "0"}], "}"}], " ", "mod", " ", "3", 
       "\[IndentingNewLine]", "For", " ", "E7", " ", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1"}], 
        "}"}], " ", "mod", " ", "2", "\[IndentingNewLine]", "None", " ", 
       "for", " ", "G2"}]}]}]}], ",", " ", "F4", ",", " ", 
   RowBox[{
   "or", " ", "E8", "\[IndentingNewLine]", "\[IndentingNewLine]", "When", " ",
     "the", " ", "modulo", " ", "factor", " ", "is", " ", "even"}], ",", " ", 
   
   RowBox[{
    RowBox[{"then", " ", "a", " ", "self"}], "-", 
    RowBox[{
    "conjugate", " ", "rep", " ", "will", " ", "be", " ", "real", " ", "if", 
     " ", "the", " ", "value", " ", "is", " ", "even"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "pseudoreal", " ", "if", " ", "it", " ", "is", " ", "odd"}], 
    ";", " ", "otherwise"}], ",", " ", 
   RowBox[{"it", " ", "is", " ", "always", " ", 
    RowBox[{
    "real", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Gets"}], " ", 
    "an", " ", "algebra", " ", "designation"}], ",", " ", 
   RowBox[{"returns", " ", "multipliers", " ", "for", " ", "weights", " ", 
    RowBox[{"(", 
     RowBox[{"can", " ", "be", " ", "more", " ", "than", " ", "one"}], 
     ")"}]}], ",", " ", 
   RowBox[{"and", " ", "the", " ", "modulus", " ", 
    RowBox[{"(", 
     RowBox[{
     "what", " ", "to", " ", "divide", " ", "by", " ", "and", " ", "take", 
      " ", "the", " ", "remainder", " ", "with"}], ")"}]}]}], " ", 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConservModMult", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ",", 
          RowBox[{"Range", "[", "n", "]"}]}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"n", "-", "1"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
         "}"}], "}"}], ",", "\[IndentingNewLine]", "3", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", "2"}], "]"}]}], "}"}], 
        "}"}], ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"n", "-", "2"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "}"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}]}], "}"}]}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"OddQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"4", ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", 
                    RowBox[{"n", "-", "2"}], "]"}], ",", "2"}], "]"}]}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], "}"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "0", ",", "1", ",", "2", ",", "0"}], 
             "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", 
              "1"}], "}"}]}], "}"}], "}"}], ",", "\[IndentingNewLine]", "8", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConservModuli", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"First", " ", "/@", " ", 
   RowBox[{"RepConservModMult", "[", "type", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepConserv", "[", 
   RowBox[{"type_", ",", "wt_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"wt", ".", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ", 
   RowBox[{"RepConservModMult", "[", "type", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepProperties", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RepReality", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", 
    RowBox[{"RepConservModuli", "[", "type", "]"}], ",", 
    RowBox[{"RepConserv", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Inverses", " ", "of", " ", "Cartan", " ", 
    RowBox[{"matrices", ".", " ", "weight"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"root", ".", "ctnmat"}], " ", "/", " ", "root"}], " ", "=", " ", 
    
    RowBox[{"weight", ".", 
     RowBox[{"inverse", "[", "ctnmat", "]"}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Found", " ", "the", " ", "greatest", " ", "common", " ", "multiples", " ",
     "of", " ", "the", " ", "denominators"}], ";", " ", 
   RowBox[{
    RowBox[{
    "they", " ", "agree", " ", "with", " ", "the", " ", "moduli", " ", "in", 
     " ", "the", " ", "conserved"}], "-", 
    RowBox[{"quantity", " ", 
     RowBox[{"calculations", "."}]}]}]}], " ", "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Casimir Invariant and Index", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CasimirInvariant", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_:", "True"}]}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "posroots", ",", "delta", ",", "metric", ",", "invmet", ",", 
      "ctnmat", ",", "invctn", ",", "maxroots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckLARep", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invmet", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invmet\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"delta", " ", "=", " ", 
      RowBox[{
       RowBox[{"Total", "[", "posroots", "]"}], "/", "2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxroots", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", "invctn", "]"}], ".", "maxwts"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"maxroots", ".", "metric", ".", 
      RowBox[{"(", 
       RowBox[{"maxroots", "+", 
        RowBox[{"2", "*", "delta"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepIndex", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_:", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"TotalDegen", "[", 
    RowBox[{"type", ",", "maxwts", ",", "mwcheck"}], "]"}], "*", 
   RowBox[{
    RowBox[{"CasimirInvariant", "[", 
     RowBox[{"type", ",", "maxwts", ",", "mwcheck"}], "]"}], "/", 
    RowBox[{"AlgDimension", "[", "type", "]"}]}]}]}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Combinations of Representations", "Section"],

Cell[CellGroupData[{

Cell["Irrep Composition", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "cases", " ", "of", " ", "multiple", " ", 
   RowBox[{"irreps", "."}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Reducible", " ", 
    RowBox[{"representations", ":", " ", 
     RowBox[{"express", " ", "as", " ", "sum", " ", "of", " ", "irreps"}]}]}],
    ",", " ", 
   RowBox[{"a", " ", "list", " ", "of", " ", "irrep", " ", "highest", " ", 
    RowBox[{"weights", ".", " ", "Uses"}], " ", "generic", " ", "rep", " ", 
    RowBox[{"function", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"tpx_", ",", "mwlist_", ",", "repfunc_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "maxwts", ",", "indrep", ",", "rprt", ",", "rrkey", ",",
       "nrp", ",", "rep", ",", "ri", ",", "rpix", ",", "ix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Find", " ", "the", " ", "combined", " ", 
       RowBox[{"representation", ".", "\[IndentingNewLine]", "Would"}], " ", 
       "like", " ", "degens"}], ",", " ", "roots", ",", " ", 
      RowBox[{"and", " ", "weights"}], ",", " ", 
      RowBox[{"since", " ", 
       RowBox[{"we", "'"}], "ll", " ", "need", " ", "all", " ", 
       RowBox[{"three", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
        "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
        "power"}], "-", 
       RowBox[{"rep", " ", "list"}]}], ";", " ", 
      RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
       RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
       "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
       "convenience"}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"nrp", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indrep", " ", "===", " ", "Null"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rrkey", " ", "=", " ", 
            RowBox[{"rprt", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rpix", "[", "rrkey", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "ix", "]"}], " ", "===", " ", "rpix"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nrp", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rep", "[", "nrp", "]"}], " ", "=", " ", "rprt"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rpix", "[", "rrkey", "]"}], " ", "=", " ", "nrp"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ri", " ", "=", " ", 
               RowBox[{"rep", "[", "ix", "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"ri", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", 
               RowBox[{"rprt", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"rep", "[", "ix", "]"}], " ", "=", " ", "ri"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rprt", ",", "indrep"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"maxwts", ",", "mwlist"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Array", "[", 
      RowBox[{"rep", ",", "nrp"}], "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CountedMaxWts", "::", "badmwc"}], " ", "=", " ", 
   "\"\<Invalid counted highest-weight vector: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckCountedMWTS", "[", "mwc_", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "mwc", "]"}], " ", "<", " ", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mwc", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "<", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"CountedMaxWts", "::", "badmwc"}], ",", "mwc"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"tpx_", ",", "mwclist_", ",", "repfunc_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "mwc", ",", "cnt", ",", "maxwts", ",", "indrep", ",", 
      "rprt", ",", "rrkey", ",", "nrp", ",", "rep", ",", "ri", ",", "rpix", 
      ",", "ix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Find", " ", "the", " ", "combined", " ", "representation", " ", "for", 
       " ", "a", " ", "counted", " ", 
       RowBox[{"list", ":", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"count", ",", "maxwts"}], ")"}], ".", 
          "\[IndentingNewLine]", "Would"}], " ", "like", " ", "degens"}]}]}], 
      ",", " ", "roots", ",", " ", 
      RowBox[{"and", " ", "weights"}], ",", " ", 
      RowBox[{"since", " ", 
       RowBox[{"we", "'"}], "ll", " ", "need", " ", "all", " ", 
       RowBox[{"three", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
        "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
        "power"}], "-", 
       RowBox[{"rep", " ", "list"}]}], ";", " ", 
      RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
       RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
       "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
       RowBox[{"convenience", ".", "  ", "Uses"}], " ", "generic", " ", "rep",
        " ", 
       RowBox[{"function", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"nrp", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"CheckCountedMWTS", "[", "mwc", "]"}]}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cnt", " ", "=", " ", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"maxwts", " ", "=", " ", 
         RowBox[{"mwc", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indrep", " ", "===", " ", "Null"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{
             RowBox[{"Rest", "[", "#", "]"}], ",", 
             RowBox[{"cnt", "*", 
              RowBox[{"First", "[", "#", "]"}]}]}], "]"}], "&"}], " ", "/@", 
          " ", "indrep"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rrkey", " ", "=", " ", 
            RowBox[{"rprt", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rpix", "[", "rrkey", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "ix", "]"}], " ", "===", " ", "rpix"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nrp", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rep", "[", "nrp", "]"}], " ", "=", " ", "rprt"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rpix", "[", "rrkey", "]"}], " ", "=", " ", "nrp"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ri", " ", "=", " ", 
               RowBox[{"rep", "[", "ix", "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"ri", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", 
               RowBox[{"rprt", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              
              RowBox[{
               RowBox[{"rep", "[", "ix", "]"}], " ", "=", " ", "ri"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rprt", ",", "indrep"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"mwc", ",", "mwclist"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"rep", ",", "nrp"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepList", "[", 
   RowBox[{"type_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"type", ",", "mwlist", ",", "GetRep"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepCntdList", "[", 
   RowBox[{"type_", ",", "mwclist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"type", ",", "mwclist", ",", "GetRep"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Irrep", " ", "of", " ", "product", " ", "of", " ", "Lie", " ", 
   RowBox[{"algebras", ":", " ", 
    RowBox[{
    "outer", " ", "product", " ", "of", " ", "irreps", " ", "of", " ", "each",
      " ", "of", " ", 
     RowBox[{"them", ".", " ", "Follows"}], " ", "the", " ", "format", " ", 
     "of", " ", "the", " ", "individual", " ", "irreps"}], ":", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", " ", "of", " ", 
      RowBox[{"{", 
       RowBox[{"degen", ",", " ", 
        RowBox[{
         RowBox[{"list", " ", "of", " ", "root"}], "-", 
         RowBox[{"vector", " ", "values"}]}], ",", " ", 
        RowBox[{
         RowBox[{"list", " ", "of", " ", "max"}], "-", "weight", "-", 
         RowBox[{"vector", " ", "values"}]}]}], "}"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "U", 
      RowBox[{"(", "1", ")"}], " ", "factors", " ", "are", " ", "implemented",
       " ", "by", " ", "adding", " ", "integers", " ", "or", " ", "rational", 
      " ", "numbers", " ", "after", " ", "the", " ", "max"}], "-", 
     RowBox[{"weight", " ", "vectors", " ", "in", " ", 
      RowBox[{"maxwts", ".", " ", "Every"}], " ", "root", " ", "in", " ", "a",
       " ", "rep", " ", "will", " ", "have", " ", "these", " ", "U", 
      RowBox[{"(", "1", ")"}], " ", 
      RowBox[{"factors", ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", "possible", " ", "for", " ", "a", " ",
       "rep", " ", "to", " ", "contain", " ", "only", " ", "U", 
      RowBox[{"(", "1", ")"}], " ", 
      RowBox[{"factors", "."}]}]}]}]}], "\[IndentingNewLine]", " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "repfunc_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", " ", ",", "ntp", ",", "rep", ",", "i", ",", "type", ",", 
      "indmwts", ",", "indrep", ",", "newrep", ",", "ptrt", ",", "rt", ",", 
      "nwrt", ",", "u1s"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ntp", " ", "=", " ", 
      RowBox[{"Length", "[", "tplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"type", " ", "=", " ", 
         RowBox[{"tplist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", " ", 
        RowBox[{"indmwts", " ", "=", " ", 
         RowBox[{"maxwts", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indrep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"type", ",", "indmwts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"indrep", " ", "===", " ", "Null"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"newrep", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nwrt", " ", "=", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"ptrt", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "*", 
                 RowBox[{"rt", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"ptrt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"rt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"ptrt", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"rt", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"newrep", ",", "nwrt"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"rt", ",", "indrep"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ptrt", ",", "rep"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", "newrep"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "ntp"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "maxwts", " ", "]"}], " ", ">", " ", "ntp"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u1s", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"maxwts", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ntp", "+", "1"}], ",", 
             RowBox[{"Length", "[", "maxwts", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "u1s"}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], ",", "u1s"}], "]"}]}], "}"}], 
           "&"}], " ", "/@", " ", "rep"}]}]}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "rep"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRep", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist", ",", "maxwts", ",", "GetRep"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepOrbits", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetAlgProdRepGeneral", "[", 
   RowBox[{"tplist", ",", "maxwts", ",", "GetRepOrbits"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepList", "[", 
   RowBox[{"tplist_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepListGeneral", "[", 
   RowBox[{"tplist", ",", "mwlist", ",", "GetAlgProdRep"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepCntdList", "[", 
   RowBox[{"tplist_", ",", "mwclist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"GetRepCntdListGeneral", "[", 
   RowBox[{"tplist", ",", "mwclist", ",", "GetAlgProdRep"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Select", " ", 
    RowBox[{"extended", ":", " ", 
     RowBox[{"xttype", " ", "is", " ", 
      RowBox[{"\"\<sngl\>\"", " ", "--"}], " ", "single", " ", "irrep"}]}]}], 
   ",", " ", 
   RowBox[{
    RowBox[{"\"\<list\>\"", " ", "--"}], " ", "list", " ", "of", " ", 
    "irreps"}], ",", " ", 
   RowBox[{
    RowBox[{"\"\<cntd\>\"", " ", "--"}], " ", "counted", " ", "list", " ", 
    "of", " ", "irreps"}], ",", " ", "x"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExtendedMaxWts", "::", "badtype"}], " ", "=", " ", 
   "\"\<Invalid extended-maxwts type: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetRepXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<sngl\>\"", ",", 
    RowBox[{"GetRep", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<list\>\"", ",", 
    RowBox[{"GetRepList", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<cntd\>\"", ",", 
    RowBox[{"GetRepCntdList", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "_", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "Null"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetAlgProdRepXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<sngl\>\"", ",", 
    RowBox[{"GetAlgProdRep", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<list\>\"", ",", 
    RowBox[{"GetAlgProdRepList", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<cntd\>\"", ",", 
    RowBox[{"GetAlgProdRepCntdList", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "_", ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "Null"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Extensions", ".", " ", "Type"}], " ", "is", " ", 
    RowBox[{"\"\<sngl\>\"", " ", "--"}], " ", "single", " ", "irrep"}], ",", 
   " ", 
   RowBox[{
    RowBox[{"\"\<list\>\"", " ", "--"}], " ", "list", " ", "of", " ", 
    "irreps"}], ",", " ", 
   RowBox[{
    RowBox[{"\"\<cntd\>\"", " ", "--"}], " ", "counted", " ", "list", " ", 
    "of", " ", 
    RowBox[{"irreps", ".", " ", "The"}], " ", "algebra", " ", "products", " ",
     "are", " ", 
    RowBox[{"{", 
     RowBox[{"la1", ",", "...", ",", "lan"}], "}"}]}], ",", " ", 
   RowBox[{"with", " ", "the", " ", "corresponding", " ", "irreps", " ", 
    RowBox[{"{", 
     RowBox[{"wt1", ",", "...", ",", "wtn", ",", "u1", ",", 
      RowBox[{"...", "um"}]}], "}"}], " ", "where", " ", "the", " ", 
    RowBox[{"la", "'"}], "s", " ", "are", " ", "the", " ", "individual", " ", 
    "algebras"}], ",", " ", 
   RowBox[{"the", " ", 
    RowBox[{"wt", "'"}], "s", " ", "the", " ", "individual", " ", "weights"}],
    ",", " ", 
   RowBox[{"and", " ", "the", " ", 
    RowBox[{"u", "'"}], "s", " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "factors", " ", "x"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<sngl\>\"", ",", 
    RowBox[{"TotalDegen", "[", 
     RowBox[{"type", ",", "maxwts"}], "]"}], ",", "\"\<list\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TotalDegen", "[", 
        RowBox[{"type", ",", "#"}], "]"}], "&"}], " ", "/@", " ", "maxwts"}], 
     "]"}], ",", "\"\<cntd\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"TotalDegen", "[", 
         RowBox[{"type", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgProdTotalDegen", "[", 
   RowBox[{"tplist_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Product", "[", 
   RowBox[{
    RowBox[{"TotalDegen", "[", 
     RowBox[{
      RowBox[{"tplist", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"maxwts", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "tplist", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlgProdTotalDegenXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Switch", "[", 
   RowBox[{"xttype", ",", "\"\<sngl\>\"", ",", 
    RowBox[{"AlgProdTotalDegen", "[", 
     RowBox[{"tplist", ",", "maxwts"}], "]"}], ",", "\"\<list\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AlgProdTotalDegen", "[", 
        RowBox[{"tplist", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}], ",", "\"\<cntd\>\"", ",", 
    RowBox[{"Total", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"AlgProdTotalDegen", "[", 
         RowBox[{"tplist", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], " ", "/@", " ", 
      "maxwts"}], "]"}], ",", 
    RowBox[{
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}], 
     ";", "Null"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Create", " ", "rep", " ", "indexing", " ", "from", " ", "list", " ", 
    "form", " ", "of", " ", 
    RowBox[{"rep", ".", "\[IndentingNewLine]", 
     RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}]}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{"number", "\[IndentingNewLine]", 
     RowBox[{"rpix", "[", 
      RowBox[{"\"\<Entry\>\"", ",", " ", "index"}], "]"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"rep", " ", "entry", "\[IndentingNewLine]", 
      RowBox[{"rpix", "[", 
       RowBox[{"\"\<Weight\>\"", ",", " ", 
        RowBox[{"weight", "-", "vector"}]}], "]"}]}], " ", "=", " ", 
     "index"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoRepIndexing", "[", 
   RowBox[{"rep_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "i", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Length", "[", "rep", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}], " ", "=", " ", "n"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"rep", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Entry\>\"", ",", "i"}], "]"}], " ", "=", " ", "r"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Weight\>\"", ",", 
           RowBox[{"r", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], " ", "=", " ", "i"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InitIndexedRep", "[", "rpix_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}], " ", "=", " ", 
   "0"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddEntryToIndexedRep", "[", 
   RowBox[{"rpix_", ",", "rpen_", ",", 
    RowBox[{"mult_:", "1"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ix", ",", "ixen"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ix", " ", "=", " ", 
      RowBox[{"rpix", "[", 
       RowBox[{"\"\<Weight\>\"", ",", 
        RowBox[{"rpen", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "ix", "]"}], " ", "===", " ", "rpix"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Add", " ", "a", " ", "new", " ", "entry"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Bump", " ", "up", " ", "the", " ", "number"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}], "++"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Add", " ", "the", " ", "rep", " ", "entry", " ", "as", " ", 
          "indexed"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ixen", " ", "=", " ", "rpen"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ixen", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "*=", " ", "mult"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Entry\>\"", ",", 
           RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}]}], "]"}], " ", "=", 
         " ", "ixen"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Add", " ", "the", " ", "indexing", " ", "by", " ", "the", " ", 
          "weight", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Weight\>\"", ",", 
           RowBox[{"rpen", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], " ", "=", " ", 
         RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Adjust", " ", "the", " ", "multiplicity", " ", "of", " ", "an", " ", 
         "existing", " ", "entry"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ixen", " ", "=", " ", 
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Entry\>\"", ",", "ix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ixen", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", 
         RowBox[{"mult", "*", 
          RowBox[{"rpen", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Entry\>\"", ",", "ix"}], "]"}], " ", "=", " ", 
         "ixen"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IndexedRepToList", "[", "rpix_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "rep", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"Array", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rpix", "[", 
          RowBox[{"\"\<Rep\>\"", ",", "#"}], "]"}], "&"}], ",", 
        RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{"rep", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Extracts", " ", "irreps", " ", "from", " ", "an", " ", "indexed", " ", 
    "rep"}], ",", " ", 
   RowBox[{"altering", " ", "it", " ", "as", " ", "it", " ", 
    RowBox[{"goes", ".", " ", 
     RowBox[{"Args", ":", " ", "algebra"}]}]}], ",", " ", 
   RowBox[{"indexed", " ", "rep"}], ",", " ", 
   RowBox[{"maximum", "-", 
    RowBox[{"root", " ", "function"}]}], ",", " ", 
   RowBox[{
    RowBox[{"irrep", "-", 
     RowBox[{"finding", " ", "function"}]}], ";", " ", 
    RowBox[{
    "it", " ", "alters", " ", "the", " ", "mults", " ", "in", " ", "rpix", 
     " ", "as", " ", "it", " ", 
     RowBox[{"goes", ".", " ", "It"}], " ", "returns", " ", "a", " ", 
     "counted", " ", "list", " ", "of", " ", "results"}]}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"tpx_", ",", "rpix_", ",", "maxrootfunc_", ",", "repfunc_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "irreplist", ",", "found", ",", "n", ",", "i", ",", "rpen", ",", 
      "maxroot", ",", "wts", ",", "nwt", ",", "rep"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"irreplist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Search", " ", "for", " ", "the", " ", "highest", " ", 
          RowBox[{"weight", ".", " ", "Ordering"}], " ", "is", " ", "with", 
          " ", "the", " ", "roots"}], ",", " ", 
         RowBox[{
          RowBox[{"not", " ", "with", " ", "the", " ", 
           RowBox[{"weights", ".", " ", "Recommended"}], " ", "in", " ", 
           "Weight", " ", 
           RowBox[{"(", 
            RowBox[{"representation", " ", "theory"}], ")"}]}], " ", "-", " ",
           "Wikipedia"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"the", " ", "free", " ", "encyclopedia"}], " ", "-", " ", 
           RowBox[{"http", ":"}]}], "//", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/",
             "Weight_"}], 
           RowBox[{"(", "representation_theory", ")"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"rpix", "[", "\"\<Count\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxroot", "=", " ", "Null"}], ";", "\[IndentingNewLine]", 
        RowBox[{"found", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"rpen", " ", "=", " ", 
            RowBox[{"rpix", "[", 
             RowBox[{"\"\<Entry\>\"", ",", "i"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Skip", " ", "over", " ", "zero", " ", "ones"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rpen", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"found", " ", "=", " ", "True"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxroot", " ", "=", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"maxroot", " ", "===", " ", "Null"}], ",", "rpen", ",", 
              
              RowBox[{"maxrootfunc", "[", 
               RowBox[{"maxroot", ",", "rpen"}], "]"}]}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"None", " ", 
          RowBox[{"found", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "found"}], ",", " ", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Found", " ", 
          RowBox[{"it", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"nwt", " ", "=", " ", 
         RowBox[{"maxroot", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"wts", " ", "=", " ", 
         RowBox[{"maxroot", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"irreplist", ",", 
          RowBox[{"{", 
           RowBox[{"nwt", ",", "wts"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"repfunc", "[", 
          RowBox[{"tpx", ",", "wts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"rep", "===", " ", "Null"}], ",", " ", 
          RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AddEntryToIndexedRep", "[", 
           RowBox[{"rpix", ",", "rpen", ",", 
            RowBox[{"-", "nwt"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"rpen", ",", "rep"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "irreplist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Bias", " ", "toward", " ", "the", " ", "first", " ", "one"}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MaxRepRoot", "[", 
   RowBox[{"en_", ",", "enx_"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"enx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"en", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], " ", ">", " ", "0"}],
     ",", "enx", ",", "en"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepIrreps", "[", 
   RowBox[{"type_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "GetRep"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractAlgProdRepIrreps", "[", 
   RowBox[{"tplist_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"tplist", ",", "rpix", ",", "MaxRepRoot", ",", "GetAlgProdRep"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractRepOrbitIrreps", "[", 
   RowBox[{"type_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "GetRepOrbits"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtractAlgProdRepOrbitIrreps", "[", 
   RowBox[{"tplist_", ",", "rpix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"ExtractRepIrrepsGeneral", "[", 
   RowBox[{
   "tplist", ",", "rpix", ",", "MaxRepRoot", ",", "GetAlgProdRepOrbits"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Application", ":", " ", 
   RowBox[{"from", " ", "Weyl", " ", "orbits", " ", "to", " ", "irreps"}]}], 
  " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RepsFromWeylOrbits", "[", 
   RowBox[{"type_", ",", "orbs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rpix", ",", "orb"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InitIndexedRep", "[", "rpix", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AddEntryToIndexedRep", "[", 
        RowBox[{"rpix", ",", "orb"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"orb", ",", "orbs"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "GetRepOrbits"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Uses", " ", "rep", " ", "sizes", " ", "instead", " ", "of", " ", 
   "expanding", " ", "the", " ", "orbits"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitSizeFromReps", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "invctn", ",", "orbs", ",", "reps"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"invctn", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbs", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"maxwts", ".", "invctn"}], ",", "maxwts"}], "}"}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"reps", " ", "=", " ", 
      RowBox[{"RepsFromWeylOrbits", "[", 
       RowBox[{"type", ",", "orbs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"TotalDegen", "[", 
          RowBox[{"type", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], " ", "/@", " ", 
       "reps"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irrep Products", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
  "From", " ", "an", " ", "algebra", " ", "and", " ", "a", " ", "pair", " ", 
   "of", " ", 
   RowBox[{"irreps", "."}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"UE", " ", "functions"}], " ", "-", " ", 
    RowBox[{
    "whether", " ", "or", " ", "not", " ", "to", " ", "use", " ", "an", " ", 
     RowBox[{"entry", ".", " ", "The"}], " ", "args", " ", "are", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Length", " ", "of", " ", 
     "the", " ", "SS"}], "-", "algebra", "-", 
    RowBox[{"product", " ", "part"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Weight", " ", 
     RowBox[{"vector", " ", "--"}], " ", "SS"}], "-", 
    RowBox[{
    "algebra", " ", "weights", " ", "or", " ", "list", " ", "of", " ", 
     "weights"}], " ", "+", " ", 
    RowBox[{"U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{
     "factors", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "The"}], 
     " ", "length", " ", "argument", " ", "is", " ", "ignored", " ", "for", 
     " ", "a", " ", "single", " ", "weight", " ", "vector", " ", "or", " ", 
     "for", " ", "using", " ", "all", " ", "the", " ", "weights", " ", 
     RowBox[{
      RowBox[{"(", "UEAll", ")"}], ".", " ", "The"}], " ", "\"\<Orbits\>\"", 
     " ", "functions", " ", "are", " ", "for", " ", "using", " ", "only", " ",
      "the", " ", "dominant", " ", "weights", " ", "of", " ", "Weyl", " ", 
     "orbits"}]}], ",", " ", 
   RowBox[{"a", " ", "speedup", " ", "that", " ", "also", " ", "saves", " ", 
    RowBox[{"memory", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UEAll", "[", 
   RowBox[{"nsa_", ",", "wts_"}], "]"}], " ", ":=", " ", "True"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UEOrbits", "[", 
   RowBox[{"nsa_", ",", "wts_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Min", "[", "wts", "]"}], " ", "\[GreaterEqual]", " ", 
   "0"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"UEAlgProdOrbits", "[", 
   RowBox[{"nsa_", ",", "wts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"nsa", " ", ">", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"Take", "[", 
       RowBox[{"wts", ",", "nsa"}], "]"}], "]"}], "\[GreaterEqual]", " ", 
     "0"}], ",", " ", "True"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{
   "type_", ",", "rep1_", ",", "rep2_", ",", "repfunc_", ",", "useentry_", 
    ",", "nsa_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i1", ",", " ", "i2", ",", "rpm1", ",", "rpm2", ",", " ", "rpm12", ",", 
      "rpix"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep1", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep2", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Use", " ", "index", " ", "function", " ", "to", " ", "speed", " ", 
       "up", " ", "the", " ", "lookup"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"InitIndexedRep", "[", "rpix", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rpm12", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"rpm1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"rpm2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"rpm1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "+", 
            RowBox[{"rpm2", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"rpm1", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "+", 
            RowBox[{"rpm2", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"useentry", "[", 
           RowBox[{"nsa", ",", 
            RowBox[{"rpm12", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AddEntryToIndexedRep", "[", 
           RowBox[{"rpix", ",", "rpm12"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rpm1", ",", "rep1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"rpm2", ",", "rep2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"type", ",", "rpix", ",", "MaxRepRoot", ",", "repfunc"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductXtnd", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype1", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype2", ",", "maxwts2"}], "]"}], ",", 
    "GetRepOrbits", ",", "UEOrbits", ",", " ", "0"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetRep"}]}]}], ",", " ", "UEAll", ",", " ",
    "0"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProduct", "[", 
   RowBox[{"type_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductXtnd", "[", 
   RowBox[{
   "type", ",", "\"\<sngl\>\"", ",", "maxwts1", ",", "\"\<sngl\>\"", ",", 
    "maxwts2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductVerify", "[", 
   RowBox[{"type_", ",", "maxwt1_", ",", "maxwt2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mwlst", ",", "rpp", ",", "mwszs", ",", "rpszs", ",", "mwtot", ",", 
      "rptot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mwlst", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"maxwt1", ",", "maxwt2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpp", " ", "=", " ", 
      RowBox[{"DecomposeRepProduct", "[", 
       RowBox[{"type", ",", "maxwt1", ",", "maxwt2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwszs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"TotalDegen", "[", 
         RowBox[{"type", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
       "mwlst"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpszs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"TotalDegen", "[", 
           RowBox[{"type", ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], " ", "/@",
        " ", "rpp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mwtot", " ", "=", "  ", 
      RowBox[{"Times", " ", "@@", " ", "mwszs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rptot", " ", "=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], " ", "/@", " ", "rpszs"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mwlst", ",", "rpp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mwszs", ",", "rpszs"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mwtot", ",", "rptot"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Alternate", ":", " ", 
    RowBox[{"do", " ", "products", " ", "on", " ", "irreps"}]}], ",", " ", 
   RowBox[{
   "then", " ", "combine", " ", "the", " ", "resulting", " ", "counted", " ", 
    "lists"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandXtndWeightList", "[", 
   RowBox[{"xttype_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"xttype", " ", "\[Equal]", " ", "\"\<cntd\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{"And", " ", "@@", " ", 
            RowBox[{"(", 
             RowBox[{"CheckCountedMWTS", " ", "/@", " ", "maxwts"}], ")"}]}], 
           ")"}]}], ",", " ", 
         RowBox[{"Return", "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"xttype", ",", "\"\<sngl\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "maxwts"}], "}"}], "}"}], ",", "\"\<list\>\"", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "#"}], "}"}], "&"}], " ", "/@", " ", "maxwts"}], 
       ",", "\"\<cntd\>\"", ",", "maxwts", ",", "_", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"ExtendedMaxWts", "::", "badtype"}], ",", "xttype"}], "]"}],
         ";", "Null"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProductXtndAlt", "[", 
   RowBox[{
   "type_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "mwcl1", ",", "mwcl2", ",", "nres", ",", "rslst", ",", 
      "rsix", ",", "mw1", ",", "mw2", ",", "mres", ",", "mri", ",", "mrnm", 
      ",", "mrwt", ",", "ix", ",", "rsi"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"mwcl1", " ", "=", " ", 
      RowBox[{"ExpandXtndWeightList", "[", 
       RowBox[{"xttype1", ",", "maxwts1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwcl2", " ", "=", "  ", 
      RowBox[{"ExpandXtndWeightList", "[", 
       RowBox[{"xttype2", ",", "maxwts2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mwcl1", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mwcl2", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nres", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mres", " ", "=", " ", 
         RowBox[{"DecomposeRepProduct", "[", 
          RowBox[{"type", ",", 
           RowBox[{"mw1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"mw2", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mres", " ", "===", " ", "Null"}], ",", 
          RowBox[{
           RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
           RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mrnm", "=", " ", 
            RowBox[{
             RowBox[{"mw1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"mw2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"mri", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"mrwt", " ", "=", " ", 
            RowBox[{"mri", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rsix", "[", "mrwt", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "ix", "]"}], " ", "===", " ", "rsix"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nres", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rsix", "[", "mrwt", "]"}], " ", "=", " ", "nres"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rslst", "[", "nres", "]"}], " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"mrnm", ",", "mrwt"}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rsi", " ", "=", " ", 
               RowBox[{"rslst", "[", "ix", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rsi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", "mrnm"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rslst", "[", "ix", "]"}], " ", "=", " ", "rsi"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"mri", ",", "mres"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"mw1", ",", "mwcl1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mw2", ",", "mwcl2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"rslst", ",", "nres"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Find", " ", "a", " ", "rep", " ", "product", " ", "for", " ", "a", " ", 
    "list", " ", "of", " ", "reps"}], ",", " ", 
   RowBox[{"and", " ", "not", " ", "just", " ", "2", " ", "reps"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepProdList", "[", 
   RowBox[{"type_", ",", "mwlist_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DecomposeRepProductXtnd", "[", 
      RowBox[{
      "type", ",", "\"\<cntd\>\"", ",", "#1", ",", "\"\<sngl\>\"", ",", 
       "#2"}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"type", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], "}"}], "}"}], 
    ",", "mwlist"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Find", " ", "a", " ", "rep", " ", "product", " ", "for", " ", "a", " ", 
   "product", " ", "of", " ", "algebras"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProductXtnd", "[", 
   RowBox[{
   "tplist_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DecomposeRepProductRoots", "[", 
   RowBox[{"tplist", ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype1", ",", "maxwts1"}], "]"}], ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype2", ",", "maxwts2"}], "]"}], ",", 
    "GetAlgProdRepOrbits", ",", "UEAlgProdOrbits", ",", 
    RowBox[{"Length", "[", "tplist", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetAlgProdRep"}]}]}], ",", " ", "UEAll", 
   ",", " ", "0"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProduct", "[", 
   RowBox[{"tplist_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"DecomposeAlgProdRepProductXtnd", "[", 
   RowBox[{
   "tplist", ",", "\"\<sngl\>\"", ",", "maxwts1", ",", "\"\<sngl\>\"", ",", 
    "maxwts2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProductXtndAlt", "[", 
   RowBox[{
   "tplist_", ",", "xttype1_", ",", "maxwts1_", ",", "xttype2_", ",", 
    "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "InputsOK", ",", "ntp", ",", "mwcl1", ",", "mwcl2", ",", "nres", ",", 
      "rslst", ",", "rsix", ",", "mw1", ",", "mw2", ",", "mres", ",", "mri", 
      ",", "mrnm", ",", "mrwt", ",", "ix", ",", "rsi", ",", "j", ",", 
      "mresnew", ",", "mrsind", ",", "jr", ",", "jm", ",", "mrsii", ",", 
      "rden", ",", "rdnwen", ",", " ", "u1", ",", " ", "u2", ",", " ", 
      "usum"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"InputsOK", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ntp", " ", "=", " ", 
      RowBox[{"Length", "[", "tplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mwcl1", " ", "=", " ", 
      RowBox[{"ExpandXtndWeightList", "[", 
       RowBox[{"xttype1", ",", "maxwts1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwcl2", " ", "=", "  ", 
      RowBox[{"ExpandXtndWeightList", "[", 
       RowBox[{"xttype2", ",", "maxwts2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mwcl1", " ", "\[Equal]", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"mwcl2", " ", "\[Equal]", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nres", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mres", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", "}"}]}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mresnew", " ", "=", " ", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mrsind", " ", "=", " ", 
            RowBox[{"DecomposeRepProduct", "[", 
             RowBox[{
              RowBox[{"tplist", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              RowBox[{"mw1", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j"}], "]"}], "]"}], ",", 
              RowBox[{"mw2", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mrsind", " ", "===", " ", "Null"}], ",", 
             RowBox[{
              RowBox[{"InputsOK", " ", "=", " ", "False"}], ";", " ", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rden", " ", "=", " ", 
               RowBox[{"mres", "[", 
                RowBox[{"[", "jr", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"mrsii", " ", "=", " ", 
               RowBox[{"mrsind", "[", 
                RowBox[{"[", "jm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"rdnwen", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rden", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"mrsii", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"rden", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                   RowBox[{"mrsii", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"mresnew", ",", "rdnwen"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"jr", ",", 
               RowBox[{"Length", "[", "mres", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jm", ",", 
               RowBox[{"Length", "[", "mrsind", "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mres", " ", "=", " ", "mresnew"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "ntp"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "InputsOK"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"u1", " ", "=", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"mw1", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "ntp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"u2", " ", "=", " ", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"mw2", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "ntp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"usum", " ", "=", " ", 
         RowBox[{"u1", " ", "+", " ", "u2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mres", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "usum"}], "]"}]}], "}"}],
            "&"}], " ", "/@", " ", "mres"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mrnm", "=", " ", 
            RowBox[{
             RowBox[{"mw1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"mw2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"mri", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"mrwt", " ", "=", " ", 
            RowBox[{"mri", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rsix", "[", "mrwt", "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "ix", "]"}], " ", "===", " ", "rsix"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nres", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rsix", "[", "mrwt", "]"}], " ", "=", " ", "nres"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rslst", "[", "nres", "]"}], " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"mrnm", ",", "mrwt"}], "}"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rsi", " ", "=", " ", 
               RowBox[{"rslst", "[", "ix", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rsi", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", "mrnm"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"rslst", "[", "ix", "]"}], " ", "=", " ", "rsi"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"mri", ",", "mres"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"mw1", ",", "mwcl1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mw2", ",", "mwcl2"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "InputsOK"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Array", "[", 
        RowBox[{"rslst", ",", "nres"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], "&"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepProductAlt", "[", 
   RowBox[{"tplist_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"DecomposeAlgProdRepProductXtndAlt", "[", 
   RowBox[{
   "tplist", ",", "\"\<sngl\>\"", ",", "maxwts1", ",", "\"\<sngl\>\"", ",", 
    "maxwts2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "A", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "one", " ", "can", " ", "use", " ", "Young", " ", "diagrams", " ", "and", 
     " ", "the", " ", "Littlewood"}], "-", 
    RowBox[{"Richardson", " ", "rule"}]}]}], " ", "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Irrep Powers", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "This", " ", "is", " ", "separate", " ", "from", " ", "Irrep", " ", 
    "Products"}], ",", " ", 
   RowBox[{
   "because", " ", "it", " ", "has", " ", "a", " ", "lot", " ", "of", " ", 
    "stuff", " ", "that", " ", "has", " ", "to", " ", "be", " ", "calculated",
     " ", "for", " ", "it"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Tensor", "-", 
    RowBox[{"product", " ", "A", 
     RowBox[{
      RowBox[{"(", "n", ")"}], "/", "SU"}], 
     RowBox[{"(", 
      RowBox[{"n", "+", "1"}], ")"}], " ", "reps", " ", "calculated", " ", 
     "with", " ", "Young", " ", 
     RowBox[{
     "diagrams", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "B"}], 
     RowBox[{
      RowBox[{"(", "n", ")"}], "/", "SO"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "n"}], "+", "1"}], ")"}], " ", "D", 
     RowBox[{
      RowBox[{"(", "n", ")"}], "/", "SO"}], 
     RowBox[{"(", 
      RowBox[{"2", "n"}], ")"}], " ", "have", " ", "traces", " ", "factored", 
     " ", "out", " ", "and", " ", "C", 
     RowBox[{
      RowBox[{"(", "n", ")"}], "/", "Sp"}], 
     RowBox[{"(", 
      RowBox[{"2", "n"}], ")"}], " ", "have", " ", "sort"}], "-", "of", "-", 
    RowBox[{
    "traces", " ", "with", " ", "the", " ", "symplectic", " ", "metrix", " ", 
     
     RowBox[{"(", 
      RowBox[{"J", " ", "=", " ", 
       RowBox[{"-", " ", 
        RowBox[{"J", "^", "T"}]}]}], ")"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "Reset", " ", "by", " ", 
     RowBox[{"doing", ":", " ", "TensorPowersYDX"}]}]}], " ", "=", " ", 
   RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorPowersYDX", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDTensAddVector", "[", "ylst_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ylnew", ",", 
      RowBox[{"ylnl", "=", 
       RowBox[{"{", "}"}]}], ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ylnew", " ", "=", " ", "ylst"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ylnew", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ylnl", ",", "ylnew"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ylst", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", ">", " ", 
          RowBox[{"ylst", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ylnew", " ", "=", " ", "ylst"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ylnew", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "+=", " ", "1"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"ylnl", ",", "ylnew"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"Length", "[", "ylst", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ylnew", " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{"ylst", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ylnl", ",", "ylnew"}], "]"}], ";", "\[IndentingNewLine]", 
     "ylnl"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"memcount", "[", "lst_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"lst", ",", "#"}], "]"}], ",", "#"}], "}"}], "&"}], " ", "/@", 
   " ", 
   RowBox[{"Union", "[", "lst", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"multnomfac", "[", "dgrm_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "cnts", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cnts", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"memcount", "[", "dgrm", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", "cnts", "]"}], "!"}], "/", 
      RowBox[{"(", 
       RowBox[{"Times", " ", "@@", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "!"}], "&"}], " ", "/@", " ", "cnts"}], ")"}]}], 
       ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDTensSetAddVector", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nxdgs", "=", 
       RowBox[{"{", "}"}]}], ",", "dgcnt", ",", "dgentry", ",", "num", ",", 
      "dg", ",", "i", ",", "ndgs", ",", "ndg", ",", "j", ",", "nxdgmlst"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dgentry", " ", "=", " ", 
         RowBox[{"dgrmlist", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"num", " ", "=", " ", 
         RowBox[{"dgentry", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"dg", " ", "=", " ", 
         RowBox[{"dgentry", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ndgs", " ", "=", " ", 
         RowBox[{"YDTensAddVector", "[", "dg", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ndg", " ", "=", " ", 
            RowBox[{"ndgs", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"dgcnt", "[", "ndg", "]"}], "]"}], " ", "===", " ", 
              "dgcnt"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"nxdgs", ",", "ndg"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"dgcnt", "[", "ndg", "]"}], " ", "=", " ", "0"}]}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"dgcnt", "[", "ndg", "]"}], " ", "+=", " ", "num"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "ndgs", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "dgrmlist", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nxdgmlst", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ndg", " ", "=", " ", 
          RowBox[{"nxdgs", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dgcnt", "[", "ndg", "]"}], ",", "ndg", ",", 
           RowBox[{"Length", "[", "ndg", "]"}], ",", 
           RowBox[{"multnomfac", "[", "ndg", "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "nxdgs", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "nxdgmlst"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetMultiplicities", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetRepDiagrams", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetLengths", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDGetMultinomFacs", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "&"}], " ", "/@", " ", 
   "dgrmlist"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeYDSetIndexing", "[", 
   RowBox[{"dgrms_", ",", "dgix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dgix", "[", 
      RowBox[{"dgrms", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", "=", " ", "i"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Uses", " ", "a", " ", "list", " ", "of", " ", "contracted", " ", "Young", 
   " ", "diagrams", " ", "that", " ", "are", " ", "all", " ", "with", " ", 
   "some", " ", "number", " ", "of", " ", 
   RowBox[{"boxes", ".", " ", "They"}], " ", "are", " ", "assumed", " ", "to",
    " ", "be", " ", "ordered", " ", "so", " ", "that", " ", "the", " ", 
   "matrix", " ", "will", " ", "be", " ", "upper", " ", "triangular"}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDKostkaMatrix", "[", "dgrms_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dglen", ",", "i", ",", "dg", ",", "dgix", ",", "lookback", ",", 
      "denfac", ",", "dgl", ",", "j", ",", "jx", ",", "dgx", ",", "k", ",", 
      "ix", ",", "dgd", ",", "kostka", ",", "kknum"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Index", " ", "the", " ", "diagrams"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MakeYDSetIndexing", "[", 
      RowBox[{"dgrms", ",", "dgix"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "\"\<C\>\"", " ", "lookback", " ", "matrix", " ", "and", 
       " ", "\"\<g\>\"", " ", "denominator", " ", "factor"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lookback", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"denfac", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dg", " ", "=", " ", 
         RowBox[{"dgrms", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgl", " ", "=", " ", 
         RowBox[{"Length", "[", "dg", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Do", " ", "lookback"}], ";", " ", 
          RowBox[{"the", " ", "+=", " ", 
           RowBox[{
           "takes", " ", "care", " ", "of", " ", "the", " ", "multiplicities",
             " ", 
            RowBox[{"automatically", "."}]}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"dgx", " ", "=", " ", "dg"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dgx", "[", 
               RowBox[{"[", "j", "]"}], "]"}], " ", "+=", " ", "k"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"dgx", "[", 
               RowBox[{"[", "jx", "]"}], "]"}], " ", "-=", " ", "k"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dgd", " ", "=", " ", 
              RowBox[{
               RowBox[{"dgx", "[", 
                RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
               RowBox[{"dgx", "[", 
                RowBox[{"[", "jx", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dgx", " ", "=", " ", 
              RowBox[{"Reverse", "[", 
               RowBox[{"Sort", "[", "dgx", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Last", "[", "dgx", "]"}], "\[Equal]", "0"}], ",", 
               RowBox[{"dgx", "=", 
                RowBox[{"Most", "[", "dgx", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ix", " ", "=", " ", 
              RowBox[{"dgix", "[", "dgx", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"lookback", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "ix"}], "]"}], "]"}], " ", "+=", " ", 
              "dgd"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"dg", "[", 
               RowBox[{"[", "jx", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"dgl", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"jx", ",", 
            RowBox[{"j", "+", "1"}], ",", "dgl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Denominator", " ", "factor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"denfac", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"dg", ".", "dg"}], ")"}]}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"dg", ".", 
            RowBox[{"Range", "[", "dgl", "]"}]}], ")"}]}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kostka", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"kostka", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"kknum", " ", "=", " ", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"lookback", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "k"}], "]"}], "]"}], "*", 
               RowBox[{"kostka", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "k"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"k", ",", "i", ",", 
                RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"kknum", " ", "\[NotEqual]", " ", "0"}], ",", 
             RowBox[{
              RowBox[{"kostka", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"kknum", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"denfac", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"denfac", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}]}]}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "dglen"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "kostka"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDNesting", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dgrms", ",", "dlens", ",", "dmnfs", ",", "dglen", ",", "dgix", ",", 
      "nesting", ",", "dgrm", ",", "i", ",", "j", ",", "k", ",", "l", ",", 
      "subdgrms", ",", "sublens", ",", "submnfs", ",", "dgxp", ",", "dgxpm", 
      ",", "insdg", ",", "dxplst", ",", "lns", ",", "mnf"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dlens", " ", "=", " ", 
      RowBox[{"YDGetLengths", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dmnfs", " ", "=", " ", 
      RowBox[{"YDGetMultinomFacs", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeYDSetIndexing", "[", 
      RowBox[{"dgrms", ",", "dgix"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}], ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"dgrm", " ", "=", " ", 
         RowBox[{"dgrms", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"subdgrms", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetRepDiagrams", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dgrms", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sublens", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetLengths", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dlens", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"submnfs", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "dgrm", "]"}], " ", ">", " ", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"YDGetMultinomFacs", "[", 
              RowBox[{"TensorPowersYDX", "[", 
               RowBox[{"[", 
                RowBox[{"#", ",", "1"}], "]"}], "]"}], "]"}], "&"}], " ", "/@",
             " ", "dgrm"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "dmnfs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgxp", " ", "=", " ", 
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "#", "]"}], "]"}], "&"}], " ", "/@", " ", 
           "subdgrms"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dgxpm", " ", "=", " ", 
            RowBox[{"dgxp", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"insdg", " ", "=", " ", 
            RowBox[{"Reverse", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"subdgrms", "[", 
                   RowBox[{"[", 
                    RowBox[{"l", ",", 
                    RowBox[{"dgxpm", "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"l", ",", 
                    RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}], 
                ",", "1"}], "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"dgix", "[", "insdg", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lns", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"sublens", "[", 
               RowBox[{"[", 
                RowBox[{"l", ",", 
                 RowBox[{"dgxpm", "[", 
                  RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", 
                RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"mnf", " ", "=", " ", 
            RowBox[{"Times", " ", "@@", " ", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"submnfs", "[", 
                RowBox[{"[", 
                 RowBox[{"l", ",", 
                  RowBox[{"dgxpm", "[", 
                   RowBox[{"[", "l", "]"}], "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", 
                 RowBox[{"Length", "[", "dgxpm", "]"}]}], "}"}]}], "]"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"dxplst", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"dgxpm", ",", "lns", ",", "mnf"}], "}"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"nesting", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "dxplst"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "dgxp", "]"}]}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "nesting"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"YDFillOut", "[", "dgrmlist_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dgrms", ",", "kska", ",", "nesting"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kska", " ", "=", " ", 
      RowBox[{"YDKostkaMatrix", "[", "dgrms", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{"YDNesting", "[", "dgrmlist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"dgrmlist", ",", "kska", ",", "nesting"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetTensorPowerYDX", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tplen", ",", "k", ",", "tnsp", ",", "dgrm", ",", "dgrmlist"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", " ", "\[LessEqual]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"YDFillOut", "[", 
         RowBox[{"{", "}"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tplen", " ", "=", " ", 
      RowBox[{"Length", "[", "TensorPowersYDX", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tplen", " ", "<", " ", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dgrm", " ", "=", " ", 
         RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "dgrm", ",", 
            RowBox[{"Length", "[", "dgrm", "]"}], ",", 
            RowBox[{"multnomfac", "[", "dgrm", "]"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TensorPowersYDX", ",", 
          RowBox[{"YDFillOut", "[", "dgrmlist", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tplen", " ", "=", " ", 
         RowBox[{"Length", "[", "TensorPowersYDX", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tnsp", " ", "=", " ", 
         RowBox[{"Last", "[", "TensorPowersYDX", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"tnsp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgrmlist", " ", "=", " ", 
         RowBox[{"YDTensSetAddVector", "[", "dgrmlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"TensorPowersYDX", ",", 
          RowBox[{"YDFillOut", "[", "dgrmlist", "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"tplen", "+", "1"}], ",", "n"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"TensorPowersYDX", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Args", ":", " ", 
    RowBox[{"tensor", "-", "power", "-", 
     RowBox[{"ydx", " ", "value"}]}]}], ",", " ", 
   RowBox[{"indexer", " ", "of", " ", 
    RowBox[{"rep", "/", "digram"}]}], ",", " ", 
   RowBox[{"list", " ", "of", " ", "indexes"}], ",", " ", 
   RowBox[{"multiplicity", " ", "list", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"gets", " ", "indexed"}], ")"}], ".", " ", 
     RowBox[{"Returns", ":", " ", 
      RowBox[{"list", " ", "of", " ", 
       RowBox[{"(", 
        RowBox[{"multiplicity", ",", "index"}], ")"}]}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"multiplicities", " ", "for", " ", "product"}], "-", 
    RowBox[{"rep", " ", "calculation"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorPowerRootMultiplicities", "[", 
   RowBox[{"TensPwrYDX_", ",", "dgix_", ",", "idxs_", ",", "mults_"}], "]"}], 
  " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mc", ",", "repyd", ",", "ixms", ",", "mspwrs", ",", "kostka", ",", 
      "nesting", ",", "nstmem", ",", "nstmmi", ",", "pwrs", ",", "mncf", ",", 
      "pwr", ",", "mspl", ",", "mspwr", ",", "mpres", ",", "i", ",", "j", ",",
       "k", ",", "l"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mc", " ", "=", " ", 
      RowBox[{"memcount", "[", "idxs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mc", " ", "=", " ", 
      RowBox[{"Sort", "[", 
       RowBox[{"mc", ",", 
        RowBox[{
         RowBox[{"OrderedQ", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "&"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"repyd", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "mc"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"ixms", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"mults", "[", 
         RowBox[{"[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], " ", "/@", 
       " ", "mc"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mspwrs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "#", "}"}], "&"}], " ", "/@", " ", "ixms"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kostka", " ", "=", " ", 
      RowBox[{"TensPwrYDX", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nesting", " ", "=", " ", 
      RowBox[{"TensPwrYDX", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", 
         RowBox[{"dgix", "[", "repyd", "]"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mpres", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"nstmem", " ", "=", " ", 
          RowBox[{"nesting", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nstmmi", " ", "=", " ", 
             RowBox[{"nstmem", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pwrs", " ", "=", " ", 
             RowBox[{"nstmmi", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"mncf", " ", "=", " ", 
             RowBox[{"nstmmi", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"mncf", "*", 
             RowBox[{"Product", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"pwr", " ", "=", " ", 
                 RowBox[{"pwrs", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspwr", " ", "=", " ", 
                 RowBox[{"mspwrs", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspl", " ", "=", " ", 
                 RowBox[{"Length", "[", "mspwr", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pwr", " ", ">", " ", "mspl"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"mspwrs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Last", "[", "mspwr", "]"}], "*", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ixms", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", "l", "+", "1"}], 
                    ")"}], "/", "l"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"{", 
                    RowBox[{"l", ",", 
                    RowBox[{"mspl", "+", "1"}], ",", "pwr"}], "}"}]}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"mspwrs", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "pwr"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", "pwrs", "]"}]}], "}"}]}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", "nstmem", "]"}]}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "nesting", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mc", ",", 
       RowBox[{"kostka", ".", "mpres"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Generator", " ", "of", " ", "index", " ", 
    RowBox[{"sets", ".", " ", "The"}], " ", "indexes", " ", "are", " ", 
    "semi"}], "-", 
   RowBox[{"ascending", "."}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstIndexVector", "[", "vlen_", "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", "vlen", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{
  "The", " ", "\"\<next\>\"", " ", "function", " ", "returns", " ", "Null", 
   " ", "when", " ", "it", " ", "runs", " ", "out"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NextIndexVector", "[", 
   RowBox[{"vlen_", ",", "ntot_", ",", "ixvec_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nixvec", ",", "k", ",", "l", ",", "didadvance"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nixvec", " ", "=", " ", "ixvec"}], ";", "\[IndentingNewLine]", 
     RowBox[{"didadvance", " ", "=", " ", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"nixvec", "[", 
          RowBox[{"[", "k", "]"}], "]"}], " ", "+=", " ", "1"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"nixvec", "[", 
            RowBox[{"[", "k", "]"}], "]"}], " ", "\[LessEqual]", " ", 
           "ntot"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"nixvec", "[", 
               RowBox[{"[", "l", "]"}], "]"}], " ", "=", " ", 
              RowBox[{"nixvec", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", 
               RowBox[{"k", "+", "1"}], ",", "vlen"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"didadvance", " ", "=", " ", "True"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "vlen", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"didadvance", ",", "nixvec", ",", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "This", " ", "is", " ", "for", " ", "decomposing", " ", "a", " ", 
    "representation", " ", "decomposed", " ", "as", " ", "roots"}], ",", " ", 
   
   RowBox[{
   "for", " ", "the", " ", "purpose", " ", "of", " ", "handling", " ", 
    "reducible", " ", "as", " ", "well", " ", "as", " ", "irreducible", " ", 
    RowBox[{"representations", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RepPower", "::", "badreppwr"}], " ", "=", " ", 
   "\"\<Invalid rep power: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckRepPower", "[", "pwr_", "]"}], " ", ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "pwr", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RepPower", "::", "badreppwr"}], ",", "pwr"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "<", " ", "0"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"RepPower", "::", "badreppwr"}], ",", "pwr"}], "]"}], ";", 
        RowBox[{"Return", "[", "False", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{
   "tpx_", ",", "rep_", ",", "pwr_", ",", "repfunc_", ",", "useentry_", ",", 
    "nsa_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "len", ",", "zerovec", ",", " ", "tpydx", ",", "dgrms", ",", "dglen", 
      ",", "dgix", ",", "rtdgns", ",", "rpdcnums", ",", "rppwrix", ",", 
      "ixvec", ",", "tpres", ",", "tpdgrm", ",", "tpmlts", ",", "rt", ",", 
      "rtsum", ",", "ixmult", ",", "i", ",", "ix", ",", "rni", ",", 
      "rppval"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepPower", "[", "pwr", "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Zero", ":", " ", 
       RowBox[{"scalar", " ", "rep"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"0", "*", 
             RowBox[{"rep", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], "}"}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Get", " ", "tensor"}], "-", 
       RowBox[{"product", " ", "data", " ", "for", " ", "power"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tpydx", " ", "=", " ", 
      RowBox[{"GetTensorPowerYDX", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tpydx", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", 
       RowBox[{"tpydx", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dglen", " ", "=", " ", 
      RowBox[{"Length", "[", "dgrms", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeYDSetIndexing", "[", 
      RowBox[{"dgrms", ",", "dgix"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
         "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
         "power"}], "-", 
        RowBox[{"rep", " ", "list"}]}], ";", " ", 
       RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
        RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
        "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
        "convenience"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"InitIndexedRep", "[", 
        RowBox[{"rppwrix", "[", "i", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rtdgns", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "rep"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rpdcnums", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "dglen", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ixvec", " ", "=", " ", 
      RowBox[{"FirstIndexVector", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpres", " ", "=", " ", 
         RowBox[{"TensorPowerRootMultiplicities", "[", 
          RowBox[{"tpydx", ",", "dgix", ",", "ixvec", ",", "rtdgns"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"tpres", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpmlts", " ", "=", " ", 
         RowBox[{"tpres", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ixmult", " ", "=", " ", 
            RowBox[{"tpdgrm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rt", " ", "=", "  ", 
            RowBox[{
             RowBox[{"ixmult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"rep", "[", 
                RowBox[{"[", 
                 RowBox[{"ixmult", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", 
             RowBox[{"rtsum", " ", "=", " ", "rt"}], ",", " ", 
             RowBox[{"rtsum", " ", "+=", " ", "rt"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"rtsum", ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"useentry", "[", 
             RowBox[{"nsa", ",", 
              RowBox[{"rtsum", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AddEntryToIndexedRep", "[", 
             RowBox[{
              RowBox[{"rppwrix", "[", "i", "]"}], ",", "rtsum", ",", 
              RowBox[{"tpmlts", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "dglen"}], "}"}]}], "\[IndentingNewLine]", "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"ixvec", " ", "=", " ", 
         RowBox[{"NextIndexVector", "[", 
          RowBox[{"pwr", ",", 
           RowBox[{"Length", "[", "rtdgns", "]"}], ",", "ixvec"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ixvec", "===", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ExtractRepIrrepsGeneral", "[", 
        RowBox[{"tpx", ",", 
         RowBox[{"rppwrix", "[", "i", "]"}], ",", "MaxRepRoot", ",", 
         "repfunc"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dglen"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "irreducible", " ", "reps"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPowerXtnd", "[", 
   RowBox[{"type_", ",", "xttype_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ",
   ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"type", ",", " ", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",", 
    "GetRepOrbits", ",", "UEOrbits", ",", "0"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetRep"}]}]}], ",", " ", "UEAll", ",", " ",
    "0"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPower", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepPowerXtnd", "[", 
   RowBox[{"type", ",", " ", "\"\<sngl\>\"", ",", "maxwts", ",", "pwr"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPowerXtnd", "[", 
   RowBox[{"tplist_", ",", "xttype_", ",", "maxwts_", ",", "pwr_"}], "]"}], 
  " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPower", "[", 
   RowBox[{"tplist", ",", " ", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",",
     "GetAlgProdRepOrbits", ",", "UEAlgProdOrbits", ",", 
    RowBox[{"Length", "[", "tplist", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetAlgProdRep"}]}]}], ",", " ", "UEAll", 
   ",", " ", "0"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPower", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{"DecomposeAlgProdRepPowerXtnd", "[", 
   RowBox[{"tplist", ",", " ", "\"\<sngl\>\"", ",", "maxwts", ",", "pwr"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPowerVerify", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tpydx", ",", "dgrms", ",", "dgmlts", ",", "rpls", ",", "mwsz", ",", 
      "rpl", ",", "rpszs", ",", "rptot", ",", "mwtnum", ",", " ", "mwtden", 
      ",", "mwtot", ",", "dgrm", ",", "dglen", ",", "dgmax", ",", "dgplaq", 
      ",", "dgdual", ",", "i", ",", "j1", ",", "j2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"tpydx", " ", "=", " ", 
      RowBox[{"GetTensorPowerYDX", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dgrms", " ", "=", " ", 
      RowBox[{"YDGetRepDiagrams", "[", 
       RowBox[{"tpydx", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dgmlts", " ", "=", " ", 
      RowBox[{"YDGetMultiplicities", "[", 
       RowBox[{"tpydx", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rpls", " ", "=", " ", 
      RowBox[{"DecomposeRepPower", "[", 
       RowBox[{"type", ",", "maxwts", ",", "pwr"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mwsz", " ", "=", " ", 
      RowBox[{"TotalDegen", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rpl", " ", "=", " ", 
         RowBox[{"rpls", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rpszs", " ", "=", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"TotalDegen", "[", 
              RowBox[{"type", ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], " ", 
          "/@", " ", "rpl"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rptot", " ", "=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}], " ", "/@", " ", 
           "rpszs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgrm", " ", "=", " ", 
         RowBox[{"dgrms", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mwtnum", " ", "=", " ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{"mwsz", "-", "j1", "+", "j2"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", 
             RowBox[{"Length", "[", "dgrm", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j2", ",", 
             RowBox[{"dgrm", "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dglen", " ", "=", " ", 
         RowBox[{"Length", "[", "dgrm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgmax", " ", "=", " ", 
         RowBox[{"Max", "[", "dgrm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dgplaq", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "dglen", "}"}], ",", 
           RowBox[{"{", "dgmax", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dgplaq", "[", 
            RowBox[{"[", 
             RowBox[{"j1", ",", "j2"}], "]"}], "]"}], "=", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"j1", ",", "dglen"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j2", ",", 
            RowBox[{"dgrm", "[", 
             RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dgdual", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"dgplaq", "[", 
              RowBox[{"[", 
               RowBox[{"j1", ",", "j2"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j1", ",", "dglen"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j2", ",", "dgmax"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"mwtden", " ", "=", " ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dgrm", "[", 
               RowBox[{"[", "j1", "]"}], "]"}], "-", "j2"}], ")"}], "+", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dgdual", "[", 
               RowBox[{"[", "j2", "]"}], "]"}], "-", "j1"}], ")"}], "+", 
            "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"j1", ",", "dglen"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j2", ",", 
             RowBox[{"dgrm", "[", 
              RowBox[{"[", "j1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mwtot", " ", "=", " ", 
         RowBox[{"mwtnum", "/", "mwtden"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"maxwts", ",", 
            RowBox[{"{", 
             RowBox[{"mwsz", ",", "pwr"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"dgrm", ",", "rpl"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"dgmlts", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", "rpszs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"mwtot", ",", "rptot"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "rpls", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Pure", " ", "symmetric", " ", "and", " ", "antisymmetric", " ", 
    RowBox[{"cases", ":", " ", "sym"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"+", "1"}], " ", "and"}], " ", "-", "1"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{
   "tpx_", ",", "rep_", ",", "pwr_", ",", "sym_", ",", "repfunc_", ",", 
    "useentry_", ",", " ", "nsa_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "symx", ",", "len", ",", "zerovec", ",", " ", "tpydx", ",", "dgrms", ",",
       "dglen", ",", "dgix", ",", "rtdgns", ",", "rppwrix", ",", "ixvec", ",",
       "tpres", ",", "tpdgrm", ",", "dgi", ",", "dnm", ",", "nmi", ",", 
      "tpmlts", ",", "rt", ",", "rtsum", ",", "ixmult", ",", "i", ",", "ix", 
      ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"CheckRepPower", "[", "pwr", "]"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Zero", ":", " ", 
       RowBox[{"scalar", " ", "rep"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pwr", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"0", "*", 
            RowBox[{"rep", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Fix", " ", "the", " ", "symmetry", " ", "factor"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"symx", " ", "=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sym", " ", "<", "0"}], ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
        "Use", " ", "index", " ", "function", " ", "rppwrix", " ", "to", " ", 
         "speed", " ", "up", " ", "lookups", " ", "in", " ", "the", " ", 
         "power"}], "-", 
        RowBox[{"rep", " ", "list"}]}], ";", " ", 
       RowBox[{"index", " ", "with", " ", "the", " ", "weight", " ", 
        RowBox[{"vector", ".", " ", "Also"}], " ", "pull", " ", "out", " ", 
        "the", " ", "root", " ", "multiplicities", " ", "for", " ", 
        "convenience"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rtdgns", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", "rep"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"InitIndexedRep", "[", "rppwrix", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ixvec", " ", "=", " ", 
      RowBox[{"FirstIndexVector", "[", "pwr", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"memcount", "[", "ixvec", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tpdgrm", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"tpdgrm", ",", 
           RowBox[{
            RowBox[{"OrderedQ", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#1", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tpmlts", " ", "=", " ", 
         RowBox[{"Product", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"dgi", " ", "=", " ", 
             RowBox[{"tpdgrm", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dnm", " ", "=", " ", 
             RowBox[{"dgi", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"nmi", " ", "=", " ", 
             RowBox[{"rtdgns", "[", 
              RowBox[{"[", 
               RowBox[{"dgi", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nmi", " ", "+", " ", 
                 RowBox[{"symx", "*", 
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}]}]}], ")"}], "/", "j"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "dnm"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ixmult", " ", "=", " ", 
            RowBox[{"tpdgrm", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rt", " ", "=", " ", 
            RowBox[{
             RowBox[{"ixmult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"rep", "[", 
                RowBox[{"[", 
                 RowBox[{"ixmult", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], ",", 
             RowBox[{"rtsum", " ", "=", " ", "rt"}], ",", 
             RowBox[{"rtsum", " ", "+=", " ", "rt"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "tpdgrm", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"PrependTo", "[", 
         RowBox[{"rtsum", ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"useentry", "[", 
           RowBox[{"nsa", ",", 
            RowBox[{"rtsum", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AddEntryToIndexedRep", "[", 
           RowBox[{"rppwrix", ",", "rtsum", ",", "tpmlts"}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ixvec", " ", "=", " ", 
         RowBox[{"NextIndexVector", "[", 
          RowBox[{"pwr", ",", 
           RowBox[{"Length", "[", "rtdgns", "]"}], ",", "ixvec"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ixvec", "===", "Null"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ExtractRepIrrepsGeneral", "[", 
      RowBox[{"tpx", ",", "rppwrix", ",", "MaxRepRoot", ",", "repfunc"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPwrSymXtnd", "[", 
   RowBox[{
   "type_", ",", "xttype_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}],
   " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"type", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{"type", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",", 
    "sym", ",", "GetRepOrbits", ",", "UEOrbits", ",", " ", "0"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetRep"}]}]}], ",", " ", "UEAll", ",", " ",
    "0"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeRepPwrSym", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}], " ", ":=",
   " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepPwrSymXtnd", "[", 
   RowBox[{
   "type", ",", "\"\<sngl\>\"", ",", "maxwts", ",", "pwr", ",", "sym"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPwrSymXtnd", "[", 
   RowBox[{
   "tplist_", ",", "xttype_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], 
   "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeRepRootsPwrSym", "[", 
   RowBox[{"tplist", ",", 
    RowBox[{"GetAlgProdRepXtnd", "[", 
     RowBox[{"tplist", ",", "xttype", ",", "maxwts"}], "]"}], ",", "pwr", ",",
     "sym", ",", "GetAlgProdRepOrbits", ",", "UEAlgProdOrbits", ",", 
    RowBox[{"Length", "[", "tplist", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"orbit", " ", "dom", " ", 
     RowBox[{"wts", " ", "--"}], " ", "all", " ", 
     RowBox[{"entries", ":", " ", "GetAlgProdRep"}]}]}], ",", " ", "UEAll"}], 
  " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DecomposeAlgProdRepPwrSym", "[", 
   RowBox[{"tplist_", ",", "maxwts_", ",", "pwr_", ",", "sym_"}], "]"}], " ", 
  ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"DecomposeAlgProdRepPwrSymXtnd", "[", 
   RowBox[{
   "tplist", ",", "\"\<sngl\>\"", ",", "maxwts", ",", "pwr", ",", "sym"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Various", " ", "identities", " ", "involving", " ", 
     RowBox[{"plethysms", ":", " ", 
      RowBox[{"rep", "-", 
       RowBox[{"power", " ", 
        RowBox[{
        "decompositions", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"http", ":"}]}]}]}]}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"www", ".", "sbfisica", ".", "org", ".", "br"}], "/", "bjp"}],
        "/", "files"}], "/", "v32_"}], "641.", "pdf", "\[IndentingNewLine]", 
     "The", " ", "Plethysm", " ", "Technique", " ", "Applied", " ", "to", " ",
      "the", " ", "Classification", " ", "of", " ", "Nuclear", " ", 
     "States"}]}], ",", " ", 
   RowBox[{"by", " ", "Alcaras"}], ",", " ", "Tambergs", ",", " ", "Krasta", 
   ",", " ", "Ruza", ",", " ", 
   RowBox[{"Katkevicius", "\[IndentingNewLine]", "\[IndentingNewLine]", "plt", 
    RowBox[{"(", 
     RowBox[{"a", ",", "x"}], ")"}], " ", "is", " ", "the", " ", "plethysm", 
    " ", "of", " ", "a", " ", "on", " ", "x"}], ",", " ", 
   RowBox[{
   "with", " ", "a", " ", "the", " ", "plethysmer", " ", "and", " ", "x", " ",
     "the", " ", "plethysmed", " ", "one"}], ",", " ", 
   RowBox[{
    RowBox[{"an", " ", 
     RowBox[{"irrep", ".", " ", "a"}], " ", "is", " ", "a", " ", 
     RowBox[{"partition", " ", "/", " ", "Young"}], " ", 
     RowBox[{"diagram", ".", " ", "A"}], " ", "power", " ", "p", " ", 
     "decomposes", " ", "into", " ", "diagrams", " ", "a", " ", "with", " ", 
     "length", " ", 
     RowBox[{
     "p", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Inner"}], " ", 
     RowBox[{"product", ":", " ", 
      RowBox[{"a", ".", "b"}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"sum", " ", "of", " ", "ipc", 
      RowBox[{"(", 
       RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "*", " ", "c", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "ipc", 
      RowBox[{"(", 
       RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "N"}], " ", "sum", " ", "over", " ", "diagrams", " ",
        "r", " ", "of", " ", "N", 
       RowBox[{"(", "r", ")"}], "*", "X", 
       RowBox[{"(", 
        RowBox[{"a", ",", "r"}], ")"}], "*", "X", 
       RowBox[{"(", 
        RowBox[{"b", ",", "r"}], ")"}], "*", "X", 
       RowBox[{"(", 
        RowBox[{"c", ",", "r"}], ")"}], "\[IndentingNewLine]", "X", 
       RowBox[{"(", 
        RowBox[{"a", ",", "r"}], ")"}]}], " ", "=", " ", 
      RowBox[{
      "characters", " ", "of", " ", "symmetric", " ", "group", " ", "for", 
       " ", "irrep", " ", "a", " ", "and", " ", "class", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{"always", " ", "integer"}], ")"}]}]}]}]}], ",", " ", 
   RowBox[{"N", 
    RowBox[{"(", "r", ")"}], " ", "is", " ", "order", " ", "of", " ", "class",
     " ", "with", " ", 
    RowBox[{"part", "/", "diag"}], " ", "r"}], ",", " ", 
   RowBox[{
    RowBox[{"N", " ", "is", " ", "total", " ", 
     RowBox[{
     "order", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Outer"}], 
     " ", 
     RowBox[{"product", ":", " ", 
      RowBox[{"a", "*", "b"}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"sum", " ", "of", " ", "opc", 
      RowBox[{"(", 
       RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "*", " ", "c", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "opc", 
      RowBox[{"(", 
       RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "one", " ", 
      "calculates", " ", "uses", " ", "the", " ", "Littlewood"}], "-", 
     RowBox[{"Richardson", " ", 
      RowBox[{
      "rule", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Reps"}], 
      " ", "x"}]}]}], ",", 
   RowBox[{"y", " ", "have", " ", "sum", " ", 
    RowBox[{"(", 
     RowBox[{
     "sum", " ", "of", " ", "coefficients", " ", "of", " ", "irreps", " ", 
      "in", " ", "it"}], ")"}]}], ",", " ", 
   RowBox[{"difference", " ", 
    RowBox[{"(", 
     RowBox[{"likewise", " ", "with", " ", "differences"}], ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{"product", " ", 
     RowBox[{"(", 
      RowBox[{"rep", " ", "product"}], ")"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "The", " ", 
     RowBox[{
     "identities", ":", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plt", 
       RowBox[{"(", 
        RowBox[{"a", ",", 
         RowBox[{"plt", 
          RowBox[{"(", 
           RowBox[{"b", ",", "x"}], ")"}]}]}], ")"}]}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"plt", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"plt", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}], ",", "x"}], ")"}], 
      "\[IndentingNewLine]", "plt", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", "+", 
         RowBox[{"-", " ", "b"}]}], ",", " ", "x"}], ")"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"plt", 
        RowBox[{"(", 
         RowBox[{"a", ",", "x"}], ")"}]}], " ", "+", 
       RowBox[{
        RowBox[{"-", " ", "plt"}], 
        RowBox[{"(", 
         RowBox[{"b", ",", "x"}], ")"}], "\[IndentingNewLine]", "plt", 
        RowBox[{"(", 
         RowBox[{"a", ",", " ", 
          RowBox[{"x", " ", "+", " ", "y"}]}], ")"}]}]}], " ", "=", " ", 
      RowBox[{"sum", " ", "over", " ", "b"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c", " ", "of", " ", "ipc", 
     RowBox[{"(", 
      RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "*", " ", "plt", 
     RowBox[{"(", 
      RowBox[{"b", ",", "x"}], ")"}], "*", "plt", 
     RowBox[{"(", 
      RowBox[{"c", ",", "y"}], ")"}], "\[IndentingNewLine]", "plt", 
     RowBox[{"(", 
      RowBox[{"a", ",", " ", 
       RowBox[{"x", " ", "-", " ", "y"}]}], ")"}]}], " ", "=", " ", 
    RowBox[{"sum", " ", "over", " ", "b"}]}], ",", 
   RowBox[{
    RowBox[{"c", " ", "of", " ", "ipc", 
     RowBox[{"(", 
      RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "*", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "^", "length"}], 
     RowBox[{"(", "c", ")"}], " ", "*", " ", "plt", 
     RowBox[{"(", 
      RowBox[{"b", ",", "x"}], ")"}], "*", "plt", 
     RowBox[{"(", 
      RowBox[{"c", ",", "y"}], ")"}], "\[IndentingNewLine]", "plt", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "*", "b"}], ",", "x"}], ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"plt", 
      RowBox[{"(", 
       RowBox[{"a", ",", "x"}], ")"}], "*", "plt", 
      RowBox[{"(", 
       RowBox[{"b", ",", "x"}], ")"}], "\[IndentingNewLine]", "plt", 
      RowBox[{"(", 
       RowBox[{"a", ",", 
        RowBox[{"x", "*", "y"}]}], ")"}]}], " ", "=", " ", 
     RowBox[{"sum", " ", "over", " ", "b"}]}]}], ",", 
   RowBox[{
    RowBox[{"c", " ", "of", " ", "opc", 
     RowBox[{"(", 
      RowBox[{"a", ",", "b", ",", "c"}], ")"}], " ", "*", " ", "plt", 
     RowBox[{"(", 
      RowBox[{"b", ",", "x"}], ")"}], "*", "plt", 
     RowBox[{"(", 
      RowBox[{"c", ",", "y"}], ")"}], "\[IndentingNewLine]", "conjg", 
     RowBox[{"(", 
      RowBox[{"plt", 
       RowBox[{"(", 
        RowBox[{"a", ",", "x"}], ")"}]}], ")"}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"plt", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "'"}], ",", 
         RowBox[{"conjg", 
          RowBox[{"(", "x", ")"}]}]}], ")"}], " ", "--"}], " ", 
      RowBox[{"a", "'"}]}], " ", "=", " ", 
     RowBox[{"a", " ", "for", " ", "length", 
      RowBox[{"(", "a", ")"}], " ", "even"}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"conjg", 
     RowBox[{"(", "a", ")"}], " ", "for", " ", "it", " ", "odd", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Conjecture"}], "-", 
    RowBox[{"test", " ", "code", " ", "removed", " ", "as", " ", 
     RowBox[{"unnecessary", "."}]}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Subalgebras and Branching Rules", "Section"],

Cell[CellGroupData[{

Cell["Doing the Branching, Setup Functions", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Takes", " ", "a", " ", "branching", " ", "generator", " ", "and", " ", 
     "the", " ", "max", " ", "weights", " ", "of", " ", "a", " ", "parent"}], 
    "-", 
    RowBox[{"group", " ", "irrep"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "finds", " ", "a", " ", "list", " ", "of", " ", "irreps", " ",
      "of", " ", "the", " ", "subgroups", " ", "and", " ", "U", 
     RowBox[{"(", "1", ")"}], " ", "factors", " ", "with", " ", "their", " ", 
     "degeneracies", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "Mathematica", " ", "does", " ", "not", " ", "do", " ", "object"}], "-", 
    
    RowBox[{"oriented", " ", "programming", " ", "very", " ", "well"}]}], ",",
    " ", 
   RowBox[{"so", " ", "I", " ", "use", " ", 
    RowBox[{"ld", "[", "\"\<member\>\"", "]"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "where", " ", "the", " ", "members", " ", "are", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"type", " ", "--"}], " ", "type", " ", "of", " ", "original", 
     " ", "algbra", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "--"}], " ", "list", " ", "of", " ", "types", 
     " ", "of", " ", "the", " ", "subalgebras", "\[IndentingNewLine]", 
     RowBox[{"rootassigns", " ", "--"}], " ", "assignments", " ", "of", " ", 
     "the", " ", "main"}], "-", 
    RowBox[{
    "algebra", " ", "roots", " ", "in", " ", "the", " ", "subalgebras"}]}], 
   ",", " ", 
   RowBox[{"where", " ", "used", "\[IndentingNewLine]", 
    RowBox[{"submats", " ", "--"}], " ", "projection", " ", "matrices", " ", 
    "for", " ", "the", " ", "roots", " ", "of", " ", "the", " ", 
    "subalgebras", " ", 
    RowBox[{"(", 
     RowBox[{"not", " ", "weights"}], ")"}], "\[IndentingNewLine]", 
    RowBox[{"u1s", " ", "--"}], " ", "list", " ", "of", " ", "indices", " ", 
    "of", " ", "roots", " ", "that", " ", "have", " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "factors"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"ld_", ",", "rep_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u1s", ",", "submats", ",", "nsa", ",", "la", ",", "ctnmats", ",", 
      "rpix", ",", "i", ",", "rpmem", ",", "rt", ",", "j", ",", "rts", ",", 
      "wts", ",", "u1vals", ",", "k", ",", "u1fac", ",", "rtdcmp"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmats", " ", "=", "  ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"la", " ", "=", " ", 
          RowBox[{"GetLieAlgebra", "[", 
           RowBox[{
            RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"InitIndexedRep", "[", "rpix", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rt", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rts", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"rt", ".", 
            RowBox[{"submats", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"wts", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rts", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ".", 
            RowBox[{"ctnmats", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Handle", " ", "both", " ", "the", " ", "cases", " ", "of", " ", "a",
           " ", "vector", " ", "to", " ", "multiply", " ", "the", " ", 
          "roots", " ", "and", " ", "a", " ", "root", " ", "index"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"u1vals", " ", "=", " ", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "u1fac", "]"}], " ", "===", " ", "List"}], 
             ",", 
             RowBox[{"u1fac", ".", "rt"}], ",", 
             RowBox[{"rt", "[", 
              RowBox[{"[", "u1fac", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"u1fac", ",", "u1s"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rtdcmp", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rpmem", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"rts", ",", "u1vals"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"wts", ",", "u1vals"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"UEAlgProdOrbits", "[", 
           RowBox[{"nsa", ",", 
            RowBox[{"rtdcmp", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AddEntryToIndexedRep", "[", 
           RowBox[{"rpix", ",", "rtdcmp"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ExtractAlgProdRepOrbitIrreps", "[", 
      RowBox[{
       RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], ",", "rpix"}], "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Originally", "\[IndentingNewLine]", "\[IndentingNewLine]", "Only", " ", 
   RowBox[{"AddEntryToIndexedRep", "[", 
    RowBox[{"rpix", ",", "rtdcmp"}], "]"}], " ", "without", " ", 
   RowBox[{"UEAlgProdOrbits", "[", 
    RowBox[{"nsa", ",", 
     RowBox[{"rtdcmp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"ExtractAlgProdRepIrreps", "[", 
    RowBox[{
     RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], ",", "rpix"}], "]"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranchingXtnd", "[", 
   RowBox[{"ld_", ",", "type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DoBranchingRoots", "[", 
   RowBox[{"ld", ",", 
    RowBox[{"GetRepXtnd", "[", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<type\>\"", "]"}], ",", "type", ",", "maxwts"}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranching", "[", 
   RowBox[{"ld_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DoBranchingXtnd", "[", 
   RowBox[{"ld", ",", "\"\<sngl\>\"", ",", "maxwts"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoBranchingVerify", "[", 
   RowBox[{"ld_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rpp", ",", "mwtot", ",", "rpszs", ",", "nsa", ",", "i", ",", " ", 
      "rptot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rpp", " ", "=", " ", 
      RowBox[{"DoBranching", "[", 
       RowBox[{"ld", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mwtot", " ", "=", " ", 
      RowBox[{"TotalDegen", "[", 
       RowBox[{
        RowBox[{"ld", "[", "\"\<type\>\"", "]"}], ",", "maxwts"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"ld", "[", "\"\<submats\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rpszs", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"TotalDegen", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", "i", "]"}], 
              ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}], "}"}], "&"}], " ", "/@",
        " ", "rpp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rptot", " ", "=", " ", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{"Times", " ", "@@", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "&"}], " ", "/@", " ",
         "rpszs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"maxwts", ",", "rpp"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mwtot", ",", "rpszs"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mwtot", ",", "rptot"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeBrancher", "[", 
   RowBox[{"ld_", ",", "type_", ",", "stsms_", ",", "u1s_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"stsmstr", ",", "subtypes", ",", "submats"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"In", " ", "case", " ", 
      RowBox[{"it", "'"}], "s", " ", "all", " ", "U", 
      RowBox[{
       RowBox[{"(", "1", ")"}], "'"}], "s"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "stsms", "]"}], " ", ">", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stsmstr", " ", "=", " ", 
         RowBox[{"Transpose", "[", "stsms", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"subtypes", " ", "=", " ", 
         RowBox[{"stsmstr", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"submats", " ", "=", " ", 
         RowBox[{"stsmstr", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"subtypes", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", " ", 
        RowBox[{"submats", " ", "=", " ", 
         RowBox[{"{", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "ld", "]"}], "===", "Symbol"}], ",", 
       RowBox[{"Clear", "[", "ld", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<type\>\"", "]"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], " ", "=", " ", 
      "subtypes"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}], " ", "=", " ", "submats"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<u1s\>\"", "]"}], " ", "=", " ", "u1s"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Makes", " ", "submats", " ", "intended", " ", "for", " ", "weight", " ", 
    RowBox[{"space", ".", " ", 
     RowBox[{"Args", ":", " ", 
      RowBox[{"size", " ", "of", " ", "original"}]}]}]}], ",", " ", 
   RowBox[{"special", " ", "column"}], ",", " ", 
   RowBox[{
    RowBox[{
    "list", " ", "of", " ", "original", " ", "root", " ", "for", " ", "each", 
     " ", "result", " ", 
     RowBox[{"root", ".", " ", "Original"}], " ", "root"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", "1"}], " ", "makes", " ", "the", " ", "special", " ", 
     "column"}]}], ",", " ", 
   RowBox[{"intended", " ", "for", " ", "extension", " ", 
    RowBox[{"splitting", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WtSpcSubmat", "[", 
   RowBox[{"n_", ",", "spccol_", ",", "origrts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "smat", ",", "i", ",", "ix", ",", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"Length", "[", "origrts", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"smat", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{"{", "m", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"origrts", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "\[Equal]", " ", 
           RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"smat", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"spccol", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ix", " ", "\[GreaterEqual]", " ", "1"}], " ", "&&", " ", 
           RowBox[{"ix", " ", "\[LessEqual]", " ", "n"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "m"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "smat"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WtSpcSbtpSbmtList", "[", 
   RowBox[{"n_", ",", "spccol_", ",", "stsmdatalist_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"WtSpcSubmat", "[", 
       RowBox[{"n", ",", "spccol", ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "&"}], " ", "/@", 
   " ", "stsmdatalist"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Takes", " ", "root"}], "-", 
   RowBox[{
   "space", " ", "forms", " ", "of", " ", "subalgebra", " ", "matrices", " ", 
    "and", " ", "returns", " ", "weight"}], "-", 
   RowBox[{"space", " ", 
    RowBox[{"forms", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatsRootToWeightSpace", "[", 
   RowBox[{"ld_", ",", "submats_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "nsa", ",", "i", ",", "m0", ",", "m1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", 
       RowBox[{"ld", "[", "\"\<type\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m0", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"la", " ", "=", " ", 
         RowBox[{"GetLieAlgebra", "[", 
          RowBox[{
           RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m1", " ", "=", " ", 
         RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m0", ".", 
         RowBox[{"submats", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", "m1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatsRootToWeightSpace", "[", "ld_", "]"}], " ", ":=", " ", 
  RowBox[{"SubmatsRootToWeightSpace", "[", 
   RowBox[{"ld", ",", 
    RowBox[{"ld", "[", "\"\<submats\>\"", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Weight", " ", "space", " ", "to", " ", "root", " ", "space"}], " ",
   "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatsWeightToRootSpace", "[", 
   RowBox[{"ld_", ",", "submats_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "nsa", ",", "i", ",", "m0", ",", "m1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", 
       RowBox[{"ld", "[", "\"\<type\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m0", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"la", " ", "=", " ", 
         RowBox[{"GetLieAlgebra", "[", 
          RowBox[{
           RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m1", " ", "=", " ", 
         RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m0", ".", 
         RowBox[{"submats", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", "m1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubmatsWeightToRootSpace", "[", "ld_", "]"}], " ", ":=", " ", 
  RowBox[{"SubmatsWeightToRootSpace", "[", 
   RowBox[{"ld", ",", 
    RowBox[{"ld", "[", "\"\<submats\>\"", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Results", ":", " ", 
    RowBox[{"in", " ", "weight", " ", "space"}]}], ",", " ", 
   RowBox[{
    RowBox[{"root", " ", "demotion", " ", "is", " ", 
     RowBox[{"easy", ":", " ", 
      RowBox[{
       RowBox[{"original", " ", "root"}], " ", "-", " ", 
       RowBox[{"subalgebra", " ", "root"}]}]}]}], " ", "=", " ", "1"}], ",", 
   " ", 
   RowBox[{
    RowBox[{"all", " ", "others", " ", 
     RowBox[{
     "zero", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Extension"}],
      " ", "splitting", " ", "turns", " ", "the", " ", "subalgebra", " ", 
     "root", " ", "assigned", " ", "to", " ", "the", " ", "extra", " ", 
     "root", " ", "into", " ", "this", " ", "column"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", 
       "2", " ", "-", "2"}], " ", "..."}], " ", "-", "2", " ", "-", "1"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"3", " ", 
       RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "1", " ", "-", 
      "1", " ", "-", "1"}], " ", "..."}], " ", "-", "1", " ", "-", "1"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"4", " ", 
       RowBox[{"n", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", 
      "2"}], " ", "..."}], " ", "-", "2", " ", "-", "1", " ", "-", "1"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"6", " ", "--"}]}], " ", "-", "1", " ", "-", "2", " ", "-", "3", 
    " ", "-", "2", " ", "-", "1", " ", "-", "2"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"7", " ", "--"}]}], " ", "-", "2", " ", "-", "3", " ", "-", "4", 
    " ", "-", "3", " ", "-", "2", " ", "-", "1", " ", "-", "2"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"8", " ", "--"}]}], " ", "-", "2", " ", "-", "4", " ", "-", "6", 
    " ", "-", "5", " ", "-", "4", " ", "-", "3", " ", "-", "2", " ", "-", 
    "3"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"6", " ", 
     RowBox[{"4", " ", "--"}]}], " ", "-", "2", " ", "-", "3", " ", "-", "2", 
    " ", "-", "1"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"7", " ", 
     RowBox[{"2", " ", "--"}]}], " ", "-", "2", " ", "-", "1"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SubalgSOEvenOdd", " ", "gives", " ", "odd", " ", "results"}], ",",
    "\[IndentingNewLine]", 
   RowBox[{
   "SubalgExtra", " ", "gives", " ", "even", " ", "odder", " ", "results"}]}],
   "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightSpaceSubalgMatricesIntoRootSpace", "[", 
   RowBox[{"ld_", ",", "wsmats_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "ctmt", ",", "submats", ",", "nsa", ",", "i"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", 
       RowBox[{"ld", "[", "\"\<type\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ctmt", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"la", " ", "=", " ", 
         RowBox[{"GetLieAlgebra", "[", 
          RowBox[{
           RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"ctmt", ".", 
         RowBox[{"wsmats", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ".", 
         RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Root Demotion: makes U(1) factors from roots", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Demotion", " ", "of", " ", "roots", " ", "to", " ", "U", 
    RowBox[{"(", "1", ")"}], " ", "factors", " ", "and", " ", "splitting", 
    " ", "the", " ", 
    RowBox[{"algebra", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Args", ":", " ", 
      RowBox[{
       RowBox[{"label", " ", "of", " ", "branching"}], "-", 
       RowBox[{"rule", " ", "generator"}]}]}]}]}], ",", " ", 
   RowBox[{"type", " ", "of", " ", "parent", " ", "algebra"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "list", " ", "of", " ", "demoted"}], "-", 
    RowBox[{"root", " ", "indices"}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Split", " ", "by", " ", "one", " ", 
   RowBox[{"root", ".", " ", 
    RowBox[{"Args", ":", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"type", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"orig", ".", " ", "roots"}], " ", "in", " ", "this", " ", 
          "subalg"}], "}"}]}], "}"}], "\[IndentingNewLine]", "root", " ", 
      "to", " ", "split", " ", "at", "\[IndentingNewLine]", "Returns", " ", 
      "list", " ", "of", " ", "objects", " ", "like", " ", "the", " ", 
      "first", " ", "arg", " ", "that", " ", "represent", " ", "the", " ", 
      "splitting"}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitByDemotedRoot", "[", 
   RowBox[{"algrts_", ",", "drt_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "family", ",", "n", ",", "rts", ",", "i", ",", "ix", ",", 
      RowBox[{"rsdt", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"algrts", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rts", " ", "=", " ", 
      RowBox[{"algrts", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"rts", ",", "drt"}], "]"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "algrts", "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "location", " ", "of", " ", "the", " ", "root",
        " ", "to", " ", "split", " ", "at"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rts", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "drt"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ix", " ", "=", " ", "i"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Break", "[", "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Create", " ", "a", " ", "list", " ", "of", " ", 
        RowBox[{"(", 
         RowBox[{"subalgebra", " ", "type"}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "which", " ", "orig", " ", "roots", " ", "because", " ", "which", 
          " ", "subalgebra", " ", "roots"}], ")"}], "\[IndentingNewLine]", 
        "The", " ", "input", " ", "roots", " ", "will", " ", "be", " ", 
        "substituted", " ", "in", " ", 
        RowBox[{"later", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", ">", " ", "1"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ix", " ", ">", " ", "1"}], "&&", 
           RowBox[{"ix", "<", 
            RowBox[{"n", "-", "1"}]}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"ix", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "<", " ", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{"n", "-", "ix"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"ix", "+", "1"}], ",", "n", ",", "1"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "\[Equal]", " ", 
           RowBox[{"n", "-", "1"}]}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"n", "-", "2"}]}], "]"}], ",", "n"}], "]"}]}], 
             "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", " ", "\[Equal]", " ", "n"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"rsdt", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"n", "-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}],
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "2", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "3", ",", "4", ",", "5"}], "}"}]}], 
               "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "5", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], 
                "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", "7"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", "3", ",", "4", ",", "5", ",", "6"}], 
                 "}"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "7"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "6", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "7"}], 
                "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
                "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "7", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", 
                 "8"}], "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "8", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6", ",", "7"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "}"}]}], "}"}]}],
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "5", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "6", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "7", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "8"}], "}"}]}], "}"}], "}"}]}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "7"}], "}"}]}], "}"}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"3", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "3", ",", "2"}], "}"}]}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "3", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "4", "}"}]}], "}"}]}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "4", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "ix", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "2", "}"}]}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rsdt", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", 
               RowBox[{"{", "1", "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Plug", " ", "in", " ", "which", " ", "actual", " ", "original", " ", 
       "roots", " ", "and", " ", "return", " ", "it"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"rts", "[", 
          RowBox[{"[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], "&"}], " ",
       "/@", " ", "rsdt"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid roots to demote: `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMultiRootDemoter", "[", 
   RowBox[{"ld_", ",", "type_", ",", "dmrts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "splt", ",", "nsa", ",", "cmt", ",", "i"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "dmrts"}], ")"}]}], ")"}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "dmrts"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Min", "[", "dmrts", "]"}], " ", "<", " ", "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "dmrts"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", "dmrts", "]"}], " ", ">", " ", "n"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "dmrts"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "dmrts", "]"}], " ", ">", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", "dmrts", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "baddmrts"}], " ", ",", "type", ",", 
          "dmrts"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"splt", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"type", ",", 
         RowBox[{"Range", "[", "n", "]"}]}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Split", " ", "by", " ", "each", " ", "one", " ", 
       RowBox[{"separately", " ", "--"}], " ", "easiest", " ", "to", " ", 
       "implement"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"splt", " ", "=", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SplitByDemotedRoot", "[", 
             RowBox[{"#", ",", 
              RowBox[{"dmrts", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "&"}], " ", "/@", " ",
            "splt"}], ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "dmrts", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Make", " ", "submats", " ", "in", " ", "weight", " ", "space"}], ",", 
       " ", 
       RowBox[{
       "then", " ", "convert", " ", "to", " ", "root", " ", "space"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", 
       RowBox[{"WtSpcSbtpSbmtList", "[", 
        RowBox[{"n", ",", "Null", ",", "splt"}], "]"}], ",", "dmrts"}], "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}], " ", "=", " ", 
      RowBox[{"SubmatsWeightToRootSpace", "[", "ld", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMultiRootDemoterVerify", "[", 
   RowBox[{"type_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ld0", ",", "ld"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MakeRootDemoter", "[", 
      RowBox[{"ld0", ",", "type", ",", "m"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeMultiRootDemoter", "[", 
      RowBox[{"ld", ",", "type", ",", 
       RowBox[{"{", "m", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], " ", "===", 
        RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"ld", "[", "\"\<submats\>\"", "]"}], " ", "===", " ", 
        RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeMultiRootDemoterVerify", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeMultiRootDemoterVerify", "[", 
      RowBox[{"type", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"type", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"For", " ", "demoting", " ", "a", " ", "single", " ", 
   RowBox[{"root", "."}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeRootDemoter", "[", 
   RowBox[{"ld_", ",", "type_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"MakeMultiRootDemoter", "[", 
   RowBox[{"ld", ",", "type", ",", 
    RowBox[{"{", "m", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Finds", " ", "a", " ", "list", " ", "of", " ", "the", " ", "possible", " ",
    "root", " ", "demotions", " ", "of", " ", "an", " ", 
   RowBox[{"algebra", "."}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListRootDemotions", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ld", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeRootDemoter", "[", 
        RowBox[{"ld", ",", "type", ",", "k"}], "]"}], ";", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extension Splitting", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Extension", " ", "of", " ", "the", " ", "Dynkin", " ", "diagram", " ", 
     "with", " ", "the", " ", "adjoint"}], "-", 
    RowBox[{
    "connected", " ", "root", " ", "and", " ", "splitting", " ", "of", " ", 
     "the", " ", "algebra", " ", "by", " ", "removing", " ", "a", " ", 
     RowBox[{"root", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Args", ":", " ", 
       RowBox[{
        RowBox[{"label", " ", "of", " ", "branching"}], "-", 
        RowBox[{"rule", " ", "generator"}]}]}]}]}]}], ",", " ", 
   RowBox[{"type", " ", "of", " ", "parent", " ", "algebra"}], ",", " ", 
   RowBox[{
    RowBox[{"and", " ", "demoted"}], "-", 
    RowBox[{"root", " ", "index"}]}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", "=", " ", 
   "\"\<For type `1`: invalid extension root: `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "unspalg"}], " ", "=", " ", 
   "\"\<Unsupported algebra: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExtensionSplitter", "[", 
   RowBox[{"ld_", ",", "type_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n", ",", 
      RowBox[{"stsmdata", "=", 
       RowBox[{"{", "}"}]}], ",", "mx", ",", "metdiag", ",", "psrtmax", ",", 
      "spccol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", ",", "type", ",", 
          "m"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"m", " ", ">", " ", "n"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", ",", "type", ",", 
          "m"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"family", " ", "\[Equal]", " ", "4"}], " ", "&&", " ", 
        RowBox[{"n", " ", "\[LessEqual]", " ", "2"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "unspalg"}], " ", ",", "type"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"D2", " ", "=", " ", 
       RowBox[{"A1", "*", "A1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"stsmdata", ",", 
         RowBox[{"{", 
          RowBox[{"type", ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"m", "+", "1"}], ",", "n"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{"m", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", " ", "\[Equal]", " ", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stsmdata", ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "n"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"stsmdata", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "m"}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"m", " ", "<", " ", "n"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stsmdata", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"2", ",", 
                  RowBox[{"n", "-", "m"}]}], "}"}], ",", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"stsmdata", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3", ",", "m"}], "}"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"m", "-", "1"}], ",", "1", ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", 
              RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", " ", "<", " ", "n"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"stsmdata", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"n", "-", "m"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"stsmdata", ",", 
           RowBox[{"{", 
            RowBox[{"type", ",", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"2", ",", "n"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"m", " ", "\[GreaterEqual]", " ", 
          RowBox[{"n", "-", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mx", " ", "=", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "-", " ", "m"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"stsmdata", ",", 
            RowBox[{"{", 
             RowBox[{"type", ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{
                    RowBox[{"n", "-", "2"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "mx"}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "True", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"stsmdata", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", "m"}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"m", "-", "1"}], ",", "1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"stsmdata", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"4", ",", 
                RowBox[{"n", "-", "m"}]}], "}"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"m", "+", "1"}], ",", "n"}], "]"}]}], "}"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "m", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "6", ",", 
                 RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "4", ",", "3", ",", "6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "5", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "6"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", 
                 RowBox[{"-", "1"}], ",", "4"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "m", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "6", ",", "5", ",", "4", ",", "3", ",", "2", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "2", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "5", ",", "4", ",", "3", ",", "7"}], 
                 "}"}]}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "3", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "7", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", 
                  "7"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4", 
                  ",", "7"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "6", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"5", ",", "4", ",", "3", ",", "2", ",", "1", ",", 
                 RowBox[{"-", "1"}], ",", "7"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "7"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3", ",", "4", 
                 ",", "5", ",", "6"}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "m", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"4", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "7", ",", "6", ",", "5", ",", "4", 
                 ",", "3", ",", "2", ",", "8"}], "}"}]}], "}"}], "}"}]}], ",",
            "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "1", "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "7", ",", "6", ",", "5", ",", "4", 
                  ",", "3", ",", "8"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", "8", "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "8"}], "}"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"5", ",", "6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"4", ",", "5"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "6"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"7", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"5", ",", "7"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                  "8"}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
           RowBox[{"stsmdata", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "8"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                 "7", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "}"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "m", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"4", ",", "3", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", "4", "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1", ",", "2", ",", "3"}], "}"}]}], 
            "}"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "m", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"-", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"stsmdata", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"stsmdata", " ", "===", " ", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badxtrts"}], " ", ",", "type", ",", 
          "m"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"metdiag", " ", "=", " ", 
      RowBox[{"Diagonal", "[", 
       RowBox[{"la", "[", "\"\<metric\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psrtmax", " ", "=", " ", 
      RowBox[{"First", "[", 
       RowBox[{"Last", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spccol", " ", "=", " ", 
      RowBox[{
       RowBox[{"-", " ", "psrtmax"}], "*", 
       RowBox[{"metdiag", "/", 
        RowBox[{"Max", "[", "metdiag", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", 
       RowBox[{"WtSpcSbtpSbmtList", "[", 
        RowBox[{"n", ",", "spccol", ",", "stsmdata"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}], " ", "=", " ", 
      RowBox[{"SubmatsWeightToRootSpace", "[", "ld", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "Finds", " ", "a", " ", "list", " ", "of", " ", "the", " ", "possible", 
    " ", "root"}], "-", 
   RowBox[{
   "extension", " ", "splits", " ", "of", " ", "an", " ", "algebra"}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListExtensionSplits", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ld", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeExtensionSplitter", "[", 
        RowBox[{"ld", ",", "type", ",", "k"}], "]"}], ";", " ", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Additional Branching-Rule Generators", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "The", " ", "first", " ", "two", " ", "here", " ", "have", " ", "an", " ", 
    "interesting", " ", 
    RowBox[{"interpretation", ":", " ", 
     RowBox[{
      RowBox[{"the", " ", "original", " ", "Lie"}], "-", 
      RowBox[{
      "group", " ", "matrices", " ", "become", " ", "outer", " ", "products", 
       " ", "of", " ", "the", " ", "subgroup", " ", 
       RowBox[{"matrices", ".", " ", "Dynkin"}], " ", "has", " ", "proved", 
       " ", "that", " ", "these", " ", "are", " ", "the", " ", "only", " ", 
       "maximal", " ", "nonsimple", " ", "subalgebra", " ", "decompositions", 
       " ", "of", " ", "the", " ", "classical", " ", "Lie", " ", 
       RowBox[{
       "algebras", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "Determination"}], " ", "of", " ", "the", " ", "simple", " ", 
       "subalgebras", " ", "can", " ", "be", " ", "very", " ", 
       "difficult"}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"it", " ", "must", " ", "be", " ", 
     RowBox[{"said", ".", " ", "This"}], " ", "document", " ", "will", " ", 
     "thus", " ", "have", " ", "only", " ", "some", " ", "of", " ", "the", 
     " ", "more", " ", "interesting", " ", "or", " ", "easier"}], "-", "to", 
    "-", 
    RowBox[{"find", " ", 
     RowBox[{"ones", "."}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "function", " ", "reduces", " ", "SU", 
    RowBox[{"(", "n", ")"}], " ", "to", " ", "a", " ", "product", " ", "of", 
    " ", "SU", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s", " ", "where", " ", "n"}], " ", "=", 
   " ", 
   RowBox[{"product", " ", "of", " ", 
    RowBox[{"m", "'"}], 
    RowBox[{"s", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsulst"}], " ", "=", " ", 
   "\"\<Invalid SU size list: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultSU", "[", 
   RowBox[{"ld_", ",", "suords_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "nso", ",", "soprod", ",", "vecproj", ",", "n", ",", "nt", ",", "type", 
      ",", 
      RowBox[{"stsms", "=", 
       RowBox[{"{", "}"}]}], ",", "kso", ",", "smat", ",", "sm", ",", "smt", 
      ",", "sstr", ",", "k", ",", "ko", ",", "ks", ",", "stype", ",", "la"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nso", " ", "=", " ", 
      RowBox[{"Length", "[", "suords", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nso", " ", "<", " ", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"IntegerQ", " ", "/@", " ", "suords"}], ")"}]}], ")"}]}], 
       ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[GreaterEqual]", "2"}], ")"}], "&"}], " ", "/@", 
            " ", "suords"}], ")"}]}], ")"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsulst"}], ",", "suords"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"soprod", " ", "=", " ", 
      RowBox[{"Times", " ", "@@", " ", "suords"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nt", " ", "=", " ", 
      RowBox[{"n", " ", "-", " ", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "This", " ", "matrix", " ", "turns", " ", "the", " ", "vector", " ", 
        "rep", " ", "into", " ", "a", " ", "diagonal", " ", "line", " ", "of",
         " ", 
        RowBox[{"1", "'"}], "s", " ", "or"}], " ", "-", 
       RowBox[{
        RowBox[{"1", "'"}], "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vecproj", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "nt", "}"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"vecproj", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
        " ", 
        RowBox[{
         RowBox[{"vecproj", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", 
            RowBox[{"k", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "nt"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sm", " ", "=", " ", 
          RowBox[{"suords", "[", 
           RowBox[{"[", "kso", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smt", " ", "=", " ", 
          RowBox[{"sm", " ", "-", " ", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stype", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"1", ",", "smt"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"sm", "-", "1"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sstr", " ", "=", " ", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{"suords", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ko", " ", "=", " ", 
             RowBox[{"Mod", "[", 
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"k", "/", "sstr"}], "]"}], ",", "sm"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ko", " ", "\[Equal]", " ", "ks"}], ",", 
                 RowBox[{
                  RowBox[{"smat", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                  "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"ko", " ", "\[Equal]", " ", 
                  RowBox[{"ks", "+", "1"}]}], ",", 
                 RowBox[{
                  RowBox[{"smat", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                  RowBox[{"-", "1"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"ks", ",", "0", ",", 
                RowBox[{"smt", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"la", " ", "=", " ", 
          RowBox[{"GetLieAlgebra", "[", "stype", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"smat", ".", 
           RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"vecproj", ".", "smat"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"stype", ",", "smat"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"kso", ",", "nso"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"This", " ", "function", " ", "reduces", " ", "SO", 
    RowBox[{"(", "n", ")"}], " ", "and", " ", "Sp", 
    RowBox[{"(", "n", ")"}], " ", "to", " ", "a", " ", "product", " ", "of", 
    " ", "SO", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s", " ", "and", " ", "Sp", 
    RowBox[{
     RowBox[{"(", "m", ")"}], "'"}], "s"}], ",", " ", 
   RowBox[{
    RowBox[{"where", " ", "n"}], " ", "=", " ", 
    RowBox[{"product", " ", "of", " ", 
     RowBox[{"m", "'"}], 
     RowBox[{"s", ".", " ", "Positive"}], " ", "n", " ", "means", " ", "SO", 
     RowBox[{"(", "n", ")"}], " ", "and", " ", "negative", " ", "n", " ", 
     "means", " ", "Sp", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "n"}], ")"}], ".", " ", "SO"}], 
     RowBox[{"(", "2", ")"}], " ", "is", " ", "handled", " ", "as", " ", "a", 
     " ", "U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{"factor", "."}]}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsosplst"}], " ", "=", " ", 
   "\"\<Invalid SO/Sp size list: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"SubalgMultSOSp", "[", 
    RowBox[{"ld_", ",", "sospords_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nso", ",", "soprod", ",", " ", "vecproj", ",", " ", "n", ",", "nt", 
       ",", "type", ",", 
       RowBox[{"stsms", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"u1s", "=", 
        RowBox[{"{", "}"}]}], ",", "kso", ",", "smat", ",", "sm", ",", "sma", 
       ",", "smt", ",", "sstr", ",", "k", ",", "ko", ",", "ks", ",", "stype", 
       ",", "la"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nso", " ", "=", " ", 
       RowBox[{"Length", "[", "sospords", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nso", " ", "<", " ", "1"}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"And", " ", "@@", " ", 
           RowBox[{"(", 
            RowBox[{"IntegerQ", " ", "/@", " ", "sospords"}], ")"}]}], 
          ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"And", " ", "@@", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[GreaterEqual]", "2"}], ")"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"#", "<", "0"}], ")"}], "&&", 
                  RowBox[{"EvenQ", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], 
             " ", "/@", " ", "sospords"}], ")"}]}], ")"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"LASubAlgebra", "::", "badsosplst"}], ",", "sospords"}], 
          "]"}], ";", 
         RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"soprod", " ", "=", " ", 
       RowBox[{"Times", " ", "@@", " ", "sospords"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Construct", " ", "a", " ", "projection", " ", "matrix", " ", "for", 
         " ", "roots", " ", "onto", " ", "vector", " ", 
         RowBox[{"rep", ".", " ", "Also"}], " ", "get", " ", "the", " ", 
         RowBox[{"type", ".", " ", "Much"}], " ", "like", " ", "the", " ", 
         "previous", " ", "function"}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"it", "'"}], "s", " ", "designed", " ", "to", " ", "turn", 
          " ", "the", " ", "vector", " ", "rep", "\[IndentingNewLine]", 
          "into", " ", "crossed", " ", "diagonal", " ", "lines", " ", "of", 
          " ", "1", " ", "and"}], " ", "-", "1"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"soprod", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "soprod", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"SO", 
             RowBox[{"(", "even", ")"}]}], ":", " ", "Dn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"4", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "nt", "}"}], ",", 
              RowBox[{"{", "nt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", "1"}], 
              ";", " ", 
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"-", "1"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vecproj", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"nt", "-", "1"}], ",", "nt"}], "]"}], "]"}], " ", "=", 
            " ", 
            RowBox[{
             RowBox[{"vecproj", "[", 
              RowBox[{"[", 
               RowBox[{"nt", ",", "nt"}], "]"}], "]"}], " ", "=", " ", 
             "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"SO", 
             RowBox[{"(", "odd", ")"}]}], ":", " ", "Bn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", "soprod"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"2", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "nt", "}"}], ",", 
              RowBox[{"{", "nt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", "1"}], 
              ";", " ", 
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"-", "1"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vecproj", "[", 
             RowBox[{"[", 
              RowBox[{"nt", ",", "nt"}], "]"}], "]"}], " ", "=", " ", "1"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"{", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", "nt", "}"}]}], "]"}], "}"}], ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"EvenQ", "[", "soprod", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Sp", 
             RowBox[{"(", "even", ")"}]}], ":", " ", "Cn"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"n", " ", "=", " ", 
            RowBox[{"-", " ", "soprod"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nt", " ", "=", " ", 
            RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"type", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{"3", ",", "nt"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "nt", "}"}], ",", 
              RowBox[{"{", "nt", "}"}]}], "]"}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", "1"}], 
              ";", " ", 
              RowBox[{
               RowBox[{"vecproj", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"k", "+", "1"}], ",", "k"}], "]"}], "]"}], "=", 
               RowBox[{"-", "1"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"nt", "-", "1"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"vecproj", "[", 
             RowBox[{"[", 
              RowBox[{"nt", ",", "nt"}], "]"}], "]"}], " ", "=", " ", "2"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"vecproj", " ", "=", " ", 
            RowBox[{"Transpose", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"vecproj", ",", 
               RowBox[{"-", 
                RowBox[{"Reverse", "[", "vecproj", "]"}]}]}], "]"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Sp", 
            RowBox[{"(", "odd", ")"}], " ", "does", " ", "not", " ", 
            "exist"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Now", " ", "the", " ", "subalgebra", " ", "matrices"}], ",", 
        " ", 
        RowBox[{"with", " ", "SO", 
         RowBox[{
          RowBox[{"(", "2", ")"}], "/", "D"}], 
         RowBox[{"(", "1", ")"}], " ", "as", " ", "a", " ", "U", 
         RowBox[{"(", "1", ")"}], " ", "factor"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"sm", " ", "=", " ", 
          RowBox[{"sospords", "[", 
           RowBox[{"[", "kso", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"sm", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "sm", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"SO", 
                RowBox[{"(", "even", ")"}]}], ":", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dn", " ", "--"}], " ", "works", " ", "for", " ", 
                 "root"}], "-", 
                RowBox[{"vector", " ", "dimension", " ", "1"}]}]}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", "sm"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{"sma", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"4", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", "n", "}"}], ",", 
                 RowBox[{"{", "smt", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ko", " ", "=", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{"smt", "-", "2"}]}], " ", "&&", " ", 
                    RowBox[{"ks", " ", "\[Equal]", " ", 
                    RowBox[{"smt", " ", "-", " ", "1"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{"smt", "+", "1"}]}], " ", "&&", " ", 
                    RowBox[{"ks", " ", "\[Equal]", " ", 
                    RowBox[{"smt", " ", "-", " ", "1"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"SO", 
                RowBox[{"(", "odd", ")"}]}], ":", " ", "Bn"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", "sm"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"sma", "-", "1"}], ")"}], "/", "2"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"2", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", "n", "}"}], ",", 
                 RowBox[{"{", "smt", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ko", " ", "=", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ks", "\[Equal]", 
                    RowBox[{"smt", "-", "1"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"-", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ks", "\[Equal]", 
                    RowBox[{"smt", "-", "1"}]}], ",", "1", ",", 
                    RowBox[{"1", "/", "2"}]}], "]"}]}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"EvenQ", "[", "sm", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"Sp", 
                RowBox[{"(", "even", ")"}]}], ":", " ", "Cn"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"sma", " ", "=", " ", 
               RowBox[{"-", "sm"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"smt", " ", "=", " ", 
               RowBox[{"sma", "/", "2"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"stype", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"3", ",", "smt"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smat", " ", "=", " ", 
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", "n", "}"}], ",", 
                 RowBox[{"{", "smt", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sstr", " ", "=", " ", 
               RowBox[{"Abs", "[", 
                RowBox[{"Product", "[", 
                 RowBox[{
                  RowBox[{"sospords", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", 
                    RowBox[{"kso", "+", "1"}], ",", "nso"}], "}"}]}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ko", " ", "=", " ", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"k", "/", "sstr"}], "]"}], ",", "sma"}], "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"Do", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", "ks"}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{"ks", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", "ks"}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ko", " ", "\[Equal]", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sma", "-", "1"}], ")"}], "-", 
                    RowBox[{"(", 
                    RowBox[{"ks", "+", "1"}], ")"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"smat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "1"}], ",", 
                    RowBox[{"ks", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                    RowBox[{"1", "/", "2"}]}]}], "]"}], ";"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"ks", ",", "0", ",", 
                    RowBox[{"smt", "-", "1"}]}], "}"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"Sp", 
               RowBox[{"(", "odd", ")"}], " ", "does", " ", "not", " ", 
               "exist"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"smat", " ", "=", " ", 
          RowBox[{"vecproj", ".", "smat"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"stype", " ", "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Skip", " ", "over", " ", "SO", 
             RowBox[{"(", "1", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Continue", "[", "]"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"stype", " ", "===", " ", 
            RowBox[{"{", 
             RowBox[{"4", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Treat", " ", "as", " ", "a", " ", "U", 
             RowBox[{"(", "1", ")"}], " ", "factor"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"u1s", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}], "*", 
              RowBox[{"First", "[", 
               RowBox[{"Transpose", "[", "smat", "]"}], "]"}]}]}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "All", " ", "the", " ", "others", " ", "are", " ", "\"\<real\>\"",
              " ", "algebras"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MakeLieAlgebra", "[", 
             RowBox[{"la", ",", "stype"}], "]"}], ";", "\[IndentingNewLine]", 
            
            RowBox[{"smat", " ", "=", " ", 
             RowBox[{"smat", ".", 
              RowBox[{"la", "[", "\"\<invctn\>\"", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stsms", ",", 
              RowBox[{"{", 
               RowBox[{"stype", ",", "smat"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"kso", ",", "nso"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"MakeBrancher", "[", 
       RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Forms", " ", "of", " ", "the", " ", "previous", " ", "two", " ", "for", 
    " ", "A"}], ",", "B", ",", "C", ",", 
   RowBox[{"D", "-", 
    RowBox[{"style", " ", 
     RowBox[{"designation", "."}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"In", ":", " ", 
   RowBox[{
    RowBox[{"list", " ", "of", " ", "root"}], "-", 
    RowBox[{"vector", " ", "lengths"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultAn", "[", 
   RowBox[{"ld_", ",", "ords_"}], "]"}], " ", ":=", " ", 
  RowBox[{"SubalgMultSU", "[", 
   RowBox[{"ld", ",", 
    RowBox[{"ords", "+", "1"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"In", ":", " ", 
    RowBox[{"list", " ", "of", " ", "algebra", " ", "types", " ", "as", " ", 
     RowBox[{"lists", ".", " ", "For"}], " ", "B", 
     RowBox[{"(", "n", ")"}]}]}], ",", 
   RowBox[{"C", 
    RowBox[{"(", "n", ")"}]}], ",", 
   RowBox[{
    RowBox[{"D", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"{", 
     RowBox[{"2", ",", "n"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "n"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "n"}], "}"}], ".", " ", "D"}], 
    RowBox[{"(", "1", ")"}], " ", "or", " ", 
    RowBox[{"{", 
     RowBox[{"4", ",", "1"}], "}"}], " ", "is", " ", 
    RowBox[{"legitimate", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgMultBCDn", "[", 
   RowBox[{"ld_", ",", "stypes_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ords", ",", "k", ",", "stype", ",", "family", ",", "n"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ords", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "stype"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "family", ",", "\[IndentingNewLine]", "2", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"2", "*", "n"}], "+", "1"}], ",", "\[IndentingNewLine]", 
           "3", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"-", "2"}], "*", "n"}], ",", "\[IndentingNewLine]", "4", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"2", "*", "n"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"stype", ",", "stypes"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SubalgMultSOSp", "[", 
      RowBox[{"ld", ",", "ords"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"This", " ", "function", " ", "does", " ", "even", " ", "SO"}], 
     " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"odd", " ", "SO", " ", "or", " ", "odd", " ", "SO"}], " ", "+", 
      " ", 
      RowBox[{"odd", " ", "SO"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"It", " ", "does", " ", "SO", 
       RowBox[{"(", 
        RowBox[{"2", "n"}], ")"}]}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"SO", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "m"}], "+", "1"}], ")"}]}], " ", "+", " ", 
        RowBox[{"SO", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "n"}], "-", 
           RowBox[{"2", "m"}], "-", "1"}], ")"}], " ", "or", " ", "D", 
         RowBox[{"(", "n", ")"}]}]}], " ", "\[Rule]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"B", 
          RowBox[{"(", "m", ")"}]}], " ", "+", " ", 
         RowBox[{"B", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "m", "-", "1"}], ")"}], ".", 
           "\[IndentingNewLine]", "The"}], " ", "main", " ", "root"}], "-", 
         RowBox[{"split", " ", "function", " ", "does", " ", "even"}]}], " ", 
        "\[Rule]", " ", 
        RowBox[{
         RowBox[{"even", " ", "+", " ", 
          RowBox[{"even", " ", "and", " ", "odd"}]}], " ", "\[Rule]", " ", 
         RowBox[{"odd", " ", "+", " ", 
          RowBox[{
           RowBox[{"even", ".", "\[IndentingNewLine]", "Use"}], " ", "the", 
           " ", "root", " ", "demoter", " ", "and", " ", "demote", " ", 
           "root", " ", "#1", " ", "to", " ", "turn", " ", "SO", 
           RowBox[{"(", "n", ")"}], " ", "into", " ", "SO", 
           RowBox[{"(", 
            RowBox[{"n", "-", "2"}], ")"}], " ", "*", " ", "SO", 
           RowBox[{"(", "2", ")"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"the", " ", "U", 
              RowBox[{"(", "1", ")"}], " ", "factor"}], ")"}], ".", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "For"}], " ", 
           "m"}]}]}]}]}]}], " ", "=", " ", "0"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "it", " ", "will", " ", "make", " ", "only", " ", "one", " ", "odd", " ", 
     "SO"}], ";", " ", 
    RowBox[{
     RowBox[{"for", " ", "m"}], " ", "\[GreaterEqual]", " ", 
     RowBox[{"1", " ", "and", " ", "m"}], " ", "\[LessEqual]", " ", 
     RowBox[{"n", "-", "2"}]}]}], ",", " ", 
   RowBox[{"it", " ", "will", " ", "make", " ", "two", " ", "odd", " ", 
    RowBox[{"SO", "'"}], 
    RowBox[{"s", "."}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsoeo"}], " ", "=", " ", 
   "\"\<Invalid SO even-to-odd parameters: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSOEvenOdd", "[", 
   RowBox[{"ld_", ",", "n_", ",", "m_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"stsms", "=", 
       RowBox[{"{", "}"}]}], ",", "k", ",", "smat", ",", "mx", ",", "i"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"m", " ", "<", " ", "0"}], " ", "||", " ", 
        RowBox[{"m", " ", ">", " ", 
         RowBox[{"n", "-", "2"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsoeo"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m", " ", ">", " ", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k", " ", "=", " ", "m"}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", "k", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"m", "-", "i", "+", "1"}], ",", "i"}], "]"}], "]"}], 
           " ", "=", " ", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "2", ",", 
            RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", ">", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"smat", "[", 
             RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", "-", "1"}], "}"}]}], "]"}], ",", "0"}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"smat", "[", 
             RowBox[{"[", "m", "]"}], "]"}], " ", "=", " ", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", "-", "1"}], "}"}]}], "]"}], ",", "0"}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"smat", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"AppendTo", "[", 
         RowBox[{"stsms", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "k"}], "}"}], ",", "smat"}], "}"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"n", " ", "-", " ", "m", " ", "-", " ", "1"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"smat", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{"{", "k", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"smat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"m", "+", "i"}], ",", "i"}], "]"}], "]"}], " ", "=", " ", 
        "1"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m", ">", "0"}], ",", 
       RowBox[{
        RowBox[{"smat", "[", 
         RowBox[{"[", "m", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", "k", "}"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"smat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"smat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "k"}], "]"}], "]"}], " ", "=", " ", 
       "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"stsms", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "k"}], "}"}], ",", "smat"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "n"}], "}"}], ",", "stsms", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Reduces", " ", "SU", 
   RowBox[{
    RowBox[{"(", "n", ")"}], "/", " ", "A"}], 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], " ", "to", " ", "SO", 
   RowBox[{
    RowBox[{"(", "n", ")"}], ".", " ", "Even"}], " ", 
   RowBox[{"n", ":", " ", 
    RowBox[{"D", 
     RowBox[{"(", 
      RowBox[{"n", "/", "2"}], ")"}], " ", "and", " ", "odd", " ", 
     RowBox[{"n", ":", " ", 
      RowBox[{"B", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], ")"}]}]}]}]}]}], "  ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsuso"}], " ", "=", " ", 
   "\"\<Invalid SU to SO parameter: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSUSO", "[", 
   RowBox[{"ld_", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nx", ",", "stype", ",", "smat", ",", "stsms", ",", "k"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsuso"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsuso"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"EvenQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nx", " ", "=", " ", 
         RowBox[{"n", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"stype", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"4", ",", "nx"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", "-", "1"}], "}"}], ",", 
           RowBox[{"{", "nx", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"smat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"n", "-", "k"}], ",", "k"}], "]"}], "]"}], " ", "=", 
            " ", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"nx", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"smat", "[", 
          RowBox[{"[", 
           RowBox[{"nx", ",", 
            RowBox[{"nx", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"-", "1"}]}], ";", " ", 
        RowBox[{
         RowBox[{"smat", "[", 
          RowBox[{"[", 
           RowBox[{"nx", ",", "nx"}], "]"}], "]"}], " ", "=", " ", "1"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Odd", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nx", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "/", "2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stype", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"2", ",", "nx"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"smat", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", "-", "1"}], "}"}], ",", 
           RowBox[{"{", "nx", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"smat", "[", 
            RowBox[{"[", 
             RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"smat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"n", "-", "k"}], ",", "k"}], "]"}], "]"}], " ", "=", 
            " ", "1"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "nx"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"stype", ",", "smat"}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", "stsms", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Reduces", " ", "SU", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "n"}], ")"}], "/", " ", "A"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "n"}], "-", "1"}], ")"}], " ", "to", " ", "Sp", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "n"}], ")"}], "/", " ", "C"}], 
   RowBox[{"(", "n", ")"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badsusp"}], " ", "=", " ", 
   "\"\<Invalid SU to Sp parameter: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSUSp", "[", 
   RowBox[{"ld_", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"smat", ",", "stsms", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "n", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsusp"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "<", "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badsusp"}], ",", "n"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"smat", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"2", "n"}], "-", "1"}], "}"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"smat", "[", 
         RowBox[{"[", 
          RowBox[{"k", ",", "k"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"smat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "n"}], "-", "k"}], ",", "k"}], "]"}], "]"}], " ", 
         "=", " ", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"smat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "n"}], "}"}], ",", "smat"}], "}"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"2", "n"}], "-", "1"}]}], "}"}], ",", "stsms", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "This", " ", "function", " ", "reduces", " ", "every", " ", "Lie", " ", 
    "algebra", " ", "to", " ", "SU", 
    RowBox[{
     RowBox[{"(", "2", ")"}], " ", "/", " ", "SO"}], 
    RowBox[{
     RowBox[{"(", "3", ")"}], " ", "/", " ", "Sp"}], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", "2", ")"}], " ", "/", " ", "A1"}], " ", "/", " ", "B1"}], 
     " ", "/", " ", "C1"}]}], ",", " ", 
   RowBox[{
    RowBox[{"the", " ", "3", "D", " ", "angular"}], "-", 
    RowBox[{"momentum", " ", 
     RowBox[{"group", ".", " ", "The"}], " ", "\"\<height\>\"", " ", "in", 
     " ", "its", " ", "name", " ", "refers", " ", "to", " ", "the", " ", 
     "largest", " ", "of", " ", "the", " ", "height", " ", "weights", " ", 
     "of", " ", "the", " ", "subalgebra", " ", "equaling", " ", "the", " ", 
     RowBox[{"rep", "'"}], "s", " ", 
     RowBox[{"height", ".", "\[IndentingNewLine]", "Maximal"}], " ", "for", 
     " ", "B", 
     RowBox[{"(", "n", ")"}]}]}], ",", " ", 
   RowBox[{"C", 
    RowBox[{"(", "n", ")"}]}], ",", " ", "G2", ",", " ", "F4", ",", " ", "E7",
    ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"E8", ".", "\[IndentingNewLine]", "There"}], " ", "are", " ", 
     "some", " ", "solutions", " ", "for", " ", "some", " ", "subalgebra"}], 
    "-", 
    RowBox[{
    "matrix", " ", "values", " ", "different", " ", "from", " ", "1."}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgHeightA1", "[", 
   RowBox[{"ld_", ",", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"type", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}]}], "}"}], "}"}], 
       ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Some", " ", "extra", " ", "ones", " ", "named", " ", 
     RowBox[{
     "individually", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
      "Mentioned"}], " ", "by", " ", "John", " ", "Baez", " ", "in", " ", 
     "\"\<The Octonions\>\""}], ":", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"B3G2", " ", "--"}], " ", 
     RowBox[{"B3", "/", "SO"}], 
     RowBox[{"(", "7", ")"}], " ", "to", " ", 
     RowBox[{"G2", " ", "--"}], " ", "G2", " ", "is", " ", "the", " ", 
     "isomorphism", " ", "group", " ", "of", " ", "the", " ", "octonions"}]}],
    ",", " ", 
   RowBox[{
   "and", " ", "one", " ", "gets", " ", "a", " ", "construction", " ", "of", 
    " ", "G2", " ", "from", " ", "it", " ", 
    RowBox[{"that", "'"}], "s", " ", "manifestly", " ", "a", " ", "subgroup", 
    " ", "of", " ", "SO", 
    RowBox[{
     RowBox[{"(", "7", ")"}], " ", "--"}], " ", "14", " ", "7", "D", " ", 
    "antisymmetric", " ", "real", " ", 
    RowBox[{"matrices", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"D4G2", " ", "--"}]}], " ", 
    RowBox[{"D4", "/", "SO"}], 
    RowBox[{"(", "8", ")"}], " ", "to", " ", 
    RowBox[{"G2", " ", "--"}], " ", "unlike", " ", "the", " ", "others"}], 
   ",", " ", 
   RowBox[{
   "not", " ", "maximal", "\[IndentingNewLine]", "\[IndentingNewLine]", "The",
     " ", "others", " ", "are", " ", "mentioned", " ", "by", " ", "Slansky"}],
    ",", " ", 
   RowBox[{"Table", " ", "15"}], ",", " ", 
   RowBox[{
    RowBox[{"p", ".", " ", "180"}], " ", 
    RowBox[{"(", "Exceptional", ")"}]}], ",", " ", 
   RowBox[{"Table", " ", "14"}], ",", " ", 
   RowBox[{
    RowBox[{"p", ".", " ", "177"}], " ", 
    RowBox[{"(", "Classical", ")"}]}], ",", " ", 
   RowBox[{"Table", " ", "58"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"p", ".", " ", "238"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Branching", " ", "Rules"}], ")"}], ".", " ", "Also"}], " ", 
     "in", " ", "Weyl"}], "-", 
    RowBox[{"Orbit", " ", "Branching", " ", "Rules", " ", "for", " ", "An"}], 
    "-", 
    RowBox[{"Larouche", " ", "Nesterenko", " ", "Patera"}], " ", "-", " ", 
    RowBox[{"arxiv", " ", "0909.2337", "v1", " ", "and", " ", "Weyl"}], "-", 
    RowBox[{
    "Orbit", " ", "Branching", " ", "Rules", " ", "for", " ", "Bn", " ", "Cn",
      " ", "Dn"}], "-", 
    RowBox[{"Larouche", " ", "Patera"}], " ", "-", " ", 
    RowBox[{
    "arxiv", " ", "1101.6043", "v1", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "None", " ", "of", " ", "these", " ", 
     "branchings", " ", "have", " ", "U", 
     RowBox[{"(", "1", ")"}], " ", 
     RowBox[{"factors", "."}]}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgExtraNames", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<G2A1\>\"", ",", " ", "\"\<B3G2\>\"", ",", " ", "\"\<D4A2\>\"", ",", 
     " ", "\"\<D4G2\>\"", ",", " ", "\"\<F4A1\>\"", ",", " ", 
     "\"\<F4A1G2\>\"", ",", " ", "\"\<E6A2\>\"", ",", " ", "\"\<E6G2\>\"", 
     ",", " ", "\"\<E6C4\>\"", ",", " ", "\"\<E6F4\>\"", ",", " ", 
     "\"\<E6A2G2\>\"", ",", " ", "\"\<E7A1-1\>\"", ",", "\"\<E7A1-2\>\"", ",",
      " ", "\"\<E7A2\>\"", ",", "\"\<E7A1A1\>\"", ",", "\"\<E7A1G2\>\"", ",", 
     " ", "\"\<E7A1F4\>\"", ",", "\"\<E7G2C3\>\"", ",", "\"\<E8A1-1\>\"", 
     ",", "\"\<E8A1-2\>\"", ",", "\"\<E8A1-3\>\"", ",", "\"\<E8A1A2\>\"", 
     ",", "\"\<E8B2\>\"", ",", "\"\<E8G2F4\>\""}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<G2A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<B3G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<D4A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<D4G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}],
   ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<F4A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<F4A1G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"7", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6C4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
       "}"}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
       "}"}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E6A2G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1-1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1-2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1A1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "2"}], "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1G2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7A1F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "3"}], ",", 
             RowBox[{"-", "4"}], ",", 
             RowBox[{"-", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E7G2C3\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-1\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1-3\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8A1A2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
    "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8B2\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], "}"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SubalgExtraData", "[", "\"\<E8G2F4\>\"", "]"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "8"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badextra"}], " ", "=", " ", 
   "\"\<Invalid extra algebra-to-subalgebra branching ``\>\""}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgExtra", "[", 
   RowBox[{"ld_", ",", "saname_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "type", ",", "stsms"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", " ", "=", " ", 
      RowBox[{"SubalgExtraData", "[", "saname", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "data", "]"}], " ", "\[Equal]", " ", 
        "SubalgExtraData"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badextra"}], ",", "saname"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", 
       RowBox[{"{", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Classical", " ", 
     RowBox[{"ones", ":", " ", "B3"}]}], " ", "\[Rule]", " ", "G2"}], ",", 
   " ", 
   RowBox[{"D4", " ", "\[Rule]", " ", "A2"}], ",", " ", 
   RowBox[{"D4", " ", "\[Rule]", " ", 
    RowBox[{"G2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"non", "-", "maximal"}], ";", " ", 
       RowBox[{
        RowBox[{"is", " ", "D4"}], " ", "\[Rule]", " ", 
        RowBox[{"B3", " ", "\[Rule]", " ", "G2"}]}]}], ")"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Here", " ", "are", " ", "the", " ", "remaining", " ", "maximal", " ", 
     "subalgebras", " ", "and", " ", "branching", " ", "rules", " ", "in", 
     " ", "Slansky"}], ";", " ", 
    RowBox[{
    "he", " ", "has", " ", "branching", " ", "rules", " ", "up", " ", "to", 
     " ", "rank", " ", "6", " ", "and", " ", "subalgebras", " ", "up", " ", 
     "to", " ", "rank", " ", "8.", "\[IndentingNewLine]", "x"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"A5", " ", "\[Rule]", " ", "A2"}], ",", "\[IndentingNewLine]", 
   RowBox[{"10000", " ", "\[Rule]", " ", "20"}], ",", " ", 
   RowBox[{"00100", " ", "\[Rule]", " ", 
    RowBox[{"30", " ", "+", " ", "03"}]}], ",", " ", 
   RowBox[{"10001", " ", "\[Rule]", " ", 
    RowBox[{"11", " ", "+", " ", "22"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"D5", " ", "\[Rule]", " ", "C2"}], ",", "\[IndentingNewLine]", 
   RowBox[{"10000", " ", "\[Rule]", " ", "20"}], ",", " ", 
   RowBox[{"00001", " ", "\[Rule]", " ", "11"}], ",", " ", 
   RowBox[{"010000", " ", "\[Rule]", " ", 
    RowBox[{"20", " ", "+", " ", "21"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"B7", " ", "\[Rule]", " ", 
    RowBox[{"A3", "/", "D3"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"1000000", " ", "\[Rule]", " ", "101"}], ",", " ", 
   RowBox[{"0100000", " ", "\[Rule]", " ", 
    RowBox[{"210", " ", "+", " ", "012", " ", "+", " ", "101"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"D7", " ", "\[Rule]", " ", 
    RowBox[{"C2", "/", "B2"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"1000000", " ", "\[Rule]", " ", "02"}], ",", " ", 
   RowBox[{"0100000", " ", "\[Rule]", " ", 
    RowBox[{"22", " ", "+", " ", "20"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"D7", " ", "\[Rule]", " ", "C3"}], ",", "\[IndentingNewLine]", 
   RowBox[{"1000000", " ", "\[Rule]", " ", "010"}], ",", " ", 
   RowBox[{"0100000", " ", "\[Rule]", " ", 
    RowBox[{"101", " ", "+", " ", "200"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"D7", " ", "\[Rule]", " ", "G2"}], ",", "\[IndentingNewLine]", 
   RowBox[{"1000000", " ", "\[Rule]", " ", "10"}], ",", " ", 
   RowBox[{"0100000", " ", "\[Rule]", " ", 
    RowBox[{"10", " ", "+", " ", "03"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"C8", " ", "\[Rule]", " ", 
    RowBox[{"C2", "/", "B2"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"10000000", " ", "\[Rule]", " ", "11"}], ",", " ", 
   RowBox[{"01000000", " ", "\[Rule]", " ", 
    RowBox[{
    "40", " ", "+", " ", "03", " ", "+", " ", "21", " ", "+", " ", "02", " ", 
     "+", " ", "01"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"D8", " ", "\[Rule]", " ", "B4"}], ",", "\[IndentingNewLine]", 
   RowBox[{"10000000", " ", "\[Rule]", " ", "0001"}], ",", " ", 
   RowBox[{"01000000", " ", "\[Rule]", " ", 
    RowBox[{"0100", " ", "+", " ", "0010"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
   "From", " ", "what", " ", "Slansky", " ", "and", " ", "Dynkin", " ", 
    "give"}], ",", " ", 
   RowBox[{
    RowBox[{"all", " ", "the", " ", "maximal", " ", "simple"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
    "nonsimple", " ", "subalgebra", " ", "decompositions", " ", "are", " ", 
     "accounted", " ", "for", " ", "in", " ", "my", " ", "code"}]}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "and", " ", "also", " ", "all", " ", "the", " ", "maximal", " ", 
      "exceptional"}], "-", 
     RowBox[{"algebra", " ", 
      RowBox[{"subalgebras", ".", " ", "What"}], " ", "remains", " ", "is", 
      " ", "maximal", " ", "classical"}]}], " ", "\[Rule]", " ", 
    RowBox[{"simple", " ", "any"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "my", " ", "code", " ", "contains", " ", "some", " ", 
     "families", " ", "of", " ", 
     RowBox[{"that", ".", " ", "Dynkin"}], " ", "and", " ", "Slansky", " ", 
     RowBox[{"(", 
      RowBox[{"p", ".88"}], ")"}], " ", "have", " ", "some", " ", "helpful", 
     " ", "theorems", " ", "about", " ", "that", " ", 
     RowBox[{
     "case", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "**"}], "*", 
     " ", "At", " ", "least", " ", "one", " ", "simple", " ", "irrep"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
     RowBox[{"one", " ", "term", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"need", " ", "not", " ", "be", " ", "simple"}], ")"}], ".", 
       " ", "True"}], " ", "of", " ", "classical"}], " ", "\[Rule]", " ", 
     "any"}]}], ",", " ", 
   RowBox[{
    RowBox[{"not", " ", "necessarily", " ", "of", " ", "exceptional"}], " ", 
    "\[Rule]", " ", 
    RowBox[{
     RowBox[{
     "any", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "Simple"}], 
     " ", 
     RowBox[{"irreps", ":", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", "and", " ", 
     RowBox[{"conjg", ".", " ", "vector"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "n"}], "+", "1"}], ")"}]}]}], ",", " ", 
   RowBox[{"both", " ", "complex"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dim", ".", " ", "2"}], "n"}], "+", "1"}], ")"}]}]}], ",", 
   " ", "real", ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"spinor", " ", 
    RowBox[{"(", 
     RowBox[{"dim", ".", " ", 
      RowBox[{"2", "^", "n"}]}], ")"}]}], ",", " ", 
   RowBox[{"real", " ", "for", " ", "4", "k"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "3"}], ",", " ", 
   RowBox[{
    RowBox[{"pseudoreal", " ", "for", " ", "4", "k"}], "+", "1"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "2"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "2"}], "n"}], ")"}]}]}], ",", " ", 
   "pseudoreal", ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"D", 
     RowBox[{"(", "n", ")"}]}], ":", " ", 
    RowBox[{"vector", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dim", ".", " ", "2"}], "n"}], ")"}]}]}], ",", " ", "real", 
   ",", "\[IndentingNewLine]", "\t", 
   RowBox[{"the", " ", "two", " ", "spinors", " ", 
    RowBox[{"(", 
     RowBox[{"dim", ".", " ", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}], ",", " ", 
   RowBox[{"real", " ", "for", " ", "4", "k"}], ",", " ", 
   RowBox[{
    RowBox[{"pseudoreal", " ", "for", " ", "4", "k"}], "+", "2"}], ",", " ", 
   RowBox[{
    RowBox[{"complex", " ", "for", " ", "4", "k"}], "+", "1"}], ",", 
   RowBox[{
    RowBox[{"4", "k"}], "+", "3"}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G", 
     RowBox[{"(", "2", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "7"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", 
     RowBox[{"(", "4", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "26"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "6", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", "and", " ", 
      RowBox[{"conjg", ".", " ", 
       RowBox[{"(", 
        RowBox[{"dim", " ", "27"}], ")"}]}]}], ":", " ", "complex"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "7", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fumdamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "56"}], ")"}]}], ":", " ", "pseudoreal"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", 
     RowBox[{"(", "8", ")"}]}], ":", " ", 
    RowBox[{
     RowBox[{"fundamental", " ", 
      RowBox[{"(", 
       RowBox[{"dim", " ", "248"}], ")"}]}], ":", " ", "real"}]}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"**", 
     RowBox[{"*", " ", "Adjoint", " ", "of", " ", "algebra"}]}], " ", 
    "\[Rule]", " ", 
    RowBox[{"adjoint", " ", "of", " ", 
     RowBox[{"subalgebra", ".", " ", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"A", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"conjg", " ", "vector"}]}]}], " ", "\[Rule]", " ", 
    RowBox[{"adjoint", " ", "+", " ", "scalar"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"B", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"C", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "symmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"D", 
      RowBox[{"(", "n", ")"}]}], ":", " ", 
     RowBox[{"vector", " ", "+", " ", 
      RowBox[{"vector", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"G", 
      RowBox[{"(", "2", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"F", 
      RowBox[{"(", "4", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "antisymmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "6", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"conjg", " ", "fund"}]}]}], " ", "\[Rule]", " ", "adjoint"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "7", ")"}]}], ":", " ", 
     RowBox[{"fund", " ", "+", " ", 
      RowBox[{"fund", " ", "symmetric"}]}]}], " ", "\[Rule]", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"E", 
      RowBox[{"(", "8", ")"}]}], ":", " ", "fund"}], " ", "=", " ", 
    "adjoint"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quadratic", "-", 
     RowBox[{"form", " ", 
      RowBox[{"constraint", ":", " ", 
       RowBox[{
       "must", " ", "carry", " ", "over", " ", "into", " ", 
        "subalgebra"}]}]}]}], ";", " ", 
    RowBox[{
    "each", " ", "form", " ", "symmetry", " ", "yields", " ", "a", " ", 
     RowBox[{"constraint", ":", "\[IndentingNewLine]", "x"}]}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Symmetric", ":", " ", "Real"}], " ", "\[Rule]", " ", "real"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Antisymmetric", ":", " ", "Pseudoreal"}], " ", "\[Rule]", " ", 
    "pseudoreal"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"None", ":", " ", "Complex"}], " ", "\[Rule]", " ", "complex"}], 
   ",", " ", "real", ",", " ", "pseudoreal", ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
   "Every", " ", "rep", " ", "*", " ", "its", " ", "conjugate", " ", "rep", 
    " ", "contains", " ", "the", " ", "adjoint", " ", 
    RowBox[{"rep", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "In"}], 
    " ", "Table", " ", "5", " ", "of", " ", "his", " ", "ref"}], ",", " ", 
   RowBox[{"Dynkin", " ", "lists", " ", "several", " ", "cases"}], ",", " ", 
   RowBox[{
    RowBox[{"which", " ", 
     RowBox[{"include", ":", " ", "An"}]}], " ", "\[Rule]", " ", 
    RowBox[{"A", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"symmetric", " ", "2"}], "-", "tensor"}], ")"}], " ", "and", 
     " ", "A", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"antisymmetric", " ", "2"}], "-", "tensor"}], ")"}]}]}], ",", 
   " ", "An", ",", "Cn", ",", 
   RowBox[{"Dn", " ", "\[Rule]", " ", 
    RowBox[{"Bn", 
     RowBox[{"(", "spinor", ")"}]}]}], ",", " ", 
   RowBox[{"Dn", 
    RowBox[{"(", "spinor", ")"}]}], ",", " ", "...", ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"An", " ", "\[Rule]", " ", 
    RowBox[{"any", " ", "spinor"}]}], ",", " ", 
   RowBox[{"Cn", " ", "\[Rule]", " ", 
    RowBox[{"pseudoreal", " ", "spinor"}]}], ",", " ", 
   RowBox[{"Dn", " ", "\[Rule]", " ", 
    RowBox[{"real", " ", "spinor"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Dynkin", " ", 
    RowBox[{"reference", ":", " ", 
     RowBox[{
     "\"\<The maximal subgroups of the classical groups\>\"", " ", "in", " ", 
      "\"\<Selected Papers of E.B. Dynkin\>\""}]}]}]}], "\[IndentingNewLine]",
   " ", "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Concatenator, relabelers, and rearrangers", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Concatenate", " ", "two", " ", "branchers"}], ",", " ", 
   RowBox[{"making", " ", "a", " ", "new", " ", 
    RowBox[{"one", ".", " ", "ld1"}], " ", "gets", " ", "concatenated", " ", 
    "to", " ", "subalgebra", " ", "ix", " ", "of", " ", "ld0"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badindex"}], " ", "=", " ", 
   "\"\<Invalid index: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "outrange"}], " ", "=", " ", 
   "\"\<Index `1` is out of range for length `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "typemm"}], " ", "=", " ", 
   "\"\<Type mismatch: `1` and `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConcatBranchers", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_", ",", "ld1_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type0", ",", "type1", ",", "subtypes0", ",", "subtypes1", ",", 
      "submats0", ",", "submats1", ",", "u1s0", ",", "u1s1", ",", "ns0", ",", 
      "ns1", ",", "smc", ",", "stsms", ",", "i0", ",", "i1", ",", "j", ",", 
      "k", ",", "u1fac", ",", "u1s1c"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type0", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"type1", " ", "=", " ", 
      RowBox[{"ld1", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes0", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"subtypes1", " ", "=", " ", 
      RowBox[{"ld1", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats0", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats1", " ", "=", " ", 
      RowBox[{"ld1", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s0", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"u1s1", " ", "=", " ", 
      RowBox[{"ld1", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns0", "=", " ", 
      RowBox[{"Length", "[", "subtypes0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ns1", "=", " ", 
      RowBox[{"Length", "[", "subtypes1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns0"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns0"}],
          "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes0", "[", 
         RowBox[{"[", "ix", "]"}], "]"}], " ", "=!=", " ", "type1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "typemm"}], ",", 
          RowBox[{"subtypes0", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "type1"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"smc", " ", "=", " ", 
      RowBox[{"submats0", "[", 
       RowBox[{"[", "ix", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i0", " ", "\[Equal]", " ", "ix"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"subtypes1", "[", 
                 RowBox[{"[", "i1", "]"}], "]"}], ",", 
                RowBox[{"smc", ".", 
                 RowBox[{"submats1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "ns1"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"subtypes0", "[", 
                RowBox[{"[", "i0", "]"}], "]"}], ",", 
               RowBox[{"submats0", "[", 
                RowBox[{"[", "i0", "]"}], "]"}]}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i0", ",", "ns0"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"u1s1c", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"u1fac", " ", "=", " ", 
          RowBox[{"u1s1", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smc", ".", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "u1fac", "]"}], " ", "===", " ", "List"}], 
            ",", "\[IndentingNewLine]", "u1fac", ",", "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", "\[Equal]", "u1fac"}], ",", "1", ",", "0"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"type1", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "u1s1", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type0", ",", "stsms", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"u1s0", ",", "u1s1c"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Does", " ", "isomorphism", " ", "A", 
     RowBox[{"(", "1", ")"}]}], " ", "-", " ", 
    RowBox[{"B", 
     RowBox[{"(", "1", ")"}]}], " ", "-", " ", 
    RowBox[{"C", 
     RowBox[{"(", "1", ")"}], " ", "in", " ", "ld0"}]}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badtypeix"}], " ", "=", " ", 
   "\"\<Invalid type `1` at index `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badfamily"}], " ", "=", " ", 
   "\"\<Invalid family: ``\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameA1B1C1", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_", ",", "newfam_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"newfam", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"newfam", " ", ">", " ", "3"}]}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "newfam"}], "]"}]}],
        ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badfamily"}], ",", "newfam"}], "]"}],
         ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"newfam", ",", "1"}], "}"}], ",", "smti"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"stpi", ",", "smti"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Does", " ", "isomorphism", " ", "B", 
     RowBox[{"(", "2", ")"}]}], " ", "-", " ", 
    RowBox[{"C", 
     RowBox[{"(", "2", ")"}], " ", "in", " ", "ld0"}]}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], " ", " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameB2C2", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"smti", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"5", "-", 
                 RowBox[{"stpi", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", "2"}], "}"}], ",", 
              "smti"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"stpi", ",", "smti"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Does", " ", "isomorphism", " ", "A", 
     RowBox[{"(", "3", ")"}]}], " ", "-", " ", 
    RowBox[{"D", 
     RowBox[{"(", "3", ")"}], " ", "in", " ", "ld0"}]}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], " ", " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRenameA3D3", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "4"}], "}"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", 
            RowBox[{"ix", ",", "1"}], "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "3"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"smti", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1", ",", "3"}], "}"}], "]"}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"5", "-", 
                 RowBox[{"stpi", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ",", "3"}], "}"}], ",", 
              "smti"}], "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"stpi", ",", "smti"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Splits", " ", "D", 
    RowBox[{"(", "2", ")"}], " ", "in", " ", "ld0"}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], " ", " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherSplitD2", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti", ",", "smti1", ",", "smti2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "4"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"stpi", " ", "=", " ", 
            RowBox[{"subtypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"smti", " ", "=", " ", 
            RowBox[{"submats", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"smti", " ", "=", " ", 
               RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smti1", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"smti", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smti2", " ", "=", " ", 
               RowBox[{"{", 
                RowBox[{"smti", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smti1", " ", "=", " ", 
               RowBox[{"Transpose", "[", "smti1", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smti2", " ", "=", " ", 
               RowBox[{"Transpose", "[", "smti2", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "smti1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1"}], "}"}], ",", "smti2"}], "}"}]}], 
               "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"stpi", ",", "smti"}], "}"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ns"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Joins", " ", "two", " ", "of", " ", 
    RowBox[{
     RowBox[{"A", "/", "B"}], "/", "C"}], 
    RowBox[{"(", "1", ")"}], " ", "to", " ", "D", 
    RowBox[{"(", "2", ")"}], " ", "in", " ", "ld0"}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], " ", " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "ixmatch"}], " ", "=", " ", 
   "\"\<Input indices ought not to match\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherJoin2A1", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix1_", ",", "ix2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti", ",", 
      RowBox[{"smtix", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix1", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix1"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix2"}], "]"}], 
        ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ix1", " ", "\[Equal]", " ", "ix2"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{"LASubAlgebra", "::", "ixmatch"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix1", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix1", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix1", ",", "ns"}],
          "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix2", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix2", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix2", ",", "ns"}],
          "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix1", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix1", "]"}], "]"}], ",", "ix1"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix2", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "1"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix2", "]"}], "]"}], ",", "ix2"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"stpi", " ", "=", " ", 
            RowBox[{"subtypes", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"smti", " ", "=", " ", 
            RowBox[{"submats", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ix1", ",", "ix2"}], "}"}], ",", "i"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"smti", " ", "=", " ", 
               RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"smtix", " ", "=", " ", 
               RowBox[{"Join", "[", 
                RowBox[{"smtix", ",", "smti"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"stpi", ",", "smti"}], "}"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ns"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"smtix", " ", "=", " ", 
      RowBox[{"Transpose", "[", "smtix", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{"stsms", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "2"}], "}"}], ",", "smtix"}], "}"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Does", " ", "conjugation", " ", "of", " ", "every", " ", "subalgebra", 
    " ", "rep", " ", "in", " ", "ld0", " ", "with", " ", "index", " ", "in", 
    " ", "cjixs"}], ",", " ", 
   RowBox[{"making", " ", "ld"}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherConjugate", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "cjixs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "ns", ",", "i",
       ",", "stsms", ",", "stpi", ",", "smti", ",", "family", ",", "n", ",", 
      "nwixs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"cjixs", ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "stpi"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"nwixs", " ", "=", " ", 
             RowBox[{"Range", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"family", " ", "\[Equal]", " ", "1"}], ",", 
              RowBox[{"nwixs", " ", "=", " ", 
               RowBox[{"Reverse", "[", "nwixs", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"family", " ", "\[Equal]", " ", "4"}], ",", 
              RowBox[{"nwixs", " ", "=", " ", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Take", "[", 
                  RowBox[{"nwixs", ",", 
                   RowBox[{"n", "-", "2"}]}], "]"}], ",", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Take", "[", 
                   RowBox[{"nwixs", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}]}], "]"}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"family", " ", "\[Equal]", " ", "5"}], " ", "&&", " ", 
               
               RowBox[{"n", " ", "\[Equal]", " ", "6"}]}], ",", 
              RowBox[{"nwixs", " ", "=", " ", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Reverse", "[", 
                  RowBox[{"Take", "[", 
                   RowBox[{"nwixs", ",", 
                    RowBox[{"n", "-", "1"}]}], "]"}], "]"}], ",", 
                 RowBox[{"Take", "[", 
                  RowBox[{"nwixs", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "smti", "]"}], "[", 
               RowBox[{"[", "nwixs", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"stpi", ",", "smti"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"stpi", ",", "smti"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Finds", " ", "general", " ", "conjugate", " ", "of", " ", "D", 
    RowBox[{"(", "4", ")"}], " ", "in", " ", "ld0"}], ",", " ", 
   RowBox[{"making", " ", 
    RowBox[{"ld", ".", " ", "newrts"}], " ", "is", " ", "a", " ", "list", " ",
     "of", " ", "what", " ", "original", " ", "roots", " ", "become", " ", 
    "new", " ", 
    RowBox[{"roots", ".", " ", "Done"}], " ", "because", " ", "one", " ", 
    "can", " ", "interchange", " ", "all", " ", "three", " ", "of", " ", 
    "the", " ", "outer", " ", 
    RowBox[{"roots", "."}]}]}], "  ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badrearr"}], " ", "=", " ", 
   "\"\<Invalid rearrangement: `1` of `2`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LASubAlgebra", "::", "badixloc"}], " ", "=", " ", 
   "\"\<Invalid index: `1` at `2` should be at `3`\>\""}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherConjgD4", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "ix_", ",", "newrts_"}], "]"}], " ", ":=",
   " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "stsms", ",", 
      "ns", ",", "i", ",", "stpi", ",", "smti"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", "ix", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badindex"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ix", " ", "<", " ", "1"}], " ", "||", " ", 
        RowBox[{"ix", " ", ">", " ", "ns"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "outrange"}], ",", "ix", ",", "ns"}], 
         "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "4"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"subtypes", "[", 
         RowBox[{"[", 
          RowBox[{"ix", ",", "2"}], "]"}], "]"}], " ", "\[NotEqual]", " ", 
        "4"}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badtypeix"}], ",", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}], ",", "ix"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", "newrts", "]"}], " ", "=!=", " ", 
        RowBox[{"Range", "[", "4", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badrearr"}], ",", "newrts", ",", 
          RowBox[{"Range", "[", "4", "]"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"newrts", "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "\[NotEqual]", " ", "2"}], ",", 
       
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "ixmsplc"}], ",", 
          RowBox[{"newrts", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "2", ",", "2"}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "ix"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"smti", "[", 
              RowBox[{"[", "newrts", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"smti", " ", "=", " ", 
             RowBox[{"Transpose", "[", "smti", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"stpi", ",", "smti"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"stpi", ",", "smti"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Rearranges", " ", "the", " ", "subalgebras"}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BrancherRearrange", "[", 
   RowBox[{"ld_", ",", "ld0_", ",", "neword_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "type", ",", "subtypes", ",", "submats", ",", "u1s", ",", "ns", ",", "i",
       ",", "ix", ",", " ", "stsms", ",", "stpi", ",", "smti"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"type", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<type\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"subtypes", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<subtypes\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld0", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ns", " ", "=", " ", 
      RowBox[{"Length", "[", "subtypes", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", "neword", "]"}], " ", "=!=", " ", 
        RowBox[{"Range", "[", "ns", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"LASubAlgebra", "::", "badrearr"}], ",", "neword", ",", 
          RowBox[{"Range", "[", "ns", "]"}]}], "]"}], ";", 
        RowBox[{"Return", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"stsms", " ", "=", " ", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ix", " ", "=", " ", 
          RowBox[{"neword", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stpi", " ", "=", " ", 
          RowBox[{"subtypes", "[", 
           RowBox[{"[", "ix", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"smti", " ", "=", " ", 
          RowBox[{"submats", "[", 
           RowBox[{"[", "ix", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"stpi", ",", "smti"}], "}"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "ns"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MakeBrancher", "[", 
      RowBox[{"ld", ",", "type", ",", "stsms", ",", "u1s"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Branch", " ", "to", " ", "self"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SubalgSelf", "[", 
   RowBox[{"ld_", ",", "type_"}], "]"}], " ", ":=", " ", 
  RowBox[{"MakeBrancher", "[", 
   RowBox[{"ld", ",", "type", ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"type", ",", 
       RowBox[{"IdentityMatrix", "[", 
        RowBox[{"type", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Graphs of Roots of Representations", "Section"],

Cell[CellGroupData[{

Cell["Root / Weight List Diagram", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Args", ":", " ", 
    RowBox[{"the", " ", "algebra"}]}], ",", " ", 
   RowBox[{"the", " ", "max", " ", "weights"}], ",", " ", 
   RowBox[{
    RowBox[{
    "and", " ", "the", " ", "indices", " ", "of", " ", "the", " ", "rep", " ",
      "member", " ", "to", " ", 
     RowBox[{"display", ".", "\[IndentingNewLine]", "1"}]}], ":", " ", 
    RowBox[{"degen", " ", 
     RowBox[{"(", 
      RowBox[{"how", " ", "many"}], ")"}], "\[IndentingNewLine]", "2"}], ":", 
    " ", 
    RowBox[{"root", " ", "vector", "\[IndentingNewLine]", "3"}], ":", " ", 
    RowBox[{"weight", " ", 
     RowBox[{"vector", ".", "\[IndentingNewLine]", "Can"}], " ", "use", " ", 
     "a", " ", "list", " ", "of", " ", "these"}]}], ",", " ", 
   RowBox[{"like", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], " ", "or", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "Output", " ", "looks", " ", "like", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}], " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Output", ":", " ", 
     RowBox[{
     "roots", " ", "with", " ", "the", " ", "same", " ", "height", " ", 
      RowBox[{"(", 
       RowBox[{"root", "-", 
        RowBox[{"vector", " ", "total"}]}], ")"}], " ", "are", " ", "on", " ",
       "the", " ", "same", " ", 
      RowBox[{"line", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RootListDiagram", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "ixs_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rep", ",", "membyht", ",", 
      RowBox[{"htmin", "=", "0"}], ",", 
      RowBox[{"htmax", "=", "0"}], ",", "rpmem", ",", "rmht", ",", "k"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"GetRep", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rpmem", " ", "=", " ", 
         RowBox[{"rep", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rmht", " ", "=", " ", 
         RowBox[{"Total", "[", 
          RowBox[{"rpmem", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"htmin", " ", "=", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"htmin", ",", "rmht"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"htmax", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"htmax", ",", "rmht"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"membyht", "[", "rmht", "]"}], "]"}], " ", "===", " ", 
           "membyht"}], ",", 
          RowBox[{
           RowBox[{"membyht", "[", "rmht", "]"}], " ", "=", " ", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"membyht", "[", "rmht", "]"}], ",", 
          RowBox[{"rpmem", "[", 
           RowBox[{"[", "ixs", "]"}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{"Length", "[", "rep", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"#", ",", "\"\<    \>\""}], "]"}], "&"}], " ", "/@", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"membyht", "[", "rmht", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"rmht", ",", "htmax", ",", "htmin", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", "Center"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Composition of 1D: A1/B1/C1 SU(2)/SO(3)/Sp(2) - 3D angular momentum\
\>", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Input", ":", " ", 
    RowBox[{"angular", "-", 
     RowBox[{"momentum", " ", 
      RowBox[{"values", ":", " ", 
       RowBox[{"highest", " ", "root"}]}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", "highest", " ", 
    RowBox[{"weight", ".", " ", "Returns"}], " ", "axes"}], ",", " ", 
   RowBox[{
   "lines", " ", "for", " ", "irreps", " ", "in", " ", "the", " ", 
    "product"}], ",", " ", 
   RowBox[{
   "and", " ", "points", " ", "for", " ", "the", " ", "root", " ", 
    "values"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Graph1DComposition", "[", 
   RowBox[{"j1_", ",", "j2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m1", ",", "m2", ",", "v", ",", "k", ",", "j12", ",", "coordaxes", ",", 
      "prodreps", ",", "prodrtvals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"v", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"j12", " ", "=", " ", 
      RowBox[{"j1", " ", "+", " ", "j2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"coordaxes", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "j12"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j12", ",", "0"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "j12"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "j12"}], "}"}]}], "}"}]}], "}"}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prodreps", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"Thick", ",", "Gray", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "j1"}], "+", "k"}], ",", 
                RowBox[{"-", "j2"}]}], "}"}], ".", "v"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "j1"}], "+", "k"}], ",", 
                RowBox[{"j2", "-", "k"}]}], "}"}], ".", "v"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"j1", ",", 
                RowBox[{"j2", "-", "k"}]}], "}"}], ".", "v"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "0", ",", 
             RowBox[{"2", 
              RowBox[{"Min", "[", 
               RowBox[{"j1", ",", "j2"}], "]"}]}]}], "}"}]}], "]"}], "]"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"prodrtvals", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
        RowBox[{"Point", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m1", ",", "m2"}], "}"}], ".", "v"}], ",", 
             RowBox[{"{", 
              RowBox[{"m1", ",", 
               RowBox[{"-", "j1"}], ",", "j1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"m2", ",", 
               RowBox[{"-", "j2"}], ",", "j2"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"coordaxes", ",", "prodreps", ",", "prodrtvals"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Root Positions", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "These", " ", "are", " ", "selected", " ", "so", " ", "as", " ", "to", " ", 
   "be", " ", "as", " ", "symmetric", " ", "as", " ", "possible"}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmRootPositions", "[", 
   RowBox[{"type_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "family", ",", "n", ",", "tmat", ",", "tm", ",", "smc", ",", "i", ",", 
      "j", ",", "rep"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"GetRep", "[", 
       RowBox[{"type", ",", "maxwts"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"rep", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmat", " ", "=", " ", 
      RowBox[{"Switch", "[", 
       RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
        RowBox[{"(*", " ", "An", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Make", " ", "a", " ", "simplex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tm", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"n", "+", "1"}], "}"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], ";", " ", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"smc", " ", "=", " ", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", "i", 
                RowBox[{"(", 
                 RowBox[{"i", "+", "1"}], ")"}]}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"tm", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"-", " ", "smc"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "i"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", "=", 
             " ", 
             RowBox[{"i", "*", "smc"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"tm", ",", "1"}], "]"}], " ", "-", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"tm", ",", 
            RowBox[{"-", "1"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", "2", 
        ",", " ", 
        RowBox[{"(*", " ", "Bn", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tm", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
         "\[IndentingNewLine]", "tm"}], ",", "\[IndentingNewLine]", "3", ",", 
        " ", 
        RowBox[{"(*", " ", "Cn", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tm", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "2"}], ";", 
         "\[IndentingNewLine]", "tm"}], ",", "\[IndentingNewLine]", "4", ",", 
        " ", 
        RowBox[{"(*", " ", "Dn", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Canonical", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tm", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"tm", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", "1"}], 
         ";", " ", 
         RowBox[{
          RowBox[{"tm", "[", 
           RowBox[{"[", 
            RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
         "\[IndentingNewLine]", "tm"}], ",", "\[IndentingNewLine]", "5", ",", 
        " ", 
        RowBox[{"(*", " ", "En", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", "0", ",", 
              "0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", 
               RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", 
               RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", 
               RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
              RowBox[{
               RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tm", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "7", "}"}], ",", 
              RowBox[{"{", "7", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "7"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ";", " ", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"tm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
               "1"}], ";", " ", 
              RowBox[{
               RowBox[{"tm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"-", "1"}]}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"7", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
           ";", " ", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"7", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "8", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tm", " ", "=", " ", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", "8", "}"}], ",", 
              RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Even", " ", "canonical", " ", "one", " ", "here"}], ";",
              " ", 
             RowBox[{"could", " ", "also", " ", "use", " ", "odd"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tm", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"1", "/", "2"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ";", " ", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"tm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", 
                  RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
               "1"}], ";", " ", 
              RowBox[{
               RowBox[{"tm", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"-", "1"}]}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"8", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
           ";", " ", 
           RowBox[{
            RowBox[{"tm", "[", 
             RowBox[{"[", 
              RowBox[{"8", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
            RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", "tm"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
        " ", 
        RowBox[{"(*", " ", "Fn", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
          " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"1", "/", "2"}], ")"}]}], 
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], "}"}]}],
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
        " ", 
        RowBox[{"(*", " ", "Gn", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Switch", "[", 
         RowBox[{
         "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", 
              RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "rep", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ".", "tmat"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"2", 
    RowBox[{"D", ":", 
     RowBox[{
      RowBox[{"A2", "/", "SU"}], 
      RowBox[{"(", "3", ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"B2", "/", "SO"}], 
    RowBox[{"(", "5", ")"}]}], ",", 
   RowBox[{
    RowBox[{"C2", "/", "Sp"}], 
    RowBox[{"(", "4", ")"}]}], ",", 
   RowBox[{
    RowBox[{"D2", "/", "SO"}], 
    RowBox[{"(", "4", ")"}]}], ",", 
   RowBox[{
   "G2", "\[IndentingNewLine]", "\[IndentingNewLine]", "Family", " ", "is", 
    " ", "1"}], ",", " ", "2", ",", " ", "3", ",", " ", "4", ",", " ", 
   RowBox[{
   "7.", "\[IndentingNewLine]", "First", " ", "root", " ", "is", " ", 
    RowBox[{"horizontal", ".", " ", "Returns"}], " ", "points", " ", 
    "only"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Graph2DRoots", "[", 
   RowBox[{"family_", ",", "maxwts_"}], "]"}], " ", ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"SymmRootPositions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"family", ",", "2"}], "}"}], ",", "maxwts"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"3", 
    RowBox[{"D", ":", 
     RowBox[{
      RowBox[{"A3", "/", "SU"}], 
      RowBox[{"(", "4", ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"B3", "/", "SO"}], 
    RowBox[{"(", "7", ")"}]}], ",", 
   RowBox[{
    RowBox[{"C2", "/", "Sp"}], 
    RowBox[{"(", "8", ")"}]}], ",", 
   RowBox[{
    RowBox[{"D3", "/", "SO"}], 
    RowBox[{"(", "6", ")"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "Family", " ", "is", " ", "1"}], ",", " ", "2", ",", " ", "3", ",", " ", 
   RowBox[{"4.", " ", "First", " ", "root", " ", "is", " ", "dim", " ", "1"}],
    ",", " ", 
   RowBox[{"second", " ", "root", " ", "dim", " ", "1"}], ",", 
   RowBox[{
    RowBox[{"2.", " ", ".", " ", "Returns"}], " ", "points", " ", "only"}]}], 
  " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Graph3DRoots", "[", 
   RowBox[{"family_", ",", "maxwts_"}], "]"}], " ", ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"SymmRootPositions", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"family", ",", "3"}], "}"}], ",", "maxwts"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Projected", " ", "positions"}], ";", " ", 
   RowBox[{
   "use", " ", "a", " ", "matrix", " ", "to", " ", "project", " ", "down", 
    " ", "to", " ", "2", "D", " ", "or", " ", "3", "D"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphProjRoots", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "tmat_"}], "]"}], " ", ":=", 
  RowBox[{"Point", "[", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"SymmRootPositions", "[", 
      RowBox[{"type", ",", "maxwts"}], "]"}], ".", "tmat"}], "]"}], 
   "]"}]}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Extras", "Section"],

Cell[CellGroupData[{

Cell["Canonical Root Vectors", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Translation", " ", "of", " ", "the", " ", "representation", " ", "roots",
      " ", "into", " ", "more", " ", "convenient", " ", "vector", " ", 
     "forms"}], ";", " ", 
    RowBox[{"take", " ", 
     RowBox[{
      RowBox[{"(", "roots", ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"canonical", " ", "root", " ", "vectors"}], ")"}], ".", " ", 
      "Since"}], " ", "there", " ", "is", " ", "more", " ", "than", " ", 
     "one", " ", "version", " ", "in", " ", "some", " ", "cases"}]}], ",", 
   " ", 
   RowBox[{
   "I", " ", "have", " ", "included", " ", "a", " ", "\"\<vers\>\"", " ", 
    RowBox[{
    "switch", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "x"}]}], ",",
    "\[IndentingNewLine]", 
   RowBox[{"B", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{"C", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{"D", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{"F4", ":", " ", "0"}], ",", "\[IndentingNewLine]", 
   RowBox[{"A", 
    RowBox[{"(", "n", ")"}]}], ",", " ", "G2", ",", " ", 
   RowBox[{"E8", ":", " ", "0"}], ",", "1", ",", "\[IndentingNewLine]", 
   RowBox[{"E7", ":", " ", "0"}], ",", "1", ",", "2", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"E6", ":", " ", "0"}], ",", "1", ",", "2", ",", "3", ",", "4"}], 
  "\[IndentingNewLine]", " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NumCanonRootVectors", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", " ", "2", ",", 
       "\[IndentingNewLine]", "2", ",", " ", "1", ",", "\[IndentingNewLine]", 
       "3", ",", " ", "1", ",", "\[IndentingNewLine]", "4", ",", " ", "1", 
       ",", "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", " ", "5", ",", 
         "\[IndentingNewLine]", "7", ",", " ", "3", ",", 
         "\[IndentingNewLine]", "8", ",", " ", "2", ",", 
         "\[IndentingNewLine]", "_", ",", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", " ", "1", ",", 
         "\[IndentingNewLine]", "_", ",", " ", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", " ", "2", ",", 
         "\[IndentingNewLine]", "_", ",", " ", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "_", ",", " ", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CanonicalRootVectors", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "cvc", ",", "smplx", ",", "smc", ",",
       "i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
       RowBox[{"(*", " ", "An", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
             ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Simplex", " ", "projection"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"smplx", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}], ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"smplx", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], ";", " ", 
          RowBox[{
           RowBox[{"smplx", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
           RowBox[{"1", "/", "2"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"smc", " ", "=", " ", 
              RowBox[{"1", "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"2", "i", 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "1"}], ")"}]}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"smplx", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", " ", "smc"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "i"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"smplx", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "1"}], ",", "i"}], "]"}], "]"}], " ", "=", 
              " ", 
              RowBox[{"i", "*", "smc"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{
            RowBox[{"Drop", "[", 
             RowBox[{"smplx", ",", "1"}], "]"}], " ", "-", " ", 
            RowBox[{"Drop", "[", 
             RowBox[{"smplx", ",", 
              RowBox[{"-", "1"}]}], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
         "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", " ", 
       RowBox[{"(*", " ", "Bn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
             ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cvc", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "1"}]}], 
         ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{"(*", " ", "Cn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
             ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cvc", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "2"}]}], 
         ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "4", ",", " ", 
       RowBox[{"(*", " ", "Dn", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
             ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cvc", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", 
              RowBox[{"n", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", "1"}], 
          ";", " ", 
          RowBox[{
           RowBox[{"cvc", "[", 
            RowBox[{"[", 
             RowBox[{"n", ",", "n"}], "]"}], "]"}], " ", "=", " ", "1"}]}], 
         ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", " ", 
       RowBox[{"(*", " ", "En", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"0", " ", "is", " ", "even", " ", "E8"}], "-", 
            "derived"}], ",", " ", 
           RowBox[{
            RowBox[{"1", " ", "is", " ", "odd", " ", "E8"}], "-", "derived"}],
            ",", " ", 
           RowBox[{
           "2", " ", "is", " ", "contracted", " ", "0", " ", "or", " ", "1"}],
            ",", " ", 
           RowBox[{"3", " ", "is", " ", "9", "D", " ", 
            RowBox[{"(", 
             RowBox[{"3", " ", "SU", 
              RowBox[{
               RowBox[{"(", "3", ")"}], "'"}], "s"}], ")"}]}], ",", " ", 
           RowBox[{"4", " ", "is", " ", "contracted", " ", "3"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "6", "}"}], ",", 
               RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                "1"}], ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3", ",", "5"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "1", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "6", "}"}], ",", 
               RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}],
                ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "5"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"6", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[LessEqual]", "3"}], ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "6", "}"}], ",", 
               RowBox[{"{", "6", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "6"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                "1"}], ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3", ",", "5"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"6", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "3", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
                ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", 
                RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
                ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "/", "3"}], ")"}], 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}], ",", "2", ",", "2", ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}], ",", 
                 RowBox[{"-", "1"}], ",", "2", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", 
                RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0", 
                ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0", ",", "0"}], 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                "1", ",", 
                RowBox[{"-", "1"}], ",", "0"}], "}"}]}], 
             "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "4", 
           ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", "0", ",", 
                "0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", 
                 RowBox[{"Sqrt", "[", "3", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", 
                 RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", 
                 RowBox[{"Sqrt", "[", "3", "]"}]}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "0", ",", "0"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
               "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}],
               ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
                RowBox[{
                 RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"0", " ", "is", " ", "even", " ", "E8"}], "-", 
            "derived"}], ",", " ", 
           RowBox[{
            RowBox[{"1", " ", "is", " ", "odd", " ", "E8"}], "-", "derived"}],
            ",", " ", 
           RowBox[{"2", " ", "is", " ", "contracted"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "7", "}"}], ",", 
               RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                "1"}], ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"7", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"7", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "1", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "7", "}"}], ",", 
               RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", "1"}],
                ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"7", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"i", "\[LessEqual]", "3"}], ",", 
                  RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"cvc", " ", "=", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", 
               RowBox[{"{", "7", "}"}], ",", 
               RowBox[{"{", "7", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"cvc", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "6"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "7"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                "1"}], ";", " ", 
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"-", "1"}]}]}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"i", ",", "3", ",", "6"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"7", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
            ";", " ", 
            RowBox[{
             RowBox[{"cvc", "[", 
              RowBox[{"[", 
               RowBox[{"7", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
             RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "_", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"0", " ", "is", " ", "even"}], ",", " ", 
           RowBox[{"1", " ", "is", " ", "odd"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cvc", " ", "=", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "8", "}"}], ",", 
             RowBox[{"{", "8", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "vers", ",", "\[IndentingNewLine]", "0", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{"1", "/", "2"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}], ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"cvc", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                 "1"}], ";", " ", 
                RowBox[{
                 RowBox[{"cvc", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"-", "1"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"8", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], 
             ";", " ", 
             RowBox[{
              RowBox[{"cvc", "[", 
               RowBox[{"[", 
                RowBox[{"8", ",", "2"}], "]"}], "]"}], " ", "=", " ", 
              RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", "1", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"cvc", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                 "1"}], ";", " ", 
                RowBox[{
                 RowBox[{"cvc", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}], " ", "=", " ", 
                 RowBox[{"-", "1"}]}]}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "7"}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"cvc", "[", 
                 RowBox[{"[", 
                  RowBox[{"8", ",", "i"}], "]"}], "]"}], " ", "=", " ", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"i", "\[LessEqual]", "3"}], ",", 
                   RowBox[{"-", "1"}], ",", "1"}], "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "8"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       " ", 
       RowBox[{"(*", " ", "F4", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1", ",", 
                RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"1", "/", "2"}], ")"}]}], 
               RowBox[{"{", 
                RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}]}], 
             "}"}]}], ",", "\[IndentingNewLine]", "_", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       " ", 
       RowBox[{"(*", " ", "G2", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
           ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sqrt", "[", "3", "]"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", 
                RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "cvc"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Finds", " ", "extended", " ", "versions", " ", "that", " ", "are", " ", 
   "invertible"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExtendedCanonicalRootVectors", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cvc", ",", "family", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cvc", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", 
              RowBox[{"n", "+", "1"}], "}"}]}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "1", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
           RowBox[{"cvc", " ", "=", " ", 
            RowBox[{"Join", "[", 
             RowBox[{"cvc", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", 
                  ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
                  RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                  "0", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Switch", "[", 
          RowBox[{
          "vers", ",", "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cvc", ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
                ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"cvc", ",", 
             RowBox[{"{", 
              RowBox[{
              "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1",
                ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"cvc", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "cvc"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Appends", " ", "canonical"}], "-", 
   RowBox[{"vector", " ", "form", " ", "to", " ", "rep"}], "-", 
   RowBox[{"root", " ", "record"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ApplyCanonRootVectorsToRep", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rptr", ",", "cvc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rptr", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"GetRep", "[", 
        RowBox[{"type", ",", "maxwts"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CanonicalRootVectors", "[", 
       RowBox[{"type", ",", " ", "vers"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"rptr", ",", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"rptr", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", "cvc"}], "]"}]}], "]"}], 
      "]"}]}]}], "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Lie-Algebra Roots Found Directly", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Formulas", " ", "only", " ", "for", " ", "the", " ", "four", " ", 
   "infinite", " ", "families"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"valrepeats", "[", 
    RowBox[{"val_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"val", ",", "k"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "n"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositiveRootsBase", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zeros", ",", "ones", ",", "k", ",", "iwd"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zeros", " ", "=", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ones", " ", "=", " ", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"1", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"zeros", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"ones", "[", 
              RowBox[{"[", 
               RowBox[{"iwd", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"zeros", "[", 
              RowBox[{"[", 
               RowBox[{"n", "-", "iwd", "-", "k", "+", "2"}], "]"}], "]"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "\[Equal]", 
              RowBox[{"n", "-", "iwd", "+", "1"}]}], ",", "iwd", ",", "0"}], 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"iwd", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"n", "-", "iwd", "+", "1"}]}], "}"}]}], "]"}], ",", "1"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositiveRootsExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "family", ",", "n", ",", "rtx", ",", "rt", ",", "wd", ",", "twos", ",", 
      "m"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"twos", " ", "=", " ", 
      RowBox[{"valrepeats", "[", 
       RowBox[{"2", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";", 
            " ", "rt"}], ",", 
           RowBox[{"{", 
            RowBox[{"rtx", ",", 
             RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}], 
         ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "rt", "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}],
            ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], 
       ",", "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m", "-", "1"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{"n", ";;"}], "]"}], "]"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "1"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "rt", "}"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", "n", "]"}]}], "}"}]}], "]"}],
            ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], 
       ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rt", ",", "wd"}], "}"}], " ", "=", " ", "rtx"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"wd", " ", ">", " ", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "2"}]}], "]"}], "]"}], ",", "#"}], 
                    "]"}], "&"}], " ", "/@", " ", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "m", "-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"twos", "[", 
                    RowBox[{"[", 
                    RowBox[{"m", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "0", ",", 
                    RowBox[{"wd", "-", "2"}]}], "}"}]}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"rt", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"n", "-", "2"}]}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "}"}]}], "]"}]}],
              ",", 
             RowBox[{"{", 
              RowBox[{"rtx", ",", 
               RowBox[{"PositiveRootsBase", "[", 
                RowBox[{"n", "-", "1"}], "]"}]}], "}"}]}], "]"}], ",", "1"}], 
          "]"}], ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         "Null", ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
         "Null"}], "]"}], ",", "\[IndentingNewLine]", "_", ",", 
       "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metrics Found Directly", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MetricForType", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "la", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", " ", 
     RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MetricExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", 
               "1", ",", 
               RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "+", "#2"}], "\[GreaterEqual]", 
                RowBox[{"2", "n"}]}], ",", "1", ",", "2"}], "]"}]}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Switch", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", 
               "1", ",", 
               RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#1", "+", "#2"}], "\[GreaterEqual]", 
                RowBox[{
                 RowBox[{"2", "n"}], "-", "1"}]}], ",", "2", ",", "1"}], 
              "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "0", ",", "1"}], "]"}]}], ",", "2", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "1", ",", "0"}], "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "2"}], "}"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", 
             RowBox[{"-", "2"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "4", ",", 
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "2"}], ",", "2", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", 
             RowBox[{"-", "3"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "3"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightSpaceMetricForType", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "metric", ",", "cmtinv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmtinv", " ", "=", " ", 
      RowBox[{"Inverse", "[", 
       RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cmtinv", ".", "metric", ".", 
      RowBox[{"Transpose", "[", "cmtinv", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeightSpaceMetricExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"n", "+", "1"}], ")"}]}], ")"}], "*", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "*", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"n", "-", "#1", "+", "1"}], ",", 
                RowBox[{"n", "-", "#2", "+", "1"}]}], "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"2", "*", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#1", "\[Equal]", "n"}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", "\[Equal]", "n"}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"#1", ",", 
                  RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"#2", ",", 
                  RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#", " ", "\[GreaterEqual]", " ", 
                 RowBox[{"n", "-", "1"}]}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"#2", " ", "\[GreaterEqual]", " ", 
                 RowBox[{"n", "-", "1"}]}], ",", 
                RowBox[{"1", "/", "2"}], ",", "1"}], "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "4"}], ")"}], "*", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "\[GreaterEqual]", 
                  RowBox[{"n", "-", "1"}]}], "&&", 
                 RowBox[{"#2", "\[GreaterEqual]", 
                  RowBox[{"n", "-", "1"}]}]}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#1", "\[Equal]", "#2"}], ",", "1", ",", 
                  RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}]}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2", ",", 
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"2", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"10", "/", "3"}], ",", "4", ",", 
             RowBox[{"8", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "4", ",", "2", ",", "3"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"8", "/", "3"}], ",", "4", ",", 
             RowBox[{"10", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2", ",", 
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "2", ",", "1", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "2", ",", "3", ",", "4", ",", "3", ",", "2", ",", "1", ",", "2"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "3", ",", "6", ",", "8", ",", "6", ",", "4", ",", "2", ",", "4"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "9", ",", "6", ",", "3", ",", 
             "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6", ",", "9", ",", 
             RowBox[{"15", "/", "2"}], ",", "5", ",", 
             RowBox[{"5", "/", "2"}], ",", 
             RowBox[{"9", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "2", ",", "3"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", 
             RowBox[{"5", "/", "2"}], ",", "2", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", 
             RowBox[{"9", "/", "2"}], ",", "3", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"7", "/", "2"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "4", ",", "7", ",", "10", ",", "8", ",", "6", ",", "4", ",", "2", 
             ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "7", ",", "14", ",", "20", ",", "16", ",", "12", ",", "8", ",", 
             "4", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "10", ",", "20", ",", "30", ",", "24", ",", "18", ",", "12", ",", 
             "6", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "8", ",", "16", ",", "24", ",", "20", ",", "15", ",", "10", ",", 
             "5", ",", "12"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "6", ",", "12", ",", "18", ",", "15", ",", "12", ",", "8", ",", 
             "4", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "10", ",", "8", ",", "6", ",", "3",
              ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", 
             ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "5", ",", "10", ",", "15", ",", "12", ",", "9", ",", "6", ",", 
             "3", ",", "8"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_",
          ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"4", ",", "6", ",", "4", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "12", ",", "8", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "8", ",", "6", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"6", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cartan Matrices Found Directly", "Subsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CartanMatrixForType", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "metric", ",", "cmtinv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CartanMatrixExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", "1"}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#2", "\[Equal]", "n"}], ",", "2", ",", "1"}], 
                "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#1", "\[Equal]", "n"}], ",", "2", ",", "1"}], 
                "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"#1", "-", "#2"}], "]"}], ",", "0", ",", "2", ",", "1",
               ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "0", ",", "1"}], "]"}]}], ",", "2", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Max", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "\[Equal]", "n"}], ",", 
                 "1", ",", "0"}], "]"}]}], ",", "_", ",", "0"}], "]"}], "&"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "2"}], "}"}]}], 
          "}"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "8", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "2"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_", ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "2"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", 
             RowBox[{"-", "3"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseCartanMatrixForType", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "metric", ",", "cmtinv"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Inverse", "[", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseCartanMatrixExplicit", "[", "type_", "]"}], " ", ":=", " ", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", " ", "\[GreaterEqual]", " ", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"n", "+", "1"}], ")"}]}], "*", " ", 
          RowBox[{"Array", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"#1", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#2"}], ")"}]}], ",", 
               RowBox[{"#2", "*", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1", "-", "#1"}], ")"}]}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "2", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", "\[Equal]", "n"}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"Min", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "3", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "\[Equal]", "n"}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"Min", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "4", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[GreaterEqual]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", ">=", 
                RowBox[{"n", "-", "1"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#2", "\[GreaterEqual]", 
                RowBox[{"n", "-", "1"}]}], ",", 
               RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"#1", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{"#2", ",", 
                   RowBox[{"n", "-", "1"}]}], "]"}]}], "]"}], "+", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "\[GreaterEqual]", 
                   RowBox[{"n", "-", "1"}]}], "&&", 
                  RowBox[{"#2", "\[GreaterEqual]", 
                   RowBox[{"n", "-", "1"}]}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"#1", "\[Equal]", "#2"}], ",", "1", ",", 
                   RowBox[{"-", "1"}]}], "]"}], ",", "0"}], "]"}]}], ")"}]}], 
            "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2", ",", 
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"2", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"10", "/", "3"}], ",", "4", ",", 
             RowBox[{"8", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "4", ",", "2", ",", "3"}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"4", "/", "3"}], ",", 
             RowBox[{"8", "/", "3"}], ",", "4", ",", 
             RowBox[{"10", "/", "3"}], ",", 
             RowBox[{"5", "/", "3"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "2", ",", 
             RowBox[{"5", "/", "3"}], ",", 
             RowBox[{"4", "/", "3"}], ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "2", ",", "1", ",", "2"}], 
            "}"}]}], "}"}], ",", "\[IndentingNewLine]", "7", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "2", ",", "3", ",", "4", ",", "3", ",", "2", ",", "1", ",", "2"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "3", ",", "6", ",", "8", ",", "6", ",", "4", ",", "2", ",", "4"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "9", ",", "6", ",", "3", ",", 
             "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6", ",", "9", ",", 
             RowBox[{"15", "/", "2"}], ",", "5", ",", 
             RowBox[{"5", "/", "2"}], ",", 
             RowBox[{"9", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "2", ",", "3"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", 
             RowBox[{"5", "/", "2"}], ",", "2", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", 
             RowBox[{"9", "/", "2"}], ",", "3", ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"7", "/", "2"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "4", ",", "7", ",", "10", ",", "8", ",", "6", ",", "4", ",", "2", 
             ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "7", ",", "14", ",", "20", ",", "16", ",", "12", ",", "8", ",", 
             "4", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "10", ",", "20", ",", "30", ",", "24", ",", "18", ",", "12", ",", 
             "6", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "8", ",", "16", ",", "24", ",", "20", ",", "15", ",", "10", ",", 
             "5", ",", "12"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "6", ",", "12", ",", "18", ",", "15", ",", "12", ",", "8", ",", 
             "4", ",", "9"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "4", ",", "8", ",", "12", ",", "10", ",", "8", ",", "6", ",", "3",
              ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "2", ",", "4", ",", "6", ",", "5", ",", "4", ",", "3", ",", "2", 
             ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "5", ",", "10", ",", "15", ",", "12", ",", "9", ",", "6", ",", 
             "3", ",", "8"}], "}"}]}], "}"}], ",", "\[IndentingNewLine]", "_",
          ",", "\[IndentingNewLine]", "Null"}], "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "6", ",", "8", ",", "4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "7", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", "Null"}], "]"}], ",", "\[IndentingNewLine]", 
       "_", ",", "\[IndentingNewLine]", "Null"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Relation", " ", "to", " ", "representation", " ", "heights", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{"highest", " ", "root"}], ")"}]}], " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"highest", " ", "weight"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"inverse", " ", "Cartan", " ", "matrix"}], ")"}]}], 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{"rep", " ", "height"}], ")"}]}], " ", "=", " ", 
    RowBox[{"2", " ", "*", " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"highest", " ", "weight"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
        "row", " ", "sums", " ", "for", " ", "inverse", " ", "Cartan", " ", 
         "matrix"}], ")"}]}], " ", ")"}]}]}]}], " ", "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Total Degeneracies / Dimensions Found Explicitly", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"from", " ", 
    RowBox[{"Wybourne", "'"}], "s", " ", "Classical", " ", "Groups", " ", 
    "for", " ", "Physicists", " ", "with", " ", "some", " ", 
    RowBox[{"fixing", ".", " ", "For"}], " ", "An"}], ",", " ", "Bn", ",", 
   " ", "Cn", ",", " ", "Dn", ",", " ", 
   RowBox[{
    RowBox[{
    "essentially", " ", "the", " ", "formulas", " ", "for", " ", "the", " ", 
     "Weyl"}], "-", 
    RowBox[{"orbit", " ", 
     RowBox[{"forms", "."}]}]}]}], "  ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TDRootExpand", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_:", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"la", ",", "family", ",", "n"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckLARep", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"maxwts", ",", "0"}], "]"}], "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "maxwts", "]"}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "maxwts", "]"}], "/", "2"}]}], "]"}], "]"}],
          "]"}], "]"}], ",", "\[IndentingNewLine]", "3", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", "maxwts", "]"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "maxwts", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"maxwts", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}], "-", 
               RowBox[{"maxwts", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "2"}], "]"}], "]"}]}], ")"}], "/", "2"}]}], 
           "]"}], "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Most", "[", "maxwts", "]"}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"Range", "[", "5", "]"}], ".", 
                   RowBox[{"Most", "[", "maxwts", "]"}]}]}], "/", "6"}]}], 
               "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3", ",", "2", ",", "1", ",", "2"}], 
             "}"}], ".", "maxwts"}]}], "]"}], ",", "\[IndentingNewLine]", "7",
          ",", "\[IndentingNewLine]", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Most", "[", "maxwts", "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "4"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "2"}], ",", 
                   RowBox[{
                    RowBox[{"-", "3"}], "/", "4"}], ",", 
                   RowBox[{"1", "/", "4"}]}], "}"}], ".", "maxwts"}]}], "]"}],
               "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{
               RowBox[{"-", "9"}], "/", "4"}], ",", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "2"}], ",", 
              RowBox[{
               RowBox[{"-", "3"}], "/", "4"}], ",", 
              RowBox[{
               RowBox[{"-", "7"}], "/", "4"}]}], "}"}], ".", "maxwts"}]}], 
          "]"}], ",", "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Reverse", "[", 
                 RowBox[{"Most", "[", "maxwts", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], "/", "3"}], ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "/", "3"}], ",", "0", ",", "0", ",", 
                   "0", ",", "0", ",", "0", ",", 
                   RowBox[{"1", "/", "3"}]}], "}"}], ".", "maxwts"}]}], "]"}],
               "]"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "5"}], "/", "3"}], ",", 
              RowBox[{
               RowBox[{"-", "10"}], "/", "3"}], ",", 
              RowBox[{"-", "5"}], ",", 
              RowBox[{"-", "4"}], ",", 
              RowBox[{"-", "3"}], ",", 
              RowBox[{"-", "2"}], ",", 
              RowBox[{"-", "1"}], ",", 
              RowBox[{
               RowBox[{"-", "8"}], "/", "3"}]}], "}"}], ".", "maxwts"}]}], 
          "]"}]}], " ", "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", 
              RowBox[{"3", "/", "2"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"1", "/", "2"}], ",", "0"}], "}"}]}], "}"}], ".", 
          "maxwts"}]}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "}"}], ".", "maxwts"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalDegenExplicit", "[", 
   RowBox[{"type_", ",", "maxwts_", ",", 
    RowBox[{"mwcheck_:", "True"}]}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "rt0", ",", "rt1", ",", "i1", ",", 
      "i2", ",", "i3", ",", "i4", ",", "s1", ",", "s2", ",", "s3", ",", 
      "sgnset", ",", "sgns", ",", "mwx"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"mwcheck", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"CheckLARep", "[", 
           RowBox[{"type", ",", "maxwts"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "]"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rt0", " ", "=", " ", 
      RowBox[{"TDRootExpand", "[", 
       RowBox[{"type", ",", 
        RowBox[{
         RowBox[{"0", "*", "maxwts"}], "+", "1"}], ",", "mwcheck"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rt1", " ", "=", " ", 
      RowBox[{"TDRootExpand", "[", 
       RowBox[{"type", ",", 
        RowBox[{"maxwts", "+", "1"}], ",", "mwcheck"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "family", ",", "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "-", 
            RowBox[{"rt1", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt0", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], "-", 
            RowBox[{"rt0", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", 
           RowBox[{"i1", "+", "1"}], ",", 
           RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rt1", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], "/", 
           RowBox[{"rt0", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rt1", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], "/", 
           RowBox[{"rt0", "[", 
            RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
        RowBox[{"Product", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "-", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "+", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i1", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", 
            RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
       RowBox[{"Product", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "-", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "+", 
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "+", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i2", ",", 
           RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "5", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rt1", "[", 
             RowBox[{"[", "7", "]"}], "]"}], "/", 
            RowBox[{"rt0", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"rt1", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], "/", "2"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"rt0", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], "/", "2"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i4", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i4", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "3"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "-", "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i4", ",", 
              RowBox[{"i3", "+", "1"}], ",", "n"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "8", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i3", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}], "+", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i3", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "4", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sgnset", " ", "=", " ", 
           RowBox[{"Tuples", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rt1", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], "/", 
              RowBox[{"rt0", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", "n"}], "}"}]}], "]"}], "*", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "-", 
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "-", 
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "+", 
                 RowBox[{"rt1", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i1", "]"}], "]"}], "+", 
                 RowBox[{"rt0", "[", 
                  RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i1", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", 
               RowBox[{"i1", "+", "1"}], ",", "n"}], "}"}]}], "]"}], "*", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"sgns", ".", "rt1"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"sgns", ".", "rt0"}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"sgns", ",", "sgnset"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "7", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rt1", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], "/", 
             RowBox[{"rt0", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}], "*", 
          RowBox[{"Product", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt1", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i1", "]"}], "]"}], "-", 
               RowBox[{"rt0", "[", 
                RowBox[{"[", "i2", "]"}], "]"}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "+", "1"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Explicit", " ", "expressions", " ", "for", " ", "F4"}], ",", " ", 
   "E6", ",", " ", "E7", ",", " ", 
   RowBox[{"and", " ", "E8", " ", "are", " ", "very", " ", "bulky"}], ",", 
   " ", 
   RowBox[{"and", " ", "are", " ", "thus", " ", "omitted"}]}], " ", 
  "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Groups", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Weyl", "-", 
    RowBox[{"group", " ", "generators"}]}], ";", " ", 
   RowBox[{
    RowBox[{
    "complete", " ", "Weyl", " ", "group", " ", "is", " ", "much", " ", 
     RowBox[{"larger", ".", " ", "Identity"}]}], " ", "+", " ", 
    RowBox[{
    "generator", " ", "for", " ", "each", " ", "positive", " ", "root"}]}]}], 
  " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupGenerators", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "metric", ",", " ", "posroots", ",", 
      " ", "id"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<posroots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"id", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"id", " ", "-", " ", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "#", "}"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{"#", ".", "metric"}], "}"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"#", ".", "metric", ".", "#"}], ")"}]}]}]}], " ", ")"}],
          "&"}], " ", "/@", " ", "posroots"}], ",", " ", "id"}], "]"}]}]}], 
   "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupCanonGens", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "cvc", ",", "family", ",", "n", ",", "dimc", ",", "nc", ",", 
      "metric", ",", " ", "posroots", ",", " ", "id"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cvc", " ", "=", " ", 
      RowBox[{"CanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"cvc", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nc", ",", "dimc"}], "}"}], " ", "=", " ", 
      RowBox[{"Dimensions", "[", "cvc", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"posroots", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"la", "[", "\"\<posroots\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"id", " ", "=", " ", 
      RowBox[{"IdentityMatrix", "[", "dimc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Assumes", " ", "an", " ", "identity", " ", "metric", " ", "for", " ", 
       "the", " ", "canonical", " ", "root", " ", "vectors"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"id", " ", "-", " ", 
           RowBox[{"2", "*", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "#", "}"}], "]"}], ".", 
              RowBox[{"{", "#", "}"}]}], "/", 
             RowBox[{"(", 
              RowBox[{"#", ".", "#"}], ")"}]}]}]}], " ", ")"}], "&"}], " ", "/@",
         " ", 
        RowBox[{"(", 
         RowBox[{"posroots", ".", "cvc"}], ")"}]}], ",", " ", "id"}], 
      "]"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Weyl", " ", "groups", " ", "for", " ", "Lie", " ", 
     RowBox[{"algebras", ":", "\n", "\n", 
      RowBox[{
       RowBox[{"A", " ", 
        RowBox[{
         RowBox[{"(", "n", ")"}], " ", "--"}], " ", "S", " ", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}], " ", ":", " ", 
       RowBox[{"symmetric", " ", "group"}]}]}]}], ";", " ", 
    RowBox[{"S", " ", 
     RowBox[{"(", "n", ")"}], " ", "is", " ", "permutation", " ", "of", " ", 
     "n", " ", "symbols", "\n", "B", " ", 
     RowBox[{"(", "n", ")"}]}]}], ",", " ", 
   RowBox[{"C", " ", 
    RowBox[{
     RowBox[{"(", "n", ")"}], " ", "--"}], " ", 
    RowBox[{"2", "^", "n"}], " ", "*", " ", "S", " ", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "wreathed", " ", "product", " ", "of", " ", "permutations", 
     " ", "S", " ", 
     RowBox[{"(", "n", ")"}], " ", "and"}], " ", "+", 
    RowBox[{
     RowBox[{"-", "1"}], " ", "group", " ", "Z", " ", 
     RowBox[{
      RowBox[{"(", "2", ")"}], "^", "n"}], "\n", "D", " ", 
     RowBox[{
      RowBox[{"(", "n", ")"}], " ", "--"}], " ", "half", " ", "of", " ", 
     "the", " ", "above", " ", 
     RowBox[{"group", " ", "--"}], " ", "Z", " ", 
     RowBox[{
      RowBox[{"(", "2", ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], " ", "instead", " ", "of", " ", "Z", 
     " ", 
     RowBox[{
      RowBox[{"(", "2", ")"}], "^", "n"}]}]}], ",", " ", 
   RowBox[{"or", " ", "Z", " ", 
    RowBox[{
     RowBox[{"(", "2", ")"}], "^", "n"}], " ", "with", " ", "the", " ", 
    "product", " ", "equal", " ", "to", " ", "1.", "\n", "\n", "Here"}], ",", 
   " ", 
   RowBox[{
    RowBox[{"the", " ", "Weyl"}], "-", 
    RowBox[{
    "group", " ", "generators", " ", "are", " ", "transformed", " ", "into", 
     " ", "forms", " ", "that", " ", "make", " ", "their", " ", "group"}], 
    "-", 
    RowBox[{"member", " ", "features", " ", 
     RowBox[{"clearer", ":", " ", 
      RowBox[{"permutation", " ", "matrix", " ", "for", " ", "An"}]}]}]}], 
   ",", " ", 
   RowBox[{
   "permutation", " ", "matrix", " ", "*", " ", "signs", " ", "for", " ", 
    "Bn"}], ",", " ", "Cn", ",", " ", "Dn"}], "\n", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "A", " ", 
    RowBox[{"(", "n", ")"}]}], ",", " ", 
   RowBox[{"simple", " ", "roots", " ", 
    RowBox[{"k", ":", " ", 
     RowBox[{
     "1", " ", "to", " ", "n", " ", "permute", " ", "symbols", " ", "k"}]}]}],
    ",", " ", 
   RowBox[{
    RowBox[{"k", "+", 
     RowBox[{"1", " ", "out", " ", "of", " ", "n"}], "+", "1"}], ";", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "all", " ", "the", " ", "positive", " ", "roots", " ", "permute", " ", 
        "two", " ", "symbols", " ", "root", " ", 
        RowBox[{"(", "k", ")"}]}], "+", 
       RowBox[{"root", " ", 
        RowBox[{"(", 
         RowBox[{"k", "+", "1"}], ")"}]}], "+"}], "..."}], "+", 
     RowBox[{"root", " ", 
      RowBox[{"(", "l", ")"}], " ", "permutes", " ", "symbols", " ", "k", " ",
       "and", " ", "l"}], "+", "1"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"1", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Add", " ", "extra", " ", "1", " ", "at", " ", "the", " ", "end", " ", 
       "to", " ", "make", " ", "it", " ", "fit", " ", "with", " ", 
       "permutation", " ", "matrices"}], " ", "*)"}], 
     RowBox[{"perms", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "#", "]"}], ",", " ", 
             RowBox[{"Table", "[", 
              RowBox[{"0", ",", " ", 
               RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", "n", "}"}]}], "]"}], ",", " ", "1"}], "]"}]}], 
         "]"}], " ", "&"}], " ", "/@", " ", "perms"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", " ", "+", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"n", " ", "+", " ", "1"}], "}"}]}], "]"}]}]}], ";", "\n", 
     "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ptmat", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", 
           RowBox[{"n", " ", "+", " ", "1"}]}], "]"}], "]"}], " ", "=", " ", 
        "1"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", " ", "<=", " ", "i"}], ",", " ", "1", ",", " ", "0"}],
           "]"}], " ", "-", " ", 
         RowBox[{"i", "/", 
          RowBox[{"(", 
           RowBox[{"n", " ", "+", " ", "1"}], ")"}]}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"n", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
        " ", "=", " ", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"n", " ", "+", " ", "1"}], ")"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "+", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"For", " ", "C", " ", 
     RowBox[{"(", "n", ")"}], " ", "ei"}], " ", "-", " ", 
    RowBox[{"ej", " ", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"+", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}], ",", " ", 
   RowBox[{"ei", " ", "+", " ", 
    RowBox[{"ej", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}], ",", " ", 
   RowBox[{"2", "*", 
    RowBox[{"ei", ":", " ", 
     RowBox[{
      RowBox[{"diagonal", " ", "with", " ", "one", " ", "element"}], " ", "-",
       "1"}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"3", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"3", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "2"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{
      RowBox[{"pminv", "[", 
       RowBox[{"[", "n", "]"}], "]"}], " ", "*=", " ", 
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"For", " ", "B", " ", 
     RowBox[{"(", "n", ")"}], " ", "ei"}], " ", "-", " ", 
    RowBox[{"ej", " ", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"+", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}], ",", " ", 
   RowBox[{"ei", " ", "+", " ", 
    RowBox[{"ej", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}], ",", " ", 
   RowBox[{"ei", ":", " ", 
    RowBox[{
     RowBox[{"diagonal", " ", "with", " ", "one", " ", "element"}], " ", "-", 
     "1"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"2", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"For", " ", "D", " ", 
     RowBox[{"(", "n", ")"}], " ", "ei"}], " ", "-", " ", 
    RowBox[{"ej", " ", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"+", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}], ",", " ", 
   RowBox[{"ei", " ", "+", " ", 
    RowBox[{"ej", ":", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], " ", "*", " ", "permute", " ", "of", " ", 
      "two"}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"4", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "perms", ",", " ", "ptmat", ",", " ", "pminv", ",", " ", "i", ",", " ", 
      "j"}], "}"}], ",", "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"4", ",", "n"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"ptmat", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"{", "n", "}"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", " ", "i"}], "]"}], "]"}], " ", "=", " ", "1"}], 
        ";", " ", 
        RowBox[{
         RowBox[{"ptmat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"i", " ", "+", " ", "1"}], ",", " ", "i"}], "]"}], "]"}], 
         " ", "=", " ", 
         RowBox[{"-", "1"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}]}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "n"}], "]"}], "]"}], 
      " ", "=", " ", "1"}], ";", " ", 
     RowBox[{
      RowBox[{"ptmat", "[", 
       RowBox[{"[", 
        RowBox[{"n", ",", " ", "n"}], "]"}], "]"}], " ", "=", " ", "1"}], ";",
      "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "=", " ", "1"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "n"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "i"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pminv", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "j"}], "]"}], "]"}], " ", "-=", " ", 
        RowBox[{"1", "/", "2"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"n", " ", "-", " ", "1"}], ",", " ", "n"}], "}"}], ",", " ", 
       
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "n"}], "}"}]}], "]"}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"The", " ", "exceptional", " ", "groups"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", 
    RowBox[{"G2", ":", " ", 
     RowBox[{
     "the", " ", "group", " ", "is", " ", "the", " ", "dihedral", " ", 
      "group", " ", "D", " ", 
      RowBox[{"(", "6", ")"}]}]}]}], ",", " ", 
   RowBox[{"order", " ", "12"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"7", ",", "2"}], "]"}], " ", ":=", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", " ", "ptmat", ",", " ", "pminv"}], "}"}], ",", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"7", ",", "2"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"ptmat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", 
           RowBox[{"Sqrt", "[", "3", "]"}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2"}], ",", " ", "1"}], "}"}]}], "}"}]}], ";", "\n", 
     "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "3", "]"}]}], ",", " ", "0"}], "}"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", 
    RowBox[{"F4", ":", " ", 
     RowBox[{
      RowBox[{
      "the", " ", "group", " ", "is", " ", "the", " ", "4", "D", " ", "24"}], 
      "-", 
      RowBox[{"cell", " ", "rotation", " ", 
       RowBox[{"group", " ", "--"}], " ", "the", " ", "SO", 
       RowBox[{"(", "9", ")"}], " ", "group", " ", "with", " ", "all", " ", 
       "matrices", " ", "of"}], " ", "+", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "1"}], "/", "2"}], " ", "with", " ", 
       "determinant"}], " ", "+", 
      RowBox[{"-", " ", "1"}]}]}]}], ",", " ", 
   RowBox[{"order", " ", "1152"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeWeylGens", "[", 
   RowBox[{"6", ",", "4"}], "]"}], " ", ":=", "  ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", " ", "ptmat", ",", " ", "pminv"}], "}"}], ",", 
    "\n", "  ", 
    RowBox[{
     RowBox[{"perms", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"ptmat", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "0", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
          RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}]}], ";", "\n", "  ", 
     RowBox[{"pminv", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1", ",", " ", "0", ",", " ", "2"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "1", ",", " ", "1", ",", " ", "3"}], "}"}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "2"}], "}"}]}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"ptmat", ".", "#", ".", "pminv"}], " ", "&"}], " ", "/@", " ", 
      "perms"}]}]}], "\n", "  ", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"For", " ", "E6"}], ",", " ", "E7", ",", " ", 
   RowBox[{"E8", ":", " ", 
    RowBox[{"orders", " ", "51840"}]}], ",", " ", "2903040", ",", " ", 
   RowBox[{"696729600", "\n", 
    RowBox[{"E6", ":", " ", 
     RowBox[{
     "automorphism", " ", "groups", " ", "of", " ", "simple", " ", "group", 
      " ", "PSU", " ", 
      RowBox[{"(", 
       RowBox[{"4", ",", "2"}], ")"}]}]}]}], ",", " ", 
   RowBox[{"PSW", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"6", "-"}], ",", "2"}], ")"}]}], ",", " ", 
   RowBox[{"PSp", " ", 
    RowBox[{"(", 
     RowBox[{"4", ",", "3"}], ")"}]}], ",", " ", 
   RowBox[{"PSW", " ", 
    RowBox[{"(", 
     RowBox[{"5", ",", "3"}], ")"}]}], ",", " ", 
   RowBox[{
    RowBox[{"order", " ", "25920", "\n", 
     RowBox[{"E7", ":", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"simple", " ", "group", " ", "PSp", " ", 
          RowBox[{"(", 
           RowBox[{"6", ",", "2"}], ")"}], " ", "or", " ", "PSW", " ", 
          RowBox[{"(", 
           RowBox[{"7", ",", "2"}], ")"}]}], ",", " ", 
         RowBox[{"order", " ", "1451520"}]}], ")"}], " ", "*", " ", "Z", " ", 
       
       RowBox[{"(", "2", ")"}], "\n", " ", 
       RowBox[{"E8", ":", " ", 
        RowBox[{"O", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", "+"}], ",", "2"}], ")"}]}]}]}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"2.", 
      RowBox[{"(", 
       RowBox[{"simple", " ", "group", " ", "PSW", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"8", "+"}], ",", "2"}], ")"}], " ", "order", " ", 
        "174182400"}], ")"}], ".2", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "E8", " ", "is", " ", "the", " ", "SO", 
      RowBox[{"(", "16", ")"}], " ", "group", " ", "with", " ", "matrices", 
      " ", "added", " ", "with", " ", "each", " ", 
      RowBox[{"row", "/", "column"}], " ", "containing", " ", "1", " ", "of", 
      " ", 
      RowBox[{"3", "/", "4"}], " ", "and", " ", "7", " ", "of", " ", 
      RowBox[{"1", "/", "4"}], " ", "with", " ", "signs"}], " ", "+", 
     "-"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetWeylGroupOrder", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"family", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{"family", ",", "\[IndentingNewLine]", "1", ",", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}], "!"}], ",", "\[IndentingNewLine]", 
       "2", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", "n"}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "3", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", "n"}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "4", ",", " ", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}]}], "*", 
        RowBox[{"n", "!"}]}], ",", "\[IndentingNewLine]", "5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "n", ",", "\[IndentingNewLine]", "6", ",", " ", "25920", ",", 
         "\[IndentingNewLine]", "7", ",", "1451520", ",", 
         "\[IndentingNewLine]", "8", ",", " ", "174182400"}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "6", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"n", ",", "\[IndentingNewLine]", "4", ",", " ", "1152"}], 
        "]"}], ",", "\[IndentingNewLine]", "7", ",", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{"n", ",", "\[IndentingNewLine]", "2", ",", " ", "12"}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOut", "[", 
   RowBox[{"initset_", ",", "xpndfunc_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"oldset", ",", "itmdset", ",", "newset"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"oldset", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newset", " ", "=", " ", "initset"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "newset", "]"}], " ", ">", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"itmdset", " ", "=", " ", "newset"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldset", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"oldset", ",", "itmdset"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newset", " ", "=", " ", 
         RowBox[{"Union", " ", "@@", " ", 
          RowBox[{"(", 
           RowBox[{"xpndfunc", " ", "/@", " ", "newset"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newset", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{"newset", ",", "oldset"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "oldset"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutGroupStep", "[", 
   RowBox[{"stpel_", ",", "els_", ",", "op_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"stpel", ",", "#"}], "]"}], "&"}], " ", "/@", " ", "els"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"op", "[", 
       RowBox[{"#", ",", "stpel"}], "]"}], "&"}], " ", "/@", " ", "els"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutGroup", "[", 
   RowBox[{"els_", ",", "op_"}], "]"}], " ", ":=", " ", 
  RowBox[{"FillOut", "[", 
   RowBox[{"els", ",", 
    RowBox[{
     RowBox[{"FillOutGroupStep", "[", 
      RowBox[{"#", ",", "els", ",", "op"}], "]"}], "&"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillOutWeylGroup", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"FillOutGroup", "[", 
   RowBox[{
    RowBox[{"WeylGroupGenerators", "[", "type", "]"}], ",", "Dot"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Uses", " ", "canonical", " ", "root", " ", "vectors"}], ";", " ", 
   
   RowBox[{"vers", " ", "is", " ", "which", " ", "set"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylGroupGensCanonVecs", "[", 
   RowBox[{"type_", ",", "vers_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "n", ",", "gens", ",", "cvcx", ",", "invcvcx", ",", "nx"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gens", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cvcx", " ", "=", " ", 
      RowBox[{"ExtendedCanonicalRootVectors", "[", 
       RowBox[{"type", ",", "vers"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nx", " ", "=", " ", 
      RowBox[{"Length", "[", "cvcx", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"invcvcx", " ", "=", " ", 
      RowBox[{"Inverse", "[", "cvcx", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nx", " ", ">", " ", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "cvcx", "]"}], ".", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"nx", "-", "n"}], "}"}], ",", 
                  RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", "n", "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"nx", "-", "n"}], "}"}]}], "]"}], ",", 
                RowBox[{"IdentityMatrix", "[", 
                 RowBox[{"nx", "-", "n"}], "]"}]}], "]"}], "]"}]}], "]"}], 
           "]"}], ".", 
          RowBox[{"Transpose", "[", "invcvcx", "]"}]}], "&"}], " ", "/@", " ",
         "gens"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Transpose", "[", "cvcx", "]"}], ".", "#", ".", 
          RowBox[{"Transpose", "[", "invcvcx", "]"}]}], "&"}], " ", "/@", " ",
         "gens"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl Orbit Combinations", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Products", " ", "of", " ", "Weyl", " ", 
   RowBox[{"orbits", ".", "\[IndentingNewLine]", "Inputs"}], " ", "in", " ", 
   "weight", " ", 
   RowBox[{"space", ".", "\[IndentingNewLine]", "Output"}], " ", "is", " ", 
   "list", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"multiplicity", ",", " ", 
     RowBox[{"dominant", " ", "root"}], ",", " ", 
     RowBox[{"dominant", " ", "weight"}]}], "}"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WeylOrbitProduct", "[", 
   RowBox[{"type_", ",", "maxwts1_", ",", "maxwts2_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "ctnmat", ",", "orb1", ",", "orb2", ",", "orbprod", ",", 
      "gens"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "\[Equal]", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmat", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orb1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"WeylOrbitForDomWt", "[", 
        RowBox[{"type", ",", "maxwts1"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orb2", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "&"}], " ", "/@", " ", 
       RowBox[{"WeylOrbitForDomWt", "[", 
        RowBox[{"type", ",", "maxwts2"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"orbprod", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Plus", " ", "@@", " ", "#"}], ")"}], "&"}], " ", "/@", " ", 
       
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"orb1", ",", "orb2"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gens", " ", "=", " ", 
      RowBox[{"WeylGroupGenerators", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ".", "ctnmat"}]}], "}"}], "&"}], 
      " ", "/@", " ", 
      RowBox[{"WeylOrbitsForRootList", "[", 
       RowBox[{"gens", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "#"}], "}"}], "&"}], " ", "/@", " ", 
         "orbprod"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "One", " ", "can", " ", "also", " ", "do", " ", "decompositions", " ", 
    "for", " ", "branching", " ", "rules"}], ",", " ", 
   RowBox[{
    RowBox[{"using", " ", "the", " ", "branching"}], "-", 
    RowBox[{"rule", " ", 
     RowBox[{"object", "'"}], "s", " ", 
     RowBox[{"contents", "."}]}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Copy", " ", "and", " ", "paste", " ", "and", " ", "edit", " ", "of", " ", 
    "irrep", " ", "branching"}], "-", 
   RowBox[{"rule", " ", "function", " ", 
    RowBox[{"DoBranching", "[", "]"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DoWeylOrbitBranching", "[", 
   RowBox[{"ld_", ",", "maxwts_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u1s", ",", "submats", ",", "nsa", ",", "la", ",", "i", ",", "j", ",", 
      "k", ",", "ctnmats", ",", " ", "rep", ",", "repx", ",", "rpmem", ",", 
      "memkey", ",", "rt", ",", "rts", ",", "wts", ",", "u1fac", ",", 
      "u1vals", ",", "rpix", ",", "ix", ",", " ", "zerovec", ",", " ", 
      "zeromem", ",", " ", "irreplist", ",", "mwmem", ",", "found", ",", 
      "outrep", ",", " ", "orind", ",", "ormem", ",", "oimem"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Get", " ", "the", " ", "parameters"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"u1s", " ", "=", " ", 
      RowBox[{"ld", "[", "\"\<u1s\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"submats", " ", "=", " ", 
      RowBox[{"ld", "[", "\"\<submats\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nsa", " ", "=", " ", 
      RowBox[{"Length", "[", "submats", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ctnmats", " ", "=", "  ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"la", " ", "=", " ", 
          RowBox[{"GetLieAlgebra", "[", 
           RowBox[{
            RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
         RowBox[{"la", "[", "\"\<ctnmat\>\"", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Find", " ", "the", " ", "rep", " ", "and", " ", "the", " ", 
       "decomposition", " ", "of", " ", "each", " ", 
       RowBox[{"member", "'"}], "s", " ", "roots", " ", "and", " ", "weights",
        " ", "into", " ", "the", " ", 
       RowBox[{"subalgebras", "'"}], " ", 
       RowBox[{"ones", ".", " ", "Also"}], " ", "handle", " ", "the", " ", 
       "demoted", " ", 
       RowBox[{"root", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"WeylOrbitLikeGetRep", "[", 
       RowBox[{
        RowBox[{"ld", "[", "\"\<type\>\"", "]"}], ",", "maxwts"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rt", " ", "=", " ", 
          RowBox[{"rpmem", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rts", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"rt", ".", 
             RowBox[{"submats", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"wts", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rts", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ".", 
             RowBox[{"ctnmats", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "nsa"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Handle", " ", "both", " ", "the", " ", "cases", " ", "of", " ", 
           "a", " ", "vector", " ", "to", " ", "multiply", " ", "the", " ", 
           "roots", " ", "and", " ", "a", " ", "root", " ", "index"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"u1vals", " ", "=", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"u1fac", " ", "=", " ", 
              RowBox[{"u1s", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "u1fac", "]"}], " ", "===", " ", 
                "List"}], ",", 
               RowBox[{"u1fac", ".", "rt"}], ",", 
               RowBox[{"rt", "[", 
                RowBox[{"[", "u1fac", "]"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", "u1s", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rpmem", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "rts", ",", "wts", ",", 
           "u1vals"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consolidate", " ", "all", " ", "rep", " ", "entries", " ", "with", " ",
        "the", " ", "same", " ", 
       RowBox[{
        RowBox[{"root", "/", "weight"}], "/", "coeff"}], " ", "value"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"repx", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"memkey", " ", "=", " ", 
         RowBox[{"rpmem", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ix", " ", "=", " ", 
         RowBox[{"rpix", "[", "memkey", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "ix", "]"}], "===", "rpix"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"repx", ",", "rpmem"}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rpix", "[", "memkey", "]"}], " ", "=", " ", 
            RowBox[{"Length", "[", "repx", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"repx", "[", 
            RowBox[{"[", 
             RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "+=", " ", 
           RowBox[{"rpmem", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"rpmem", ",", "rep"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rep", " ", "=", " ", "repx"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "all", " ", "the", " ", "irreps"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Create", " ", "a", " ", "convenient", " ", 
       RowBox[{"reference", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"zerovec", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "#", "]"}], "}"}]}], "]"}], "&"}], " ", "/@",
        " ", "ctnmats"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"zeromem", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "zerovec", ",", " ", "zerovec", ",", " ", "0"}],
        "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"irreplist", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{"True", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mwmem", " ", "=", " ", "zeromem"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"found", " ", "=", " ", "False"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rpmem", " ", "=", " ", 
            RowBox[{"rep", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Ought", " ", "to", " ", "have", " ", "an", " ", "assert", " ", 
             "for", " ", "negative", " ", "values"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rpmem", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "\[LessEqual]", " ", 
              "0"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "Ordering", " ", "is", " ", "with", " ", "the", " ", "roots"}], 
             ",", " ", 
             RowBox[{
              RowBox[{"not", " ", "with", " ", "the", " ", 
               RowBox[{"weights", ".", " ", "Recommended"}], " ", "in", " ", 
               "Weight", " ", 
               RowBox[{"(", 
                RowBox[{"representation", " ", "theory"}], ")"}]}], " ", "-", 
              " ", "Wikipedia"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"the", " ", "free", " ", "encyclopedia"}], " ", "-", 
               " ", 
               RowBox[{"http", ":"}]}], "//", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], 
                "/", "Weight_"}], 
               RowBox[{"(", "representation_theory", ")"}]}]}]}], " ", "*)"}],
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"rpmem", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", 
                RowBox[{"mwmem", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", 
              "\[GreaterEqual]", " ", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"found", " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"mwmem", " ", "=", " ", "rpmem"}]}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "rep", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Are", " ", "we", " ", 
          RowBox[{"done", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "found"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Subtract", " ", "out", " ", "what", " ", "we", " ", "found"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outrep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"mwmem", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"orind", " ", "=", " ", 
            RowBox[{"WeylOrbitLikeGetRep", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ld", "[", "\"\<subtypes\>\"", "]"}], "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"mwmem", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "i"}], "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"outrep", " ", "=", " ", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ormem", " ", "=", " ", 
                  RowBox[{"outrep", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"oimem", " ", "=", " ", 
                    RowBox[{"orind", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"oimem", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"ormem", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Length", "[", "orind", "]"}]}], "}"}]}], "]"}]}],
                 ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{"Length", "[", "outrep", "]"}]}], "}"}]}], "]"}], 
              ",", "\[IndentingNewLine]", "1"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nsa"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ix", " ", "=", " ", 
            RowBox[{"rpix", "[", 
             RowBox[{"ormem", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4"}], "}"}], "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rep", "[", 
             RowBox[{"[", 
              RowBox[{"ix", ",", "1"}], "]"}], "]"}], " ", "-=", "  ", 
            RowBox[{
             RowBox[{"mwmem", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"ormem", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ormem", ",", "outrep"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"irreplist", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"mwmem", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"mwmem", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{"mwmem", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "irreplist"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Cartan-Weyl Normalizations", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Finds", " ", "the", " ", "Cartan"}], "-", 
     RowBox[{"Weyl", " ", 
      RowBox[{"normalizations", ".", " ", "These"}], " ", "are", " ", 
      RowBox[{"for", "\[IndentingNewLine]", "[", 
       RowBox[{
        RowBox[{"H", 
         RowBox[{"(", "i", ")"}]}], ",", 
        RowBox[{"E", 
         RowBox[{"(", "a", ")"}]}]}], "]"}]}]}], " ", "=", " ", 
    RowBox[{
     RowBox[{"a", 
      RowBox[{"(", "i", ")"}], "E", 
      RowBox[{
       RowBox[{"(", "a", ")"}], "\[IndentingNewLine]", "[", 
       RowBox[{
        RowBox[{"E", 
         RowBox[{"(", "a", ")"}]}], ",", 
        RowBox[{"E", 
         RowBox[{"(", 
          RowBox[{"-", "a"}], ")"}]}]}], "]"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"a", ".", "g", ".", 
       RowBox[{"H", "\[IndentingNewLine]", "[", 
        RowBox[{
         RowBox[{"E", 
          RowBox[{"(", "a", ")"}]}], ",", 
         RowBox[{"E", 
          RowBox[{"(", "b", ")"}]}]}], "]"}]}], " ", "=", " ", 
      RowBox[{"N", 
       RowBox[{"(", 
        RowBox[{"a", ",", "b"}], ")"}], "*", "E", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}], "\[IndentingNewLine]", "a"}]}]}]}], 
   ",", " ", 
   RowBox[{"b", ":", " ", 
    RowBox[{"root", " ", "vectors"}]}], ",", " ", 
   RowBox[{
   "i", " ", "index", " ", "in", " ", "root", " ", "vector", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "Find", " ", "N", 
    RowBox[{"(", 
     RowBox[{"a", ",", "b"}], ")"}], " ", "values"}]}], "\[IndentingNewLine]",
   "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "All", " ", "the", " ", "nonzero", " ", "ones", " ", "used", " ", "in", " ",
    "the", " ", "constraints"}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNVariables", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "psrs", ",", "nps", ",", "i1", ",", "i2", ",", "pi1", ",", 
      "pi2", ",", "pi12", ",", 
      RowBox[{"vars", "=", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"vars", ",", 
            RowBox[{"nrm", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "vars"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "The", " ", "squares", " ", "of", " ", "the", " ", "normalizations", " ", 
   "as", " ", "functions", " ", "of", " ", "the", " ", "sorted", " ", "root", 
   " ", 
   RowBox[{"lenghts", ":", " ", 
    RowBox[{"N", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", ",", "b"}], ")"}], "^", "2"}], " ", "as", " ", 
     "functions", " ", "of", " ", "sort", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"len", 
          RowBox[{"(", "a", ")"}]}], ",", 
         RowBox[{"len", 
          RowBox[{"(", "b", ")"}]}], ",", 
         RowBox[{"len", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b"}], ")"}]}]}], "}"}], ")"}], "."}]}]}]}], " ",
   "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "1"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4", ",", "4"}], "}"}]}], "]"}], " ", "=", " ", "2"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "]"}], " ", "=", " ", "4"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "6"}], "}"}]}], "]"}], " ", "=", " ", "3"}],
   ";", " ", 
  RowBox[{
   RowBox[{"CWNLenMag", "[", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "6", ",", "6"}], "}"}]}], "]"}], " ", "=", " ", "3"}],
   ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"All", " ", "the", " ", 
    RowBox[{"constraints", ".", " ", "Experience"}], " ", "indicates", " ", 
    "that", " ", "there", " ", "this", " ", "works", " ", "up", " ", "to", 
    " ", "signs"}], ",", " ", 
   RowBox[{"and", " ", "that", " ", "there", " ", "are", " ", 
    RowBox[{"2", "^", "n"}], " ", "resulting", " ", "equation", " ", "for", 
    " ", "n", " ", "undetermined", " ", "signs"}], ","}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNConstraints", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "family", ",", "n", ",", "psrs", ",", "metric", ",", "nps", 
      ",", "nrm0", ",", "nrmx", ",", "i1", ",", "i2", ",", "i3", ",", "pi1", 
      ",", "pi2", ",", "pi12", ",", "pi3", ",", "pi13", ",", "pi23", ",", 
      "pi123", ",", "psrsx", ",", 
      RowBox[{"cstrs", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nrm", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"family", ",", "n"}], "}"}], " ", "=", " ", "type"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", "a"}], ")"}]}]}], " ", "=", " ", 
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "a"}], ")"}]}], " ", "=", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"-", " ", "N"}], 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", 
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}]}], ")"}]}], " ", "=", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}], ",", "a"}], ")"}]}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", 
           RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", "pi2"}], "]"}], " ", "=", " ", "0"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", 
           RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Fix", " ", "the", " ", "sign"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nrm0", " ", "=", " ", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"CWNLenMag", "[", 
              RowBox[{"family", ",", " ", 
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"pi1", ".", "metric", ".", "pi1"}], ",", 
                  RowBox[{"pi2", ".", "metric", ".", "pi2"}], ",", 
                  RowBox[{"pi12", ".", "metric", ".", "pi12"}]}], "}"}], 
                "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nrm0", " ", "*=", " ", 
            RowBox[{"nrm", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi2"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi1"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", 
            RowBox[{"-", " ", "nrm0"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], "=", "0"}], ";", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], "=", "0"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "^", "2"}]}], " ", "-", " ", 
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", 
              RowBox[{"-", "b"}]}], ")"}], "^", "2"}]}]}]}], " ", "=", " ", 
        RowBox[{"-", " ", 
         RowBox[{"<", "a"}]}]}], ",", 
       RowBox[{"b", ">"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{
               RowBox[{"nrmx", "[", 
                RowBox[{"pi1", ",", "pi2"}], "]"}], "^", "2"}], " ", "-", " ", 
              RowBox[{
               RowBox[{"nrmx", "[", 
                RowBox[{"pi1", ",", 
                 RowBox[{"-", "pi2"}]}], "]"}], "^", "2"}], " ", "+", " ", 
              RowBox[{"pi1", ".", "metric", ".", "pi2"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "nps"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Constraints", ":", " ", 
        RowBox[{
        "Jacobi", " ", "with", " ", "no", " ", "roots", " ", "or", " ", 
         "root", " ", "sums", " ", 
         RowBox[{"zero", ":", " ", 
          RowBox[{
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"a", "+", "b"}], ",", "c"}], ")"}]}], " ", "+", " ", 
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"b", ",", "c"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", "+", "c"}], ",", "a"}], ")"}]}], " ", "+", " ", 
           RowBox[{"N", 
            RowBox[{"(", 
             RowBox[{"c", ",", "a"}], ")"}], "N", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", "+", "a"}], ",", "b"}], ")"}]}]}]}]}]}], " ", "=", 
       " ", "0"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"psrsx", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"psrs", ",", 
        RowBox[{"-", "psrs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi3", " ", "=", " ", 
              RowBox[{"psrsx", "[", 
               RowBox[{"[", "i3", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi12", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi2"}]}], ";", " ", 
             RowBox[{"pi13", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi3"}]}], ";", " ", 
             RowBox[{"pi23", " ", "=", " ", 
              RowBox[{"pi2", "+", "pi3"}]}], ";", 
             RowBox[{"pi123", " ", "=", " ", 
              RowBox[{"pi1", "+", "pi2", "+", "pi3"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi12", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi13", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi23", "]"}], "]"}], "\[Equal]", "0"}],
                 " ", "||", " ", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Abs", "[", "pi123", "]"}], "]"}], "\[Equal]", 
                 "0"}]}], ",", "\[IndentingNewLine]", "0", ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi1", ",", "pi2"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi12", ",", "pi3"}], "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi2", ",", "pi3"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi23", ",", "pi1"}], "]"}]}], " ", "+", " ", 
                RowBox[{
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi3", ",", "pi1"}], "]"}], "*", 
                 RowBox[{"nrmx", "[", 
                  RowBox[{"pi13", ",", "pi2"}], "]"}]}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"2", "*", "nps"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i3", ",", 
              RowBox[{"i2", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}],
        "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"Union", "[", "cstrs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNSolution", "[", 
   RowBox[{"type_", ",", "nrm_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "vars", ",", "nvrs", ",", "cstrs", ",", "handled", ",", 
      RowBox[{"nrls", "=", 
       RowBox[{"{", "}"}]}], ",", "soln", ",", "i", ",", "vr", ",", "ncss", 
      ",", "nwrl"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"CWNVariables", "[", 
       RowBox[{"type", ",", "nrm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nvrs", " ", "=", " ", 
      RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"CWNConstraints", "[", 
       RowBox[{"type", ",", "nrm"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"handled", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"False", ",", 
        RowBox[{"{", "nvrs", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"And", " ", "@@", " ", "handled"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"handled", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"vr", " ", "=", " ", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nwrl", " ", "=", " ", 
            RowBox[{"vr", " ", "\[Rule]", " ", "1"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ncss", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"cstrs", " ", "/.", " ", "nwrl"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[NotEqual]", "0"}], "&"}], " ", "/@", " ", 
                 "ncss"}], ",", "True"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"handled", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"cstrs", " ", "=", " ", "ncss"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nrls", ",", "nwrl"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"nwrl", " ", "=", " ", 
            RowBox[{"vr", " ", "\[Rule]", " ", 
             RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"ncss", " ", "=", " ", 
            RowBox[{"Union", "[", 
             RowBox[{"cstrs", " ", "/.", " ", "nwrl"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[NotEqual]", "0"}], "&"}], " ", "/@", " ", 
                 "ncss"}], ",", "True"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"handled", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", "True"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"cstrs", " ", "=", " ", "ncss"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"nrls", ",", "nwrl"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", 
            "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nvrs"}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "nrls"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Copy", " ", "and", " ", "paste", " ", "of", " ", "above"}], ",", 
   " ", 
   RowBox[{
   "but", " ", "for", " ", "squares", " ", "and", " ", "as", " ", "functions",
     " ", "of", " ", "the", " ", "root", " ", "lengths"}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CWNSquareConstraints", "[", "type_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "la", ",", "nrm", ",", "family", ",", "psrs", ",", "metric", ",", "nps", 
      ",", "nrm0", ",", "nrmx", ",", "i1", ",", "i2", ",", "i3", ",", "pi1", 
      ",", "pi2", ",", "pi12", ",", "pi3", ",", "pi13", ",", "pi23", ",", 
      "pi123", ",", "psrsx", ",", 
      RowBox[{"cstrs", " ", "=", " ", 
       RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"la", " ", "=", " ", 
      RowBox[{"GetLieAlgebra", "[", "type", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"la", " ", "===", " ", "Null"}], ",", 
       RowBox[{"Return", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "nrm", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"family", " ", "=", " ", 
      RowBox[{"type", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"psrs", " ", "=", " ", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"la", "[", "\"\<posroots\>\"", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nps", " ", "=", " ", 
      RowBox[{"Length", "[", "psrs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"metric", " ", "=", " ", 
      RowBox[{"la", "[", "\"\<metric\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", "a"}], ")"}]}]}], " ", "=", " ", 
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "a"}], ")"}]}], " ", "=", " ", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "a"}], ",", 
           RowBox[{"-", "b"}]}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"-", " ", "N"}], 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"N", 
         RowBox[{"(", 
          RowBox[{"a", ",", "b"}], ")"}]}], " ", "=", " ", 
        RowBox[{
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{"b", ",", 
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}]}], ")"}]}], " ", "=", " ", 
         RowBox[{"N", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "a"}], "-", "b"}], ",", "a"}], ")"}]}]}]}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", 
           RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", "pi2"}], "]"}], " ", "=", " ", "0"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{"pi1", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", " ", 
        
        RowBox[{
         RowBox[{"nrmx", "[", 
          RowBox[{
           RowBox[{"-", "pi1"}], ",", 
           RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pi1", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi2", " ", "=", " ", 
         RowBox[{"psrs", "[", 
          RowBox[{"[", "i2", "]"}], "]"}]}], ";", " ", 
        RowBox[{"pi12", " ", "=", " ", 
         RowBox[{"pi1", " ", "+", " ", "pi2"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"psrs", ",", "pi12"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nrm0", " ", "=", " ", 
            RowBox[{"CWNLenMag", "[", 
             RowBox[{"family", ",", " ", 
              RowBox[{"Sort", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"pi1", ".", "metric", ".", "pi1"}], ",", 
                 RowBox[{"pi2", ".", "metric", ".", "pi2"}], ",", 
                 RowBox[{"pi12", ".", "metric", ".", "pi12"}]}], "}"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "nrm0"}], ";",
            "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi2", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi2"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi12"}], ",", "pi1"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", 
              RowBox[{"-", "pi12"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi2"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi12", ",", 
              RowBox[{"-", "pi1"}]}], "]"}], " ", "=", " ", "nrm0"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", "pi12"}], "]"}], " ", "=", " ", 
            "nrm0"}], ";"}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nrmx", "[", 
             RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{"pi2", ",", "pi1"}], "]"}], " ", "=", " ", "0"}], ";", 
           " ", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{
              RowBox[{"-", "pi1"}], ",", 
              RowBox[{"-", "pi2"}]}], "]"}], "=", "0"}], ";", 
           RowBox[{
            RowBox[{"nrm", "[", 
             RowBox[{
              RowBox[{"-", "pi2"}], ",", 
              RowBox[{"-", "pi1"}]}], "]"}], "=", "0"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "nps"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i2", ",", 
         RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", "b"}], ")"}], "^", "2"}]}], " ", "-", " ", 
          RowBox[{"N", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", ",", 
              RowBox[{"-", "b"}]}], ")"}], "^", "2"}]}]}]}], " ", "=", " ", 
        RowBox[{"-", " ", 
         RowBox[{"<", "a"}]}]}], ",", 
       RowBox[{"b", ">"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cstrs", " ", "=", " ", 
      RowBox[{"Join", "[", 
       RowBox[{"cstrs", ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"pi1", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"pi2", " ", "=", " ", 
              RowBox[{"psrs", "[", 
               RowBox[{"[", "i2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"nrmx", "[", 
               RowBox[{"pi1", ",", "pi2"}], "]"}], " ", "-", " ", 
              RowBox[{"nrmx", "[", 
               RowBox[{"pi1", ",", 
                RowBox[{"-", "pi2"}]}], "]"}], " ", "+", " ", 
              RowBox[{"pi1", ".", "metric", ".", "pi2"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", "nps"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i2", ",", 
              RowBox[{"i1", "-", "1"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Constraints", ":", " ", 
         RowBox[{
         "Jacobi", " ", "with", " ", "no", " ", "roots", " ", "or", " ", 
          "root", " ", "sums", " ", 
          RowBox[{"zero", ":", " ", 
           RowBox[{
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"a", ",", "b"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "b"}], ",", "c"}], ")"}]}], " ", "+", " ", 
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"b", ",", "c"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", "+", "c"}], ",", "a"}], ")"}]}], " ", "+", " ", 
            RowBox[{"N", 
             RowBox[{"(", 
              RowBox[{"c", ",", "a"}], ")"}], "N", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "+", "a"}], ",", "b"}], ")"}]}]}]}]}]}], " ", "=",
         " ", 
        RowBox[{
        "0", "\[IndentingNewLine]", "\[IndentingNewLine]", "Omitted", " ", 
         "because", " ", "it", " ", "supplies", " ", "sign", " ", 
         "constraints"}]}], ";", " ", 
       RowBox[{
       "working", " ", "on", " ", "values", " ", "of", " ", "squares"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Union", "[", "cstrs", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Successfully", " ", "does", " ", "constraints"}], ",", " ", 
   RowBox[{"to", " ", "within", " ", "several", " ", "signs"}]}], " ", 
  "*)"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conversion Utilities", "Subsection"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Converts", " ", "numerical", " ", "data", " ", "in", " ", "arrays", " ", 
    "into", " ", "Python", " ", 
    RowBox[{"form", ".", " ", "Supports"}], " ", "Null", " ", 
    RowBox[{"(", 
     RowBox[{"\[Rule]", "None"}], ")"}]}], ",", " ", "integers", ",", " ", 
   "fractions", ",", "\[IndentingNewLine]", 
   RowBox[{
   "and", " ", "lists", " ", "of", " ", "them", " ", "and", " ", "of", " ", 
    "lists"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pythonize", "[", "data_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"num", ",", "den", ",", "slst"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ToString", "[", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"Head", "[", "data", "]"}], ",", "\[IndentingNewLine]", 
       "Symbol", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"data", "===", "Null"}], ",", "\"\<None\>\"", ",", "data"}], 
        "]"}], ",", "\[IndentingNewLine]", "Rational", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"num", " ", "=", " ", 
         RowBox[{"Numerator", "[", "data", "]"}]}], ";", " ", 
        RowBox[{"den", " ", "=", " ", 
         RowBox[{"Denominator", "[", "data", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{"\"\<`1`Fraction(`2`,`3`)\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"num", "\[GreaterEqual]", "0"}], ",", "\"\<\>\"", ",", 
             "\"\<-\>\""}], "]"}], ",", 
           RowBox[{"Abs", "[", "num", "]"}], ",", "den"}], "]"}], "]"}]}], 
       ",", "\[IndentingNewLine]", "List", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"slst", " ", "=", " ", 
         RowBox[{"Pythonize", " ", "/@", " ", "data"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"slst", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{"slst", ",", 
              RowBox[{"Table", "[", 
               RowBox[{"\"\<, \>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"Length", "[", "data", "]"}], "}"}]}], "]"}]}], 
             "}"}], "]"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "data", "]"}], " ", ">", " ", "1"}], ",", 
          RowBox[{"slst", " ", "=", " ", 
           RowBox[{"Most", "[", "slst", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"StringForm", "[", 
         RowBox[{"\"\<(``)\>\"", ",", 
          RowBox[{"(", 
           RowBox[{"StringJoin", " ", "@@", " ", "slst"}], ")"}]}], "]"}]}], 
       ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", "data"}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PythonizeSubalgExtraData", "[", "]"}], " ", ":=", " ", 
  RowBox[{"StringJoin", "[", 
   RowBox[{"\"\<SubalgExtraData = {}\\n\\n\>\"", ",", 
    RowBox[{"StringJoin", " ", "@@", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<SubalgExtraData[\\\"``\\\"] = ``\\n\\n\>\"", ",", "#", ",", 
           RowBox[{"Pythonize", "[", 
            RowBox[{"SubalgExtraData", "[", "#", "]"}], "]"}]}], "]"}], "]"}],
         "&"}], " ", "/@", " ", "SubalgExtraNames"}], ")"}]}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "Takes", " ", "the", " ", "stsmdata", " ", "objects", " ", "in", " ", 
    "root", " ", "demotion", " ", "and", " ", "extension", " ", "splitting"}],
    ",", " ", 
   RowBox[{
   "and", " ", "turns", " ", "them", " ", "into", " ", "flattened", " ", 
    "data", " ", "suitable", " ", "for", " ", "storing", " ", "in", " ", "a", 
    " ", 
    RowBox[{"C", "++"}], " ", "version"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenSTSMData", "[", "stsmdata_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"flattened", "=", 
       RowBox[{"{", "}"}]}], ",", "sslen", ",", "i", ",", "ssind"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sslen", " ", "=", " ", 
      RowBox[{"Length", "[", "stsmdata", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{"flattened", ",", "sslen"}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ssind", " ", "=", " ", 
         RowBox[{"stsmdata", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"ssind", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"ssind", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flattened", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"flattened", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Numerator", "[", "#", "]"}], ",", 
                 RowBox[{"Denominator", "[", "#", "]"}]}], "}"}], "&"}], " ", 
              "/@", " ", 
              RowBox[{"ssind", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", "1"}], "]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "sslen"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "flattened"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Flattens", " ", "the", " ", "extra", " ", "data", " ", "to", " ", "put", 
     " ", "it", " ", "into", " ", "a", " ", "form", " ", "suitable", " ", 
     "for", " ", 
     RowBox[{"C", "++"}], " ", 
     RowBox[{"code", ".", " ", "Assumes"}], " ", "that", " ", "the", " ", 
     "projection", " ", "matrices", " ", "are", " ", "all"}], "-", 
    "integer"}], ",", " ", 
   RowBox[{"and", " ", "adds", " ", "a", " ", "count", " ", "of", " ", 
    RowBox[{"them", ".", " ", "No"}], " ", "U", 
    RowBox[{
     RowBox[{"(", "1", ")"}], "'"}], "s", " ", 
    RowBox[{"here", "."}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FlattenSEData", "[", "sedata_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"params", ",", "projs", ",", "npjs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"params", " ", "=", " ", 
      RowBox[{"sedata", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"projs", " ", "=", " ", 
      RowBox[{"sedata", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"npjs", " ", "=", " ", 
      RowBox[{"Length", "[", "projs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"params", ",", "npjs", ",", "projs"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "The", " ", "substitution", " ", "is", " ", "to", " ", "make", " ", "the",
      " ", "labels", " ", "more", " ", 
     RowBox[{"C", "++"}]}], "-", "friendly"}], ",", " ", 
   RowBox[{
   "so", " ", "they", " ", "can", " ", "be", " ", "used", " ", "as", " ", 
    "identifiers"}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CPPizeLabel", "[", "lbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"lbl", ",", 
     RowBox[{"\"\<-\>\"", "\[Rule]", "\"\<_\>\""}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSEString", "[", "selbl_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<static const DKINT SubalgExtraData_\>\"", ",", 
      RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<[] = \>\"", ",", 
      RowBox[{"ToString", "[", 
       RowBox[{"FlattenSEData", "[", 
        RowBox[{"SubalgExtraData", "[", "selbl", "]"}], "]"}], "]"}], ",", 
      "\"\<;\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSEEntryString", "[", "selbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\tSubalgExtraData_\>\"", ",", 
     RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<,\\n\>\""}], 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSESetString", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ind", ",", "plc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"plc", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEEntryString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "ind", ",", "\"\<\\nstatic const DKINT *SubalgExtraData[] = {\\n\>\"", 
       ",", "plc", ",", "\"\<};\\n\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeSEEnumString", "[", "selbl_", "]"}], " ", ":=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"\"\<\\tLA_BR_SUBALG_EXTRA_\>\"", ",", 
     RowBox[{"CPPizeLabel", "[", "selbl", "]"}], ",", "\"\<,\\n\>\""}], 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeSEEnumSetString", "[", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ind", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ind", " ", "=", " ", 
      RowBox[{"StringJoin", " ", "@@", " ", 
       RowBox[{"(", 
        RowBox[{"MakeSEEnumString", " ", "/@", " ", "SubalgExtraNames"}], 
        ")"}]}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "\"\<enum {\\n\>\"", ",", "ind", ",", 
       "\"\<\\tLA_BR_NUMBER_OF_SUBALG_EXTRAS\\n};\\n\>\""}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"]
}, Closed]]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowSize->{717, 778},
WindowMargins->{{23, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 31, 0, 64, "Section"],
Cell[601, 24, 15608, 216, 6357, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16246, 245, 42, 0, 64, "Section"],
Cell[16291, 247, 235, 5, 63, "Input"],
Cell[16529, 254, 159, 3, 63, "Input"],
Cell[16691, 259, 1955, 50, 250, "Input"],
Cell[18649, 311, 2289, 60, 250, "Input"],
Cell[20941, 373, 540, 13, 97, "Input"],
Cell[21484, 388, 1101, 29, 97, "Input"],
Cell[22588, 419, 8680, 187, 947, "Input"],
Cell[31271, 608, 381, 9, 63, "Input"],
Cell[31655, 619, 652, 20, 46, "Input"],
Cell[32310, 641, 430, 12, 46, "Input"],
Cell[32743, 655, 441, 11, 80, "Input"],
Cell[33187, 668, 152, 4, 28, "Input"],
Cell[33342, 674, 29676, 733, 2341, "Input"],
Cell[63021, 1409, 119, 3, 28, "Input"],
Cell[63143, 1414, 90, 2, 28, "Input"],
Cell[63236, 1418, 262, 6, 46, "Input"],
Cell[63501, 1426, 1006, 26, 182, "Input"],
Cell[64510, 1454, 797, 21, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[65344, 1480, 55, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[65424, 1484, 39, 0, 44, "Subsection"],
Cell[65466, 1486, 561, 11, 97, "Input"],
Cell[66030, 1499, 185, 5, 46, "Input"],
Cell[66218, 1506, 1701, 48, 165, "Input"],
Cell[67922, 1556, 112, 2, 28, "Input"],
Cell[68037, 1560, 1104, 29, 97, "Input"],
Cell[69144, 1591, 6085, 139, 658, "Input"],
Cell[75232, 1732, 486, 9, 80, "Input"],
Cell[75721, 1743, 4860, 121, 488, "Input"],
Cell[80584, 1866, 270, 6, 63, "Input"],
Cell[80857, 1874, 1138, 29, 148, "Input"],
Cell[81998, 1905, 162, 4, 28, "Input"],
Cell[82163, 1911, 212, 5, 28, "Input"],
Cell[82378, 1918, 287, 5, 63, "Input"],
Cell[82668, 1925, 253, 7, 28, "Input"],
Cell[82924, 1934, 540, 10, 97, "Input"],
Cell[83467, 1946, 2648, 69, 301, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[86152, 2020, 33, 0, 36, "Subsection"],
Cell[86188, 2022, 263, 5, 46, "Input"],
Cell[86454, 2029, 4360, 104, 488, "Input"],
Cell[90817, 2135, 172, 4, 28, "Input"],
Cell[90992, 2141, 2838, 71, 335, "Input"],
Cell[93833, 2214, 147, 4, 28, "Input"],
Cell[93983, 2220, 215, 5, 28, "Input"],
Cell[94201, 2227, 2122, 56, 182, "Input"],
Cell[96326, 2285, 223, 6, 28, "Input"],
Cell[96552, 2293, 174, 4, 28, "Input"],
Cell[96729, 2299, 15814, 381, 1321, "Input"],
Cell[112546, 2682, 1160, 32, 97, "Input"],
Cell[113709, 2716, 343, 6, 46, "Input"],
Cell[114055, 2724, 89, 2, 28, "Input"],
Cell[114147, 2728, 1652, 42, 199, "Input"],
Cell[115802, 2772, 344, 9, 46, "Input"],
Cell[116149, 2783, 1328, 32, 165, "Input"],
Cell[117480, 2817, 1040, 26, 114, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[118557, 2848, 45, 0, 36, "Subsection"],
Cell[118605, 2850, 176, 4, 28, "Input"],
Cell[118784, 2856, 4366, 105, 522, "Input"],
Cell[123153, 2963, 701, 15, 97, "Input"],
Cell[123857, 2980, 5457, 133, 556, "Input"],
Cell[129317, 3115, 547, 14, 80, "Input"],
Cell[129867, 3131, 1165, 29, 148, "Input"],
Cell[131035, 3162, 377, 7, 46, "Input"],
Cell[131415, 3171, 103, 2, 28, "Input"],
Cell[131521, 3175, 1285, 32, 165, "Input"],
Cell[132809, 3209, 292, 6, 46, "Input"],
Cell[133104, 3217, 1075, 30, 97, "Input"],
Cell[134182, 3249, 163, 4, 28, "Input"],
Cell[134348, 3255, 304, 7, 46, "Input"],
Cell[134655, 3264, 343, 7, 46, "Input"],
Cell[135001, 3273, 94, 2, 28, "Input"],
Cell[135098, 3277, 1243, 32, 165, "Input"],
Cell[136344, 3311, 257, 6, 46, "Input"],
Cell[136604, 3319, 320, 9, 28, "Input"],
Cell[136927, 3330, 465, 12, 80, "Input"],
Cell[137395, 3344, 1207, 33, 114, "Input"],
Cell[138605, 3379, 3127, 82, 267, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[141769, 3466, 38, 0, 36, "Subsection"],
Cell[141810, 3468, 404, 10, 46, "Input"],
Cell[142217, 3480, 2630, 64, 301, "Input"],
Cell[144850, 3546, 744, 18, 97, "Input"],
Cell[145597, 3566, 818, 20, 97, "Input"],
Cell[146418, 3588, 4242, 110, 590, "Input"],
Cell[150663, 3700, 877, 23, 114, "Input"],
Cell[151543, 3725, 229, 6, 28, "Input"],
Cell[151775, 3733, 4408, 110, 369, "Input"],
Cell[156186, 3845, 5576, 127, 556, "Input"],
Cell[161765, 3974, 5371, 134, 726, "Input"],
Cell[167139, 4110, 193, 4, 28, "Input"],
Cell[167335, 4116, 436, 13, 28, "Input"],
Cell[167774, 4131, 385, 10, 46, "Input"],
Cell[168162, 4143, 376, 10, 46, "Input"],
Cell[168541, 4155, 434, 11, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[169012, 4171, 49, 0, 36, "Subsection"],
Cell[169064, 4173, 2282, 59, 250, "Input"],
Cell[171349, 4234, 443, 11, 63, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[171841, 4251, 50, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[171916, 4255, 39, 0, 44, "Subsection"],
Cell[171958, 4257, 152, 3, 28, "Input"],
Cell[172113, 4262, 422, 9, 46, "Input"],
Cell[172538, 4273, 4040, 93, 437, "Input"],
Cell[176581, 4368, 171, 4, 28, "Input"],
Cell[176755, 4374, 1425, 40, 131, "Input"],
Cell[178183, 4416, 5508, 131, 522, "Input"],
Cell[183694, 4549, 222, 5, 28, "Input"],
Cell[183919, 4556, 232, 5, 46, "Input"],
Cell[184154, 4563, 1664, 33, 216, "Input"],
Cell[185821, 4598, 4659, 118, 420, "Input"],
Cell[190483, 4718, 232, 5, 46, "Input"],
Cell[190718, 4725, 244, 5, 46, "Input"],
Cell[190965, 4732, 240, 5, 46, "Input"],
Cell[191208, 4739, 250, 5, 46, "Input"],
Cell[191461, 4746, 505, 13, 63, "Input"],
Cell[191969, 4761, 164, 4, 28, "Input"],
Cell[192136, 4767, 682, 16, 80, "Input"],
Cell[192821, 4785, 718, 16, 97, "Input"],
Cell[193542, 4803, 1212, 29, 97, "Input"],
Cell[194757, 4834, 888, 24, 80, "Input"],
Cell[195648, 4860, 486, 14, 46, "Input"],
Cell[196137, 4876, 1086, 29, 97, "Input"],
Cell[197226, 4907, 696, 17, 80, "Input"],
Cell[197925, 4926, 1184, 32, 131, "Input"],
Cell[199112, 4960, 186, 5, 28, "Input"],
Cell[199301, 4967, 3035, 75, 318, "Input"],
Cell[202339, 5044, 745, 21, 80, "Input"],
Cell[203087, 5067, 812, 20, 97, "Input"],
Cell[203902, 5089, 4826, 112, 556, "Input"],
Cell[208731, 5203, 133, 3, 28, "Input"],
Cell[208867, 5208, 464, 14, 28, "Input"],
Cell[209334, 5224, 253, 6, 46, "Input"],
Cell[209590, 5232, 271, 6, 46, "Input"],
Cell[209864, 5240, 264, 6, 46, "Input"],
Cell[210131, 5248, 286, 7, 46, "Input"],
Cell[210420, 5257, 173, 4, 28, "Input"],
Cell[210596, 5263, 770, 19, 97, "Input"],
Cell[211369, 5284, 182, 4, 28, "Input"],
Cell[211554, 5290, 1483, 39, 148, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[213074, 5334, 36, 0, 36, "Subsection"],
Cell[213113, 5336, 227, 5, 63, "Input"],
Cell[213343, 5343, 1459, 30, 165, "Input"],
Cell[214805, 5375, 125, 3, 28, "Input"],
Cell[214933, 5380, 209, 6, 28, "Input"],
Cell[215145, 5388, 395, 11, 28, "Input"],
Cell[215543, 5401, 2542, 66, 233, "Input"],
Cell[218088, 5469, 531, 12, 63, "Input"],
Cell[218622, 5483, 273, 7, 28, "Input"],
Cell[218898, 5492, 308, 7, 46, "Input"],
Cell[219209, 5501, 2103, 57, 182, "Input"],
Cell[221315, 5560, 287, 7, 46, "Input"],
Cell[221605, 5569, 1380, 36, 131, "Input"],
Cell[222988, 5607, 4696, 114, 505, "Input"],
Cell[227687, 5723, 279, 7, 28, "Input"],
Cell[227969, 5732, 633, 19, 63, "Input"],
Cell[228605, 5753, 188, 4, 28, "Input"],
Cell[228796, 5759, 609, 13, 97, "Input"],
Cell[229408, 5774, 280, 7, 28, "Input"],
Cell[229691, 5783, 329, 8, 46, "Input"],
Cell[230023, 5793, 8551, 204, 828, "Input"],
Cell[238577, 5999, 335, 8, 46, "Input"],
Cell[238915, 6009, 332, 9, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[239284, 6023, 34, 0, 36, "Subsection"],
Cell[239321, 6025, 380, 9, 46, "Input"],
Cell[239704, 6036, 1325, 35, 131, "Input"],
Cell[241032, 6073, 110, 3, 28, "Input"],
Cell[241145, 6078, 1924, 49, 267, "Input"],
Cell[243072, 6129, 307, 10, 28, "Input"],
Cell[243382, 6141, 779, 22, 80, "Input"],
Cell[244164, 6165, 3034, 74, 352, "Input"],
Cell[247201, 6241, 234, 7, 28, "Input"],
Cell[247438, 6250, 231, 7, 28, "Input"],
Cell[247672, 6259, 227, 7, 28, "Input"],
Cell[247902, 6268, 232, 7, 28, "Input"],
Cell[248137, 6277, 415, 12, 46, "Input"],
Cell[248555, 6291, 492, 9, 63, "Input"],
Cell[249050, 6302, 7029, 173, 675, "Input"],
Cell[256082, 6477, 6507, 153, 590, "Input"],
Cell[262592, 6632, 772, 20, 114, "Input"],
Cell[263367, 6654, 2532, 61, 318, "Input"],
Cell[265902, 6717, 766, 19, 80, "Input"],
Cell[266671, 6738, 5479, 134, 488, "Input"],
Cell[272153, 6874, 249, 6, 28, "Input"],
Cell[272405, 6882, 191, 5, 28, "Input"],
Cell[272599, 6889, 200, 4, 28, "Input"],
Cell[272802, 6895, 1867, 48, 216, "Input"],
Cell[274672, 6945, 437, 10, 63, "Input"],
Cell[275112, 6957, 149, 4, 28, "Input"],
Cell[275264, 6963, 929, 26, 97, "Input"],
Cell[276196, 6991, 7283, 173, 726, "Input"],
Cell[283482, 7166, 109, 2, 28, "Input"],
Cell[283594, 7170, 431, 9, 63, "Input"],
Cell[284028, 7181, 273, 7, 28, "Input"],
Cell[284304, 7190, 299, 7, 46, "Input"],
Cell[284606, 7199, 505, 10, 63, "Input"],
Cell[285114, 7211, 280, 7, 28, "Input"],
Cell[285397, 7220, 317, 7, 46, "Input"],
Cell[285717, 7229, 5984, 149, 437, "Input"],
Cell[291704, 7380, 289, 8, 28, "Input"],
Cell[291996, 7390, 7274, 175, 658, "Input"],
Cell[299273, 7567, 466, 11, 63, "Input"],
Cell[299742, 7580, 273, 7, 28, "Input"],
Cell[300018, 7589, 325, 8, 46, "Input"],
Cell[300346, 7599, 532, 11, 63, "Input"],
Cell[300881, 7612, 264, 7, 28, "Input"],
Cell[301148, 7621, 343, 8, 46, "Input"],
Cell[301494, 7631, 7836, 200, 675, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[309379, 7837, 50, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[309454, 7841, 58, 0, 44, "Subsection"],
Cell[309515, 7843, 2041, 43, 284, "Input"],
Cell[311559, 7888, 4552, 112, 437, "Input"],
Cell[316114, 8002, 592, 14, 131, "Input"],
Cell[316709, 8018, 349, 9, 46, "Input"],
Cell[317061, 8029, 223, 5, 28, "Input"],
Cell[317287, 8036, 2304, 63, 199, "Input"],
Cell[319594, 8101, 2119, 54, 267, "Input"],
Cell[321716, 8157, 758, 18, 80, "Input"],
Cell[322477, 8177, 2002, 51, 199, "Input"],
Cell[324482, 8230, 488, 15, 46, "Input"],
Cell[324973, 8247, 308, 8, 46, "Input"],
Cell[325284, 8257, 1422, 37, 165, "Input"],
Cell[326709, 8296, 234, 5, 28, "Input"],
Cell[326946, 8303, 134, 3, 28, "Input"],
Cell[327083, 8308, 1422, 37, 165, "Input"],
Cell[328508, 8347, 234, 5, 28, "Input"],
Cell[328745, 8354, 2751, 67, 335, "Input"],
Cell[331499, 8423, 1458, 37, 182, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[332994, 8465, 66, 0, 36, "Subsection"],
Cell[333063, 8467, 715, 15, 114, "Input"],
Cell[333781, 8484, 691, 15, 97, "Input"],
Cell[334475, 8501, 25868, 647, 2324, "Input"],
Cell[360346, 9150, 173, 4, 28, "Input"],
Cell[360522, 9156, 4228, 108, 369, "Input"],
Cell[364753, 9266, 924, 23, 97, "Input"],
Cell[365680, 9291, 338, 9, 46, "Input"],
Cell[366021, 9302, 150, 3, 28, "Input"],
Cell[366174, 9307, 253, 6, 28, "Input"],
Cell[366430, 9315, 236, 5, 28, "Input"],
Cell[366669, 9322, 652, 18, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[367358, 9345, 41, 0, 36, "Subsection"],
Cell[367402, 9347, 838, 19, 131, "Input"],
Cell[368243, 9368, 172, 4, 28, "Input"],
Cell[368418, 9374, 153, 4, 28, "Input"],
Cell[368574, 9380, 27997, 695, 2035, "Input"],
Cell[396574, 10077, 305, 8, 63, "Input"],
Cell[396882, 10087, 660, 18, 63, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[397579, 10110, 58, 0, 36, "Subsection"],
Cell[397640, 10112, 1365, 28, 182, "Input"],
Cell[399008, 10142, 437, 11, 63, "Input"],
Cell[399448, 10155, 155, 4, 28, "Input"],
Cell[399606, 10161, 7293, 183, 641, "Input"],
Cell[406902, 10346, 1004, 24, 97, "Input"],
Cell[407909, 10372, 160, 4, 28, "Input"],
Cell[408072, 10378, 30544, 706, 2086, "Input"],
Cell[438619, 11086, 289, 8, 28, "Input"],
Cell[438911, 11096, 192, 5, 28, "Input"],
Cell[439106, 11103, 221, 6, 28, "Input"],
Cell[439330, 11111, 770, 23, 46, "Input"],
Cell[440103, 11136, 1383, 35, 267, "Input"],
Cell[441489, 11173, 2710, 67, 199, "Input"],
Cell[444202, 11242, 167, 4, 28, "Input"],
Cell[444372, 11248, 6186, 172, 403, "Input"],
Cell[450561, 11422, 609, 19, 46, "Input"],
Cell[451173, 11443, 160, 4, 28, "Input"],
Cell[451336, 11449, 4133, 111, 318, "Input"],
Cell[455472, 11562, 377, 12, 28, "Input"],
Cell[455852, 11576, 160, 4, 28, "Input"],
Cell[456015, 11582, 2374, 70, 165, "Input"],
Cell[458392, 11654, 1498, 36, 182, "Input"],
Cell[459893, 11692, 1060, 30, 97, "Input"],
Cell[460956, 11724, 2805, 64, 335, "Input"],
Cell[463764, 11790, 769, 13, 80, "Input"],
Cell[464536, 11805, 497, 17, 28, "Input"],
Cell[465036, 11824, 639, 21, 28, "Input"],
Cell[465678, 11847, 741, 24, 46, "Input"],
Cell[466422, 11873, 713, 23, 46, "Input"],
Cell[467138, 11898, 579, 19, 28, "Input"],
Cell[467720, 11919, 1142, 36, 63, "Input"],
Cell[468865, 11957, 909, 29, 46, "Input"],
Cell[469777, 11988, 883, 28, 46, "Input"],
Cell[470663, 12018, 1011, 28, 80, "Input"],
Cell[471677, 12048, 983, 27, 80, "Input"],
Cell[472663, 12077, 1574, 48, 63, "Input"],
Cell[474240, 12127, 704, 22, 46, "Input"],
Cell[474947, 12151, 704, 22, 46, "Input"],
Cell[475654, 12175, 982, 31, 63, "Input"],
Cell[476639, 12208, 1253, 38, 63, "Input"],
Cell[477895, 12248, 1546, 47, 63, "Input"],
Cell[479444, 12297, 1690, 47, 80, "Input"],
Cell[481137, 12346, 1883, 55, 97, "Input"],
Cell[483023, 12403, 745, 23, 46, "Input"],
Cell[483771, 12428, 745, 23, 46, "Input"],
Cell[484519, 12453, 745, 23, 46, "Input"],
Cell[485267, 12478, 1663, 50, 80, "Input"],
Cell[486933, 12530, 1083, 34, 80, "Input"],
Cell[488019, 12566, 2270, 64, 114, "Input"],
Cell[490292, 12632, 182, 5, 46, "Input"],
Cell[490477, 12639, 1244, 33, 148, "Input"],
Cell[491724, 12674, 13744, 343, 1525, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[505505, 13022, 63, 0, 36, "Subsection"],
Cell[505571, 13024, 334, 7, 46, "Input"],
Cell[505908, 13033, 148, 4, 28, "Input"],
Cell[506059, 13039, 171, 4, 28, "Input"],
Cell[506233, 13045, 155, 4, 28, "Input"],
Cell[506391, 13051, 5777, 139, 590, "Input"],
Cell[512171, 13192, 367, 10, 28, "Input"],
Cell[512541, 13204, 161, 4, 28, "Input"],
Cell[512705, 13210, 150, 4, 28, "Input"],
Cell[512858, 13216, 4775, 124, 437, "Input"],
Cell[517636, 13342, 306, 8, 28, "Input"],
Cell[517945, 13352, 4696, 119, 437, "Input"],
Cell[522644, 13473, 306, 8, 28, "Input"],
Cell[522953, 13483, 4706, 119, 437, "Input"],
Cell[527662, 13604, 206, 5, 28, "Input"],
Cell[527871, 13611, 5234, 129, 488, "Input"],
Cell[533108, 13742, 330, 8, 28, "Input"],
Cell[533441, 13752, 162, 4, 28, "Input"],
Cell[533606, 13758, 5924, 152, 539, "Input"],
Cell[539533, 13912, 319, 7, 63, "Input"],
Cell[539855, 13921, 4329, 101, 437, "Input"],
Cell[544187, 14024, 621, 12, 80, "Input"],
Cell[544811, 14038, 164, 4, 28, "Input"],
Cell[544978, 14044, 173, 4, 28, "Input"],
Cell[545154, 14050, 5286, 134, 505, "Input"],
Cell[550443, 14186, 118, 3, 28, "Input"],
Cell[550564, 14191, 2417, 58, 301, "Input"],
Cell[552984, 14251, 103, 2, 28, "Input"],
Cell[553090, 14255, 428, 12, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[553567, 14273, 53, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[553645, 14277, 48, 0, 44, "Subsection"],
Cell[553696, 14279, 2034, 52, 301, "Input"],
Cell[555733, 14333, 2654, 67, 250, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[558424, 14405, 97, 2, 36, "Subsection"],
Cell[558524, 14409, 630, 17, 63, "Input"],
Cell[559157, 14428, 3397, 94, 233, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[562591, 14527, 36, 0, 36, "Subsection"],
Cell[562630, 14529, 218, 5, 28, "Input"],
Cell[562851, 14536, 15734, 398, 1185, "Input"],
Cell[578588, 14936, 772, 23, 80, "Input"],
Cell[579363, 14961, 299, 9, 46, "Input"],
Cell[579665, 14972, 810, 23, 80, "Input"],
Cell[580478, 14997, 299, 9, 46, "Input"],
Cell[580780, 15008, 274, 7, 46, "Input"],
Cell[581057, 15017, 324, 9, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[581430, 15032, 25, 0, 50, "Section"],
Cell[CellGroupData[{
Cell[581480, 15036, 44, 0, 44, "Subsection"],
Cell[581527, 15038, 1392, 34, 182, "Input"],
Cell[582922, 15074, 1616, 35, 403, "Input"],
Cell[584541, 15111, 33866, 817, 2579, "Input"],
Cell[618410, 15930, 163, 4, 28, "Input"],
Cell[618576, 15936, 4811, 111, 590, "Input"],
Cell[623390, 16049, 219, 5, 28, "Input"],
Cell[623612, 16056, 928, 25, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[624577, 16086, 54, 0, 36, "Subsection"],
Cell[624634, 16088, 172, 4, 28, "Input"],
Cell[624809, 16094, 338, 10, 28, "Input"],
Cell[625150, 16106, 1614, 42, 131, "Input"],
Cell[626767, 16150, 8542, 199, 981, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[635346, 16354, 44, 0, 36, "Subsection"],
Cell[635393, 16356, 567, 14, 80, "Input"],
Cell[635963, 16372, 9993, 241, 845, "Input"],
Cell[645959, 16615, 988, 25, 131, "Input"],
Cell[646950, 16642, 10248, 249, 862, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[657235, 16896, 52, 0, 36, "Subsection"],
Cell[657290, 16898, 646, 17, 97, "Input"],
Cell[657939, 16917, 9768, 235, 811, "Input"],
Cell[667710, 17154, 691, 18, 97, "Input"],
Cell[668404, 17174, 10147, 249, 845, "Input"],
Cell[678554, 17425, 906, 26, 97, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[679497, 17456, 70, 0, 36, "Subsection"],
Cell[679570, 17458, 534, 13, 63, "Input"],
Cell[680107, 17473, 7950, 199, 828, "Input"],
Cell[688060, 17674, 18750, 489, 1151, "Input"],
Cell[706813, 18165, 334, 8, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[707184, 18178, 33, 0, 36, "Subsection"],
Cell[707220, 18180, 405, 11, 63, "Input"],
Cell[707628, 18193, 1828, 49, 182, "Input"],
Cell[709459, 18244, 2530, 66, 233, "Input"],
Cell[711992, 18312, 2285, 59, 233, "Input"],
Cell[714280, 18373, 924, 25, 80, "Input"],
Cell[715207, 18400, 4021, 111, 233, "Input"],
Cell[719231, 18513, 716, 21, 63, "Input"],
Cell[719950, 18536, 2193, 63, 148, "Input"],
Cell[722146, 18601, 688, 20, 63, "Input"],
Cell[722837, 18623, 2022, 58, 148, "Input"],
Cell[724862, 18683, 543, 16, 46, "Input"],
Cell[725408, 18701, 2678, 77, 165, "Input"],
Cell[728089, 18780, 111, 2, 28, "Input"],
Cell[728203, 18784, 321, 9, 28, "Input"],
Cell[728527, 18795, 1459, 44, 114, "Input"],
Cell[729989, 18841, 682, 18, 97, "Input"],
Cell[730674, 18861, 1946, 52, 131, "Input"],
Cell[732623, 18915, 2181, 57, 148, "Input"],
Cell[734807, 18974, 1812, 43, 369, "Input"],
Cell[736622, 19019, 1378, 34, 199, "Input"],
Cell[738003, 19055, 465, 15, 46, "Input"],
Cell[738471, 19072, 294, 8, 28, "Input"],
Cell[738768, 19082, 227, 6, 28, "Input"],
Cell[738998, 19090, 214, 6, 28, "Input"],
Cell[739215, 19098, 2828, 68, 301, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[742080, 19171, 45, 0, 36, "Subsection"],
Cell[742128, 19173, 471, 10, 63, "Input"],
Cell[742602, 19185, 2377, 66, 216, "Input"],
Cell[744982, 19253, 387, 10, 46, "Input"],
Cell[745372, 19265, 283, 7, 46, "Input"],
Cell[745658, 19274, 15312, 366, 1304, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[761007, 19645, 48, 0, 36, "Subsection"],
Cell[761058, 19647, 1589, 46, 148, "Input"],
Cell[762650, 19695, 180, 4, 28, "Input"],
Cell[762833, 19701, 2065, 54, 199, "Input"],
Cell[764901, 19757, 763, 23, 46, "Input"],
Cell[765667, 19782, 2317, 79, 131, "Input"],
Cell[767987, 19863, 489, 10, 63, "Input"],
Cell[768479, 19875, 15481, 393, 1066, "Input"],
Cell[783963, 20270, 4709, 110, 573, "Input"],
Cell[788675, 20382, 310, 8, 46, "Input"],
Cell[788988, 20392, 11935, 313, 879, "Input"],
Cell[800926, 20707, 210, 5, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[801173, 20717, 42, 0, 36, "Subsection"],
Cell[801218, 20719, 499, 12, 63, "Input"],
Cell[801720, 20733, 2561, 61, 301, "Input"],
Cell[804284, 20796, 639, 16, 97, "Input"],
Cell[804926, 20814, 468, 11, 63, "Input"],
Cell[805397, 20827, 2004, 52, 216, "Input"],
Cell[807404, 20881, 681, 16, 63, "Input"],
Cell[808088, 20899, 810, 20, 114, "Input"],
Cell[808901, 20921, 380, 10, 46, "Input"],
Cell[809284, 20933, 236, 6, 28, "Input"],
Cell[809523, 20941, 576, 12, 80, "Input"],
Cell[810102, 20955, 288, 7, 46, "Input"],
Cell[810393, 20964, 893, 22, 114, "Input"],
Cell[811289, 20988, 290, 7, 46, "Input"],
Cell[811582, 20997, 637, 16, 80, "Input"]
}, Closed]]
}, Closed]]
}
]
*)

